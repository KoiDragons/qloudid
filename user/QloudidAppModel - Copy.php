<?php
require_once('../AppModel.php');
class safeqloudAppModel extends AppModel
{   
		
		function tenantInvoiceInfo($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select id,invoice_generated_date,total_amount,payment_due,is_paid from landloard_building_tenant_invoice_detail where tenant_id=(select id from landloard_building_tenant where building_id=? and tenant_email=(select email from user_logins where id=?)) order by is_paid");
			$stmt->bind_param("ii", $data['building_id'],$data['user_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			while($row = $result->fetch_assoc())
			{
			$row['latest']=date('d M',$row['payment_due']);
			$row['invoice_month']=date('M',$row['invoice_generated_date']);
			array_push($org,$row);
			}
			$stmt->close();
			$dbCon->close();
			return $org;
			
			
		}
		
		
		function payRentInvoice($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select first_name,tenant_email,landloard_building_tenant_invoice_detail.id,invoice_generated_date,total_amount,payment_due from landloard_building_tenant_invoice_detail left join landloard_building_tenant on landloard_building_tenant.id=landloard_building_tenant_invoice_detail.tenant_id  where landloard_building_tenant_invoice_detail.id=?");
			$stmt->bind_param("i", $data['invoice_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			$ch = curl_init();
			curl_setopt($ch, CURLOPT_URL, 'https://api.stripe.com/v1/tokens');
			curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
			curl_setopt($ch, CURLOPT_POST, 1);
			curl_setopt($ch, CURLOPT_POSTFIELDS, "card[number]=4242424242424242&card[exp_month]=2&card[exp_year]=2050&card[cvc]=314");
			curl_setopt($ch, CURLOPT_USERPWD, 'sk_test_mTVjBSZHopmJyA3wgvzRwUM2' . ':' . '');

			$headers = array();
			$headers[] = 'Content-Type: application/x-www-form-urlencoded';
			curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);

			$result = curl_exec($ch);
			if (curl_errno($ch)) {
				echo 'Error:' . curl_error($ch);
			}
			curl_close($ch);
			$a=json_decode($result,true);
			 
			$ch = curl_init();

			curl_setopt($ch, CURLOPT_URL, 'https://api.stripe.com/v1/customers');
			curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
			curl_setopt($ch, CURLOPT_POST, 1);
			curl_setopt($ch, CURLOPT_POSTFIELDS, "name=".$row['first_name']."&email=".$row['tenant_email']."&source=".$a['id']."&description=My");
			curl_setopt($ch, CURLOPT_USERPWD, 'sk_test_mTVjBSZHopmJyA3wgvzRwUM2' . ':' . '');

			$headers = array();
			$headers[] = 'Content-Type: application/x-www-form-urlencoded';
			curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);

			$result = curl_exec($ch);
			if (curl_errno($ch)) {
				echo 'Error:' . curl_error($ch);
			}
			curl_close($ch);
			$b=json_decode($result,true);
			$cuId=$b['id'];
			
			$total_price=$row['total_amount']*100;
			if($total_price<500)
			{
				$total_price=500;
			}
			$ch = curl_init();

			curl_setopt($ch, CURLOPT_URL, 'https://api.stripe.com/v1/charges');
			curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
			curl_setopt($ch, CURLOPT_POST, 1);
			curl_setopt($ch, CURLOPT_POSTFIELDS, "customer=".$b['id']."&amount=".$total_price."&currency=sek&description=My");
			curl_setopt($ch, CURLOPT_USERPWD, 'sk_test_mTVjBSZHopmJyA3wgvzRwUM2' . ':' . '');

			$headers = array();
			$headers[] = 'Content-Type: application/x-www-form-urlencoded';
			curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);

			$result = curl_exec($ch);
			if (curl_errno($ch)) {
				echo 'Error:' . curl_error($ch);
			}
			curl_close($ch);			
			$c=json_decode($result,true);
			$Chargeid=$c['id'];	
			
			$stmt = $dbCon->prepare("update landloard_building_tenant_invoice_detail set is_paid=1,paid_on=now(),paid_by_user=?,payee_id=?,payee_user_id=?,card_id=?,transection_id=? where id=?");
			$stmt->bind_param("iiiisi",$data['is_company'],$data['invoice_id'],$data['user_id'],$data['card_id'],$Chargeid,$data['invoice_id']);
			$stmt->execute();
			$stmt->close();
			$dbCon->close();
			return 1;
		}

		function checkinAparmentOwner($data)
		{
			$dbCon = AppModel::createConnection();
			$hotel_id= $this->encrypt_decrypt('decrypt',$data['id']);
			$guest_adults=1;
			$st=3;
			$guest_children=0;
			
			$stmt = $dbCon->prepare("insert into `hotel_checkout_detail`(guest_children,guest_infant,user_id,checked_in,created_on,`guest_adult`,`checkin_date`,`room_type_id`,`hotel_property_type`) values (?, ?,?, ?, now(),?,now(), ?, ?)");
			
			/* bind parameters for markers */
			$stmt->bind_param("iiiiiii",$guest_children,$guest_children,$data['user_id'],$guest_adults, $guest_adults,$hotel_id,$st);
			$stmt->execute();
			
			$id=$stmt->insert_id;
			 
			
			$curl = curl_init();
			  curl_setopt_array($curl, array(
			  CURLOPT_URL => 'https://dstricts.com/user/index.php/DstrictsApp/checkinAparmentOwner',
			  CURLOPT_RETURNTRANSFER => true,
			  CURLOPT_ENCODING => '',
			  CURLOPT_MAXREDIRS => 10,
			  CURLOPT_TIMEOUT => 0,
			  CURLOPT_FOLLOWLOCATION => true,
			  CURLOPT_HTTP_VERSION => CURL_HTTP_VERSION_1_1,
			  CURLOPT_CUSTOMREQUEST => 'POST',
			  CURLOPT_POSTFIELDS => array('user_id' =>$data['user_id'],'room_type_id' => $hotel_id,'checkid' => $id),
			));
			$response = curl_exec($curl);
			curl_close($curl);
			$stmt->close();
			$dbCon->close();
			return 1;
			 
		}
		

		function apartmentDetailInfoCheckin($data)
		{
			 
			$dbCon = AppModel::createConnection();
			$hotel_id= $this->encrypt_decrypt('decrypt',$data['id']);
			 
			$stmt = $dbCon->prepare("select property_nickname,name_on_house,user_id from user_address where id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $hotel_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			if($row['user_id']==$data['dstricts_user_id'])
			{
				$row['is_owner']=1;
			}
			else
			{
			$row['is_owner']=0;	
			}
			$row['property_nickname']=html_entity_decode($row['property_nickname'],ENT_NOQUOTES, 'UTF-8');
			$row['name_on_house']=html_entity_decode($row['name_on_house'],ENT_NOQUOTES, 'UTF-8'); 
			
			$today=strtotime(date('Y-m-d'));
			$stmt = $dbCon->prepare("select id,chekin_type,checked_in,checkin_booking_date,checkout_booking_date from hotel_checkout_detail where room_type_id=? and user_id=? and checkin_booking_date<=? and checkout_booking_date>? and hotel_property_type=2 and checked_in=0");
			
			/* bind parameters for markers */
			$stmt->bind_param("iiss",$hotel_id,$data['dstricts_user_id'],$today,$today);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowChecking = $result->fetch_assoc();
			 
			if(empty($rowChecking))
			{
			 $row['qloud_checkout_id']=0;	
			}
			else
			{
			$row['qloud_checkout_id']=$this->encrypt_decrypt('encrypt',$rowChecking['id']);		
			}
			
			$stmt = $dbCon->prepare("select count(id) as num from hotel_checkout_detail where room_type_id=? and user_id=? and hotel_property_type=3 and checked_in=1");
			
			/* bind parameters for markers */
			$stmt->bind_param("ii",$hotel_id,$data['dstricts_user_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowChecking = $result->fetch_assoc();
			$row['owner_checked_in']=$rowChecking['num'];
			$stmt->close();
			$dbCon->close();
			return $row;
			
		}
		
		
		function deleteBathroom($data)
		{ 
		
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select count(id) as num from user_apartment_bathroom_detail where user_address_id=?");
			$stmt->bind_param("i", $data['aid']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			if($row['num']>1)
			{
			$stmt = $dbCon->prepare("select max(id) as m_id from user_apartment_bathroom_detail where user_address_id=?");
			$stmt->bind_param("i", $data['aid']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			
			$stmt = $dbCon->prepare("delete from user_apartment_bathroom_detail where id=?");
			$stmt->bind_param("i", $row['m_id']);
			$stmt->execute();	
			$stmt->close();
			$dbCon->close();
			return 1;
			}
			 else
			 {
			$stmt->close();
			$dbCon->close();
			return 0;
			 }
			 	
		}
		
		function addBathroom($data)
		{ 
		
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("insert into user_apartment_bathroom_detail (user_address_id, created_on, modified_on) values (?,now(), now())");
			$stmt->bind_param("i", $data['aid']);
			$stmt->execute();	
			
			$stmt->close();
			$dbCon->close();
			return 1;	
		}
		
		function updateWheelchair($data)
		{ 
		
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("update user_apartment_bathroom_detail set is_wheelchair_accessible=?,modified_on=now() where id=?");
			$stmt->bind_param("ii",$data['private_info'], $data['bathroom_id']);
			$stmt->execute();
			$stmt->close();
			$dbCon->close();
			return 1;
		}
		
		function updatePrivate($data)
		{ 
		
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("update user_apartment_bathroom_detail set is_private=?,modified_on=now() where id=?");
			$stmt->bind_param("ii",$data['private_info'], $data['bathroom_id']);
			$stmt->execute();
			$stmt->close();
			$dbCon->close();
			return 1;
		}
		
		function updateEnsuit($data)
		{ 
		
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("update user_apartment_bathroom_detail set is_ensuit=?,modified_on=now() where id=?");
			$stmt->bind_param("ii",$data['private_info'], $data['bathroom_id']);
			$stmt->execute();
			$stmt->close();
			$dbCon->close();
			return 1;
		}

		function updateToilet($data)
		{ 
		
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select count(id) as num from user_apartment_bathroom_detail where user_address_id=?");
			$stmt->bind_param("i", $data['aid']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			if($data['bath']==1)	
			{
			$stmt = $dbCon->prepare("update user_apartment_bathroom_detail set toilet_and_sink=?,modified_on=now() where id=?");
			 
			$stmt->bind_param("ii",$data['bath'], $data['bathroom_id']);
			$stmt->execute();
			$stmt->close();
			$dbCon->close();
			return 1;		
			}
			$stmt = $dbCon->prepare("select count(id) as num from user_apartment_bathroom_detail where user_address_id=? and toilet_and_sink=1");
			$stmt->bind_param("i", $data['aid']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row1 = $result->fetch_assoc();
			if($row['num']==1)
			{
				
			$stmt->close();
			$dbCon->close();
			return 0;	
			}
			else
			{
			if(($row1['num']-1)==0)
			{
			$stmt->close();
			$dbCon->close();
			return 0;	
			}
			else
			{
			$stmt = $dbCon->prepare("select bath,shower from user_apartment_bathroom_detail where id=?");
			$stmt->bind_param("i", $data['bathroom_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row1 = $result->fetch_assoc();	
			if($row1['bath']==0 && $row1['shower']==0 && $data['bath']==0)	
			{
			$stmt = $dbCon->prepare("delete from  user_apartment_bathroom_detail where id=?");
			 
			$stmt->bind_param("i",$data['bathroom_id']);
			$stmt->execute();
			$stmt->close();
			$dbCon->close();
			return 1;		
			}
			else
			{
			$stmt = $dbCon->prepare("update user_apartment_bathroom_detail set toilet_and_sink=?,modified_on=now() where id=?");
			 
			$stmt->bind_param("ii",$data['bath'], $data['bathroom_id']);
			$stmt->execute();
			$stmt->close();
			$dbCon->close();
			return 1;	
			}
				
			}		
			}
			
		}
		
		function updateOverbath($data)
		{ 
		
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("update user_apartment_bathroom_detail set standalone_shower=?,over_bath_shower=?,modified_on=now() where id=?");
			$stmt->bind_param("iii",$data['standalone'],$data['overbath'], $data['bathroom_id']);
			$stmt->execute();
			$stmt->close();
			$dbCon->close();
			return 1;
		}
		
		function updateBath($data)
		{ 
		
			$dbCon = AppModel::createConnection();
			if($data['bath']==1)
			 {
				$stmt = $dbCon->prepare("update user_apartment_bathroom_detail set bath=?,modified_on=now() where id=?"); 
				$stmt->bind_param("ii",$data['bath'], $data['bathroom_id']);
				$stmt->execute();
				$stmt->close();
				$dbCon->close();
				return 1;
			 }
			$stmt = $dbCon->prepare("select count(id) as num from user_apartment_bathroom_detail where user_address_id=? && (bath=1 || shower=1)");
			$stmt->bind_param("i", $data['aid']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			if($row['num']==1)
			{
			 
			$stmt->close();
			$dbCon->close();
			return 0;	
			 	
			}
			else
			{
			$stmt = $dbCon->prepare("select bath,toilet_and_sink from user_apartment_bathroom_detail where id=?");
			$stmt->bind_param("i", $data['bathroom_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();	
			if($row['shower']==0 && $row['toilet_and_sink']==0 && $data['bath']==0)
			{
			$stmt = $dbCon->prepare("delete from user_apartment_bathroom_detail where id=?");
			$stmt->bind_param("i",$data['bathroom_id']);
			$stmt->execute();
			$stmt->close();
			$dbCon->close();
			
			return 1;		
			}
			else
			{
			if($data['bath']==0)
			{
			$stmt = $dbCon->prepare("update user_apartment_bathroom_detail set bath=?,modified_on=now() where id=?");
			}
			else
			{
			$stmt = $dbCon->prepare("update user_apartment_bathroom_detail set bath=?,modified_on=now() where id=?");	
			}
			$stmt->bind_param("ii",$data['bath'], $data['bathroom_id']);
			$stmt->execute();
			$stmt->close();
			$dbCon->close();
			return 1;	
			}
				
			}
			
		}
		
		function updateShower($data)
		{ 
		
			$dbCon = AppModel::createConnection();
			
			$data['standalone']=$data['bath'];
			$data['overbath']=0;
			if($data['standalone']==1)
				{
				$stmt = $dbCon->prepare("update user_apartment_bathroom_detail set shower=?,standalone_shower=?,over_bath_shower=?,modified_on=now() where id=?");
				$stmt->bind_param("iiii",$data['standalone'],$data['standalone'],$data['overbath'], $data['bathroom_id']);
				$stmt->execute();
				$stmt->close();
				$dbCon->close();
				return 1;	
				}
			$stmt = $dbCon->prepare("select count(id) as num from user_apartment_bathroom_detail where user_address_id=?");
			$stmt->bind_param("i", $data['aid']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			if($row['num']==1)
			{
				if($data['standalone']==1)
				{
				$stmt = $dbCon->prepare("update user_apartment_bathroom_detail set shower=?,standalone_shower=?,over_bath_shower=?,modified_on=now() where id=?");
				$stmt->bind_param("iiii",$data['standalone'],$data['standalone'],$data['overbath'], $data['bathroom_id']);
				$stmt->execute();
				$stmt->close();
				$dbCon->close();
				return 1;	
				}
			$stmt = $dbCon->prepare("select bath from user_apartment_bathroom_detail where user_address_id=?");
			$stmt->bind_param("i", $data['aid']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();	
			if($row['bath']==1)
			{
			$stmt = $dbCon->prepare("update user_apartment_bathroom_detail set shower=?,standalone_shower=?,over_bath_shower=?,modified_on=now() where id=?");
			$stmt->bind_param("iiii",$data['standalone'],$data['standalone'],$data['overbath'], $data['bathroom_id']);
			$stmt->execute();
			$stmt->close();
			$dbCon->close();
			return 1;
			}
			else
			{
			$stmt->close();
			$dbCon->close();
			return 0;	
			}
				
			}
			else
			{
			$stmt = $dbCon->prepare("select count(id) as num  from user_apartment_bathroom_detail where user_address_id=? and bath=1");
			$stmt->bind_param("i", $data['aid']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();	
			if($row['num']>0)
			{
			$stmt = $dbCon->prepare("select bath,toilet_and_sink from user_apartment_bathroom_detail where id=?");
			$stmt->bind_param("i", $data['bathroom_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();	
			if($row['bath']==0 && $row['toilet_and_sink']==0 && $data['standalone']==0)
			{
			$stmt = $dbCon->prepare("delete from user_apartment_bathroom_detail where id=?");
			$stmt->bind_param("i",$data['bathroom_id']);
			$stmt->execute();
			$stmt->close();
			$dbCon->close();
			return 1;		
			}
			else
			{
			$stmt = $dbCon->prepare("update user_apartment_bathroom_detail set shower=?,standalone_shower=?,over_bath_shower=?,modified_on=now() where id=?");
			$stmt->bind_param("iiii",$data['standalone'],$data['standalone'],$data['overbath'], $data['bathroom_id']);
			$stmt->execute();
			$stmt->close();
			$dbCon->close();
			return 1;	
			}	
			}
			else
			{
			$stmt = $dbCon->prepare("select count(id) as num  from user_apartment_bathroom_detail where user_address_id=? and shower=1");
			$stmt->bind_param("i", $data['aid']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();	
			if($row['num']>1)
			{
			$stmt = $dbCon->prepare("select bath,toilet_and_sink from user_apartment_bathroom_detail where id=?");
			$stmt->bind_param("i", $data['bathroom_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();	
			if($row['bath']==0 && $row['toilet_and_sink']==0 && $data['standalone']==0)
			{
			$stmt = $dbCon->prepare("delete from user_apartment_bathroom_detail where id=?");
			$stmt->bind_param("i",$data['bathroom_id']);
			$stmt->execute();
			$stmt->close();
			$dbCon->close();
			return 1;		
			}
			else
			{
			$stmt = $dbCon->prepare("update user_apartment_bathroom_detail set shower=?,standalone_shower=?,over_bath_shower=?,modified_on=now() where id=?");
			$stmt->bind_param("iiii",$data['standalone'],$data['standalone'],$data['overbath'], $data['bathroom_id']);
			$stmt->execute();
			$stmt->close();
			$dbCon->close();
			return 1;	
			}	
			}
			else
			{
			$stmt->close();
			$dbCon->close();
			return 0;
			}
			}
			
				
			}
			
		}
		

		function bedroomCount($data)
		{ 
		
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select count(id) as num from user_apartment_bedrooms where user_address_id=?");
			$stmt->bind_param("i", $data['aid']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			if($row['num']==0)
			{
			$stmt = $dbCon->prepare("insert into user_apartment_bedrooms (user_address_id, created_on) values (?,now())");
			$stmt->bind_param("i",$data['aid']);
			$stmt->execute();	
			$id=$stmt->insert_id;
			$bed='Single';
			$stmt = $dbCon->prepare("insert into user_apartment_bedrooms_beds (bedroom_id,bed_info, created_on,modified_on) values (?,?,now(),now())");
			$stmt->bind_param("is", $id,$bed);
			$stmt->execute();	
			
			$stmt = $dbCon->prepare("select count(id) as num from user_apartment_bedrooms where user_address_id=?");
			$stmt->bind_param("i", $data['aid']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			}
			$stmt->close();
			$dbCon->close();
			return $row['num'];	
		}
		function bathroomCount($data)
		{ 
		
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select count(id) as num from user_apartment_bathroom_detail where user_address_id=?");
			$stmt->bind_param("i", $data['aid']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			if($row['num']==0)
			{
			$stmt = $dbCon->prepare("insert into user_apartment_bathroom_detail (user_address_id, created_on, modified_on) values (?,now(), now())");
			$stmt->bind_param("i", $data['aid']);
			$stmt->execute();	
			
			$stmt = $dbCon->prepare("select count(id) as num from user_apartment_bathroom_detail where user_address_id=?");
			$stmt->bind_param("i", $data['aid']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			}
			$stmt->close();
			$dbCon->close();
			return $row['num'];	
		}
		
		function bathroomDetail($data)
		{ 
		
			$dbCon = AppModel::createConnection();
			
			$stmt = $dbCon->prepare("update user_address set bathroom_updated=1 where id=?");
			$stmt->bind_param("i", $data['aid']);
			$stmt->execute(); 
			 
			$stmt = $dbCon->prepare("select * from user_apartment_bathroom_detail where user_address_id=?");
			$stmt->bind_param("i", $data['aid']);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			$j=0;
			while($row = $result->fetch_assoc())
			{
				if($row['shower']==0)
				{
					$row['standalone_shower']=1;
				}
				$row['bathroom_count']=++$j;
			array_push($org,$row);	
			
			}
			 
			$stmt->close();
			$dbCon->close();
			return $org;	
		}
		
			

		function communityAvailableTenantsInfo($data)
		{
			$dbCon = AppModel::createConnection();
			$org=array();
			$stmt = $dbCon->prepare("select id,port_number from landloard_building_ports where buildingid in (select building_id from landloard_society_buildings where society_id=?)");
			$stmt->bind_param("i", $data['community_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$j=0;
			while($row = $result->fetch_assoc())
			{
				
			array_push($org,$row);
			$tid='';
			$stmt = $dbCon->prepare("select teanat_details,floor_number from landloard_building_port_floors_offices left join landloard_building_port_floors on landloard_building_port_floors.id=landloard_building_port_floors_offices.floor_id where floor_id in(select id from landloard_building_port_floors where port_id=?)");
			$stmt->bind_param("i", $row['id']);
			$stmt->execute();
			$result2 = $stmt->get_result();
			$org[$j]['tenants']=array();
			while($row2 = $result2->fetch_assoc())
			{
			$stmt = $dbCon->prepare("select id,first_name  , last_name  , tenant_email  , mobile_country , mobile_number  , fixed_phone_country , landline_number  , street_address  , port_number  , zipcode  , city  , country_of_residence , nationality , passport_number  , issue_month , issue_year , expiry_month , expiry_year , passport_front_image  , passport_back_image from landloard_building_tenant  where find_in_set(id,?)");
			$stmt->bind_param("s", $row2['teanat_details']);
			$stmt->execute();
			$result3 = $stmt->get_result();
			while($row3 = $result3->fetch_assoc())
			{
				$row3['floor_number']=$row2['floor_number'];
				$row3['image_path']='https://dstricts.com/html/usercontent/images/bg/tenantImage.png';
				array_push($org[$j]['tenants'],$row3);
			}
				 
			}
			$j++;
			}
			$stmt->close();
			$dbCon->close();
			return $org;
			
			
		}
		
		
		function apartmentCommunityAmenities($data)
		{
			$dbCon = AppModel::createConnection();
			
			$stmt = $dbCon->prepare("select id,community_aminity_name as amenity_name from community_aminity_info where id in(select amenity_id from community_aminity_detail where society_id=? and is_available=1)");
			/* bind parameters for markers */
			$stmt->bind_param("i",$data['community_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			$org['community_amenity']=array();
			while($row = $result->fetch_assoc())
			{
				$row['image_path']="https://www.safeqloud.com/html/usercontent/images/amenities/community/".$row['id'].".jpeg";
				array_push($org['community_amenity'],$row);
			}	
			
			
			$stmt = $dbCon->prepare("select id,amenity_name from lanloard_building_amenity_info where id in (select amenity_id from landloard_building_amenities where building_id in (select building_id from landloard_society_buildings where society_id=?) and is_available=1 and amenity_id!=4 and amenity_id!=9)");
			/* bind parameters for markers */
			$stmt->bind_param("i",$data['community_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			while($row = $result->fetch_assoc())
			{
				$row['image_path']="https://www.safeqloud.com/html/usercontent/images/amenities/".$row['id'].".jpeg";
				array_push($org['community_amenity'],$row);
			}	
			
			$org['book']=array(); 
			$stmt = $dbCon->prepare("select id,amenity_name from lanloard_building_amenity_info where id in (select amenity_id from landloard_building_amenities where building_id in (select building_id from landloard_society_buildings where society_id=?) and is_available=1 and (amenity_id=4 or amenity_id=9))");
			/* bind parameters for markers */
			$stmt->bind_param("i",$data['community_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			while($row = $result->fetch_assoc())
			{
				$row['image_path']="https://www.safeqloud.com/html/usercontent/images/amenities/".$row['id'].".jpeg";
				array_push($org['book'],$row);
			}	
			 
			 
			$stmt->close();
			$dbCon->close();
			return $org;			
		}	
		
	 
		
		
		function getCommunityDetailInfo($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select * from landloard_society where id=?");
			/* bind parameters for markers */
			$stmt->bind_param("i",$data['community_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			$row['society_name']=html_entity_decode($row['society_name'],ENT_NOQUOTES, 'UTF-8'); 
			$row['street_address']=html_entity_decode($row['street_address'],ENT_NOQUOTES, 'UTF-8'); 
			$row['city']=html_entity_decode($row['city'],ENT_NOQUOTES, 'UTF-8'); 
			
			
			$row['description']=strip_tags(html_entity_decode($row['description'],ENT_NOQUOTES, 'ISO-8859-1')); 
			 $row['description']=trim(strip_tags($row['description']));
			$row['images']=array();
			$stmt = $dbCon->prepare("select building_photo_path from landloard_building_photos where building_id in (select building_id from landloard_society_buildings where society_id=?) limit 0,5");
			/* bind parameters for markers */
			$stmt->bind_param("i",$data['community_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			while($rowImages = $result->fetch_assoc())
			{
			$filename="../estorecss/".$rowImages['building_photo_path'].".txt"; $value_a=file_get_contents("../estorecss/".$rowImages['building_photo_path'].".txt"); $value_a=str_replace('"','',$value_a); $rowImages['building_photo_path'] = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$rowImages['building_photo_path'].'.jpg' );
			$rowImages['building_photo_path']=str_replace('../','https://www.safeqloud.com/',$rowImages['building_photo_path']);
			array_push($row['images'],$rowImages);	
			}
			
			$stmt->close();
			$dbCon->close();
			return $row;			
		}	
		
		function apartmentCommunityTicketCreatedCount($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select count(id) as num from landloard_property_problem_tickets  where qloud_checkout_id=? and (ticket_status=0 or ticket_status=3)");
			/* bind parameters for markers */
			$stmt->bind_param("i",$data['check_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			$row = $result->fetch_assoc();
			$org['new_ticket']=$row['num'];
				
			
			$stmt = $dbCon->prepare("select count(id) as num from landloard_property_problem_tickets  where qloud_checkout_id=? and ticket_status=1");
			/* bind parameters for markers */
			$stmt->bind_param("i",$data['check_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			$org['ongoing_ticket']=$row['num'];
			
			$stmt = $dbCon->prepare("select count(id) as num from landloard_property_problem_tickets  where qloud_checkout_id=? and ticket_status=2");
			/* bind parameters for markers */
			$stmt->bind_param("i",$data['check_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			$org['finished_ticket']=$row['num'];
			 
			$stmt->close();
			$dbCon->close();
			return $org;			
		}	

		function apartmentCommunityTicketList($data)
		{
			$dbCon = AppModel::createConnection();
			 
			$apartment_id= $this -> encrypt_decrypt('decrypt',$data['apartment_id']);   
			$stmt = $dbCon->prepare("select id as room_type_id,property_nickname from user_address  where id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i",$apartment_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$row   = $result->fetch_assoc(); 
			 
			$apartment_id=$row['room_type_id'];
			$stmt = $dbCon->prepare("select ticket_status,apartment_id,landloard_property_problem_tickets.id,problem_description,landloard_property_problem_tickets.ticket_type,ticket_title,ticket_subtitle from landloard_property_problem_tickets left join landloard_ticket_title on landloard_ticket_title.id=landloard_property_problem_tickets.problem_id left join landloard_ticket_subtitle on landloard_ticket_subtitle.id=landloard_property_problem_tickets.subproblem_id where apartment_id=? and ticket_status=0");
			/* bind parameters for markers */
			$stmt->bind_param("i",$apartment_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			$org['apartment_name']=$row['property_nickname'];
			$org['notstarted']=array();
			while($row = $result->fetch_assoc())
			{
				array_push($org['notstarted'],$row);
			}	
			
			 
			$stmt = $dbCon->prepare("select ticket_status,apartment_id,landloard_property_problem_tickets.id,problem_description,landloard_property_problem_tickets.ticket_type,ticket_title,ticket_subtitle from landloard_property_problem_tickets left join landloard_ticket_title on landloard_ticket_title.id=landloard_property_problem_tickets.problem_id left join landloard_ticket_subtitle on landloard_ticket_subtitle.id=landloard_property_problem_tickets.subproblem_id where apartment_id=? and ticket_status=3 and accepted_by_employee!=(select id from employees where user_login_id=? and company_id=?)");
			/* bind parameters for markers */
			$stmt->bind_param("iii",$apartment_id,$data['user_id'],$data['company_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			while($row = $result->fetch_assoc())
			{
				array_push($org['notstarted'],$row);
			}	
			
			$org['started']=array();
			
			$stmt = $dbCon->prepare("select ticket_status,apartment_id,landloard_property_problem_tickets.id,problem_description,landloard_property_problem_tickets.ticket_type,ticket_title,ticket_subtitle from landloard_property_problem_tickets left join landloard_ticket_title on landloard_ticket_title.id=landloard_property_problem_tickets.problem_id left join landloard_ticket_subtitle on landloard_ticket_subtitle.id=landloard_property_problem_tickets.subproblem_id where apartment_id=? and ticket_status=1 and accepted_by=? and accepting_company_id=?");
			/* bind parameters for markers */
			$stmt->bind_param("iii",$apartment_id,$data['user_id'],$data['company_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			while($row = $result->fetch_assoc())
			{
				array_push($org['started'],$row);
			}	
			
			
			$org['finished']=array();
			$stmt = $dbCon->prepare("select ticket_status,apartment_id,landloard_property_problem_tickets.id,problem_description,landloard_property_problem_tickets.ticket_type,ticket_title,ticket_subtitle from landloard_property_problem_tickets left join landloard_ticket_title on landloard_ticket_title.id=landloard_property_problem_tickets.problem_id left join landloard_ticket_subtitle on landloard_ticket_subtitle.id=landloard_property_problem_tickets.subproblem_id where apartment_id=? and ticket_status=2 and accepted_by=? and accepting_company_id=?");
			/* bind parameters for markers */
			$stmt->bind_param("iii",$apartment_id,$data['user_id'],$data['company_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			while($row = $result->fetch_assoc())
			{
				array_push($org['finished'],$row);
			}	
			
			
			$org['cancelled']=array();
			$stmt = $dbCon->prepare("select ticket_status,apartment_id,landloard_property_problem_tickets.id,problem_description,landloard_property_problem_tickets.ticket_type,ticket_title,ticket_subtitle from landloard_property_problem_tickets left join landloard_ticket_title on landloard_ticket_title.id=landloard_property_problem_tickets.problem_id left join landloard_ticket_subtitle on landloard_ticket_subtitle.id=landloard_property_problem_tickets.subproblem_id where apartment_id=? and ticket_status=3 and accepted_by=? and accepting_company_id=?");
			/* bind parameters for markers */
			$stmt->bind_param("iii",$apartment_id,$data['user_id'],$data['company_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			while($row = $result->fetch_assoc())
			{
				array_push($org['cancelled'],$row);
			}
			 
			$stmt->close();
			$dbCon->close();
			return $org;			
		}	
		
		function updateApartmentCommunityTicket($data)
		{
			$dbCon = AppModel::createConnection();
			 
			$stmt = $dbCon->prepare("select id from employees where user_login_id=? and company_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("ii",$data['user_id'],$data['company_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row   = $result->fetch_assoc();  
			$stmt = $dbCon->prepare("update landloard_property_problem_tickets set ticket_status=?,accepted_by_employee=?,accepted_by=?,accepting_company_id=? where id=?");
			/* bind parameters for markers */
			$stmt->bind_param("iiiii",$data['ticket_status'],$row['id'],$data['user_id'],$data['company_id'],$data['id']);
			$stmt->execute();
			$stmt->close();
			$dbCon->close();
			return 1;			
		}
		
		
		function acceptApartmentCommunityTicket($data)
		{
			$dbCon = AppModel::createConnection();
			
			$stmt = $dbCon->prepare("select id from employees where user_login_id=? and company_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("ii",$data['user_id'],$data['company_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row   = $result->fetch_assoc();  
			$stmt = $dbCon->prepare("update landloard_property_problem_tickets set ticket_status=1,accepted_by_employee=?,accepted_by=?,accepting_company_id=? where id=?");
			/* bind parameters for markers */
			$stmt->bind_param("iii",$row['id'],$data['user_id'],$data['company_id'],$data['id']);
			$stmt->execute();
			$stmt->close();
			$dbCon->close();
			return 1;			
		}

		function finishApartmentCommunityTicket($data)
		{
			$dbCon = AppModel::createConnection();
			
			$stmt = $dbCon->prepare("select id from employees where user_login_id=? and company_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("ii",$data['user_id'],$data['company_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row   = $result->fetch_assoc();  
			$stmt = $dbCon->prepare("update landloard_property_problem_tickets set ticket_status=2,accepted_by_employee=?,accepted_by=?,accepting_company_id=? where id=?");
			/* bind parameters for markers */
			$stmt->bind_param("iii",$row['id'],$data['user_id'],$data['company_id'],$data['id']);
			$stmt->execute();
			$stmt->close();
			$dbCon->close();
			return 1;			
		}
			
		function rejectApartmentCommunityTicket($data)
		{
			$dbCon = AppModel::createConnection();
			
			$stmt = $dbCon->prepare("select id from employees where user_login_id=? and company_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("ii",$data['user_id'],$data['company_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row   = $result->fetch_assoc();  
			$stmt = $dbCon->prepare("update landloard_property_problem_tickets set ticket_status=3,accepted_by_employee=?,accepted_by=?,accepting_company_id=? where id=?");
			/* bind parameters for markers */
			$stmt->bind_param("iii",$row['id'],$data['user_id'],$data['company_id'],$data['id']);
			$stmt->execute();
			$stmt->close();
			$dbCon->close();
			return 1;			
		}

		function apartmentCommunityPendingTicket($data)
		{
			$dbCon = AppModel::createConnection();
			 
			$qloud_checkout_id= $this -> encrypt_decrypt('decrypt',$data['check_id']);  
			$stmt = $dbCon->prepare("select room_type_id from hotel_checkout_detail  where id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i",$qloud_checkout_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$row   = $result->fetch_assoc(); 
			$apartment_id=$row['room_type_id'];
			 
			$stmt = $dbCon->prepare("select landloard_property_problem_tickets.id,problem_description,landloard_property_problem_tickets.ticket_type,ticket_title,ticket_subtitle from landloard_property_problem_tickets left join landloard_ticket_title on landloard_ticket_title.id=landloard_property_problem_tickets.problem_id left join landloard_ticket_subtitle on landloard_ticket_subtitle.id=landloard_property_problem_tickets.subproblem_id where apartment_id=? and ticket_status=0");
			/* bind parameters for markers */
			$stmt->bind_param("i",$apartment_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			 
			while($row = $result->fetch_assoc())
			{
				array_push($org,$row);
			}	

			 
			$stmt = $dbCon->prepare("select landloard_property_problem_tickets.id,problem_description,landloard_property_problem_tickets.ticket_type,ticket_title,ticket_subtitle from landloard_property_problem_tickets left join landloard_ticket_title on landloard_ticket_title.id=landloard_property_problem_tickets.problem_id left join landloard_ticket_subtitle on landloard_ticket_subtitle.id=landloard_property_problem_tickets.subproblem_id where apartment_id=? and ticket_status=3 and accepted_by_employee!=(select id from employees where user_login_id=? and company_id=?)");
			/* bind parameters for markers */
			$stmt->bind_param("iii",$apartment_id,$data['user_id'],$data['company_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			while($row = $result->fetch_assoc())
			{
				array_push($org,$row);
			}	
			 
			$stmt->close();
			$dbCon->close();
			return $org;			
		}	
		
		function apartmentCommunityStartedTicket($data)
		{
			$dbCon = AppModel::createConnection();
			$qloud_checkout_id= $this -> encrypt_decrypt('decrypt',$data['check_id']);  
			$stmt = $dbCon->prepare("select room_type_id from hotel_checkout_detail  where id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i",$qloud_checkout_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$row   = $result->fetch_assoc(); 
			$apartment_id=$row['room_type_id'];  
			$stmt = $dbCon->prepare("select landloard_property_problem_tickets.id,problem_description,landloard_property_problem_tickets.ticket_type,ticket_title,ticket_subtitle from landloard_property_problem_tickets left join landloard_ticket_title on landloard_ticket_title.id=landloard_property_problem_tickets.problem_id left join landloard_ticket_subtitle on landloard_ticket_subtitle.id=landloard_property_problem_tickets.subproblem_id where apartment_id=? and ticket_status=1 and accepted_by=? and accepting_company_id=?");
			/* bind parameters for markers */
			$stmt->bind_param("iii",$apartment_id,$data['user_id'],$data['company_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			while($row = $result->fetch_assoc())
			{
				array_push($org,$row);
			}				
			 
			$stmt->close();
			$dbCon->close();
			return $org;			
		}	
		
		function apartmentCommunityCompletedTicket($data)
		{
			$dbCon = AppModel::createConnection();
			$qloud_checkout_id= $this -> encrypt_decrypt('decrypt',$data['check_id']);  
			$stmt = $dbCon->prepare("select room_type_id from hotel_checkout_detail  where id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i",$qloud_checkout_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$row   = $result->fetch_assoc(); 
			$apartment_id=$row['room_type_id'];
			$stmt = $dbCon->prepare("select landloard_property_problem_tickets.id,problem_description,landloard_property_problem_tickets.ticket_type,ticket_title,ticket_subtitle from landloard_property_problem_tickets left join landloard_ticket_title on landloard_ticket_title.id=landloard_property_problem_tickets.problem_id left join landloard_ticket_subtitle on landloard_ticket_subtitle.id=landloard_property_problem_tickets.subproblem_id where apartment_id=? and ticket_status=2 and accepted_by=? and accepting_company_id=?");
			/* bind parameters for markers */
			$stmt->bind_param("iii",$apartment_id,$data['user_id'],$data['company_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			while($row = $result->fetch_assoc())
			{
				array_push($org,$row);
			}				
			 
			$stmt->close();
			$dbCon->close();
			return $org;			
		}	
		 
		function apartmentCommunityCancelledTicket($data)
		{
			$dbCon = AppModel::createConnection();
			$qloud_checkout_id= $this -> encrypt_decrypt('decrypt',$data['check_id']);  
			$stmt = $dbCon->prepare("select room_type_id from hotel_checkout_detail  where id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i",$qloud_checkout_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$row   = $result->fetch_assoc(); 
			$apartment_id=$row['room_type_id'];
			$stmt = $dbCon->prepare("select landloard_property_problem_tickets.id,problem_description,landloard_property_problem_tickets.ticket_type,ticket_title,ticket_subtitle from landloard_property_problem_tickets left join landloard_ticket_title on landloard_ticket_title.id=landloard_property_problem_tickets.problem_id left join landloard_ticket_subtitle on landloard_ticket_subtitle.id=landloard_property_problem_tickets.subproblem_id where apartment_id=? and ticket_status=3 and accepted_by=? and accepting_company_id=?");
			/* bind parameters for markers */
			$stmt->bind_param("iii",$apartment_id,$data['user_id'],$data['company_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			while($row = $result->fetch_assoc())
			{
				array_push($org,$row);
			}				
			 
			$stmt->close();
			$dbCon->close();
			return $org;			
		}	 

		function apartmentCommunityTicketDetail($data)
		{
			$dbCon = AppModel::createConnection();
			 
			$stmt = $dbCon->prepare("select ticket_status,landloard_property_problem_tickets.id,problem_description,landloard_property_problem_tickets.ticket_type,ticket_title,ticket_subtitle from landloard_property_problem_tickets left join landloard_ticket_title on landloard_ticket_title.id=landloard_property_problem_tickets.problem_id left join landloard_ticket_subtitle on landloard_ticket_subtitle.id=landloard_property_problem_tickets.subproblem_id where landloard_property_problem_tickets.id=?");
			/* bind parameters for markers */
			$stmt->bind_param("i",$data['id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();				
			$row['images']=array();
			$stmt = $dbCon->prepare("select * from landloard_property_problem_tickets_images   where landloard_property_problem_tickets_id=?");
			/* bind parameters for markers */
			$stmt->bind_param("i",$row['id']);
			$stmt->execute();
			$result = $stmt->get_result();
			while($rowImages = $result->fetch_assoc())
			{
				$filename="../estorecss/".$rowImages['image_path'].".txt"; $value_a=file_get_contents("../estorecss/".$rowImages['image_path'].".txt"); $value_a=str_replace('"','',$value_a); $rowImages['image_path'] = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$rowImages['image_path'].'.jpg' );
				$rowImages['image_path']=str_replace('../','https://www.safeqloud.com/',$rowImages['image_path']);
				array_push($row['images'],$rowImages);
			}		

			
			
			$stmt->close();
			$dbCon->close();
			return $row;			
		}	
		
		
		function createCommunityTicket($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select room_type_id from hotel_checkout_detail where id=?");
			/* bind parameters for markers */
			$stmt->bind_param("i",$data['check_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();	
			if($data['ticket_type']==1)
			{
				$data['community_id']=0;
			}
			 
			$stmt = $dbCon->prepare("insert into `landloard_property_problem_tickets`(problem_description,`ticket_type`,`problem_id`,`subproblem_id`,`apartment_id`,`community_id`,`qloud_checkout_id`,`created_on`) values (?,?,?,?,?,?,?,now())");
			/* bind parameters for markers */
			$stmt->bind_param("siiiiii",$data['problem_description'],$data['ticket_type'],$data['ticket_id'],$data['subticket_id'],$row['room_type_id'],$data['community_id'],$data['check_id']);
			$stmt->execute();
			$id=$stmt->insert_id;
			$stmt->close();
			$dbCon->close();
			return $id;			
		}	
		
			function addCommunityTicketImage($data)
		{
			$dbCon = AppModel::createConnection();
			 
			$data1 = strip_tags($data['ImageData']);
			$data1='url("data:image/png;base64,'.$data1.'")';
			//echo $data; die;
			define('UPLOAD_DIR','../estorecss/'); // image dir path
			$img_name1="new".microtime();
			file_put_contents(UPLOAD_DIR.$img_name1.".txt", $data1);
				 
			$stmt = $dbCon->prepare("insert into `landloard_property_problem_tickets_images`(landloard_property_problem_tickets_id,image_path) values (?,?)");
			/* bind parameters for markers */
			$stmt->bind_param("is",$data['problem_id'],$img_name1);
			$stmt->execute();
			
			
			$stmt->close();
			$dbCon->close();
			return 1;	
			 
			 
		}
		
		function getCommunityInfo($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select society_id from landloard_society_buildings where building_id=(select building_id from user_address where id=(select room_type_id from hotel_checkout_detail where id=?))");
			/* bind parameters for markers */
			$stmt->bind_param("i",$data['check_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			if(empty($row))
			{
			$stmt->close();
			$dbCon->close();
			return 0;			
			}				
			else
			{
			$stmt->close();
			$dbCon->close();
			return $row['society_id'];			
			}
			 
		}	
		
		
		
		
		
		function getTicketTitleInfo($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select * from landloard_ticket_title where ticket_type=? and id!=14");
			/* bind parameters for markers */
			$stmt->bind_param("i",$data['ticket_type']);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			while($row = $result->fetch_assoc())
			{
			array_push($org,$row);		
			}				
			 
			$stmt->close();
			$dbCon->close();
			return $org;			
		}	
		
		
		function getTicketSubTitleInfo($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select * from landloard_ticket_subtitle where ticket_id=?");
			/* bind parameters for markers */
			$stmt->bind_param("i",$data['ticket_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			while($row = $result->fetch_assoc())
			{
			array_push($org,$row);		
			}				
			 
			$stmt->close();
			$dbCon->close();
			return $org;			
		}	


		function getPreCheckinStatus($data)
		{
			$dbCon = AppModel::createConnection();
			
			$id= $this -> encrypt_decrypt('decrypt',$data['id']);  
			$stmt = $dbCon->prepare("select precheckin_status,hotel_name,hotel_checkout_detail.room_id,hotel_checkout_detail.id,room_type_id,checkout_booking_date,checkin_booking_date,checkin_date,checkout_date,guest_adult,guest_children,room_name,hotel_room_type.room_type,hotel_checkout_detail.property_id,first_name,last_name,is_approved_cleaning,checked_in from hotel_checkout_detail left join hotel_room_detail on hotel_room_detail.id=hotel_checkout_detail.room_id left join company_hotel_room_type_detail on company_hotel_room_type_detail.id=hotel_checkout_detail.room_type_id left join hotel_room_type on hotel_room_type.id=company_hotel_room_type_detail.room_type left join user_logins on user_logins.id=hotel_checkout_detail.user_id left join hotel_basic_information on hotel_basic_information.property_id=hotel_checkout_detail.property_id where hotel_checkout_detail.id=? and hotel_checkout_detail.user_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("ii", $id,$data['user_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowPrice = $result->fetch_assoc();
			 $org=array();
			if(empty($rowPrice))
			{
			$org['guest_adult']=0;
			$org['guest_children']=0;
			$org['guest_adult_left']=0;
			$org['guest_children_left']=0;
			$org['name']='-';
			$org['result']=0;
			$org['booking_dates']='-';
			$org['hotel_name']='-';
			$org['guests']='-';
			$org['id']=$data['id'];
			$org['checkid']=$rowPrice['id'];
			$stmt->close();
			$dbCon->close();
			return $org;
			}
			$stmt = $dbCon->prepare("select count(id) as num from hotel_checkout_invitation_info where hotel_checkout_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $id);
			$stmt->execute();
			$resultCount = $stmt->get_result();
			$rowDependentCount = $resultCount->fetch_assoc();
			 
			$rowPrice['guest_adult_left']=$rowPrice['guest_adult']-$rowDependentCount['num']-1;
			
			$stmt = $dbCon->prepare("select count(id) as num from hotel_checkout_dependent_detail where hotel_checkout_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $id);
			$stmt->execute();
			$resultCount = $stmt->get_result();
			$rowDependentCount = $resultCount->fetch_assoc();
		 
			$rowPrice['guest_children_left']=$rowPrice['guest_children']-$rowDependentCount['num'];
			 if($rowPrice['guest_children_left']<0)
			 {
				 $rowPrice['guest_children_left']=0;
			 }	
			$totalLeft=$rowPrice['guest_adult_left']+$rowPrice['guest_children_left'];
			 
			$org=array();
			if(empty($rowPrice))
			{
			$org['guest_adult']=$rowPrice['guest_adult'];
			$org['guest_children']=$rowPrice['guest_children'];
			$org['guest_adult_left']=$rowPrice['guest_adult_left'];
			$org['guest_children_left']=$rowPrice['guest_children_left'];
			$org['name']='-';
			$org['result']=0;
			$org['booking_dates']='-';
			$org['hotel_name']='-';
			$org['guests']='-';
			$org['id']=$data['id'];
			$org['checkid']=$rowPrice['id'];
			$stmt->close();
			$dbCon->close();
			return $org;
			}
			else if($rowPrice['checked_in']>0)
			{
			$org['guest_adult']=$rowPrice['guest_adult'];
			$org['guest_children']=$rowPrice['guest_children'];
			$org['guest_adult_left']=$rowPrice['guest_adult_left'];
			$org['guest_children_left']=$rowPrice['guest_children_left'];
			$org['name']=$rowPrice['first_name'].' '.$rowPrice['last_name'];
			$org['result']=3;
			$org['booking_dates']=date('d M',$rowPrice['checkin_booking_date']).'-'.date('d M',$rowPrice['checkout_booking_date']);
			$org['hotel_name']=$rowPrice['hotel_name'];
			$org['guests']=$rowPrice['guest_adult'].' Adults ,'.$rowPrice['guest_children'].' child';
			$org['id']=$data['id'];
			$org['checkid']=$rowPrice['id'];
			$stmt->close();
			$dbCon->close();
			return $org;
			}
			else if($rowPrice['precheckin_status']==1)
			{
				
			
			if($totalLeft==0)
			{
			$org['guest_adult']=$rowPrice['guest_adult'];
			$org['guest_children']=$rowPrice['guest_children'];
			$org['guest_adult_left']=$rowPrice['guest_adult_left'];
			$org['guest_children_left']=$rowPrice['guest_children_left'];
			$org['name']=$rowPrice['first_name'].' '.$rowPrice['last_name'];
			$org['result']=3;
			$org['booking_dates']=date('d M',$rowPrice['checkin_booking_date']).'-'.date('d M',$rowPrice['checkout_booking_date']);
			$org['hotel_name']=$rowPrice['hotel_name'];
			$org['guests']=$rowPrice['guest_adult'].' Adults ,'.$rowPrice['guest_children'].' child';
			$org['id']=$data['id'];
			$org['checkid']=$rowPrice['id'];
			$stmt->close();
			$dbCon->close();
			return $org;	
			}			
			$org['guest_adult']=$rowPrice['guest_adult'];
			$org['guest_children']=$rowPrice['guest_children'];
			$org['guest_adult_left']=$rowPrice['guest_adult_left'];
			$org['guest_children_left']=$rowPrice['guest_children_left'];
			$org['name']=$rowPrice['first_name'].' '.$rowPrice['last_name'];
			$org['result']=1;
			$org['booking_dates']=date('d M',$rowPrice['checkin_booking_date']).'-'.date('d M',$rowPrice['checkout_booking_date']);
			$org['hotel_name']=$rowPrice['hotel_name'];
			$org['guests']=$rowPrice['guest_adult'].' Adults ,'.$rowPrice['guest_children'].' child';
			$org['id']=$data['id'];
			$org['checkid']=$rowPrice['id'];
			$stmt->close();
			$dbCon->close();
			return $org;
			}
			else
			{
			$org['guest_adult']=$rowPrice['guest_adult'];
			$org['guest_children']=$rowPrice['guest_children'];
			$org['guest_adult_left']=$rowPrice['guest_adult_left'];
			$org['guest_children_left']=$rowPrice['guest_children_left'];
			$org['name']=$rowPrice['first_name'].' '.$rowPrice['last_name'];
			$org['result']=2;
			$org['booking_dates']=date('d M',$rowPrice['checkin_booking_date']).'-'.date('d M',$rowPrice['checkout_booking_date']);
			$org['hotel_name']=$rowPrice['hotel_name'];
			$org['guests']=$rowPrice['guest_adult'].' Adults ,'.$rowPrice['guest_children'].' child';
			$org['id']=$data['id'];
			$org['checkid']=$rowPrice['id'];
			$stmt->close();
			$dbCon->close();
			return $org;
			}
		
		}	
		
		
		function updatePreCheckinStatus($data)
		{
			$dbCon = AppModel::createConnection();
			
			$id= $this -> encrypt_decrypt('decrypt',$data['id']);  
			$stmt = $dbCon->prepare("update hotel_checkout_detail set precheckin_status=1  where id=?");
			/* bind parameters for markers */
			$stmt->bind_param("i", $id);
			$stmt->execute();
			
			$stmt = $dbCon->prepare("select precheckin_status,hotel_name,hotel_checkout_detail.room_id,hotel_checkout_detail.id,room_type_id,checkout_booking_date,checkin_booking_date,checkin_date,checkout_date,guest_adult,guest_children,room_name,hotel_room_type.room_type,hotel_checkout_detail.property_id,first_name,last_name,is_approved_cleaning,checked_in from hotel_checkout_detail left join hotel_room_detail on hotel_room_detail.id=hotel_checkout_detail.room_id left join company_hotel_room_type_detail on company_hotel_room_type_detail.id=hotel_checkout_detail.room_type_id left join hotel_room_type on hotel_room_type.id=company_hotel_room_type_detail.room_type left join user_logins on user_logins.id=hotel_checkout_detail.user_id left join hotel_basic_information on hotel_basic_information.property_id=hotel_checkout_detail.property_id where hotel_checkout_detail.id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $id);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowPrice = $result->fetch_assoc();
			
			$stmt = $dbCon->prepare("select count(id) as num from hotel_checkout_invitation_info where hotel_checkout_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $id);
			$stmt->execute();
			$resultCount = $stmt->get_result();
			$rowDependentCount = $resultCount->fetch_assoc();
			 
			$rowPrice['guest_adult_left']=$rowPrice['guest_adult']-$rowDependentCount['num']-1;
			
			$stmt = $dbCon->prepare("select count(id) as num from hotel_checkout_dependent_detail where hotel_checkout_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $id);
			$stmt->execute();
			$resultCount = $stmt->get_result();
			$rowDependentCount = $resultCount->fetch_assoc();
		 
			$rowPrice['guest_children_left']=$rowPrice['guest_children']-$rowDependentCount['num'];
			 if($rowPrice['guest_children_left']<0)
			 {
				 $rowPrice['guest_children_left']=0;
			 }	
			 $org=array();
			$org['guest_adult']=$rowPrice['guest_adult'];
			$org['guest_children']=$rowPrice['guest_children'];
			$org['guest_adult_left']=$rowPrice['guest_adult_left'];
			$org['guest_children_left']=$rowPrice['guest_children_left'];
			$org['total_left']=$rowPrice['guest_adult_left']+$rowPrice['guest_children_left'];
			$org['result']=1;
			$stmt->close();
			$dbCon->close();
			return $org;
			  
		}	

		
		function getUserActiveStatus($data)
		{
			$dbCon = AppModel::createConnection();
			
			$stmt = $dbCon->prepare("select count(id) as num from user_cards where user_login_id = ?");
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['user_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowCard    = $result->fetch_assoc();	
			
			
			$stmt = $dbCon->prepare("select count(id) as num from user_address where user_id = ?");
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['user_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowAdd    = $result->fetch_assoc();
			
			
			$stmt = $dbCon->prepare("select count(id) as num from user_identification where user_id = ? and identification_type=3 and is_completed=1");
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['user_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowId    = $result->fetch_assoc();	
			$org=array();
			$org['cards']=$rowCard['num'];
			$org['address']=$rowAdd['num'];
			$org['passport']=$rowId['num'];
			
			$stmt = $dbCon->prepare("select id from user_identification where user_id = ? and identification_type=3 and is_completed=0");
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['user_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowId    = $result->fetch_assoc();	
			
			if(empty($rowId))
			{
			$org['passport_id']=0;	
			}
			else
			{
			$org['passport_id']=$rowId['id'];	
			}
			$stmt->close();
			$dbCon->close();
			return $org;
		
		}	



		function getUserStatus()
		{
				$dbCon = AppModel::createConnection();
			 
				$stmt = $dbCon->prepare("select count(id) as num from user_address where user_id=?");
				
				$stmt->bind_param("i",$_POST['user_id']);
				$stmt->execute();
				$result1 = $stmt->get_result();
				$row = $result1->fetch_assoc();	
				if($row['num']==0)
				{
				$stmt->close();
				$dbCon->close();
				return 0;	
				}					
				$stmt = $dbCon->prepare("select count(id) as num from user_cards where user_login_id=?");
				$stmt->bind_param("i",$_POST['user_id']);
				$stmt->execute();
				$result1 = $stmt->get_result();
				$row = $result1->fetch_assoc();
				if($row['num']==0)
				{
				$stmt->close();
				$dbCon->close();
				return 0;	
				}
				
				$stmt = $dbCon->prepare("select count(id) as num from user_identification where user_id=?");
				
				$stmt->bind_param("i",$_POST['user_id']);
				$stmt->execute();
				$result1 = $stmt->get_result();
				$row = $result1->fetch_assoc();
				$stmt->close();
				$dbCon->close();
				return $row['num'];
		
		}
		
		
		function getUserStatusCompanyRequirement($data)
		{
				$dbCon = AppModel::createConnection();
				$stmt = $dbCon->prepare("select identificator_info from signup_required_fields_info where company_id=(select company_id from oauth_clients where client_id=?)");
				
				$stmt->bind_param("s",$data['id']);
				$stmt->execute();
				$result1 = $stmt->get_result();
				$rowClient = $result1->fetch_assoc();	
				 
				
				$stmt = $dbCon->prepare("select count(id) as num from user_address where user_id=?");
				
				$stmt->bind_param("i",$data['user_id']);
				$stmt->execute();
				$result1 = $stmt->get_result();
				$row = $result1->fetch_assoc();	
				if($row['num']==0)
				{
				$stmt->close();
				$dbCon->close();
				return 0;	
				}					
				$stmt = $dbCon->prepare("select count(id) as num from user_cards where user_login_id=?");
				$stmt->bind_param("i",$data['user_id']);
				$stmt->execute();
				$result1 = $stmt->get_result();
				$row = $result1->fetch_assoc();
				if($row['num']==0)
				{
				$stmt->close();
				$dbCon->close();
				return 0;	
				}
				if($rowClient['identificator_info']==1)
				{
				$stmt = $dbCon->prepare("select count(id) as num from user_identification where user_id=? and is_completed=1");
				
				$stmt->bind_param("i",$data['user_id']);
				$stmt->execute();
				$result1 = $stmt->get_result();
				$row = $result1->fetch_assoc();
				$stmt->close();
				$dbCon->close();
				return $row['num'];	
				}
				else
				{
				$stmt->close();
				$dbCon->close();
				return 1;	
				}
				
		
		}
		
		
		function informEmployee($data)
		{
			$dbCon = AppModel::createConnection();
			 
			$stmt = $dbCon->prepare("select companies.company_name,company_id,location_id,inviting_employee,first_name,visitor_email as email,employee_invited_visitor.country_id,phone_number from employee_invited_visitor left join companies on companies.id=employee_invited_visitor.company_id where employee_invited_visitor.id = ?");
			/* bind parameters for markers */
			$cont=1;
			$stmt->bind_param("i", $data['id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowVisitInfo = $result->fetch_assoc();
			 
			$company_id=$rowVisitInfo['company_id'];
			
			$stmt = $dbCon->prepare("select company_name,exposed_times from whitelist_company where company_id = ? and status=1");
			/* bind parameters for markers */
			$cont=1;
			$stmt->bind_param("i", $company_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$row_company = $result->fetch_assoc();
			$exposed=$row_company['exposed_times'];
			
			$stmt = $dbCon->prepare("select email,concat_ws(' ',first_name,last_name) as name from employees where id=?");
			/* bind parameters for markers */
			
			$stmt->bind_param("i",$rowVisitInfo['inviting_employee']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			 $data['booked']='Drop in';
			$stmt = $dbCon->prepare("insert into company_visitors (booked,company_id,employee_id,name,last_name,email,country,phone_number,created_on,visitor_user_id,meeting_id,is_company,visitor_profile_id)values (?, ?, ?, ?, ?, ?, ?, ?, now(),?,?,?,?)");
			/* bind parameters for markers */
			
			$stmt->bind_param("siisssisiiii",$data['booked'],$company_id,$rowVisitInfo['inviting_employee'],$rowVisitInfo['first_name'],$rowVisitInfo['last_name'],$rowVisitInfo['email'],$rowVisitInfo['country_code'],$rowVisitInfo['phone_number'],$data['user_id'],$data['id'],$data['is_company'],$data['visitor_profile_id']);
			if($stmt->execute())
			{
		
				$id=$stmt->insert_id;
				 
				$to      = $row['email'];
				
				$subject = "Your visitor is here";
				
				$emailContent ='';
				try {
				 sendEmail($subject, $to, $emailContent);
						}

					catch(Exception $e) {
						$to      = 'kowaken.ghirmai@gmail.com';
						sendEmail($subject, $to, $emailContent);
					   
					}
				
				$exposed=$exposed+1;
				
				$stmt = $dbCon->prepare("select country_code,phone_number,passport_image,concat_ws(' ',first_name,last_name) as name  from user_profiles left join phone_country_code on phone_country_code.country_name=user_profiles.country_phone left join user_logins on user_logins.id=user_profiles.user_logins_id where user_profiles.user_logins_id=(select user_login_id from employees where id=?)");
				
				$stmt->bind_param("i",$rowVisitInfo['inviting_employee']);
				$stmt->execute();
				$result = $stmt->get_result();
				$row = $result->fetch_assoc();
				
				$phone='+'.trim($row['country_code']).''.trim($row['phone_number']);
				$subject='Your visitor is here';
				$to=$phone;
				if($data['is_company']==1)
				{
				$stmt = $dbCon->prepare("select company_name  from companies where id=?");
				
				$stmt->bind_param("i",$data['visitor_profile_id']);
				$stmt->execute();
				$result = $stmt->get_result();
				$rowDetail = $result->fetch_assoc();	
				$html=$rowVisitInfo['first_name'].' '.$rowVisitInfo['last_name'].' from '.$rowDetail['company_name'].' is here to meet you at '.$row_company['company_name'];
				}
				else
				{
				$html=$rowVisitInfo['first_name'].' '.$rowVisitInfo['last_name'].' is here to meet you at '.$row_company['company_name'];	
				}
				//echo $html.' '.$to;
				$res=sendSms($subject, $to, $html);
				$res=json_decode($res,true);
				
				if($res['status']=="OK")
				{
				$exposed=$exposed+1;
				}
				
				$stmt = $dbCon->prepare("update whitelist_company set exposed_times=? where company_id = ? and status=1");
				/* bind parameters for markers */
				$stmt->bind_param("ii", $exposed,$company_id);
				$stmt->execute();
				
				
				$enc_id=$this->encrypt_decrypt('encrypt',$id);
				$url='https://www.safeqloud.com/company/index.php/Company/confirmVisit/'.$enc_id;
				$surl=getShortUrl($url);
				
				$stmt = $dbCon->prepare("select country_code,phone_number from company_visitors left join phone_country_code on phone_country_code.country_name=company_visitors.country where company_visitors.id=?");
				
				$stmt->bind_param("i",$id);
				$stmt->execute();
				$result1 = $stmt->get_result();
				$row_phone = $result1->fetch_assoc();
				
				$phone='+'.trim($row_phone['country_code']).''.trim($row_phone['phone_number']);
				$subject='Confirm Your visit';
				$to=$phone;
				$html='Hej '.$rowVisitInfo['first_name'].', Jag är där alldeles strax.'.$surl;
				//echo $html.' '.$to;
				$res=sendSms($subject, $to, $html);
				$stmt->close();
				$dbCon->close();
				return 1;
			}
		}
		
		function invitedVisitorsMeetingList($data)
		{
			$dbCon = AppModel::createConnection();
			$location_id=$this -> encrypt_decrypt('decrypt',$data['location_id']);
			
			$stmt = $dbCon->prepare("select country_of_residence,phone_number from user_profiles left join user_logins on user_logins.id=user_profiles.user_logins_id where user_profiles.user_logins_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['user_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			   
			$today=strtotime(date('Y-m-d'));
			$org=array();
			$stmt = $dbCon->prepare("select concat_ws(' ',employees.first_name,employees.last_name) as name,employee_invited_visitor.id,visiting_date,visiting_time,visiting_address,d_port_number from employee_invited_visitor left join employees on employees.id=employee_invited_visitor.inviting_employee left join property_location on property_location.id=employee_invited_visitor.location_id where employee_invited_visitor.location_id=? and country_id=? and employee_invited_visitor.phone_number=? and visitdate_id=? and employee_invited_visitor.id not in (select meeting_id from company_visitors where visitor_user_id=?)");
			
			/* bind parameters for markers */
			$stmt->bind_param("iissi", $location_id,$row['country_of_residence'],$row['phone_number'],$today,$data['user_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			while($rowLocation = $result->fetch_assoc())
			{
					$rowLocation['address']=html_entity_decode($rowLocation['visiting_address'],ENT_NOQUOTES, 'UTF-8').' '.$rowLocation['d_port_number'];
					array_push($org,$rowLocation);
				
				 
			}
			 
			$stmt->close();
			$dbCon->close();
			return $org;
				 
		}
		
		function checkedInMeetingList($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select country_of_residence,phone_number from user_profiles left join user_logins on user_logins.id=user_profiles.user_logins_id where user_profiles.user_logins_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['user_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			
			date_default_timezone_set("Europe/Stockholm");  
			$today=strtotime(date('Y-m-d'));
			$org=array();
			$stmt = $dbCon->prepare("select concat_ws(' ',employees.first_name,employees.last_name) as name,employee_invited_visitor.id,visiting_date,visiting_time,visiting_address,d_port_number,companies.company_name from employee_invited_visitor left join employees on employees.id=employee_invited_visitor.inviting_employee left join property_location on property_location.id=employee_invited_visitor.location_id left join companies on companies.id=property_location.company_id where visitdate_id=?  and employee_invited_visitor.id in (select meeting_id from company_visitors where visitor_user_id=?)");
			
			/* bind parameters for markers */
			$stmt->bind_param("si",$today,$data['user_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			while($rowLocation = $result->fetch_assoc())
			{
					$rowLocation['company_name']=html_entity_decode($rowLocation['company_name'],ENT_NOQUOTES, 'UTF-8');
					$rowLocation['address']=html_entity_decode($rowLocation['visiting_address'],ENT_NOQUOTES, 'UTF-8').' '.$rowLocation['d_port_number'];
					array_push($org,$rowLocation);
			}
			 
			$stmt->close();
			$dbCon->close();
			return $org;
				 
		}
		
		
		function inviteVisitor($data)
		{
			$dbCon = AppModel::createConnection();
			$company_id= $data['company_id'];
			
			$stmt = $dbCon->prepare("select location_id,visiting_address from user_company_profile left join property_location on property_location.id=user_company_profile.location_id where user_company_profile.user_login_id=? and user_company_profile.company_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("ii", $data['user_id'],$data['company_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowLocation = $result->fetch_assoc();
			$location_id=$this -> encrypt_decrypt('encrypt',$rowLocation['location_id']);
			
			$stmt = $dbCon->prepare("select employees.id,concat_ws('',first_name,last_name) as name,company_name from employees left join companies on companies.id=employees.company_id where employees.user_login_id=? and company_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("ii", $data['user_id'],$data['company_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			$employee_id= $row['id'];
				$stmt = $dbCon->prepare("select country_code from phone_country_code where country_name=(select country_name from country where id=? )");
				
				/* bind parameters for markers */
				$stmt->bind_param("s", $data['country_id']);
				$stmt->execute();
				$result_phone = $stmt->get_result();
				$row_phone = $result_phone->fetch_assoc();
				$mdate=date('Y-m-d',strtotime($data['vdate']));
				$today=strtotime(date('Y-m-d'));
				$vdate_id=strtotime($data['vdate']);
				if($vdate_id<$today)
				{
					$vdate_id=$today;
					$mdate=date('Y-m-d');
				}
				
				$data['vrepeat']=1;
				$stmt = $dbCon->prepare("insert into employee_invited_visitor (company_id,inviting_employee,first_name,visitor_email,visiting_date,visiting_time,created_on,repeating_cycle,country_id,phone_number,location_id ,visitdate_id) values ( ?, ?, ?, ?, ?, ?, now(), ?, ?,?,?,?)");
			/* bind parameters for markers */
			
			$stmt->bind_param("iissssiisis",$company_id,$employee_id,htmlentities($data['name'],ENT_NOQUOTES, 'ISO-8859-1'),$data['email'],$mdate,$data['vtime'],$data['vrepeat'],$data['country_id'],$data['phone'],$rowLocation['location_id'],$vdate_id);
				$stmt->execute();
				$id=$stmt->insert_id;
				 
				$url="https://www.safeqloud.com/public/index.php/VisitorsQR/visitorFrontDesk/".$location_id;	
				if(!empty($data['email']))
				{
				$to      = $data['email'];
				$subject = "Meeting Invitation received";
				$emailContent ='<html>
    <head>
        <title>Reservation confirmed</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <style type="text/css">
            /* GT AMERICA */

            @font-face {
                font-display: fallback;
                font-family: "GT America Regular";
                font-weight: 400;
                src: url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Regular.woff2") format("woff2"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Regular.woff") format("woff"),
                    url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Regular.ttf") format("truetype");
            }

            @font-face {
                font-display: fallback;
                font-family: "GT America Medium";
                font-weight: 600;
                src: url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Medium.woff2") format("woff2"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Medium.woff") format("woff"),
                    url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Medium.ttf") format("truetype");
            }

            @font-face {
                font-display: fallback;
                font-family: "GT America Condensed Bold";
                font-weight: 700;
                src: url("https://www.exploretock.com/fonts/gt-america/GT-America-Condensed-Bold.woff2") format("woff2"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Condensed-Bold.woff") format("woff"),
                    url("https://www.exploretock.com/fonts/gt-america/GT-America-Condensed-Bold.ttf") format("truetype");
            }

            /* CLIENT-SPECIFIC RESET */

            body,
            table,
            td,
            a {
                -webkit-text-size-adjust: 100%;
                -ms-text-size-adjust: 100%;
            }

            /* Prevent WebKit and Windows mobile changing default text sizes */

            table,
            td {
                mso-table-lspace: 0pt;
                mso-table-rspace: 0pt;
            }

            /* Remove spacing between tables in Outlook 2007 and up */

            img {
                -ms-interpolation-mode: bicubic;
            }

            /* Allow smoother rendering of resized image in Internet Explorer */

            .im {
                color: inherit !important;
            }

            /* DEVICE-SPECIFIC RESET */

            a[x-apple-data-detectors] {
                color: inherit !important;
                text-decoration: none !important;
                font-size: inherit !important;
                font-family: inherit !important;
                font-weight: inherit !important;
                line-height: inherit !important;
            }

            /* iOS BLUE LINKS */

            /* RESET */

            img {
                border: 0;
                height: auto;
                line-height: 100%;
                outline: none;
                text-decoration: none;
                display: block;
            }

            table {
                border-collapse: collapse;
            }

            table td {
                border-collapse: collapse;
                display: table-cell;
            }

            body {
                height: 100% !important;
                margin: 0 !important;
                padding: 0 !important;
                width: 100% !important;
            }

            /* BG COLORS */

            .mainTable {
                background-color: #f0f0f0;
            }

            .mainTable--hospitality {
                background-color: #f7f2ed;
            }

            html {
                background-color: #f0f0f0;
            }

            /* VARIABLES */

            .bg-white {
                background-color: white;
            }

            .hr {
                /* Cross-client horizontal rule. Adapted from https://litmus.com/community/discussions/4633-is-there-a-reliable-1px-horizontal-rule-method */
                background-color: #d3d3d8;
                border-collapse: collapse;
                mso-table-lspace: 0pt;
                mso-table-rspace: 0pt;
                mso-line-height-rule: exactly;
                line-height: 1px;
            }

            .textAlignLeft {
                text-align: left !important;
            }

            .textAlignRight {
                text-align: right !important;
            }

            .textAlignCenter {
                text-align: center !important;
            }

            .mt1 {
                margin-top: 6px;
            }

            .list {
                padding-left: 18px;
                margin: 0;
            }

            /* TYPOGRAPHY */

            body {
                font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
                font-weight: 400;
                color: #4f4f65;
                -webkit-font-smoothing: antialiased;
                -ms-text-size-adjust: 100%;
                -moz-osx-font-smoothing: grayscale;
                font-smoothing: always;
                text-rendering: optimizeLegibility;
            }

            .h1 {
                font-family: "GT America Condensed Bold", "Roboto Condensed", "Roboto", "Helvetica", "Arial", sans-serif;
                font-weight: 700;
                vertical-align: middle;
                font-size: 36px;
                line-height: 42px;
            }

            .h2 {
                font-family: "GT America Medium", "Roboto", "Helvetica", "Arial", sans-serif;
                font-weight: 600;
                vertical-align: middle;
                font-size: 16px;
                line-height: 24px;
            }

            .text {
                font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
                font-weight: 400;
                font-size: 16px;
                line-height: 21px;
            }

            .text-list {
                font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
                font-weight: 400;
                font-size: 16px;
                line-height: 25px;
            }

            .textSmall {
                font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
                font-weight: 400;
                font-size: 14px;
            }

            .text-xsmall {
                font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
                font-size: 11px;
                text-transform: uppercase;
                line-height: 22px;
                letter-spacing: 1px;
            }

            .text-bold {
                font-weight: 600;
            }

            .text-link {
                text-decoration: underline;
            }

            .text-linkNoUnderline {
                text-decoration: none;
            }

            .text-strike {
                text-decoration: line-through;
            }

            /* FONT COLORS */

            .textColorDark {
                color: #23233e;
            }

            .textColorNormal {
                color: #4f4f65;
            }

            .textColorBlue {
                color: #2020c0;
            }

            .textColorGrayDark {
                color: #7b7b8b;
            }

            .textColorGray {
                color: #a5a8ad;
            }

            .textColorWhite {
                color: #ffffff;
            }

            .textColorRed {
                color: #df3232;
            }

            /* BUTTON */

            .Button-primary-wrapper {
                border-radius: 3px;
                background-color: #2020c0;
            }

            .Button-primary {
                font-family: "GT America Medium", "Roboto", "Helvetica", "Arial", sans-serif;
                border-radius: 3px;
                border: 1px solid #2020c0;
                color: #ffffff;
                display: block;
                font-size: 16px;
                font-weight: 600;
                padding: 18px;
                text-decoration: none;
            }

            .Button-secondary-wrapper {
                border-radius: 3px;
                background-color: #ffffff;
            }

            .Button-secondary {
                font-family: "GT America Medium", "Roboto", "Helvetica", "Arial", sans-serif;
                border-radius: 3px;
                border: 1px solid #2020c0;
                color: #2020c0;
                display: block;
                font-size: 16px;
                font-weight: 600;
                padding: 18px;
                text-decoration: none;
            }

            /* LAYOUT */

            .Content-container {
                padding-left: 60px;
                padding-right: 60px;
            }

            .Content-container--main {
                padding-top: 54px;
                padding-bottom: 60px;
            }

            .Content {
                width: 580px;
                margin: 0 auto;
            }

            .wrapper {
                max-width: 600px;
            }

            .section {
                padding: 24px 0px;
                border-bottom: 1px solid #d3d3d8;
            }

            .section--noBorder {
                padding: 24px 0px 0;
            }

            .section--last {
                padding: 24px 0px;
            }

            .message {
                background-color: #f4f4f5;
                padding: 18px;
            }

            .card {
                border: 1px solid #d3d3d8;
                padding: 18px;
            }

            /* HEADER */

            .header-tockLogoImage {
                display: block;
                color: #f0f0f0;
            }

            .header-heroImage {
                padding-bottom: 24px;
            }

            /* PREHEADER */

            .preheader {
                display: none;
                font-size: 1px;
                color: #ffffff;
                line-height: 1px;
                max-height: 0px;
                max-width: 0px;
                opacity: 0;
                overflow: hidden;
            }

            /* BANNER */

            .notice {
                padding: 12px;
                background: #23233e;
                color: #ffffff;
                display: block;
                font-size: 14px;
                font-family: "GT America Medium", "Roboto", "Helvetica", "Arial", sans-serif;
                font-weight: 600;
            }

            /* INTRO */

            .section--intro {
                padding-bottom: 48px;
            }

            /* BOOKING INFO */

            .business-logo__container {
                width: 48px;
                height: 48px;
                border-radius: 3px;
                border: 1px solid #d3d3d8;
                overflow: hidden;
            }

            .business-logo__image {
                border: 1px solid transparent;
                border-radius: 3px;
                width: 48px;
                height: 48px;
                display: block;
            }

            .business-address--address {
                width: 50%;
            }

            .business-address--map {
                width: 50%;
            }

            .business-address--map-image {
                width: 100%;
            }

            /* MOBILE TICKETS */

            .mobile-ticket--description {
                width: 65%;
                margin-top: 12px;
                margin-right: 5%;
            }

            .mobile-ticket--code {
                width: 30%;
            }

            .mobile-ticket--code-image {
                width: 100%;
            }

            /* RESERVATION ACTIONS */

            .linksTable {
                border-bottom: 1px solid #d3d3d8;
            }

            .linksTableRow {
                padding: 24px 12px;
            }

            .actions-icon {
                vertical-align: middle;
            }

            .actions-text {
                vertical-align: middle;
            }

            /* RECEIPT */

            .receipt__container {
                border: 1px solid #d3d3d8;
                padding: 24px;
            }

            .receipt__row {
                border-top: 1px solid #d3d3d8;
            }

            /* FEEDBACK ICONS */

            .feedback-link {
                border: 1px solid #d4d5da;
                border-radius: 3px;
                display: inline-block;
                width: calc(32% - 2px);
                padding: 10px 0;
            }

            .feedback-link-bumper {
                display: inline-block;
                width: 1%;
            }

            .feedback-link img {
                height: 50px;
                width: 50px;
            }

            /* SOCIAL ICONS */

            .social-link {
                display: inline-block;
                width: auto;
            }

            .social-link-text {
                padding: 14px 24px 14px 14px;
            }

            /* TABLET STYLES */

            @media screen and (max-width: 648px) {
                /* DEVICE-SPECIFIC RESET */
                div[style*="margin: 16px 0;"] {
                    margin: 0 !important;
                }
                /* ANDROID CENTER FIX */
                /* LAYOUT */
                .wrapper {
                    width: 100% !important;
                    max-width: 100% !important;
                }
                .Content {
                    width: 90% !important;
                }
                .Content-container {
                    padding-left: 36px !important;
                    padding-right: 36px !important;
                }
                .Content-container--main {
                    padding-top: 30px !important;
                    padding-bottom: 42px !important;
                }
                .responsiveTable {
                    width: 100% !important;
                }
                /* RESERVATION ACTIONS */
                .linksTableRow {
                    padding-left: 0 !important;
                    padding-right: 0 !important;
                    padding-top: 12px !important;
                    padding-bottom: 12px !important;
                }
                .linksTableRow--borderRight {
                    border-right: none !important;
                    padding-left: 0 !important;
                    padding-right: 0 !important;
                }
                /* FEEDBACK LINK */
                .feedback-link img {
                    height: 38px !important;
                    width: 38px !important;
                }
            }

            /* MOBILE STYLES */

            @media screen and (max-width: 480px) {
                /* TYPOGRAPHY */
                .h1 {
                    font-size: 30px !important;
                    line-height: 30px !important;
                }
                .text {
                    font-size: 16px !important;
                    line-height: 22px !important;
                }
                /* BUTTON */
                .mobile-buttonContainer {
                    width: 100% !important;
                }
                /* LAYOUT */
                .Content {
                    width: 100% !important;
                }
                .Content-container {
                    padding-left: 18px !important;
                    padding-right: 18px !important;
                }
                .Content-container--main {
                    padding-top: 24px !important;
                    padding-bottom: 30px !important;
                }
                .section {
                    padding: 18px 0 !important;
                }
                .section--last {
                    padding: 18px 0 !important;
                }
                .header {
                    padding: 0 18px !important;
                }
                .business-address--address {
                    width: 100% !important;
                }
                .business-address--map {
                    margin-top: 30px !important;
                    width: 100% !important;
                }
                .mobile-ticket--description {
                    width: 100% !important;
                    margin-top: 0px !important;
                }
                .mobile-ticket--code {
                    margin-top: 30px !important;
                    margin-left: 0;
                    width: 100% !important;
                }
                /* RECEIPT */
                .receipt__container {
                    padding: 12px !important;
                }
                /* SOCIAL ICONS */
                .social-link {
                    display: block !important;
                    width: 100% !important;
                    border-bottom: 1px solid #d3d3d8 !important;
                }
                /* INTRO */
                .section--intro {
                    padding-top: 18px !important;
                    padding-bottom: 18px !important;
                }
            }
        </style>

        <!--[if mso]>
            <style type="text/css">
                .h1 {
                    font-family: "Helvetica", "Arial", sans-serif !important;
                    font-weight: 700 !important;
                    vertical-align: middle !important;
                    font-size: 36px !important;
                    mso-line-height-rule: exactly;
                    line-height: 42px !important;
                }
                .h2 {
                    font-family: "Helvetica", "Arial", sans-serif !important;
                    font-weight: 600 !important;
                    vertical-align: middle !important;
                    font-size: 16px !important;
                    mso-line-height-rule: exactly;
                    line-height: 24px !important;
                }
                .text {
                    font-family: "Helvetica", "Arial", sans-serif !important;
                    font-weight: 400 !important;
                    font-size: 16px !important;
                    mso-line-height-rule: exactly;
                    line-height: 21px !important;
                }
                .text-list {
                    font-family: "Helvetica", "Arial", sans-serif !important;
                    font-weight: 400 !important;
                    font-size: 16px !important;
                    mso-line-height-rule: exactly;
                    line-height: 25px !important;
                }
                .textSmall {
                    font-family: "Helvetica", "Arial", sans-serif !important;
                    font-weight: 400 !important;
                    font-size: 14px !important;
                }
                .text-xsmall {
                    font-family: "Helvetica", "Arial", sans-serif !important;
                    font-size: 11px !important;
                    text-transform: uppercase !important;
                    mso-line-height-rule: exactly;
                    line-height: 22px !important;
                    letter-spacing: 1px !important;
                }
                .text-bold {
                    font-weight: 600 !important;
                }
                .text-link {
                    text-decoration: underline !important;
                }
                .text-linkNoUnderline {
                    text-decoration: none !important;
                }
                .text-strike {
                    text-decoration: line-through !important;
                }
                .textColorDark {
                    color: #23233e !important;
                }
                .textColorNormal {
                    color: #4f4f65 !important;
                }
                .textColorBlue {
                    color: #2020c0 !important;
                }
                .textColorGray {
                    color: #a5a8ad !important;
                }
                .textColorWhite {
                    color: #ffffff !important;
                }
                .Button-primary {
                    font-family: "Helvetica", "Arial", sans-serif !important;
                    border-radius: 3px !important;
                    border: 1px solid #2020c0 !important;
                    color: #ffffff !important;
                    display: block !important;
                    font-size: 16px !important;
                    font-weight: 600 !important;
                    padding: 18px !important;
                    text-decoration: none !important;
                }
                .Button-secondary {
                    font-family: "Helvetica", "Arial", sans-serif !important;
                    border-radius: 3px !important;
                    border: 1px solid #2020c0 !important;
                    color: #2020c0 !important;
                    display: block !important;
                    font-size: 16px !important;
                    font-weight: 600 !important;
                    padding: 18px !important;
                    text-decoration: none !important;
                }
            </style>
        <![endif]-->
        <!-- HIDDEN PREHEADER TEXT -->
    </head>
    <body>
        <div class="preheader" style="display: none; font-size: 1px; color: rgb(255, 255, 255); line-height: 1px; max-height: 0px; max-width: 0px; opacity: 0; overflow: hidden;"></div>
        <table
            border="0"
            cellpadding="0"
            cellspacing="0"
            width="100%"
            class="mainTable"
            style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; background-color: rgb(240, 240, 240);"
        >
            <tbody>
                <tr>
                    <td
                        style="
                            display: none !important;
                            visibility: hidden;
                            mso-hide: all;
                            font-size: 1px;
                            color: #ffffff;
                            line-height: 1px;
                            max-height: 0px;
                            max-width: 0px;
                            opacity: 0;
                            overflow: hidden;
                            -webkit-text-size-adjust: 100%;
                            -ms-text-size-adjust: 100%;
                            mso-table-lspace: 0pt;
                            mso-table-rspace: 0pt;
                            border-collapse: collapse;
                            display: table-cell;
                        "
                    >
                        We are thrilled that you will be joining us. If yo...
                    </td>
                    <!-- HEADER -->
                </tr>
                <tr>
                    <td align="center" class="header" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                        <!--[if (gte mso 9)|(IE)]>
    <table align="center" border="0" cellspacing="0" cellpadding="0" width="600">
    <tr>
    <td align="center" valign="top" width="600">
    <![endif]-->
                        <table
                            border="0"
                            cellpadding="0"
                            cellspacing="0"
                            width="100%"
                            class="Content"
                            style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; width: 580px; margin: 0 auto;"
                        >
                            <tbody>
                                <tr class="spacer">
                                    <td
                                        height="12px"
                                        colspan="2"
                                        style="font-size: 12px; line-height: 12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;"
                                    >
                                        &nbsp;
                                    </td>
                                </tr>
                                <tr class="spacer">
                                    <td
                                        height="12px"
                                        colspan="2"
                                        style="font-size: 12px; line-height: 12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;"
                                    >
                                        &nbsp;
                                    </td>
                                </tr>
                                <tr>
                                    <td align="left" valign="middle" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        <h1 style="font-size: 33px; font-weight: 800; line-height: 30px;">Dstricts</h1>
                                    </td>
                                </tr>
                                <tr class="spacer">
                                    <td
                                        height="12px"
                                        colspan="2"
                                        style="font-size: 12px; line-height: 12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;"
                                    >
                                        &nbsp;
                                    </td>
                                </tr>
                                <tr class="spacer">
                                    <td
                                        height="12px"
                                        colspan="2"
                                        style="font-size: 12px; line-height: 12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;"
                                    >
                                        &nbsp;
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <!--[if (gte mso 9)|(IE)]>
    </td>
    </tr>
    </table>
    <![endif]-->
                    </td>
                </tr>
                <!-- CONTENT -->
                <tr>
                    <td align="center" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                        <!--[if (gte mso 9)|(IE)]>
    <table align="center" border="0" cellspacing="0" cellpadding="0" width="600">
    <tr>
    <td align="center" valign="top" width="600">
    <![endif]-->
                        <table
                            border="0"
                            cellpadding="0"
                            cellspacing="0"
                            width="100%"
                            class="Content bg-white"
                            style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; background-color: white; width: 580px; margin: 0 auto;"
                        >
                            <tbody>
                                <tr>
                                    <td
                                        class="Content-container Content-container--main text textColorNormal"
                                        style="
                                            -webkit-text-size-adjust: 100%;
                                            -ms-text-size-adjust: 100%;
                                            mso-table-lspace: 0pt;
                                            mso-table-rspace: 0pt;
                                            border-collapse: collapse;
                                            display: table-cell;
                                            font-family: GT America Regular, Roboto, Helvetica, Arial, sans-serif;
                                            font-weight: 400;
                                            font-size: 16px;
                                            line-height: 21px;
                                            color: rgb(79, 79, 101);
                                            padding-left: 60px;
                                            padding-right: 60px;
                                            padding-top: 54px;
                                            padding-bottom: 60px;
                                        "
                                    >
                                        <table
                                            width="100%"
                                            border="0"
                                            cellspacing="0"
                                            cellpadding="0"
                                            style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;"
                                        >
                                            <!-- RESTAURANT INFO -->
                                            <tbody>
                                                <tr>
                                                    <td valign="top" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                                        <table
                                                            align="left"
                                                            border="0"
                                                            cellpadding="0"
                                                            cellspacing="0"
                                                            width="100%"
                                                            style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;"
                                                        >
                                                            <tbody>
                                                                <tr>
                                                                    <td
                                                                        width="12"
                                                                        style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;"
                                                                    >
                                                                        &nbsp;
                                                                    </td>
                                                                    <td
                                                                        align="left"
                                                                        valign="middle"
                                                                        style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;"
                                                                    >
                                                                        <span
                                                                            class="h2 textColorDark"
                                                                            style="
                                                                                font-family: GT America Medium, Roboto, Helvetica, Arial, sans-serif;
                                                                                font-weight: 600;
                                                                                vertical-align: middle;
                                                                                font-size: 16px;
                                                                                line-height: 24px;
                                                                                color: rgb(35, 35, 62);
                                                                            "
                                                                        >
                                                                            '.htmlentities($data['name'],ENT_NOQUOTES, 'ISO-8859-1').'
                                                                        </span>
                                                                    </td>
                                                                </tr>
                                                                <tr class="spacer">
                                                                    <td
                                                                        height="12px"
                                                                        colspan="2"
                                                                        style="
                                                                            font-size: 12px;
                                                                            line-height: 12px;
                                                                            -webkit-text-size-adjust: 100%;
                                                                            -ms-text-size-adjust: 100%;
                                                                            mso-table-lspace: 0pt;
                                                                            mso-table-rspace: 0pt;
                                                                            border-collapse: collapse;
                                                                            display: table-cell;
                                                                        "
                                                                    >
                                                                        &nbsp;
                                                                    </td>
                                                                </tr>
                                                                <tr class="spacer">
                                                                    <td
                                                                        height="12px"
                                                                        colspan="2"
                                                                        style="
                                                                            font-size: 12px;
                                                                            line-height: 12px;
                                                                            -webkit-text-size-adjust: 100%;
                                                                            -ms-text-size-adjust: 100%;
                                                                            mso-table-lspace: 0pt;
                                                                            mso-table-rspace: 0pt;
                                                                            border-collapse: collapse;
                                                                            display: table-cell;
                                                                        "
                                                                    >
                                                                        &nbsp;
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </td>
                                                </tr>
                                                <!-- INTRO -->
                                                <tr>
                                                    <td
                                                        valign="top"
                                                        align="left"
                                                        style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;"
                                                    >
                                                        <table
                                                            width="100%"
                                                            border="0"
                                                            cellspacing="0"
                                                            cellpadding="0"
                                                            style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;"
                                                        >
                                                            <tbody>
                                                                <tr>
                                                                    <td
                                                                        align="left"
                                                                        style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;"
                                                                    >
                                                                        <span
                                                                            class="h1 textColorDark"
                                                                            style="
                                                                                font-family: GT America Condensed Bold, Roboto Condensed, Roboto, Helvetica, Arial, sans-serif;
                                                                                font-weight: 700;
                                                                                vertical-align: middle;
                                                                                font-size: 36px;
                                                                                line-height: 42px;
                                                                                color: rgb(35, 35, 62);
                                                                            "
                                                                        >
                                                                            You have a meeting invitation from '.$row['name'].' at '.$row['company_name'].'
                                                                        </span>
                                                                    </td>
                                                                </tr>
                                                                <tr class="spacer">
                                                                    <td
                                                                        height="18px"
                                                                        colspan="2"
                                                                        style="
                                                                            font-size: 18px;
                                                                            line-height: 18px;
                                                                            -webkit-text-size-adjust: 100%;
                                                                            -ms-text-size-adjust: 100%;
                                                                            mso-table-lspace: 0pt;
                                                                            mso-table-rspace: 0pt;
                                                                            border-collapse: collapse;
                                                                            display: table-cell;
                                                                        "
                                                                    >
                                                                        &nbsp;
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td
                                                                        align="left"
                                                                        colspan="2"
                                                                        valign="top"
                                                                        width="100%"
                                                                        height="1"
                                                                        class="hr"
                                                                        style="
                                                                            -webkit-text-size-adjust: 100%;
                                                                            -ms-text-size-adjust: 100%;
                                                                            mso-table-lspace: 0pt;
                                                                            mso-table-rspace: 0pt;
                                                                            border-collapse: collapse;
                                                                            display: table-cell;
                                                                            background-color: rgb(211, 211, 216);
                                                                            border-collapse: collapse;
                                                                            mso-table-lspace: 0pt;
                                                                            mso-table-rspace: 0pt;
                                                                            mso-line-height-rule: exactly;
                                                                            line-height: 1px;
                                                                        "
                                                                    >
                                                                        <!--[if gte mso 15]>&nbsp;<![endif]-->
                                                                    </td>
                                                                </tr>
                                                                <tr class="spacer">
                                                                    <td
                                                                        height="18px"
                                                                        colspan="2"
                                                                        style="
                                                                            font-size: 18px;
                                                                            line-height: 18px;
                                                                            -webkit-text-size-adjust: 100%;
                                                                            -ms-text-size-adjust: 100%;
                                                                            mso-table-lspace: 0pt;
                                                                            mso-table-rspace: 0pt;
                                                                            border-collapse: collapse;
                                                                            display: table-cell;
                                                                        "
                                                                    >
                                                                        &nbsp;
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </td>
                                                </tr>
                                                <!-- MESSAGE -->

                                                <!-- BOOKING INFO -->
                                                <tr>
                                                    <td valign="top" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                                        <table
                                                            align="left"
                                                            border="0"
                                                            cellpadding="0"
                                                            cellspacing="0"
                                                            width="100%"
                                                            style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;"
                                                        >
                                                            <tbody>
                                                                <tr>
                                                                    <td
                                                                        align="left"
                                                                        valign="middle"
                                                                        width="468"
                                                                        style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;"
                                                                    ></td>
                                                                </tr>

                                                                <tr class="spacer">
                                                                    <td
                                                                        height="12px"
                                                                        colspan="2"
                                                                        style="
                                                                            font-size: 12px;
                                                                            line-height: 12px;
                                                                            -webkit-text-size-adjust: 100%;
                                                                            -ms-text-size-adjust: 100%;
                                                                            mso-table-lspace: 0pt;
                                                                            mso-table-rspace: 0pt;
                                                                            border-collapse: collapse;
                                                                            display: table-cell;
                                                                        "
                                                                    >
                                                                        &nbsp;
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td
                                                                        align="center"
                                                                        valign="center"
                                                                        width="100%"
                                                                        style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;"
                                                                    >
                                                                        <table
                                                                            border="0"
                                                                            cellspacing="0"
                                                                            cellpadding="0"
                                                                            width="100%"
                                                                            style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;"
                                                                        >
                                                                            <tbody>
                                                                                <tr>
                                                                                    <td
                                                                                        align="center"
                                                                                        valign="center"
                                                                                        width="100%"
                                                                                        class="Button-primary-wrapper"
                                                                                        style="
                                                                                            -webkit-text-size-adjust: 100%;
                                                                                            -ms-text-size-adjust: 100%;
                                                                                            mso-table-lspace: 0pt;
                                                                                            mso-table-rspace: 0pt;
                                                                                            border-collapse: collapse;
                                                                                            display: table-cell;
                                                                                            border-radius: 3px;
                                                                                            background-color: rgb(32, 32, 192);
                                                                                        "
                                                                                    >
                                                                                        <a
                                                                                            href="'.$url.'"
                                                                                            target="_blank"
                                                                                            class="Button-primary"
                                                                                            style="
                                                                                                -webkit-text-size-adjust: 100%;
                                                                                                -ms-text-size-adjust: 100%;
                                                                                                font-family: GT America Medium, Roboto, Helvetica, Arial, sans-serif;
                                                                                                border-radius: 3px;
                                                                                                border: 1px solid rgb(32, 32, 192);
                                                                                                color: rgb(255, 255, 255);
                                                                                                display: block;
                                                                                                font-size: 16px;
                                                                                                font-weight: 600;
                                                                                                padding: 18px;
                                                                                                text-decoration: none;
                                                                                            "
                                                                                        >
                                                                                            Manage your Meeting
                                                                                        </a>
                                                                                    </td>
                                                                                </tr>
                                                                            </tbody>
                                                                        </table>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </td>
                                                </tr>
                                                <!-- ADDRESS -->
                                                <tr>
                                                    <td align="center" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                                        <table
                                                            border="0"
                                                            cellpadding="0"
                                                            cellspacing="0"
                                                            width="100%"
                                                            style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;"
                                                        >
                                                            <tbody>
                                                                <tr class="spacer">
                                                                    <td
                                                                        height="18px"
                                                                        colspan="2"
                                                                        style="
                                                                            font-size: 18px;
                                                                            line-height: 18px;
                                                                            -webkit-text-size-adjust: 100%;
                                                                            -ms-text-size-adjust: 100%;
                                                                            mso-table-lspace: 0pt;
                                                                            mso-table-rspace: 0pt;
                                                                            border-collapse: collapse;
                                                                            display: table-cell;
                                                                        "
                                                                    >
                                                                        &nbsp;
                                                                    </td>
                                                                </tr>
                                                                <tr class="spacer">
                                                                    <td
                                                                        height="18px"
                                                                        colspan="2"
                                                                        style="
                                                                            font-size: 18px;
                                                                            line-height: 18px;
                                                                            -webkit-text-size-adjust: 100%;
                                                                            -ms-text-size-adjust: 100%;
                                                                            mso-table-lspace: 0pt;
                                                                            mso-table-rspace: 0pt;
                                                                            border-collapse: collapse;
                                                                            display: table-cell;
                                                                        "
                                                                    >
                                                                        &nbsp;
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td
                                                                        align="left"
                                                                        colspan="2"
                                                                        valign="top"
                                                                        width="100%"
                                                                        height="1"
                                                                        class="hr"
                                                                        style="
                                                                            -webkit-text-size-adjust: 100%;
                                                                            -ms-text-size-adjust: 100%;
                                                                            mso-table-lspace: 0pt;
                                                                            mso-table-rspace: 0pt;
                                                                            border-collapse: collapse;
                                                                            display: table-cell;
                                                                            background-color: rgb(211, 211, 216);
                                                                            border-collapse: collapse;
                                                                            mso-table-lspace: 0pt;
                                                                            mso-table-rspace: 0pt;
                                                                            mso-line-height-rule: exactly;
                                                                            line-height: 1px;
                                                                        "
                                                                    >
                                                                        <!--[if gte mso 15]>&nbsp;<![endif]-->
                                                                    </td>
                                                                </tr>
                                                                <tr class="spacer">
                                                                    <td
                                                                        height="18px"
                                                                        colspan="2"
                                                                        style="
                                                                            font-size: 18px;
                                                                            line-height: 18px;
                                                                            -webkit-text-size-adjust: 100%;
                                                                            -ms-text-size-adjust: 100%;
                                                                            mso-table-lspace: 0pt;
                                                                            mso-table-rspace: 0pt;
                                                                            border-collapse: collapse;
                                                                            display: table-cell;
                                                                        "
                                                                    >
                                                                        &nbsp;
                                                                    </td>
                                                                </tr>
                                                                <tr class="spacer">
                                                                    <td
                                                                        height="18px"
                                                                        colspan="2"
                                                                        style="
                                                                            font-size: 18px;
                                                                            line-height: 18px;
                                                                            -webkit-text-size-adjust: 100%;
                                                                            -ms-text-size-adjust: 100%;
                                                                            mso-table-lspace: 0pt;
                                                                            mso-table-rspace: 0pt;
                                                                            border-collapse: collapse;
                                                                            display: table-cell;
                                                                        "
                                                                    >
                                                                        &nbsp;
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td
                                                                        align="left"
                                                                        valign="middle"
                                                                        style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;"
                                                                    >
                                                                        <table
                                                                            border="0"
                                                                            cellpadding="0"
                                                                            cellspacing="0"
                                                                            width="100%"
                                                                            style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;"
                                                                        >
                                                                            <tbody>
                                                                                <tr>
                                                                                    <td
                                                                                        style="
                                                                                            -webkit-text-size-adjust: 100%;
                                                                                            -ms-text-size-adjust: 100%;
                                                                                            mso-table-lspace: 0pt;
                                                                                            mso-table-rspace: 0pt;
                                                                                            border-collapse: collapse;
                                                                                            display: table-cell;
                                                                                        "
                                                                                    >
                                                                                        <table
                                                                                            align="left"
                                                                                            border="0"
                                                                                            cellpadding="0"
                                                                                            cellspacing="0"
                                                                                            width="230"
                                                                                            class="business-address--address"
                                                                                            style="
                                                                                                -webkit-text-size-adjust: 100%;
                                                                                                -ms-text-size-adjust: 100%;
                                                                                                mso-table-lspace: 0pt;
                                                                                                mso-table-rspace: 0pt;
                                                                                                border-collapse: collapse;
                                                                                                width: 70%;
                                                                                            "
                                                                                        >
                                                                                            <tbody>
                                                                                                <tr>
                                                                                                    <td
                                                                                                        align="left"
                                                                                                        width="100%"
                                                                                                        class="text-list textColorNormal"
                                                                                                        style="
                                                                                                            -webkit-text-size-adjust: 100%;
                                                                                                            -ms-text-size-adjust: 100%;
                                                                                                            mso-table-lspace: 0pt;
                                                                                                            mso-table-rspace: 0pt;
                                                                                                            border-collapse: collapse;
                                                                                                            display: table-cell;
                                                                                                            font-family: GT America Regular, Roboto, Helvetica, Arial, sans-serif;
                                                                                                            font-weight: 400;
                                                                                                            font-size: 16px;
                                                                                                            line-height: 25px;
                                                                                                            color: rgb(79, 79, 101);
                                                                                                        "
                                                                                                    >
                                                                                                        <span
                                                                                                            class="h2 textColorDark"
                                                                                                            style="
                                                                                                                font-family: GT America Medium, Roboto, Helvetica, Arial, sans-serif;
                                                                                                                font-weight: 600;
                                                                                                                vertical-align: middle;
                                                                                                                font-size: 16px;
                                                                                                                line-height: 24px;
                                                                                                                color: rgb(35, 35, 62);
                                                                                                            "
                                                                                                        >
                                                                                                            If button dont work please copy and paste the link in browser: '.$surl.'
                                                                                                        </span>
                                                                                                    </td>
                                                                                                </tr>
                                                                                            </tbody>
                                                                                        </table>
                                                                                        <!--[if mso]></td><td><![endif]-->
                                                                                        <table
                                                                                            align="right"
                                                                                            border="0"
                                                                                            cellpadding="0"
                                                                                            cellspacing="0"
                                                                                            width="230"
                                                                                            class="business-address--map"
                                                                                            style="
                                                                                                -webkit-text-size-adjust: 100%;
                                                                                                -ms-text-size-adjust: 100%;
                                                                                                mso-table-lspace: 0pt;
                                                                                                mso-table-rspace: 0pt;
                                                                                                border-collapse: collapse;
                                                                                                width: 50%;
                                                                                            "
                                                                                        >
                                                                                            <tbody>
                                                                                                <tr></tr>
                                                                                            </tbody>
                                                                                        </table>
                                                                                    </td>
                                                                                </tr>
                                                                            </tbody>
                                                                        </table>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </td>
                                                </tr>
                                                <tr class="spacer">
                                                    <td
                                                        height="18px"
                                                        colspan="2"
                                                        style="
                                                            font-size: 18px;
                                                            line-height: 18px;
                                                            -webkit-text-size-adjust: 100%;
                                                            -ms-text-size-adjust: 100%;
                                                            mso-table-lspace: 0pt;
                                                            mso-table-rspace: 0pt;
                                                            border-collapse: collapse;
                                                            display: table-cell;
                                                        "
                                                    >
                                                        &nbsp;
                                                    </td>
                                                </tr>
                                                <tr class="spacer">
                                                    <td
                                                        height="18px"
                                                        colspan="2"
                                                        style="
                                                            font-size: 18px;
                                                            line-height: 18px;
                                                            -webkit-text-size-adjust: 100%;
                                                            -ms-text-size-adjust: 100%;
                                                            mso-table-lspace: 0pt;
                                                            mso-table-rspace: 0pt;
                                                            border-collapse: collapse;
                                                            display: table-cell;
                                                        "
                                                    >
                                                        &nbsp;
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td
                                                        align="left"
                                                        colspan="2"
                                                        valign="top"
                                                        width="100%"
                                                        height="1"
                                                        class="hr"
                                                        style="
                                                            -webkit-text-size-adjust: 100%;
                                                            -ms-text-size-adjust: 100%;
                                                            mso-table-lspace: 0pt;
                                                            mso-table-rspace: 0pt;
                                                            border-collapse: collapse;
                                                            display: table-cell;
                                                            background-color: rgb(211, 211, 216);
                                                            border-collapse: collapse;
                                                            mso-table-lspace: 0pt;
                                                            mso-table-rspace: 0pt;
                                                            mso-line-height-rule: exactly;
                                                            line-height: 1px;
                                                        "
                                                    >
                                                        <!--[if gte mso 15]>&nbsp;<![endif]-->
                                                    </td>
                                                </tr>

                                                <!-- RECEIPT -->

                                                <tr class="spacer">
                                                    <td
                                                        height="18px"
                                                        colspan="2"
                                                        style="
                                                            font-size: 18px;
                                                            line-height: 18px;
                                                            -webkit-text-size-adjust: 100%;
                                                            -ms-text-size-adjust: 100%;
                                                            mso-table-lspace: 0pt;
                                                            mso-table-rspace: 0pt;
                                                            border-collapse: collapse;
                                                            display: table-cell;
                                                        "
                                                    >
                                                        &nbsp;
                                                    </td>
                                                </tr>
                                                <!-- EDIT RECEIPT -->
                                                <!-- CANCELLATION POLICY -->
                                                <tr>
                                                    <td valign="top" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                                        <table
                                                            border="0"
                                                            cellpadding="0"
                                                            cellspacing="0"
                                                            width="100%"
                                                            style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;"
                                                        >
                                                            <tbody>
                                                                <tr>
                                                                    <td
                                                                        align="left"
                                                                        style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;"
                                                                    >
                                                                        <div
                                                                            class="text text-bold textColorDark"
                                                                            style="
                                                                                font-family: GT America Regular, Roboto, Helvetica, Arial, sans-serif;
                                                                                font-weight: 400;
                                                                                font-size: 16px;
                                                                                line-height: 21px;
                                                                                font-weight: 600;
                                                                                color: rgb(35, 35, 62);
                                                                            "
                                                                        >
                                                                            Address for meeting
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td
                                                                        align="left"
                                                                        style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;"
                                                                    >
                                                                        <div
                                                                            class="text textColorNormal mt1"
                                                                            style="
                                                                                margin-top: 6px;
                                                                                font-family: GT America Regular, Roboto,Helvetica, Arial, sans-serif;
                                                                                font-weight: 400;
                                                                                font-size: 16px;
                                                                                line-height: 21px;
                                                                                color: rgb(79, 79, 101);
                                                                            "
                                                                        >
                                                                            <span>'.$rowLocation['visiting_address'].'</span>
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </td>
                                                </tr>
                                                <tr class="spacer">
                                                    <td
                                                        height="12px"
                                                        colspan="2"
                                                        style="
                                                            font-size: 12px;
                                                            line-height: 12px;
                                                            -webkit-text-size-adjust: 100%;
                                                            -ms-text-size-adjust: 100%;
                                                            mso-table-lspace: 0pt;
                                                            mso-table-rspace: 0pt;
                                                            border-collapse: collapse;
                                                            display: table-cell;
                                                        "
                                                    >
                                                        &nbsp;
                                                    </td>
                                                </tr>
                                                <tr class="spacer">
                                                    <td
                                                        height="12px"
                                                        colspan="2"
                                                        style="
                                                            font-size: 12px;
                                                            line-height: 12px;
                                                            -webkit-text-size-adjust: 100%;
                                                            -ms-text-size-adjust: 100%;
                                                            mso-table-lspace: 0pt;
                                                            mso-table-rspace: 0pt;
                                                            border-collapse: collapse;
                                                            display: table-cell;
                                                        "
                                                    >
                                                        &nbsp;
                                                    </td>
                                                </tr>
                                                <!-- QUESTIONS -->
                                            </tbody>
                                        </table>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </td>
                </tr>
                <!-- FOOTER -->
                <tr>
                    <td
                        align="center"
                        class="Content"
                        style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell; width: 580px; margin: 0 auto;"
                    >
                        <!-- Will most likely required a feature flag -->
                        <!--[if (gte mso 9)|(IE)]>
<table align="center" border="0" cellspacing="0" cellpadding="0" width="600">
<tr>
<td align="center" valign="top" width="600">
<![endif]-->
                        <table
                            width="100%"
                            border="0"
                            cellspacing="0"
                            cellpadding="0"
                            align="center"
                            class="Content-container"
                            style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; padding-left: 60px; padding-right: 60px;"
                        >
                            <tbody>
                                <tr class="spacer">
                                    <td
                                        height="12px"
                                        colspan="2"
                                        style="font-size: 12px; line-height: 12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;"
                                    >
                                        &nbsp;
                                    </td>
                                </tr>
                                <tr class="spacer">
                                    <td
                                        height="12px"
                                        colspan="2"
                                        style="font-size: 12px; line-height: 12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;"
                                    >
                                        &nbsp;
                                    </td>
                                </tr>
                                <tr class="spacer">
                                    <td
                                        height="12px"
                                        colspan="2"
                                        style="font-size: 12px; line-height: 12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;"
                                    >
                                        &nbsp;
                                    </td>
                                </tr>
                                <tr>
                                    <td align="center" valign="top" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        <a href="https://www.exploretock.com" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%;">
                                            <img
                                                src="https://storage.googleapis.com/tock-public-assets/images-email-template/tock-brandmark-color.png"
                                                width="30"
                                                height="30"
                                                alt="Tock"
                                                border="0"
                                                style="-ms-interpolation-mode: bicubic; border: 0; height: auto; line-height: 100%; outline: none; text-decoration: none; display: block;"
                                            />
                                        </a>
                                    </td>
                                </tr>
                                <tr class="spacer">
                                    <td
                                        height="18px"
                                        colspan="2"
                                        style="font-size: 18px; line-height: 18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;"
                                    >
                                        &nbsp;
                                    </td>
                                </tr>
                                <tr>
                                    <td align="center" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        <div
                                            class="text-xsmall textColorNormal"
                                            style="font-family: GT America Regular, Roboto,Helvetica, Arial, sans-serif; font-size: 11px; text-transform: uppercase; line-height: 22px; letter-spacing: 1px; color: rgb(79, 79, 101);"
                                        >
                                            © 2019 Tock, Inc.
                                        </div>
                                        <div
                                            class="text-xsmall textColorNormal"
                                            style="font-family: GT America Regular, Roboto,Helvetica, Arial, sans-serif; font-size: 11px; text-transform: uppercase; line-height: 22px; letter-spacing: 1px; color: rgb(79, 79, 101);"
                                        >
                                            All Rights Reserved
                                        </div>
                                    </td>
                                </tr>
                                <tr class="spacer">
                                    <td
                                        height="12px"
                                        colspan="2"
                                        style="font-size: 12px; line-height: 12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;"
                                    >
                                        &nbsp;
                                    </td>
                                </tr>
                                <tr class="spacer">
                                    <td
                                        height="12px"
                                        colspan="2"
                                        style="font-size: 12px; line-height: 12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;"
                                    >
                                        &nbsp;
                                    </td>
                                </tr>
                                <tr class="spacer">
                                    <td
                                        height="12px"
                                        colspan="2"
                                        style="font-size: 12px; line-height: 12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;"
                                    >
                                        &nbsp;
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <!--[if (gte mso 9)|(IE)]>
</td>
</tr>
</table>
<![endif]-->
                    </td>
                </tr>
            </tbody>
        </table>
    </body>
</html>';
				try {
					 sendEmail($subject, $to, $emailContent);
					}

					 
					catch(Exception $e) {
					   
					}
					
				}
				
				 
				$to            = '+'.trim($row_phone['country_code']).''.trim($data['phone']);
				
				$surl=getShortUrl($url);
				$emailContent =$row['name']." has sent you request for a meeting at ".$row['company_name']." please scan qr code on reception to confirm your visit. you can check qr code here: ".$surl;
				$res=sendSms($subject, $to, $emailContent);
				
				$stmt->close();
				$dbCon->close();
				return 1;
				 
		}
		

		function getAvailableRooms($data)
		{
			$dbCon = AppModel::createConnection();
			 
			$stmt = $dbCon->prepare("select room_type_id,checkin_code,user_id,checkin_booking_date,checkout_booking_date,hotel_id from hotel_checkout_detail where id=?");
			/* bind parameters for markers */
			$stmt->bind_param("i",$data['checkout_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowCode = $result->fetch_assoc();
			 
			$stmt = $dbCon->prepare("select id,room_name from hotel_room_detail where room_type=? and id not in (select room_id from hotel_checkout_detail where room_type_id=? and checked_in=1 and room_id is not null) and is_approved_cleaning=1 and id not in (select room_id from hotel_insta_boxes where hotel_id=?)");
		
			$stmt->bind_param("iii",$rowCode['room_type_id'],$rowCode['room_type_id'],$rowCode['hotel_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			while($row = $result->fetch_assoc())
			{
				 
				array_push($org,$row);
			}
			$stmt->close();
			$dbCon->close();
			return $org;
		}	
		
		
		 


		function releaseHotelInstabox($data)
		{
			$dbCon = AppModel::createConnection();
			$id=$this->encrypt_decrypt('decrypt',$data['id']);
			$stmt = $dbCon->prepare("update hotel_basic_information set login_ip=null,login_status=0,login_started_at=null,insta_box_id=null,booking_id=null where id=?");
				/* bind parameters for markers */
			$stmt->bind_param("i",$id);
			$stmt->execute();
			$stmt->close();
			$dbCon->close();
			return 1;
			 
			
		}
		
		function allocateCheckedOutRoomForCleaning($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("update hotel_room_detail set cleaning_work_assigned=1,staff_assigned_id=?,is_approved_cleaning=0 where id=?");
			$stmt->bind_param("ii",$data['user_id'],$data['room_id']);
			$stmt->execute();
			 
			$stmt->close();
			$dbCon->close();
			return 1;
			 
		}
		function hotelCheckedOutListForCleningStaff($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select location_id,concat_ws(' ',first_name,last_name) as name from user_company_profile left join user_logins on user_logins.id=user_company_profile.user_login_id where company_id=? and user_login_id=?");
			$stmt->bind_param("ii",$data['company_id'],$data['user_id']);
			$stmt->execute();
			$result2 = $stmt->get_result();
			$row2 = $result2->fetch_assoc();
			 
			$today=strtotime(date('Y-m-d'));
			
			$stmt = $dbCon->prepare("select room_id,cleaning_work_assigned,room_name,hotel_checkout_detail.id,concat_ws(' ',first_name,last_name) as name, checkout_time_info,staff_assigned_id from hotel_checkout_detail  left join hotel_room_detail on hotel_room_detail.id=hotel_checkout_detail.room_id  left join user_logins on user_logins.id=hotel_room_detail.staff_assigned_id  where checked_in=2 and hotel_checkout_detail.property_id=? and is_approved_cleaning=0");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $row2['location_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			while($row = $result->fetch_assoc())
			{
				 
				 if($row['cleaning_work_assigned']==0)
				 {
					$row['started_by']='Not started';
					$row['name_assigned']='';
				 }
				 else
				 {
					 
				 
					$stmt = $dbCon->prepare("select location_id,concat_ws(' ',first_name,last_name) as name from user_company_profile left join user_logins on user_logins.id=user_company_profile.user_login_id where company_id=? and user_login_id=?");
					$stmt->bind_param("ii",$data['company_id'],$row['staff_assigned_id']);
					$stmt->execute();
					$resultStarted = $stmt->get_result();
					$rowStarted = $resultStarted->fetch_assoc();
					$row['name_assigned']=html_entity_decode($rowStarted['name'],ENT_NOQUOTES, 'UTF-8'); 
					$row['started_by']='Started by - '.html_entity_decode($rowStarted['name'],ENT_NOQUOTES, 'UTF-8'); 
				  }
				  
				  $today=strtotime(date('Y-m-d H:i:s'));
				  $checkout=strtotime($row['checkout_time_info']);
				  $row['checkout_time_diff']=round(($today-$checkout)/(60)).' min ago';
				array_push($org,$row);
			}
			$stmt->close();
			$dbCon->close();
			 
			return $org;
		}
		
		function hotelCheckedOutListForHousekeepingIncepectionStaff($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select location_id,concat_ws(' ',first_name,last_name) as name from user_company_profile left join user_logins on user_logins.id=user_company_profile.user_login_id where company_id=? and user_login_id=?");
			$stmt->bind_param("ii",$data['company_id'],$data['user_id']);
			$stmt->execute();
			$result2 = $stmt->get_result();
			$row2 = $result2->fetch_assoc();
			 
			$today=strtotime(date('Y-m-d'));
			
			$stmt = $dbCon->prepare("select inspector_id,room_id,inspection_work_allocatied,room_name,hotel_checkout_detail.id,concat_ws(' ',first_name,last_name) as name, checkout_time_info from hotel_checkout_detail  left join hotel_room_detail on hotel_room_detail.id=hotel_checkout_detail.room_id  left join user_logins on user_logins.id=hotel_room_detail.staff_assigned_id  where checked_in=2 and hotel_checkout_detail.property_id=? and is_approved_cleaning=2");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $row2['location_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			while($row = $result->fetch_assoc())
			{
				 
				 if($row['inspection_work_allocatied']==0)
				 {
					$row['started_by']='Not started';
					$row['name_assigned']='';
				 }
				 else
				 {
					 
				 
					$stmt = $dbCon->prepare("select location_id,concat_ws(' ',first_name,last_name) as name from user_company_profile left join user_logins on user_logins.id=user_company_profile.user_login_id where company_id=? and user_login_id=?");
					$stmt->bind_param("ii",$data['company_id'],$row['inspector_id']);
					$stmt->execute();
					$resultStarted = $stmt->get_result();
					$rowStarted = $resultStarted->fetch_assoc();
					$row['name_assigned']=html_entity_decode($rowStarted['name'],ENT_NOQUOTES, 'UTF-8'); 
					$row['started_by']='Started by - '.html_entity_decode($rowStarted['name'],ENT_NOQUOTES, 'UTF-8'); 
				  }
				array_push($org,$row);
			}
			$stmt->close();
			$dbCon->close();
			 
			return $org;
		}

		function allocateCheckedOutRoomForInspection($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("update hotel_room_detail set inspection_work_allocatied=1,inspector_id=? where id=?");
			$stmt->bind_param("ii",$data['user_id'],$data['room_id']);
			$stmt->execute();
			 
			$stmt->close();
			$dbCon->close();
			return 1;
			 
		}
		
		
		function updateCheckedOutRoomInspection($data)
		{
			$dbCon = AppModel::createConnection();
			if($data['inspection_result']==0)
			{
			$stmt = $dbCon->prepare("update hotel_room_detail set is_approved_cleaning=?,inspection_work_allocatied=0,inspector_id=0 where id=?");
			/* bind parameters for markers */
			$stmt->bind_param("ii",$data['inspection_result'],$data['room_id']);
			$stmt->execute();	
			}
			else
			{
			$stmt = $dbCon->prepare("update hotel_room_detail set is_approved_cleaning=?,inspection_work_allocatied=0,inspector_id=0,cleaning_work_assigned=0,staff_assigned_id=0 where id=?");
			/* bind parameters for markers */
			$stmt->bind_param("ii",$data['inspection_result'],$data['room_id']);
			$stmt->execute();
			
			$stmt = $dbCon->prepare("update hotel_checkout_detail set checked_in=3 where id=?");
			/* bind parameters for markers */
			$stmt->bind_param("i",$data['id']);
			$stmt->execute();
			
			$stmt = $dbCon->prepare("select email from hotel_checkout_detail left join user_logins on user_logins.id=hotel_checkout_detail.user_id where room_id=? and checked_in=1");
			
			/* bind parameters for markers */
			$stmt->bind_param("i",$data['room_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowCode = $result->fetch_assoc();
				if(!empty($rowCode))
				{
				$subject='Welcome! please wait while room is being Cleaned.';
				$to      = $rowCode['email'];
				$emailContent='<html><head><title>Reservation confirmed</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <style type="text/css">
    /* GT AMERICA */

    @font-face {
      font-display: fallback;
      font-family: "GT America Regular";
      font-weight: 400;
      src: url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Regular.woff2") format("woff2"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Regular.woff") format("woff"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Regular.ttf") format("truetype");
    }

    @font-face {
      font-display: fallback;
      font-family: "GT America Medium";
      font-weight: 600;
      src: url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Medium.woff2") format("woff2"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Medium.woff") format("woff"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Medium.ttf") format("truetype");
    }

    @font-face {
      font-display: fallback;
      font-family: "GT America Condensed Bold";
      font-weight: 700;
      src: url("https://www.exploretock.com/fonts/gt-america/GT-America-Condensed-Bold.woff2") format("woff2"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Condensed-Bold.woff") format("woff"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Condensed-Bold.ttf") format("truetype");
    }

    /* CLIENT-SPECIFIC RESET */

    body,
    table,
    td,
    a {
      -webkit-text-size-adjust: 100%;
      -ms-text-size-adjust: 100%;
    }

    /* Prevent WebKit and Windows mobile changing default text sizes */

    table,
    td {
      mso-table-lspace: 0pt;
      mso-table-rspace: 0pt;
    }

    /* Remove spacing between tables in Outlook 2007 and up */

    img {
      -ms-interpolation-mode: bicubic;
    }

    /* Allow smoother rendering of resized image in Internet Explorer */

    .im {
      color: inherit !important;
    }

    /* DEVICE-SPECIFIC RESET */

    a[x-apple-data-detectors] {
      color: inherit !important;
      text-decoration: none !important;
      font-size: inherit !important;
      font-family: inherit !important;
      font-weight: inherit !important;
      line-height: inherit !important;
    }

    /* iOS BLUE LINKS */

    /* RESET */

    img {
      border: 0;
      height: auto;
      line-height: 100%;
      outline: none;
      text-decoration: none;
      display: block;
    }

    table {
      border-collapse: collapse;
    }

    table td {
      border-collapse: collapse;
      display: table-cell;
    }

    body {
      height: 100% !important;
      margin: 0 !important;
      padding: 0 !important;
      width: 100% !important;
    }

    /* BG COLORS */

    .mainTable {
      background-color: #F0F0F0;
    }

    .mainTable--hospitality {
      background-color: #f7f2ed;
    }

    html {
      background-color: #F0F0F0;
    }

    /* VARIABLES */

    .bg-white {
      background-color: white;
    }

    .hr {
      /* Cross-client horizontal rule. Adapted from https://litmus.com/community/discussions/4633-is-there-a-reliable-1px-horizontal-rule-method */
      background-color: #d3d3d8;
      border-collapse: collapse;
      mso-table-lspace: 0pt;
      mso-table-rspace: 0pt;
      mso-line-height-rule: exactly;
      line-height: 1px;
    }

    .textAlignLeft {
      text-align: left !important;
    }

    .textAlignRight {
      text-align: right !important;
    }

    .textAlignCenter {
      text-align: center !important;
    }

    .mt1 {
      margin-top: 6px;
    }

    .list {
      padding-left: 18px;
      margin: 0;
    }

    /* TYPOGRAPHY */

    body {
      font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
      font-weight: 400;
      color: #4f4f65;
      -webkit-font-smoothing: antialiased;
      -ms-text-size-adjust: 100%;
      -moz-osx-font-smoothing: grayscale;
      font-smoothing: always;
      text-rendering: optimizeLegibility;
    }

    .h1 {
      font-family: "GT America Condensed Bold", "Roboto Condensed", "Roboto", "Helvetica", "Arial", sans-serif;
      font-weight: 700;
      vertical-align: middle;
      font-size: 36px;
      line-height: 42px;
    }

    .h2 {
      font-family: "GT America Medium", "Roboto", "Helvetica", "Arial", sans-serif;
      font-weight: 600;
      vertical-align: middle;
      font-size: 16px;
      line-height: 24px;
    }

    .text {
      font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
      font-weight: 400;
      font-size: 16px;
      line-height: 21px;
    }

    .text-list {
      font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
      font-weight: 400;
      font-size: 16px;
      line-height: 25px;
    }

    .textSmall {
      font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
      font-weight: 400;
      font-size: 14px;
    }

    .text-xsmall {
      font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
      font-size: 11px;
      text-transform: uppercase;
      line-height: 22px;
      letter-spacing: 1px;
    }

    .text-bold {
      font-weight: 600;
    }

    .text-link {
      text-decoration: underline;
    }

    .text-linkNoUnderline {
      text-decoration: none;
    }

    .text-strike {
      text-decoration: line-through;
    }

    /* FONT COLORS */

    .textColorDark {
      color: #23233e;
    }

    .textColorNormal {
      color: #4f4f65;
    }

    .textColorBlue {
      color: #2020c0;
    }

    .textColorGrayDark {
      color: #7B7B8B;
    }

    .textColorGray {
      color: #A5A8AD;
    }

    .textColorWhite {
      color: #FFFFFF;
    }

    .textColorRed {
      color: #df3232;
    }

    /* BUTTON */

    .Button-primary-wrapper {
      border-radius: 3px;
      background-color: #2020C0;
    }

    .Button-primary {
      font-family: "GT America Medium", "Roboto", "Helvetica", "Arial", sans-serif;
      border-radius: 3px;
      border: 1px solid #2020C0;
      color: #ffffff;
      display: block;
      font-size: 16px;
      font-weight: 600;
      padding: 18px;
      text-decoration: none;
    }

    .Button-secondary-wrapper {
      border-radius: 3px;
      background-color: #ffffff;
    }

    .Button-secondary {
      font-family: "GT America Medium", "Roboto", "Helvetica", "Arial", sans-serif;
      border-radius: 3px;
      border: 1px solid #2020C0;
      color: #2020C0;
      display: block;
      font-size: 16px;
      font-weight: 600;
      padding: 18px;
      text-decoration: none;
    }

    /* LAYOUT */

    .Content-container {
      padding-left: 60px;
      padding-right: 60px;
    }

    .Content-container--main {
      padding-top: 54px;
      padding-bottom: 60px;
    }

    .Content {
      width: 580px;
      margin: 0 auto;
    }

    .wrapper {
      max-width: 600px;
    }

    .section {
      padding: 24px 0px;
      border-bottom: 1px solid #d3d3d8;
    }

    .section--noBorder {
      padding: 24px 0px 0;
    }

    .section--last {
      padding: 24px 0px;
    }

    .message {
      background-color: #F4F4F5;
      padding: 18px;
    }

    .card {
      border: 1px solid #d3d3d8;
      padding: 18px;
    }

    /* HEADER */

    .header-tockLogoImage {
      display: block;
      color: #F0F0F0;
    }

    .header-heroImage {
      padding-bottom: 24px;
    }

    /* PREHEADER */

    .preheader {
      display: none;
      font-size: 1px;
      color: #FFFFFF;
      line-height: 1px;
      max-height: 0px;
      max-width: 0px;
      opacity: 0;
      overflow: hidden;
    }

    /* BANNER */

    .notice {
      padding: 12px;
      background: #23233E;
      color: #FFFFFF;
      display: block;
      font-size: 14px;
      font-family: "GT America Medium", "Roboto", "Helvetica", "Arial", sans-serif;
      font-weight: 600;
    }

    /* INTRO */

    .section--intro {
      padding-bottom: 48px;
    }

    /* BOOKING INFO */

    .business-logo__container {
      width: 48px;
      height: 48px;
      border-radius: 3px;
      border: 1px solid #d3d3d8;
      overflow: hidden;
    }

    .business-logo__image {
      border: 1px solid transparent;
      border-radius: 3px;
      width: 48px;
      height: 48px;
      display: block;
    }

    .business-address--address {
      width: 50%;
    }

    .business-address--map {
      width: 50%;
    }

    .business-address--map-image {
      width: 100%;
    }

    /* MOBILE TICKETS */

    .mobile-ticket--description {
      width: 65%;
      margin-top: 12px;
      margin-right: 5%;
    }

    .mobile-ticket--code {
      width: 30%;
    }

    .mobile-ticket--code-image {
      width: 100%;
    }

    /* RESERVATION ACTIONS */

    .linksTable {
      border-bottom: 1px solid #d3d3d8;
    }

    .linksTableRow {
      padding: 24px 12px;
    }

    .actions-icon {
      vertical-align: middle;
    }

    .actions-text {
      vertical-align: middle;
    }

    /* RECEIPT */

    .receipt__container {
      border: 1px solid #d3d3d8;
      padding: 24px;
    }

    .receipt__row {
      border-top: 1px solid #d3d3d8;
    }

    /* FEEDBACK ICONS */

    .feedback-link {
      border: 1px solid #d4d5da;
      border-radius: 3px;
      display: inline-block;
      width: calc(32% - 2px);
      padding: 10px 0;
    }

    .feedback-link-bumper {
      display: inline-block;
      width: 1%;
    }

    .feedback-link img {
      height: 50px;
      width: 50px;
    }

    /* SOCIAL ICONS */

    .social-link {
      display: inline-block;
      width: auto;
    }

    .social-link-text {
      padding: 14px 24px 14px 14px;
    }

    /* TABLET STYLES */

    @media screen and (max-width: 648px) {
      /* DEVICE-SPECIFIC RESET */
      div[style*="margin: 16px 0;"] {
        margin: 0 !important;
      }
      /* ANDROID CENTER FIX */
      /* LAYOUT */
      .wrapper {
        width: 100% !important;
        max-width: 100% !important;
      }
      .Content {
        width: 90% !important;
      }
      .Content-container {
        padding-left: 36px !important;
        padding-right: 36px !important;
      }
      .Content-container--main {
        padding-top: 30px !important;
        padding-bottom: 42px !important;
      }
      .responsiveTable {
        width: 100% !important;
      }
      /* RESERVATION ACTIONS */
      .linksTableRow {
        padding-left: 0 !important;
        padding-right: 0 !important;
        padding-top: 12px !important;
        padding-bottom: 12px !important;
      }
      .linksTableRow--borderRight {
        border-right: none !important;
        padding-left: 0 !important;
        padding-right: 0 !important;
      }
      /* FEEDBACK LINK */
      .feedback-link img {
        height: 38px !important;
        width: 38px !important;
      }
    }

    /* MOBILE STYLES */

    @media screen and (max-width: 480px) {
      /* TYPOGRAPHY */
      .h1 {
        font-size: 30px !important;
        line-height: 30px !important;
      }
      .text {
        font-size: 16px !important;
        line-height: 22px !important;
      }
      /* BUTTON */
      .mobile-buttonContainer {
        width: 100% !important;
      }
      /* LAYOUT */
      .Content {
        width: 100% !important;
      }
      .Content-container {
        padding-left: 18px !important;
        padding-right: 18px !important;
      }
      .Content-container--main {
        padding-top: 24px !important;
        padding-bottom: 30px !important;
      }
      .section {
        padding: 18px 0 !important;
      }
      .section--last {
        padding: 18px 0 !important;
      }
      .header {
        padding: 0 18px !important;
      }
      .business-address--address {
        width: 100% !important;
      }
      .business-address--map {
        margin-top: 30px !important;
        width: 100% !important;
      }
      .mobile-ticket--description {
        width: 100% !important;
        margin-top: 0px !important;
      }
      .mobile-ticket--code {
        margin-top: 30px !important;
        margin-left: 0;
        width: 100% !important;
      }
      /* RECEIPT */
      .receipt__container {
        padding: 12px !important;
      }
      /* SOCIAL ICONS */
      .social-link {
        display: block !important;
        width: 100% !important;
        border-bottom: 1px solid #d3d3d8 !important;
      }
      /* INTRO */
      .section--intro {
        padding-top: 18px !important;
        padding-bottom: 18px !important;
      }
    }
  </style>



   
  <!--[if mso]>
    <style type="text/css">
.h1 {font-family: "Helvetica", "Arial", sans-serif !important; font-weight: 700 !important; vertical-align: middle !important; font-size: 36px !important; mso-line-height-rule: exactly;line-height: 42px !important;}
.h2 {font-family: "Helvetica", "Arial", sans-serif !important;font-weight: 600 !important;vertical-align: middle !important;font-size: 16px !important;mso-line-height-rule: exactly;line-height: 24px !important;}
.text {font-family: "Helvetica", "Arial", sans-serif !important;font-weight: 400 !important;font-size: 16px !important;mso-line-height-rule: exactly;line-height: 21px !important;}
.text-list {font-family: "Helvetica", "Arial", sans-serif !important;font-weight: 400 !important;font-size: 16px !important;mso-line-height-rule: exactly;line-height: 25px !important;}
.textSmall {font-family: "Helvetica", "Arial", sans-serif !important;font-weight: 400 !important;font-size: 14px !important;}
.text-xsmall {font-family: "Helvetica", "Arial", sans-serif !important;font-size: 11px !important;text-transform: uppercase !important;mso-line-height-rule: exactly;line-height: 22px !important;letter-spacing: 1px !important;}
.text-bold {font-weight: 600 !important;}
.text-link {text-decoration: underline !important;}
.text-linkNoUnderline {text-decoration: none !important;}
.text-strike {text-decoration: line-through !important;}
.textColorDark {color: #23233e !important;}
.textColorNormal {color: #4f4f65 !important;}
.textColorBlue {color: #2020c0 !important;}
.textColorGray {color: #A5A8AD !important;}
.textColorWhite {color: #FFFFFF !important;}
.Button-primary {font-family: "Helvetica", "Arial", sans-serif !important;border-radius: 3px !important;border: 1px solid #2020C0 !important;color: #ffffff !important;display: block !important;font-size: 16px !important;font-weight: 600 !important;padding: 18px !important;text-decoration: none !important;}
.Button-secondary {font-family: "Helvetica", "Arial", sans-serif !important;border-radius: 3px !important;border: 1px solid #2020C0 !important;color: #2020C0 !important;display: block !important;font-size: 16px !important;font-weight: 600 !important;padding: 18px !important;text-decoration: none !important;}
    </style>
    <![endif]-->
  <!-- HIDDEN PREHEADER TEXT -->
  </head><body><div class="preheader" style="display: none; font-size: 1px; color: rgb(255, 255, 255); line-height: 1px; max-height: 0px; max-width: 0px; opacity: 0; overflow: hidden;">
  </div>
  <table border="0" cellpadding="0" cellspacing="0" width="100%" class=" mainTable  " style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; background-color: rgb(240, 240, 240);">
    <tbody><tr><td style="display:none !important;
 visibility:hidden;
 mso-hide:all;
 font-size:1px;
 color:#ffffff;
 line-height:1px;
 max-height:0px;
 max-width:0px;
 opacity:0;
 overflow:hidden; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;"> We are thrilled that you will be joining us. If yo... </td>
    <!-- HEADER -->
    </tr><tr>
      <td align="center" class="header" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
        <!--[if (gte mso 9)|(IE)]>
    <table align="center" border="0" cellspacing="0" cellpadding="0" width="600">
    <tr>
    <td align="center" valign="top" width="600">
    <![endif]-->
        <table border="0" cellpadding="0" cellspacing="0" width="100%" class="Content" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; width: 580px; margin: 0 auto;">
          <tbody><tr class="spacer">
            <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
          </tr>
          <tr class="spacer">
            <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
          </tr>
          <tr>
            <td align="left" valign="middle" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;"> <h1 style="font-size: 33px;font-weight: 800;line-height: 30px;">Dstricts</h1>               </td>
          </tr>
          <tr class="spacer">
            <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
          </tr>
          <tr class="spacer">
            <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
          </tr>
        </tbody></table>
        <!--[if (gte mso 9)|(IE)]>
    </td>
    </tr>
    </table>
    <![endif]-->
      </td>
    </tr>
    <!-- CONTENT -->
    <tr>
      <td align="center" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
        <!--[if (gte mso 9)|(IE)]>
    <table align="center" border="0" cellspacing="0" cellpadding="0" width="600">
    <tr>
    <td align="center" valign="top" width="600">
    <![endif]-->
        <table border="0" cellpadding="0" cellspacing="0" width="100%" class="Content bg-white" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; background-color: white; width: 580px; margin: 0 auto;">
          <tbody><tr>
            <td class="Content-container Content-container--main text textColorNormal" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell; font-family: &quot;GT America Regular&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-weight: 400; font-size: 16px; line-height: 21px; color: rgb(79, 79, 101); padding-left: 60px; padding-right: 60px; padding-top: 54px; padding-bottom: 60px;">
              <table width="100%" border="0" cellspacing="0" cellpadding="0" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
                <!-- RESTAURANT INFO -->
                <tbody><tr>
                  <td valign="top" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                    <table align="left" border="0" cellpadding="0" cellspacing="0" width="100%" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
                      <tbody><tr>
                        
                        <td width="12" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
                        <td align="left" valign="middle" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;"> <span class="h2 textColorDark" style="font-family: &quot;GT America Medium&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-weight: 600; vertical-align: middle; font-size: 16px; line-height: 24px; color: rgb(35, 35, 62);">Completed</span>                          </td>
                      </tr>
                      <tr class="spacer">
                        <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
                      </tr>
                      <tr class="spacer">
                        <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
                      </tr>
                    </tbody></table>
                  </td>
                </tr>
                <!-- INTRO -->
                <tr>
                  <td valign="top" align="left" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                    <table width="100%" border="0" cellspacing="0" cellpadding="0" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
                      <tbody><tr>
                        <td align="left" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;"> <span class="h1 textColorDark" style="font-family: &quot;GT America Condensed Bold&quot;, &quot;Roboto Condensed&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-weight: 700; vertical-align: middle; font-size: 36px; line-height: 42px; color: rgb(35, 35, 62);">Your room has been cleaned</span>                          </td>
                      </tr>
                      <tr class="spacer">
                        <td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
                      </tr>
                      <tr>
                        <td align="left" colspan="2" valign="top" width="100%" height="1" class="hr" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell; background-color: rgb(211, 211, 216); border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; mso-line-height-rule: exactly; line-height: 1px;">
                          <!--[if gte mso 15]>&nbsp;<![endif]-->
                        </td>
                      </tr>
                      <tr class="spacer">
                        <td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
                      </tr>
                    </tbody></table>
                  </td>
                </tr>
                <!-- MESSAGE -->
                
                
                
                
                
                
                <!-- BOOKING INFO -->
                
                <!-- ADDRESS -->
                <tr>
                  <td align="center" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                    <table border="0" cellpadding="0" cellspacing="0" width="100%" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
                      <tbody>
                      
                      
                      <tr class="spacer">
                        <td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
                      </tr>
                      <tr class="spacer">
                        <td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
                      </tr>
                      <tr>
                        <td align="left" valign="middle" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                          <table border="0" cellpadding="0" cellspacing="0" width="100%" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
                            <tbody><tr>
                              <td style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                <table align="left" border="0" cellpadding="0" cellspacing="0" width="230" class="business-address--address" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; width: 70%;">
                                  <tbody><tr>
                                    <td align="left" width="100%" class="text-list textColorNormal" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell; font-family: &quot;GT America Regular&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-weight: 400; font-size: 16px; line-height: 25px; color: rgb(79, 79, 101);">
                                    <span class="h2 textColorDark" style="font-family: &quot;GT America Medium&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-weight: 600; vertical-align: middle; font-size: 16px; line-height: 24px; color: rgb(35, 35, 62);">We regret for inconvenience. Your room is cleaned now you can proceed to your room.</span>                                         </td>
                                  </tr>
                                </tbody></table>
                                <!--[if mso]></td><td><![endif]-->
                                <table align="right" border="0" cellpadding="0" cellspacing="0" width="230" class="business-address--map" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; width: 50%;">
                                  <tbody><tr>
                                    
                                  </tr>
                                </tbody></table>
                              </td>
                            </tr>
                          </tbody></table>
                        </td>
                      </tr>
                    </tbody></table>
                  </td>
                </tr>
                <tr class="spacer">
                  <td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
                </tr>
                <tr class="spacer">
                  <td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
                </tr>
                
                
                
                <!-- RECEIPT -->
                
                
                
                <!-- EDIT RECEIPT -->
                <!-- CANCELLATION POLICY -->
                
                
                
                <!-- QUESTIONS -->
                
              </tbody></table>
            </td>
          </tr>
        </tbody></table>
      </td>
    </tr>
    <!-- FOOTER -->
    <tr>
      <td align="center" class="Content" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell; width: 580px; margin: 0 auto;">
        <!-- Will most likely required a feature flag -->
        <!--[if (gte mso 9)|(IE)]>
<table align="center" border="0" cellspacing="0" cellpadding="0" width="600">
<tr>
<td align="center" valign="top" width="600">
<![endif]-->
        <table width="100%" border="0" cellspacing="0" cellpadding="0" align="center" class="Content-container" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; padding-left: 60px; padding-right: 60px;">
          <tbody><tr class="spacer">
            <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
          </tr>
          <tr class="spacer">
            <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
          </tr>
          <tr class="spacer">
            <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
          </tr>
          <tr>
            <td align="center" valign="top" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;"> <a href="https://www.exploretock.com" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%;"> <img src="https://storage.googleapis.com/tock-public-assets/images-email-template/tock-brandmark-color.png" width="30" height="30" alt="Tock" border="0" style="-ms-interpolation-mode: bicubic; border: 0; height: auto; line-height: 100%; outline: none; text-decoration: none; display: block;"> </a>              </td>
          </tr>
          <tr class="spacer">
            <td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
          </tr>
          <tr>
            <td align="center" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
              <div class="text-xsmall textColorNormal" style="font-family: &quot;GT America Regular&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-size: 11px; text-transform: uppercase; line-height: 22px; letter-spacing: 1px; color: rgb(79, 79, 101);">
                © 2019 Tock, Inc.
              </div>
              <div class="text-xsmall textColorNormal" style="font-family: &quot;GT America Regular&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-size: 11px; text-transform: uppercase; line-height: 22px; letter-spacing: 1px; color: rgb(79, 79, 101);">
                All Rights Reserved
              </div>
            </td>
          </tr>
          <tr class="spacer">
            <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
          </tr>
          <tr class="spacer">
            <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
          </tr>
          <tr class="spacer">
            <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
          </tr>
        </tbody></table>
        <!--[if (gte mso 9)|(IE)]>
</td>
</tr>
</table>
<![endif]-->
      </td>
    </tr>
  </tbody></table>



</body></html>';
				sendEmail($subject, $to, $emailContent); 
				}
				
			
			}
			$stmt->close();
			$dbCon->close();
			return 1;
			 
		}
		
		function updateCheckedOutRoomCleaning($data)
		{
			$dbCon = AppModel::createConnection();
			
			$stmt = $dbCon->prepare("update hotel_room_detail set is_approved_cleaning=2 where id=?");
			/* bind parameters for markers */
			$stmt->bind_param("i",$data['room_id']);
			$stmt->execute();
			$stmt->close();
			$dbCon->close();
			return 1;
			 
		}
		
		
		
		function getCheckedInHotel()
		{
			$dbCon = AppModel::createConnection();
			
			$stmt = $dbCon->prepare("select hotel_property_type,transection_id,cust_id,total_days,price,payment_option,room_type_id,checkin_code,user_id,checkin_booking_date,checkout_booking_date,hotel_id,email from hotel_checkout_detail left join user_logins on user_logins.id=hotel_checkout_detail.user_id where hotel_checkout_detail.id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i",$_POST['checkout_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowCode = $result->fetch_assoc();
			
			if($rowCode['hotel_property_type']==1)
			{
				$stmt = $dbCon->prepare("select id,room_id from hotel_insta_boxes where booking_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i",$_POST['checkout_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowRoom = $result->fetch_assoc();
			
			if(empty($rowRoom))
			{
				$date=strtotime(date('Y-m-d'));
			$select="select id,room_name,is_approved_cleaning from hotel_room_detail where room_type='".$rowCode['room_type_id']."' and id not in(select room_id from hotel_checkout_detail where room_type_id='".$rowCode['room_type_id']."' and checked_in=1 and checkout_booking_date>='".$date."') and room_available=1 and id not in (select room_id from hotel_insta_boxes where hotel_id=".$rowCode['hotel_id'].")";
			$resultCountId=mysqli_query($dbCon, $select);
			$rowCountId=mysqli_fetch_array($resultCountId);
			if($rowCountId['is_approved_cleaning']==0)
			{
				$subject='Welcome! please wait while room is being Cleaned.';
				$to      = $rowCode['email'];
				 
				$emailContent='<html><head><title>Reservation confirmed</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <style type="text/css">
    /* GT AMERICA */

    @font-face {
      font-display: fallback;
      font-family: "GT America Regular";
      font-weight: 400;
      src: url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Regular.woff2") format("woff2"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Regular.woff") format("woff"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Regular.ttf") format("truetype");
    }

    @font-face {
      font-display: fallback;
      font-family: "GT America Medium";
      font-weight: 600;
      src: url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Medium.woff2") format("woff2"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Medium.woff") format("woff"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Medium.ttf") format("truetype");
    }

    @font-face {
      font-display: fallback;
      font-family: "GT America Condensed Bold";
      font-weight: 700;
      src: url("https://www.exploretock.com/fonts/gt-america/GT-America-Condensed-Bold.woff2") format("woff2"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Condensed-Bold.woff") format("woff"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Condensed-Bold.ttf") format("truetype");
    }

    /* CLIENT-SPECIFIC RESET */

    body,
    table,
    td,
    a {
      -webkit-text-size-adjust: 100%;
      -ms-text-size-adjust: 100%;
    }

    /* Prevent WebKit and Windows mobile changing default text sizes */

    table,
    td {
      mso-table-lspace: 0pt;
      mso-table-rspace: 0pt;
    }

    /* Remove spacing between tables in Outlook 2007 and up */

    img {
      -ms-interpolation-mode: bicubic;
    }

    /* Allow smoother rendering of resized image in Internet Explorer */

    .im {
      color: inherit !important;
    }

    /* DEVICE-SPECIFIC RESET */

    a[x-apple-data-detectors] {
      color: inherit !important;
      text-decoration: none !important;
      font-size: inherit !important;
      font-family: inherit !important;
      font-weight: inherit !important;
      line-height: inherit !important;
    }

    /* iOS BLUE LINKS */

    /* RESET */

    img {
      border: 0;
      height: auto;
      line-height: 100%;
      outline: none;
      text-decoration: none;
      display: block;
    }

    table {
      border-collapse: collapse;
    }

    table td {
      border-collapse: collapse;
      display: table-cell;
    }

    body {
      height: 100% !important;
      margin: 0 !important;
      padding: 0 !important;
      width: 100% !important;
    }

    /* BG COLORS */

    .mainTable {
      background-color: #F0F0F0;
    }

    .mainTable--hospitality {
      background-color: #f7f2ed;
    }

    html {
      background-color: #F0F0F0;
    }

    /* VARIABLES */

    .bg-white {
      background-color: white;
    }

    .hr {
      /* Cross-client horizontal rule. Adapted from https://litmus.com/community/discussions/4633-is-there-a-reliable-1px-horizontal-rule-method */
      background-color: #d3d3d8;
      border-collapse: collapse;
      mso-table-lspace: 0pt;
      mso-table-rspace: 0pt;
      mso-line-height-rule: exactly;
      line-height: 1px;
    }

    .textAlignLeft {
      text-align: left !important;
    }

    .textAlignRight {
      text-align: right !important;
    }

    .textAlignCenter {
      text-align: center !important;
    }

    .mt1 {
      margin-top: 6px;
    }

    .list {
      padding-left: 18px;
      margin: 0;
    }

    /* TYPOGRAPHY */

    body {
      font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
      font-weight: 400;
      color: #4f4f65;
      -webkit-font-smoothing: antialiased;
      -ms-text-size-adjust: 100%;
      -moz-osx-font-smoothing: grayscale;
      font-smoothing: always;
      text-rendering: optimizeLegibility;
    }

    .h1 {
      font-family: "GT America Condensed Bold", "Roboto Condensed", "Roboto", "Helvetica", "Arial", sans-serif;
      font-weight: 700;
      vertical-align: middle;
      font-size: 36px;
      line-height: 42px;
    }

    .h2 {
      font-family: "GT America Medium", "Roboto", "Helvetica", "Arial", sans-serif;
      font-weight: 600;
      vertical-align: middle;
      font-size: 16px;
      line-height: 24px;
    }

    .text {
      font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
      font-weight: 400;
      font-size: 16px;
      line-height: 21px;
    }

    .text-list {
      font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
      font-weight: 400;
      font-size: 16px;
      line-height: 25px;
    }

    .textSmall {
      font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
      font-weight: 400;
      font-size: 14px;
    }

    .text-xsmall {
      font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
      font-size: 11px;
      text-transform: uppercase;
      line-height: 22px;
      letter-spacing: 1px;
    }

    .text-bold {
      font-weight: 600;
    }

    .text-link {
      text-decoration: underline;
    }

    .text-linkNoUnderline {
      text-decoration: none;
    }

    .text-strike {
      text-decoration: line-through;
    }

    /* FONT COLORS */

    .textColorDark {
      color: #23233e;
    }

    .textColorNormal {
      color: #4f4f65;
    }

    .textColorBlue {
      color: #2020c0;
    }

    .textColorGrayDark {
      color: #7B7B8B;
    }

    .textColorGray {
      color: #A5A8AD;
    }

    .textColorWhite {
      color: #FFFFFF;
    }

    .textColorRed {
      color: #df3232;
    }

    /* BUTTON */

    .Button-primary-wrapper {
      border-radius: 3px;
      background-color: #2020C0;
    }

    .Button-primary {
      font-family: "GT America Medium", "Roboto", "Helvetica", "Arial", sans-serif;
      border-radius: 3px;
      border: 1px solid #2020C0;
      color: #ffffff;
      display: block;
      font-size: 16px;
      font-weight: 600;
      padding: 18px;
      text-decoration: none;
    }

    .Button-secondary-wrapper {
      border-radius: 3px;
      background-color: #ffffff;
    }

    .Button-secondary {
      font-family: "GT America Medium", "Roboto", "Helvetica", "Arial", sans-serif;
      border-radius: 3px;
      border: 1px solid #2020C0;
      color: #2020C0;
      display: block;
      font-size: 16px;
      font-weight: 600;
      padding: 18px;
      text-decoration: none;
    }

    /* LAYOUT */

    .Content-container {
      padding-left: 60px;
      padding-right: 60px;
    }

    .Content-container--main {
      padding-top: 54px;
      padding-bottom: 60px;
    }

    .Content {
      width: 580px;
      margin: 0 auto;
    }

    .wrapper {
      max-width: 600px;
    }

    .section {
      padding: 24px 0px;
      border-bottom: 1px solid #d3d3d8;
    }

    .section--noBorder {
      padding: 24px 0px 0;
    }

    .section--last {
      padding: 24px 0px;
    }

    .message {
      background-color: #F4F4F5;
      padding: 18px;
    }

    .card {
      border: 1px solid #d3d3d8;
      padding: 18px;
    }

    /* HEADER */

    .header-tockLogoImage {
      display: block;
      color: #F0F0F0;
    }

    .header-heroImage {
      padding-bottom: 24px;
    }

    /* PREHEADER */

    .preheader {
      display: none;
      font-size: 1px;
      color: #FFFFFF;
      line-height: 1px;
      max-height: 0px;
      max-width: 0px;
      opacity: 0;
      overflow: hidden;
    }

    /* BANNER */

    .notice {
      padding: 12px;
      background: #23233E;
      color: #FFFFFF;
      display: block;
      font-size: 14px;
      font-family: "GT America Medium", "Roboto", "Helvetica", "Arial", sans-serif;
      font-weight: 600;
    }

    /* INTRO */

    .section--intro {
      padding-bottom: 48px;
    }

    /* BOOKING INFO */

    .business-logo__container {
      width: 48px;
      height: 48px;
      border-radius: 3px;
      border: 1px solid #d3d3d8;
      overflow: hidden;
    }

    .business-logo__image {
      border: 1px solid transparent;
      border-radius: 3px;
      width: 48px;
      height: 48px;
      display: block;
    }

    .business-address--address {
      width: 50%;
    }

    .business-address--map {
      width: 50%;
    }

    .business-address--map-image {
      width: 100%;
    }

    /* MOBILE TICKETS */

    .mobile-ticket--description {
      width: 65%;
      margin-top: 12px;
      margin-right: 5%;
    }

    .mobile-ticket--code {
      width: 30%;
    }

    .mobile-ticket--code-image {
      width: 100%;
    }

    /* RESERVATION ACTIONS */

    .linksTable {
      border-bottom: 1px solid #d3d3d8;
    }

    .linksTableRow {
      padding: 24px 12px;
    }

    .actions-icon {
      vertical-align: middle;
    }

    .actions-text {
      vertical-align: middle;
    }

    /* RECEIPT */

    .receipt__container {
      border: 1px solid #d3d3d8;
      padding: 24px;
    }

    .receipt__row {
      border-top: 1px solid #d3d3d8;
    }

    /* FEEDBACK ICONS */

    .feedback-link {
      border: 1px solid #d4d5da;
      border-radius: 3px;
      display: inline-block;
      width: calc(32% - 2px);
      padding: 10px 0;
    }

    .feedback-link-bumper {
      display: inline-block;
      width: 1%;
    }

    .feedback-link img {
      height: 50px;
      width: 50px;
    }

    /* SOCIAL ICONS */

    .social-link {
      display: inline-block;
      width: auto;
    }

    .social-link-text {
      padding: 14px 24px 14px 14px;
    }

    /* TABLET STYLES */

    @media screen and (max-width: 648px) {
      /* DEVICE-SPECIFIC RESET */
      div[style*="margin: 16px 0;"] {
        margin: 0 !important;
      }
      /* ANDROID CENTER FIX */
      /* LAYOUT */
      .wrapper {
        width: 100% !important;
        max-width: 100% !important;
      }
      .Content {
        width: 90% !important;
      }
      .Content-container {
        padding-left: 36px !important;
        padding-right: 36px !important;
      }
      .Content-container--main {
        padding-top: 30px !important;
        padding-bottom: 42px !important;
      }
      .responsiveTable {
        width: 100% !important;
      }
      /* RESERVATION ACTIONS */
      .linksTableRow {
        padding-left: 0 !important;
        padding-right: 0 !important;
        padding-top: 12px !important;
        padding-bottom: 12px !important;
      }
      .linksTableRow--borderRight {
        border-right: none !important;
        padding-left: 0 !important;
        padding-right: 0 !important;
      }
      /* FEEDBACK LINK */
      .feedback-link img {
        height: 38px !important;
        width: 38px !important;
      }
    }

    /* MOBILE STYLES */

    @media screen and (max-width: 480px) {
      /* TYPOGRAPHY */
      .h1 {
        font-size: 30px !important;
        line-height: 30px !important;
      }
      .text {
        font-size: 16px !important;
        line-height: 22px !important;
      }
      /* BUTTON */
      .mobile-buttonContainer {
        width: 100% !important;
      }
      /* LAYOUT */
      .Content {
        width: 100% !important;
      }
      .Content-container {
        padding-left: 18px !important;
        padding-right: 18px !important;
      }
      .Content-container--main {
        padding-top: 24px !important;
        padding-bottom: 30px !important;
      }
      .section {
        padding: 18px 0 !important;
      }
      .section--last {
        padding: 18px 0 !important;
      }
      .header {
        padding: 0 18px !important;
      }
      .business-address--address {
        width: 100% !important;
      }
      .business-address--map {
        margin-top: 30px !important;
        width: 100% !important;
      }
      .mobile-ticket--description {
        width: 100% !important;
        margin-top: 0px !important;
      }
      .mobile-ticket--code {
        margin-top: 30px !important;
        margin-left: 0;
        width: 100% !important;
      }
      /* RECEIPT */
      .receipt__container {
        padding: 12px !important;
      }
      /* SOCIAL ICONS */
      .social-link {
        display: block !important;
        width: 100% !important;
        border-bottom: 1px solid #d3d3d8 !important;
      }
      /* INTRO */
      .section--intro {
        padding-top: 18px !important;
        padding-bottom: 18px !important;
      }
    }
  </style>



   
  <!--[if mso]>
    <style type="text/css">
.h1 {font-family: "Helvetica", "Arial", sans-serif !important; font-weight: 700 !important; vertical-align: middle !important; font-size: 36px !important; mso-line-height-rule: exactly;line-height: 42px !important;}
.h2 {font-family: "Helvetica", "Arial", sans-serif !important;font-weight: 600 !important;vertical-align: middle !important;font-size: 16px !important;mso-line-height-rule: exactly;line-height: 24px !important;}
.text {font-family: "Helvetica", "Arial", sans-serif !important;font-weight: 400 !important;font-size: 16px !important;mso-line-height-rule: exactly;line-height: 21px !important;}
.text-list {font-family: "Helvetica", "Arial", sans-serif !important;font-weight: 400 !important;font-size: 16px !important;mso-line-height-rule: exactly;line-height: 25px !important;}
.textSmall {font-family: "Helvetica", "Arial", sans-serif !important;font-weight: 400 !important;font-size: 14px !important;}
.text-xsmall {font-family: "Helvetica", "Arial", sans-serif !important;font-size: 11px !important;text-transform: uppercase !important;mso-line-height-rule: exactly;line-height: 22px !important;letter-spacing: 1px !important;}
.text-bold {font-weight: 600 !important;}
.text-link {text-decoration: underline !important;}
.text-linkNoUnderline {text-decoration: none !important;}
.text-strike {text-decoration: line-through !important;}
.textColorDark {color: #23233e !important;}
.textColorNormal {color: #4f4f65 !important;}
.textColorBlue {color: #2020c0 !important;}
.textColorGray {color: #A5A8AD !important;}
.textColorWhite {color: #FFFFFF !important;}
.Button-primary {font-family: "Helvetica", "Arial", sans-serif !important;border-radius: 3px !important;border: 1px solid #2020C0 !important;color: #ffffff !important;display: block !important;font-size: 16px !important;font-weight: 600 !important;padding: 18px !important;text-decoration: none !important;}
.Button-secondary {font-family: "Helvetica", "Arial", sans-serif !important;border-radius: 3px !important;border: 1px solid #2020C0 !important;color: #2020C0 !important;display: block !important;font-size: 16px !important;font-weight: 600 !important;padding: 18px !important;text-decoration: none !important;}
    </style>
    <![endif]-->
  <!-- HIDDEN PREHEADER TEXT -->
  </head><body><div class="preheader" style="display: none; font-size: 1px; color: rgb(255, 255, 255); line-height: 1px; max-height: 0px; max-width: 0px; opacity: 0; overflow: hidden;">
  </div>
  <table border="0" cellpadding="0" cellspacing="0" width="100%" class=" mainTable  " style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; background-color: rgb(240, 240, 240);">
    <tbody><tr><td style="display:none !important;
 visibility:hidden;
 mso-hide:all;
 font-size:1px;
 color:#ffffff;
 line-height:1px;
 max-height:0px;
 max-width:0px;
 opacity:0;
 overflow:hidden; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;"> We are thrilled that you will be joining us. If yo... </td>
    <!-- HEADER -->
    </tr><tr>
      <td align="center" class="header" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
        <!--[if (gte mso 9)|(IE)]>
    <table align="center" border="0" cellspacing="0" cellpadding="0" width="600">
    <tr>
    <td align="center" valign="top" width="600">
    <![endif]-->
        <table border="0" cellpadding="0" cellspacing="0" width="100%" class="Content" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; width: 580px; margin: 0 auto;">
          <tbody><tr class="spacer">
            <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
          </tr>
          <tr class="spacer">
            <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
          </tr>
          <tr>
            <td align="left" valign="middle" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;"> <h1 style="font-size: 33px;font-weight: 800;line-height: 30px;">Dstricts</h1>               </td>
          </tr>
          <tr class="spacer">
            <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
          </tr>
          <tr class="spacer">
            <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
          </tr>
        </tbody></table>
        <!--[if (gte mso 9)|(IE)]>
    </td>
    </tr>
    </table>
    <![endif]-->
      </td>
    </tr>
    <!-- CONTENT -->
    <tr>
      <td align="center" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
        <!--[if (gte mso 9)|(IE)]>
    <table align="center" border="0" cellspacing="0" cellpadding="0" width="600">
    <tr>
    <td align="center" valign="top" width="600">
    <![endif]-->
        <table border="0" cellpadding="0" cellspacing="0" width="100%" class="Content bg-white" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; background-color: white; width: 580px; margin: 0 auto;">
          <tbody><tr>
            <td class="Content-container Content-container--main text textColorNormal" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell; font-family: &quot;GT America Regular&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-weight: 400; font-size: 16px; line-height: 21px; color: rgb(79, 79, 101); padding-left: 60px; padding-right: 60px; padding-top: 54px; padding-bottom: 60px;">
              <table width="100%" border="0" cellspacing="0" cellpadding="0" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
                <!-- RESTAURANT INFO -->
                <tbody><tr>
                  <td valign="top" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                    <table align="left" border="0" cellpadding="0" cellspacing="0" width="100%" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
                      <tbody><tr>
                        
                        <td width="12" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
                        <td align="left" valign="middle" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;"> <span class="h2 textColorDark" style="font-family: &quot;GT America Medium&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-weight: 600; vertical-align: middle; font-size: 16px; line-height: 24px; color: rgb(35, 35, 62);">Welcome</span>                          </td>
                      </tr>
                      <tr class="spacer">
                        <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
                      </tr>
                      <tr class="spacer">
                        <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
                      </tr>
                    </tbody></table>
                  </td>
                </tr>
                <!-- INTRO -->
                <tr>
                  <td valign="top" align="left" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                    <table width="100%" border="0" cellspacing="0" cellpadding="0" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
                      <tbody><tr>
                        <td align="left" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;"> <span class="h1 textColorDark" style="font-family: &quot;GT America Condensed Bold&quot;, &quot;Roboto Condensed&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-weight: 700; vertical-align: middle; font-size: 36px; line-height: 42px; color: rgb(35, 35, 62);">You are checked in now</span>                          </td>
                      </tr>
                      <tr class="spacer">
                        <td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
                      </tr>
                      <tr>
                        <td align="left" colspan="2" valign="top" width="100%" height="1" class="hr" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell; background-color: rgb(211, 211, 216); border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; mso-line-height-rule: exactly; line-height: 1px;">
                          <!--[if gte mso 15]>&nbsp;<![endif]-->
                        </td>
                      </tr>
                      <tr class="spacer">
                        <td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
                      </tr>
                    </tbody></table>
                  </td>
                </tr>
                <!-- MESSAGE -->
                
                
                
                
                
                
                <!-- BOOKING INFO -->
                
                <!-- ADDRESS -->
                <tr>
                  <td align="center" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                    <table border="0" cellpadding="0" cellspacing="0" width="100%" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
                      <tbody>
                      
                      
                      <tr class="spacer">
                        <td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
                      </tr>
                      <tr class="spacer">
                        <td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
                      </tr>
                      <tr>
                        <td align="left" valign="middle" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                          <table border="0" cellpadding="0" cellspacing="0" width="100%" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
                            <tbody><tr>
                              <td style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                <table align="left" border="0" cellpadding="0" cellspacing="0" width="230" class="business-address--address" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; width: 70%;">
                                  <tbody><tr>
                                    <td align="left" width="100%" class="text-list textColorNormal" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell; font-family: &quot;GT America Regular&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-weight: 400; font-size: 16px; line-height: 25px; color: rgb(79, 79, 101);">
                                    <span class="h2 textColorDark" style="font-family: &quot;GT America Medium&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-weight: 600; vertical-align: middle; font-size: 16px; line-height: 24px; color: rgb(35, 35, 62);">We regret that the room is not cleaned. Please wait for a while before we clean the room. We will inform you asap its done and you can proceed to your room.</span>                                         </td>
                                  </tr>
                                </tbody></table>
                                <!--[if mso]></td><td><![endif]-->
                                <table align="right" border="0" cellpadding="0" cellspacing="0" width="230" class="business-address--map" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; width: 50%;">
                                  <tbody><tr>
                                    
                                  </tr>
                                </tbody></table>
                              </td>
                            </tr>
                          </tbody></table>
                        </td>
                      </tr>
                    </tbody></table>
                  </td>
                </tr>
                <tr class="spacer">
                  <td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
                </tr>
                <tr class="spacer">
                  <td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
                </tr>
                
                
                
                <!-- RECEIPT -->
                
                
                
                <!-- EDIT RECEIPT -->
                <!-- CANCELLATION POLICY -->
                
                
                
                <!-- QUESTIONS -->
                
              </tbody></table>
            </td>
          </tr>
        </tbody></table>
      </td>
    </tr>
    <!-- FOOTER -->
    <tr>
      <td align="center" class="Content" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell; width: 580px; margin: 0 auto;">
        <!-- Will most likely required a feature flag -->
        <!--[if (gte mso 9)|(IE)]>
<table align="center" border="0" cellspacing="0" cellpadding="0" width="600">
<tr>
<td align="center" valign="top" width="600">
<![endif]-->
        <table width="100%" border="0" cellspacing="0" cellpadding="0" align="center" class="Content-container" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; padding-left: 60px; padding-right: 60px;">
          <tbody><tr class="spacer">
            <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
          </tr>
          <tr class="spacer">
            <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
          </tr>
          <tr class="spacer">
            <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
          </tr>
          <tr>
            <td align="center" valign="top" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;"> <a href="https://www.exploretock.com" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%;"> <img src="https://storage.googleapis.com/tock-public-assets/images-email-template/tock-brandmark-color.png" width="30" height="30" alt="Tock" border="0" style="-ms-interpolation-mode: bicubic; border: 0; height: auto; line-height: 100%; outline: none; text-decoration: none; display: block;"> </a>              </td>
          </tr>
          <tr class="spacer">
            <td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
          </tr>
          <tr>
            <td align="center" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
              <div class="text-xsmall textColorNormal" style="font-family: &quot;GT America Regular&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-size: 11px; text-transform: uppercase; line-height: 22px; letter-spacing: 1px; color: rgb(79, 79, 101);">
                © 2019 Tock, Inc.
              </div>
              <div class="text-xsmall textColorNormal" style="font-family: &quot;GT America Regular&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-size: 11px; text-transform: uppercase; line-height: 22px; letter-spacing: 1px; color: rgb(79, 79, 101);">
                All Rights Reserved
              </div>
            </td>
          </tr>
          <tr class="spacer">
            <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
          </tr>
          <tr class="spacer">
            <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
          </tr>
          <tr class="spacer">
            <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
          </tr>
        </tbody></table>
        <!--[if (gte mso 9)|(IE)]>
</td>
</tr>
</table>
<![endif]-->
      </td>
    </tr>
  </tbody></table>



</body></html>';
				
				sendEmail($subject, $to, $emailContent); 
				$today=strtotime(date('Y-m-d'))-100;
			}
			else
			{
				$today=strtotime(date('Y-m-d'));
			}
			$room_id=$rowCountId['id'];			
			}
			else
			{
			$room_id=$rowRoom['room_id'];	
			}
			
			if($rowCode['payment_option']==2)
			{
			$ch = curl_init();

			curl_setopt($ch, CURLOPT_URL, 'https://api.stripe.com/v1/tokens');
			curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
			curl_setopt($ch, CURLOPT_POST, 1);
			curl_setopt($ch, CURLOPT_POSTFIELDS, "card[number]=4242424242424242&card[exp_month]=2&card[exp_year]=2030&card[cvc]=314");
			curl_setopt($ch, CURLOPT_USERPWD, 'sk_test_mTVjBSZHopmJyA3wgvzRwUM2' . ':' . '');

			$headers = array();
			$headers[] = 'Content-Type: application/x-www-form-urlencoded';
			curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);

			$result = curl_exec($ch);
			if (curl_errno($ch)) {
				echo 'Error:' . curl_error($ch);
			}
			curl_close($ch);
			$a=json_decode($result,true);
			 
			$ch = curl_init();

			curl_setopt($ch, CURLOPT_URL, 'https://api.stripe.com/v1/customers');
			curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
			curl_setopt($ch, CURLOPT_POST, 1);
			curl_setopt($ch, CURLOPT_POSTFIELDS, "name=".$row['first_name']."&email=".$row['email']."&source=".$a['id']."&description=My");
			curl_setopt($ch, CURLOPT_USERPWD, 'sk_test_mTVjBSZHopmJyA3wgvzRwUM2' . ':' . '');

			$headers = array();
			$headers[] = 'Content-Type: application/x-www-form-urlencoded';
			curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);

			$result = curl_exec($ch);
			if (curl_errno($ch)) {
				echo 'Error:' . curl_error($ch);
			}
			curl_close($ch);
			$b=json_decode($result,true);
			$cuId=$b['id'];
			
			$total_price=$rowCode['total_days']*$rowCode['price']*100;
			if($total_price<500)
			{
				$total_price=500;
			}
			$ch = curl_init();

			curl_setopt($ch, CURLOPT_URL, 'https://api.stripe.com/v1/charges');
			curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
			curl_setopt($ch, CURLOPT_POST, 1);
			curl_setopt($ch, CURLOPT_POSTFIELDS, "customer=".$b['id']."&amount=".$total_price."&currency=sek&description=My");
			curl_setopt($ch, CURLOPT_USERPWD, 'sk_test_mTVjBSZHopmJyA3wgvzRwUM2' . ':' . '');

			$headers = array();
			$headers[] = 'Content-Type: application/x-www-form-urlencoded';
			curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);

			$result = curl_exec($ch);
			if (curl_errno($ch)) {
				echo 'Error:' . curl_error($ch);
			}
			curl_close($ch);			
			$c=json_decode($result,true);
			$Chargeid=$c['id'];	
 
	
			}
			else
			{
				$cuId=$rowCode['cust_id'];
				$Chargeid=$rowCode['transection_id']; 
			}
			
			$stmt = $dbCon->prepare("update hotel_checkout_detail set cust_id=?,transection_id=?,checked_in=1,room_id=?,room_cleaning_date=? where id=?");
			/* bind parameters for markers */
			 
			$stmt->bind_param("ssisi",$cuId,$Chargeid,$room_id,$today,$_POST['checkout_id']);
			$stmt->execute();	
			
			$stmt = $dbCon->prepare("select hotel_basic_information.id,hotel_name   from company_hotel_room_type_detail left join hotel_room_type on hotel_room_type.id=company_hotel_room_type_detail.room_type left join hotel_basic_information on company_hotel_room_type_detail.location_id=hotel_basic_information.property_id left join property_location on property_location.id=hotel_basic_information.property_id where company_hotel_room_type_detail.id=(select room_type_id from hotel_checkout_detail where id=?)");
			
			/* bind parameters for markers */
			$stmt->bind_param("i",$_POST['checkout_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			
			
			$stmt = $dbCon->prepare("select email from user_logins where id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i",$rowCode['user_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowUser = $result->fetch_assoc();
			
			
			$stmt = $dbCon->prepare("select count(id) as num from employee_identificator_verification_detail where employee_user_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i",$rowCode['user_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowVerified = $result->fetch_assoc();
			if($rowVerified['num']>0)
			{
			
			$stmt = $dbCon->prepare("select id,box_number from hotel_insta_boxes where booking_id=? and in_use=1 and is_active=1");
			/* bind parameters for markers */
			$stmt->bind_param("i", $_POST['checkout_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowInstaBox = $result->fetch_assoc();
			if(!empty($rowInstaBox))
			{
				$encId=$this->encrypt_decrypt('encrypt',$row['id']);
				$url="https://www.safeqloud.com/public/index.php/InstaBox/welcome/".$encId;
				$surl=getShortUrl($url);
				$subject='Welcome! you have room key available in instabox.';
				$to      = $rowUser['email'];
				$emailContent='Welcome Guest! you can collect your key from the instabox number # 100-'.$rowInstaBox['box_number'].' using the url : '.$surl.' and the verification code:-'.$rowCode['checkin_code'];
				sendEmail($subject, $to, $emailContent); 
			}	
			}
			}
			else if($rowCode['hotel_property_type']==2)
			{
			$stmt = $dbCon->prepare("update hotel_checkout_detail set checked_in=1 where id=?");
			/* bind parameters for markers */
			 
			$stmt->bind_param("i",$_POST['checkout_id']);
			$stmt->execute();	
			}
			$stmt->close();
			$dbCon->close();
			return 1;	
			 
			}
		
	
		
		function getFrontDeskCheckedInHotel()
		{
			$dbCon = AppModel::createConnection();
			 
			$stmt = $dbCon->prepare("select transection_id,cust_id,total_days,price,payment_option,room_type_id,checkin_code,user_id,checkin_booking_date,checkout_booking_date,hotel_id,email from hotel_checkout_detail left join user_logins on user_logins.id=hotel_checkout_detail.user_id where hotel_checkout_detail.id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i",$_POST['checkout_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowCode = $result->fetch_assoc();
			
			if($rowCode['payment_option']==2)
			{
			$ch = curl_init();

			curl_setopt($ch, CURLOPT_URL, 'https://api.stripe.com/v1/tokens');
			curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
			curl_setopt($ch, CURLOPT_POST, 1);
			curl_setopt($ch, CURLOPT_POSTFIELDS, "card[number]=4242424242424242&card[exp_month]=2&card[exp_year]=2030&card[cvc]=314");
			curl_setopt($ch, CURLOPT_USERPWD, 'sk_test_mTVjBSZHopmJyA3wgvzRwUM2' . ':' . '');

			$headers = array();
			$headers[] = 'Content-Type: application/x-www-form-urlencoded';
			curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);

			$result = curl_exec($ch);
			if (curl_errno($ch)) {
				echo 'Error:' . curl_error($ch);
			}
			curl_close($ch);
			$a=json_decode($result,true);
			 
			$ch = curl_init();

			curl_setopt($ch, CURLOPT_URL, 'https://api.stripe.com/v1/customers');
			curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
			curl_setopt($ch, CURLOPT_POST, 1);
			curl_setopt($ch, CURLOPT_POSTFIELDS, "name=".$row['first_name']."&email=".$row['email']."&source=".$a['id']."&description=My");
			curl_setopt($ch, CURLOPT_USERPWD, 'sk_test_mTVjBSZHopmJyA3wgvzRwUM2' . ':' . '');

			$headers = array();
			$headers[] = 'Content-Type: application/x-www-form-urlencoded';
			curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);

			$result = curl_exec($ch);
			if (curl_errno($ch)) {
				echo 'Error:' . curl_error($ch);
			}
			curl_close($ch);
			$b=json_decode($result,true);
			$cuId=$b['id'];
			
			$total_price=$rowCode['total_days']*$rowCode['price']*100;
			if($total_price<500)
			{
				$total_price=500;
			}
			$ch = curl_init();

			curl_setopt($ch, CURLOPT_URL, 'https://api.stripe.com/v1/charges');
			curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
			curl_setopt($ch, CURLOPT_POST, 1);
			curl_setopt($ch, CURLOPT_POSTFIELDS, "customer=".$b['id']."&amount=".$total_price."&currency=sek&description=My");
			curl_setopt($ch, CURLOPT_USERPWD, 'sk_test_mTVjBSZHopmJyA3wgvzRwUM2' . ':' . '');

			$headers = array();
			$headers[] = 'Content-Type: application/x-www-form-urlencoded';
			curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);

			$result = curl_exec($ch);
			if (curl_errno($ch)) {
				echo 'Error:' . curl_error($ch);
			}
			curl_close($ch);			
			$c=json_decode($result,true);
			$Chargeid=$c['id'];	
 
	
			}
			else
			{
				$cuId=$rowCode['cust_id'];
				$Chargeid=$rowCode['transection_id']; 
			}

			
			$stmt = $dbCon->prepare("select id,room_id from hotel_insta_boxes where booking_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i",$_POST['checkout_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowRoom = $result->fetch_assoc();
			
			if(empty($rowRoom))
			{
			$select="select id,room_name,is_approved_cleaning from hotel_room_detail where room_type='".$rowCode['room_type_id']."' and id not in(select room_id from hotel_checkout_detail where room_type_id='".$rowCode['room_type_id']."' and checked_in=1 and room_id is not null) and room_available=1 and id not in (select room_id from hotel_insta_boxes where hotel_id=".$rowCode['hotel_id'].")";
			$resultCountId=mysqli_query($dbCon, $select);
			$rowCountId=mysqli_fetch_array($resultCountId);	
			
			if($rowCountId['is_approved_cleaning']==0)
			{
				$subject='Welcome! please wait while room is being cleaned.';
				$to      = $rowCode['email'];
				 
				$emailContent='<html><head><title>Reservation confirmed</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <style type="text/css">
    /* GT AMERICA */

    @font-face {
      font-display: fallback;
      font-family: "GT America Regular";
      font-weight: 400;
      src: url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Regular.woff2") format("woff2"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Regular.woff") format("woff"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Regular.ttf") format("truetype");
    }

    @font-face {
      font-display: fallback;
      font-family: "GT America Medium";
      font-weight: 600;
      src: url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Medium.woff2") format("woff2"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Medium.woff") format("woff"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Medium.ttf") format("truetype");
    }

    @font-face {
      font-display: fallback;
      font-family: "GT America Condensed Bold";
      font-weight: 700;
      src: url("https://www.exploretock.com/fonts/gt-america/GT-America-Condensed-Bold.woff2") format("woff2"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Condensed-Bold.woff") format("woff"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Condensed-Bold.ttf") format("truetype");
    }

    /* CLIENT-SPECIFIC RESET */

    body,
    table,
    td,
    a {
      -webkit-text-size-adjust: 100%;
      -ms-text-size-adjust: 100%;
    }

    /* Prevent WebKit and Windows mobile changing default text sizes */

    table,
    td {
      mso-table-lspace: 0pt;
      mso-table-rspace: 0pt;
    }

    /* Remove spacing between tables in Outlook 2007 and up */

    img {
      -ms-interpolation-mode: bicubic;
    }

    /* Allow smoother rendering of resized image in Internet Explorer */

    .im {
      color: inherit !important;
    }

    /* DEVICE-SPECIFIC RESET */

    a[x-apple-data-detectors] {
      color: inherit !important;
      text-decoration: none !important;
      font-size: inherit !important;
      font-family: inherit !important;
      font-weight: inherit !important;
      line-height: inherit !important;
    }

    /* iOS BLUE LINKS */

    /* RESET */

    img {
      border: 0;
      height: auto;
      line-height: 100%;
      outline: none;
      text-decoration: none;
      display: block;
    }

    table {
      border-collapse: collapse;
    }

    table td {
      border-collapse: collapse;
      display: table-cell;
    }

    body {
      height: 100% !important;
      margin: 0 !important;
      padding: 0 !important;
      width: 100% !important;
    }

    /* BG COLORS */

    .mainTable {
      background-color: #F0F0F0;
    }

    .mainTable--hospitality {
      background-color: #f7f2ed;
    }

    html {
      background-color: #F0F0F0;
    }

    /* VARIABLES */

    .bg-white {
      background-color: white;
    }

    .hr {
      /* Cross-client horizontal rule. Adapted from https://litmus.com/community/discussions/4633-is-there-a-reliable-1px-horizontal-rule-method */
      background-color: #d3d3d8;
      border-collapse: collapse;
      mso-table-lspace: 0pt;
      mso-table-rspace: 0pt;
      mso-line-height-rule: exactly;
      line-height: 1px;
    }

    .textAlignLeft {
      text-align: left !important;
    }

    .textAlignRight {
      text-align: right !important;
    }

    .textAlignCenter {
      text-align: center !important;
    }

    .mt1 {
      margin-top: 6px;
    }

    .list {
      padding-left: 18px;
      margin: 0;
    }

    /* TYPOGRAPHY */

    body {
      font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
      font-weight: 400;
      color: #4f4f65;
      -webkit-font-smoothing: antialiased;
      -ms-text-size-adjust: 100%;
      -moz-osx-font-smoothing: grayscale;
      font-smoothing: always;
      text-rendering: optimizeLegibility;
    }

    .h1 {
      font-family: "GT America Condensed Bold", "Roboto Condensed", "Roboto", "Helvetica", "Arial", sans-serif;
      font-weight: 700;
      vertical-align: middle;
      font-size: 36px;
      line-height: 42px;
    }

    .h2 {
      font-family: "GT America Medium", "Roboto", "Helvetica", "Arial", sans-serif;
      font-weight: 600;
      vertical-align: middle;
      font-size: 16px;
      line-height: 24px;
    }

    .text {
      font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
      font-weight: 400;
      font-size: 16px;
      line-height: 21px;
    }

    .text-list {
      font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
      font-weight: 400;
      font-size: 16px;
      line-height: 25px;
    }

    .textSmall {
      font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
      font-weight: 400;
      font-size: 14px;
    }

    .text-xsmall {
      font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
      font-size: 11px;
      text-transform: uppercase;
      line-height: 22px;
      letter-spacing: 1px;
    }

    .text-bold {
      font-weight: 600;
    }

    .text-link {
      text-decoration: underline;
    }

    .text-linkNoUnderline {
      text-decoration: none;
    }

    .text-strike {
      text-decoration: line-through;
    }

    /* FONT COLORS */

    .textColorDark {
      color: #23233e;
    }

    .textColorNormal {
      color: #4f4f65;
    }

    .textColorBlue {
      color: #2020c0;
    }

    .textColorGrayDark {
      color: #7B7B8B;
    }

    .textColorGray {
      color: #A5A8AD;
    }

    .textColorWhite {
      color: #FFFFFF;
    }

    .textColorRed {
      color: #df3232;
    }

    /* BUTTON */

    .Button-primary-wrapper {
      border-radius: 3px;
      background-color: #2020C0;
    }

    .Button-primary {
      font-family: "GT America Medium", "Roboto", "Helvetica", "Arial", sans-serif;
      border-radius: 3px;
      border: 1px solid #2020C0;
      color: #ffffff;
      display: block;
      font-size: 16px;
      font-weight: 600;
      padding: 18px;
      text-decoration: none;
    }

    .Button-secondary-wrapper {
      border-radius: 3px;
      background-color: #ffffff;
    }

    .Button-secondary {
      font-family: "GT America Medium", "Roboto", "Helvetica", "Arial", sans-serif;
      border-radius: 3px;
      border: 1px solid #2020C0;
      color: #2020C0;
      display: block;
      font-size: 16px;
      font-weight: 600;
      padding: 18px;
      text-decoration: none;
    }

    /* LAYOUT */

    .Content-container {
      padding-left: 60px;
      padding-right: 60px;
    }

    .Content-container--main {
      padding-top: 54px;
      padding-bottom: 60px;
    }

    .Content {
      width: 580px;
      margin: 0 auto;
    }

    .wrapper {
      max-width: 600px;
    }

    .section {
      padding: 24px 0px;
      border-bottom: 1px solid #d3d3d8;
    }

    .section--noBorder {
      padding: 24px 0px 0;
    }

    .section--last {
      padding: 24px 0px;
    }

    .message {
      background-color: #F4F4F5;
      padding: 18px;
    }

    .card {
      border: 1px solid #d3d3d8;
      padding: 18px;
    }

    /* HEADER */

    .header-tockLogoImage {
      display: block;
      color: #F0F0F0;
    }

    .header-heroImage {
      padding-bottom: 24px;
    }

    /* PREHEADER */

    .preheader {
      display: none;
      font-size: 1px;
      color: #FFFFFF;
      line-height: 1px;
      max-height: 0px;
      max-width: 0px;
      opacity: 0;
      overflow: hidden;
    }

    /* BANNER */

    .notice {
      padding: 12px;
      background: #23233E;
      color: #FFFFFF;
      display: block;
      font-size: 14px;
      font-family: "GT America Medium", "Roboto", "Helvetica", "Arial", sans-serif;
      font-weight: 600;
    }

    /* INTRO */

    .section--intro {
      padding-bottom: 48px;
    }

    /* BOOKING INFO */

    .business-logo__container {
      width: 48px;
      height: 48px;
      border-radius: 3px;
      border: 1px solid #d3d3d8;
      overflow: hidden;
    }

    .business-logo__image {
      border: 1px solid transparent;
      border-radius: 3px;
      width: 48px;
      height: 48px;
      display: block;
    }

    .business-address--address {
      width: 50%;
    }

    .business-address--map {
      width: 50%;
    }

    .business-address--map-image {
      width: 100%;
    }

    /* MOBILE TICKETS */

    .mobile-ticket--description {
      width: 65%;
      margin-top: 12px;
      margin-right: 5%;
    }

    .mobile-ticket--code {
      width: 30%;
    }

    .mobile-ticket--code-image {
      width: 100%;
    }

    /* RESERVATION ACTIONS */

    .linksTable {
      border-bottom: 1px solid #d3d3d8;
    }

    .linksTableRow {
      padding: 24px 12px;
    }

    .actions-icon {
      vertical-align: middle;
    }

    .actions-text {
      vertical-align: middle;
    }

    /* RECEIPT */

    .receipt__container {
      border: 1px solid #d3d3d8;
      padding: 24px;
    }

    .receipt__row {
      border-top: 1px solid #d3d3d8;
    }

    /* FEEDBACK ICONS */

    .feedback-link {
      border: 1px solid #d4d5da;
      border-radius: 3px;
      display: inline-block;
      width: calc(32% - 2px);
      padding: 10px 0;
    }

    .feedback-link-bumper {
      display: inline-block;
      width: 1%;
    }

    .feedback-link img {
      height: 50px;
      width: 50px;
    }

    /* SOCIAL ICONS */

    .social-link {
      display: inline-block;
      width: auto;
    }

    .social-link-text {
      padding: 14px 24px 14px 14px;
    }

    /* TABLET STYLES */

    @media screen and (max-width: 648px) {
      /* DEVICE-SPECIFIC RESET */
      div[style*="margin: 16px 0;"] {
        margin: 0 !important;
      }
      /* ANDROID CENTER FIX */
      /* LAYOUT */
      .wrapper {
        width: 100% !important;
        max-width: 100% !important;
      }
      .Content {
        width: 90% !important;
      }
      .Content-container {
        padding-left: 36px !important;
        padding-right: 36px !important;
      }
      .Content-container--main {
        padding-top: 30px !important;
        padding-bottom: 42px !important;
      }
      .responsiveTable {
        width: 100% !important;
      }
      /* RESERVATION ACTIONS */
      .linksTableRow {
        padding-left: 0 !important;
        padding-right: 0 !important;
        padding-top: 12px !important;
        padding-bottom: 12px !important;
      }
      .linksTableRow--borderRight {
        border-right: none !important;
        padding-left: 0 !important;
        padding-right: 0 !important;
      }
      /* FEEDBACK LINK */
      .feedback-link img {
        height: 38px !important;
        width: 38px !important;
      }
    }

    /* MOBILE STYLES */

    @media screen and (max-width: 480px) {
      /* TYPOGRAPHY */
      .h1 {
        font-size: 30px !important;
        line-height: 30px !important;
      }
      .text {
        font-size: 16px !important;
        line-height: 22px !important;
      }
      /* BUTTON */
      .mobile-buttonContainer {
        width: 100% !important;
      }
      /* LAYOUT */
      .Content {
        width: 100% !important;
      }
      .Content-container {
        padding-left: 18px !important;
        padding-right: 18px !important;
      }
      .Content-container--main {
        padding-top: 24px !important;
        padding-bottom: 30px !important;
      }
      .section {
        padding: 18px 0 !important;
      }
      .section--last {
        padding: 18px 0 !important;
      }
      .header {
        padding: 0 18px !important;
      }
      .business-address--address {
        width: 100% !important;
      }
      .business-address--map {
        margin-top: 30px !important;
        width: 100% !important;
      }
      .mobile-ticket--description {
        width: 100% !important;
        margin-top: 0px !important;
      }
      .mobile-ticket--code {
        margin-top: 30px !important;
        margin-left: 0;
        width: 100% !important;
      }
      /* RECEIPT */
      .receipt__container {
        padding: 12px !important;
      }
      /* SOCIAL ICONS */
      .social-link {
        display: block !important;
        width: 100% !important;
        border-bottom: 1px solid #d3d3d8 !important;
      }
      /* INTRO */
      .section--intro {
        padding-top: 18px !important;
        padding-bottom: 18px !important;
      }
    }
  </style>



   
  <!--[if mso]>
    <style type="text/css">
.h1 {font-family: "Helvetica", "Arial", sans-serif !important; font-weight: 700 !important; vertical-align: middle !important; font-size: 36px !important; mso-line-height-rule: exactly;line-height: 42px !important;}
.h2 {font-family: "Helvetica", "Arial", sans-serif !important;font-weight: 600 !important;vertical-align: middle !important;font-size: 16px !important;mso-line-height-rule: exactly;line-height: 24px !important;}
.text {font-family: "Helvetica", "Arial", sans-serif !important;font-weight: 400 !important;font-size: 16px !important;mso-line-height-rule: exactly;line-height: 21px !important;}
.text-list {font-family: "Helvetica", "Arial", sans-serif !important;font-weight: 400 !important;font-size: 16px !important;mso-line-height-rule: exactly;line-height: 25px !important;}
.textSmall {font-family: "Helvetica", "Arial", sans-serif !important;font-weight: 400 !important;font-size: 14px !important;}
.text-xsmall {font-family: "Helvetica", "Arial", sans-serif !important;font-size: 11px !important;text-transform: uppercase !important;mso-line-height-rule: exactly;line-height: 22px !important;letter-spacing: 1px !important;}
.text-bold {font-weight: 600 !important;}
.text-link {text-decoration: underline !important;}
.text-linkNoUnderline {text-decoration: none !important;}
.text-strike {text-decoration: line-through !important;}
.textColorDark {color: #23233e !important;}
.textColorNormal {color: #4f4f65 !important;}
.textColorBlue {color: #2020c0 !important;}
.textColorGray {color: #A5A8AD !important;}
.textColorWhite {color: #FFFFFF !important;}
.Button-primary {font-family: "Helvetica", "Arial", sans-serif !important;border-radius: 3px !important;border: 1px solid #2020C0 !important;color: #ffffff !important;display: block !important;font-size: 16px !important;font-weight: 600 !important;padding: 18px !important;text-decoration: none !important;}
.Button-secondary {font-family: "Helvetica", "Arial", sans-serif !important;border-radius: 3px !important;border: 1px solid #2020C0 !important;color: #2020C0 !important;display: block !important;font-size: 16px !important;font-weight: 600 !important;padding: 18px !important;text-decoration: none !important;}
    </style>
    <![endif]-->
  <!-- HIDDEN PREHEADER TEXT -->
  </head><body><div class="preheader" style="display: none; font-size: 1px; color: rgb(255, 255, 255); line-height: 1px; max-height: 0px; max-width: 0px; opacity: 0; overflow: hidden;">
  </div>
  <table border="0" cellpadding="0" cellspacing="0" width="100%" class=" mainTable  " style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; background-color: rgb(240, 240, 240);">
    <tbody><tr><td style="display:none !important;
 visibility:hidden;
 mso-hide:all;
 font-size:1px;
 color:#ffffff;
 line-height:1px;
 max-height:0px;
 max-width:0px;
 opacity:0;
 overflow:hidden; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;"> We are thrilled that you will be joining us. If yo... </td>
    <!-- HEADER -->
    </tr><tr>
      <td align="center" class="header" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
        <!--[if (gte mso 9)|(IE)]>
    <table align="center" border="0" cellspacing="0" cellpadding="0" width="600">
    <tr>
    <td align="center" valign="top" width="600">
    <![endif]-->
        <table border="0" cellpadding="0" cellspacing="0" width="100%" class="Content" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; width: 580px; margin: 0 auto;">
          <tbody><tr class="spacer">
            <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
          </tr>
          <tr class="spacer">
            <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
          </tr>
          <tr>
            <td align="left" valign="middle" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;"> <h1 style="font-size: 33px;font-weight: 800;line-height: 30px;">Dstricts</h1>               </td>
          </tr>
          <tr class="spacer">
            <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
          </tr>
          <tr class="spacer">
            <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
          </tr>
        </tbody></table>
        <!--[if (gte mso 9)|(IE)]>
    </td>
    </tr>
    </table>
    <![endif]-->
      </td>
    </tr>
    <!-- CONTENT -->
    <tr>
      <td align="center" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
        <!--[if (gte mso 9)|(IE)]>
    <table align="center" border="0" cellspacing="0" cellpadding="0" width="600">
    <tr>
    <td align="center" valign="top" width="600">
    <![endif]-->
        <table border="0" cellpadding="0" cellspacing="0" width="100%" class="Content bg-white" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; background-color: white; width: 580px; margin: 0 auto;">
          <tbody><tr>
            <td class="Content-container Content-container--main text textColorNormal" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell; font-family: &quot;GT America Regular&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-weight: 400; font-size: 16px; line-height: 21px; color: rgb(79, 79, 101); padding-left: 60px; padding-right: 60px; padding-top: 54px; padding-bottom: 60px;">
              <table width="100%" border="0" cellspacing="0" cellpadding="0" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
                <!-- RESTAURANT INFO -->
                <tbody><tr>
                  <td valign="top" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                    <table align="left" border="0" cellpadding="0" cellspacing="0" width="100%" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
                      <tbody><tr>
                        
                        <td width="12" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
                        <td align="left" valign="middle" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;"> <span class="h2 textColorDark" style="font-family: &quot;GT America Medium&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-weight: 600; vertical-align: middle; font-size: 16px; line-height: 24px; color: rgb(35, 35, 62);">Welcome</span>                          </td>
                      </tr>
                      <tr class="spacer">
                        <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
                      </tr>
                      <tr class="spacer">
                        <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
                      </tr>
                    </tbody></table>
                  </td>
                </tr>
                <!-- INTRO -->
                <tr>
                  <td valign="top" align="left" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                    <table width="100%" border="0" cellspacing="0" cellpadding="0" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
                      <tbody><tr>
                        <td align="left" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;"> <span class="h1 textColorDark" style="font-family: &quot;GT America Condensed Bold&quot;, &quot;Roboto Condensed&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-weight: 700; vertical-align: middle; font-size: 36px; line-height: 42px; color: rgb(35, 35, 62);">You are checked in now</span>                          </td>
                      </tr>
                      <tr class="spacer">
                        <td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
                      </tr>
                      <tr>
                        <td align="left" colspan="2" valign="top" width="100%" height="1" class="hr" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell; background-color: rgb(211, 211, 216); border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; mso-line-height-rule: exactly; line-height: 1px;">
                          <!--[if gte mso 15]>&nbsp;<![endif]-->
                        </td>
                      </tr>
                      <tr class="spacer">
                        <td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
                      </tr>
                    </tbody></table>
                  </td>
                </tr>
                <!-- MESSAGE -->
                
                
                
                
                
                
                <!-- BOOKING INFO -->
                
                <!-- ADDRESS -->
                <tr>
                  <td align="center" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                    <table border="0" cellpadding="0" cellspacing="0" width="100%" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
                      <tbody>
                      
                      
                      <tr class="spacer">
                        <td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
                      </tr>
                      <tr class="spacer">
                        <td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
                      </tr>
                      <tr>
                        <td align="left" valign="middle" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                          <table border="0" cellpadding="0" cellspacing="0" width="100%" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
                            <tbody><tr>
                              <td style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                <table align="left" border="0" cellpadding="0" cellspacing="0" width="230" class="business-address--address" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; width: 70%;">
                                  <tbody><tr>
                                    <td align="left" width="100%" class="text-list textColorNormal" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell; font-family: &quot;GT America Regular&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-weight: 400; font-size: 16px; line-height: 25px; color: rgb(79, 79, 101);">
                                    <span class="h2 textColorDark" style="font-family: &quot;GT America Medium&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-weight: 600; vertical-align: middle; font-size: 16px; line-height: 24px; color: rgb(35, 35, 62);">We regret that the room is not cleaned. Please wait for a while before we clean the room. We will inform you asap its done and you can proceed to your room.</span>                                         </td>
                                  </tr>
                                </tbody></table>
                                <!--[if mso]></td><td><![endif]-->
                                <table align="right" border="0" cellpadding="0" cellspacing="0" width="230" class="business-address--map" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; width: 50%;">
                                  <tbody><tr>
                                    
                                  </tr>
                                </tbody></table>
                              </td>
                            </tr>
                          </tbody></table>
                        </td>
                      </tr>
                    </tbody></table>
                  </td>
                </tr>
                <tr class="spacer">
                  <td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
                </tr>
                <tr class="spacer">
                  <td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
                </tr>
                
                
                
                <!-- RECEIPT -->
                
                
                
                <!-- EDIT RECEIPT -->
                <!-- CANCELLATION POLICY -->
                
                
                
                <!-- QUESTIONS -->
                
              </tbody></table>
            </td>
          </tr>
        </tbody></table>
      </td>
    </tr>
    <!-- FOOTER -->
    <tr>
      <td align="center" class="Content" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell; width: 580px; margin: 0 auto;">
        <!-- Will most likely required a feature flag -->
        <!--[if (gte mso 9)|(IE)]>
<table align="center" border="0" cellspacing="0" cellpadding="0" width="600">
<tr>
<td align="center" valign="top" width="600">
<![endif]-->
        <table width="100%" border="0" cellspacing="0" cellpadding="0" align="center" class="Content-container" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; padding-left: 60px; padding-right: 60px;">
          <tbody><tr class="spacer">
            <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
          </tr>
          <tr class="spacer">
            <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
          </tr>
          <tr class="spacer">
            <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
          </tr>
          <tr>
            <td align="center" valign="top" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;"> <a href="https://www.exploretock.com" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%;"> <img src="https://storage.googleapis.com/tock-public-assets/images-email-template/tock-brandmark-color.png" width="30" height="30" alt="Tock" border="0" style="-ms-interpolation-mode: bicubic; border: 0; height: auto; line-height: 100%; outline: none; text-decoration: none; display: block;"> </a>              </td>
          </tr>
          <tr class="spacer">
            <td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
          </tr>
          <tr>
            <td align="center" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
              <div class="text-xsmall textColorNormal" style="font-family: &quot;GT America Regular&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-size: 11px; text-transform: uppercase; line-height: 22px; letter-spacing: 1px; color: rgb(79, 79, 101);">
                © 2019 Tock, Inc.
              </div>
              <div class="text-xsmall textColorNormal" style="font-family: &quot;GT America Regular&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-size: 11px; text-transform: uppercase; line-height: 22px; letter-spacing: 1px; color: rgb(79, 79, 101);">
                All Rights Reserved
              </div>
            </td>
          </tr>
          <tr class="spacer">
            <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
          </tr>
          <tr class="spacer">
            <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
          </tr>
          <tr class="spacer">
            <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
          </tr>
        </tbody></table>
        <!--[if (gte mso 9)|(IE)]>
</td>
</tr>
</table>
<![endif]-->
      </td>
    </tr>
  </tbody></table>



</body></html>';
				
				sendEmail($subject, $to, $emailContent); 
				$today=strtotime(date('Y-m-d'))-100;
			}
			else
			{
				$today=strtotime(date('Y-m-d'));
			}
			$room_id=$rowCountId['id'];			
			}
			else
			{
			$room_id=$rowRoom['room_id'];	
			}
			
			
			 
			$stmt = $dbCon->prepare("update hotel_checkout_detail set cust_id=?,transection_id=?, checked_in=1,room_id=?,guest_adult=?,guest_children=?,room_cleaning_date=? where id=?");
			/* bind parameters for markers */
			$stmt->bind_param("ssiiisi",$cuId,$Chargeid,$room_id,$_POST['guest_adult'],$_POST['guest_children'],$today,$_POST['checkout_id']);
			$stmt->execute();	
			
			$stmt = $dbCon->prepare("select hotel_basic_information.id,hotel_name   from company_hotel_room_type_detail left join hotel_room_type on hotel_room_type.id=company_hotel_room_type_detail.room_type left join hotel_basic_information on company_hotel_room_type_detail.location_id=hotel_basic_information.property_id left join property_location on property_location.id=hotel_basic_information.property_id where company_hotel_room_type_detail.id=(select room_type_id from hotel_checkout_detail where id=?)");
			/* bind parameters for markers */
			$stmt->bind_param("i",$_POST['checkout_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			
			$stmt = $dbCon->prepare("select room_type_id,checkin_code,user_id from hotel_checkout_detail where id=?");
			/* bind parameters for markers */
			$stmt->bind_param("i",$_POST['checkout_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowCode = $result->fetch_assoc();
			
			$stmt = $dbCon->prepare("select email from user_logins where id=?");
			/* bind parameters for markers */
			$stmt->bind_param("i",$rowCode['user_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowUser = $result->fetch_assoc();
			
			$stmt = $dbCon->prepare("select count(id) as num from employee_identificator_verification_detail where employee_user_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i",$rowCode['user_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowVerified = $result->fetch_assoc();
			if($rowVerified['num']>0)
			{
			$stmt = $dbCon->prepare("select id,box_number from hotel_insta_boxes where booking_id=? and in_use=1 and is_active=1");
			/* bind parameters for markers */
			$stmt->bind_param("i", $_POST['checkout_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowInstaBox = $result->fetch_assoc();
			if(!empty($rowInstaBox))
			{
				 
				$encId=$this->encrypt_decrypt('encrypt',$row['id']);
				$url="https://www.safeqloud.com/public/index.php/InstaBox/welcome/".$encId;
				$surl=getShortUrl($url);
				 
				$subject='Welcome! you have room key available in instabox.';
				$to      = $rowUser['email'];
				 
				$emailContent='Welcome Guest! you can collect your key from the instabox number # 100-'.$rowInstaBox['box_number'].' using the url : '.$surl.' and the verification code:-'.$rowCode['checkin_code'];
				
				sendEmail($subject, $to, $emailContent); 
			}	
			}
			$stmt->close();
			$dbCon->close();
			return 1;	
			 
			}
		
		function hotelBookingListForFrontDeskCheckin($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select location_id from user_company_profile where company_id=? and user_login_id=?");
			$stmt->bind_param("ii",$data['company_id'],$data['user_id']);
			$stmt->execute();
			$result2 = $stmt->get_result();
			$row2 = $result2->fetch_assoc();
			 
			$today=strtotime(date('Y-m-d'));
			 
			$stmt = $dbCon->prepare("select hotel_checkout_detail.id,first_name,last_name,guest_adult,guest_children,checkin_booking_date,checkout_booking_date  from hotel_checkout_detail left join user_logins on user_logins.id=hotel_checkout_detail.user_id where is_paid=1 and checked_in=0 and property_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $row2['location_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			while($row = $result->fetch_assoc())
			{
				if($today<$row['checkin_booking_date'] || $today>$row['checkout_booking_date'])
				{
					continue;
				}
				array_push($org,$row);
			}
			$row['first_name']=html_entity_decode($row['first_name'],ENT_NOQUOTES, 'UTF-8');
			$row['last_name']=html_entity_decode($row['last_name'],ENT_NOQUOTES, 'UTF-8'); 
			$stmt->close();
			$dbCon->close();
			 
			return $org;
		}
		
		function handoverKey($data)
		{
			$dbCon = AppModel::createConnection();
			
			 
			$stmt = $dbCon->prepare("update hotel_checkout_detail set key_received=1 where id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i",$data['id']);
			$stmt->execute();
			
			$stmt = $dbCon->prepare("update hotel_insta_boxes  set booking_id=null,in_use=0,room_id=0 where booking_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i",$data['id']);
			$stmt->execute();
			
			$curl = curl_init();
			  curl_setopt_array($curl, array(
			  CURLOPT_URL => 'https://dstricts.com/user/index.php/DstrictsApp/updateKeyReceiving',
			  CURLOPT_RETURNTRANSFER => true,
			  CURLOPT_ENCODING => '',
			  CURLOPT_MAXREDIRS => 10,
			  CURLOPT_TIMEOUT => 0,
			  CURLOPT_FOLLOWLOCATION => true,
			  CURLOPT_HTTP_VERSION => CURL_HTTP_VERSION_1_1,
			  CURLOPT_CUSTOMREQUEST => 'POST',
			  CURLOPT_POSTFIELDS => array('checkid' => $data['id']),
			));
			$response = curl_exec($curl);
			curl_close($curl);
			
			$stmt = $dbCon->prepare("select email from user_logins where id=(select user_id from hotel_checkout_detail where id=?)");
			$stmt->bind_param("i",$data['id']);
			$stmt->execute();
			$result2 = $stmt->get_result();
			$row2 = $result2->fetch_assoc();
			
			$subject='Welcome guest!';
			$to      = $row2['email'];
			$emailContent='Welcome guest! you can proceed to your room. Have a nice stay.';
			sendEmail($subject, $to, $emailContent); 
			
			$stmt->close();
			$dbCon->close();
			return 1;
			 
		}
		
		
		function checkOutGuest($data)
		{
			$dbCon = AppModel::createConnection();
			
			 $today=date('Y-m-d H:i:s');
			$stmt = $dbCon->prepare("update hotel_checkout_detail set checked_in=2,checkout_time_info=now() where id=?");
			/* bind parameters for markers */
			$stmt->bind_param("i",$data['id']);
			$stmt->execute();
			
			$stmt = $dbCon->prepare("select room_id from hotel_checkout_detail where id=?");
			$stmt->bind_param("i",$data['id']);
			$stmt->execute();
			$result2 = $stmt->get_result();
			$row2 = $result2->fetch_assoc(); 
			 
			$stmt = $dbCon->prepare("update hotel_room_detail set is_approved_cleaning=0,staff_assigned_id=0,cleaning_work_assigned=0,inspector_id=0,inspection_work_allocatied=0 where id=?");
			/* bind parameters for markers */
			$stmt->bind_param("i",$row2['room_id']);
			$stmt->execute();
			
			$curl = curl_init();
			  curl_setopt_array($curl, array(
			  CURLOPT_URL => 'https://dstricts.com/user/index.php/DstrictsApp/checkOutGuest',
			  CURLOPT_RETURNTRANSFER => true,
			  CURLOPT_ENCODING => '',
			  CURLOPT_MAXREDIRS => 10,
			  CURLOPT_TIMEOUT => 0,
			  CURLOPT_FOLLOWLOCATION => true,
			  CURLOPT_HTTP_VERSION => CURL_HTTP_VERSION_1_1,
			  CURLOPT_CUSTOMREQUEST => 'POST',
			  CURLOPT_POSTFIELDS => array('checkid' => $data['id']),
			));
			$response = curl_exec($curl);
			curl_close($curl);
			
			$stmt = $dbCon->prepare("select email from user_logins where id=(select user_id from hotel_checkout_detail where id=?)");
			$stmt->bind_param("i",$data['id']);
			$stmt->execute();
			$result2 = $stmt->get_result();
			$row2 = $result2->fetch_assoc();
			
			$subject='Thanks!';
			$to      = $row2['email'];
			$emailContent='Thanks! For selecting us, Hope you had a pleasent stay. Visit again soon.';
			sendEmail($subject, $to, $emailContent); 
			
			$stmt->close();
			$dbCon->close();
			return 1;
			 
		}
		
		function allocateRoomForCleaning($data)
		{
			$dbCon = AppModel::createConnection();
			
			$today=strtotime(date('Y-m-d')); 
			$stmt = $dbCon->prepare("update hotel_checkout_detail set room_cleaning_allocated=1,room_cleaning_staff_id=?,room_cleaning_date=? where id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("isi",$data['user_id'],$today,$data['id']);
			$stmt->execute();
			 
			$stmt->close();
			$dbCon->close();
			return 1;
			 
		}
		
		
		function updateRoomCleaning($data)
		{
			$dbCon = AppModel::createConnection();
			
			$stmt = $dbCon->prepare("update hotel_checkout_detail set room_cleaning_allocated=0,room_cleaning_staff_id=null,room_cleaning_status=1 where id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i",$data['id']);
			$stmt->execute();
			
			$stmt = $dbCon->prepare("select email from hotel_checkout_detail left join user_logins on user_logins.id=hotel_checkout_detail.user_id where id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i",$data['id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowCode = $result->fetch_assoc();
			if(!empty($rowCode))
			{
				$subject='Welcome! please wait while room is being Cleaned.';
				$to      = $rowCode['email'];
				$emailContent='<html><head><title>Reservation confirmed</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <style type="text/css">
    /* GT AMERICA */

    @font-face {
      font-display: fallback;
      font-family: "GT America Regular";
      font-weight: 400;
      src: url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Regular.woff2") format("woff2"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Regular.woff") format("woff"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Regular.ttf") format("truetype");
    }

    @font-face {
      font-display: fallback;
      font-family: "GT America Medium";
      font-weight: 600;
      src: url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Medium.woff2") format("woff2"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Medium.woff") format("woff"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Medium.ttf") format("truetype");
    }

    @font-face {
      font-display: fallback;
      font-family: "GT America Condensed Bold";
      font-weight: 700;
      src: url("https://www.exploretock.com/fonts/gt-america/GT-America-Condensed-Bold.woff2") format("woff2"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Condensed-Bold.woff") format("woff"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Condensed-Bold.ttf") format("truetype");
    }

    /* CLIENT-SPECIFIC RESET */

    body,
    table,
    td,
    a {
      -webkit-text-size-adjust: 100%;
      -ms-text-size-adjust: 100%;
    }

    /* Prevent WebKit and Windows mobile changing default text sizes */

    table,
    td {
      mso-table-lspace: 0pt;
      mso-table-rspace: 0pt;
    }

    /* Remove spacing between tables in Outlook 2007 and up */

    img {
      -ms-interpolation-mode: bicubic;
    }

    /* Allow smoother rendering of resized image in Internet Explorer */

    .im {
      color: inherit !important;
    }

    /* DEVICE-SPECIFIC RESET */

    a[x-apple-data-detectors] {
      color: inherit !important;
      text-decoration: none !important;
      font-size: inherit !important;
      font-family: inherit !important;
      font-weight: inherit !important;
      line-height: inherit !important;
    }

    /* iOS BLUE LINKS */

    /* RESET */

    img {
      border: 0;
      height: auto;
      line-height: 100%;
      outline: none;
      text-decoration: none;
      display: block;
    }

    table {
      border-collapse: collapse;
    }

    table td {
      border-collapse: collapse;
      display: table-cell;
    }

    body {
      height: 100% !important;
      margin: 0 !important;
      padding: 0 !important;
      width: 100% !important;
    }

    /* BG COLORS */

    .mainTable {
      background-color: #F0F0F0;
    }

    .mainTable--hospitality {
      background-color: #f7f2ed;
    }

    html {
      background-color: #F0F0F0;
    }

    /* VARIABLES */

    .bg-white {
      background-color: white;
    }

    .hr {
      /* Cross-client horizontal rule. Adapted from https://litmus.com/community/discussions/4633-is-there-a-reliable-1px-horizontal-rule-method */
      background-color: #d3d3d8;
      border-collapse: collapse;
      mso-table-lspace: 0pt;
      mso-table-rspace: 0pt;
      mso-line-height-rule: exactly;
      line-height: 1px;
    }

    .textAlignLeft {
      text-align: left !important;
    }

    .textAlignRight {
      text-align: right !important;
    }

    .textAlignCenter {
      text-align: center !important;
    }

    .mt1 {
      margin-top: 6px;
    }

    .list {
      padding-left: 18px;
      margin: 0;
    }

    /* TYPOGRAPHY */

    body {
      font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
      font-weight: 400;
      color: #4f4f65;
      -webkit-font-smoothing: antialiased;
      -ms-text-size-adjust: 100%;
      -moz-osx-font-smoothing: grayscale;
      font-smoothing: always;
      text-rendering: optimizeLegibility;
    }

    .h1 {
      font-family: "GT America Condensed Bold", "Roboto Condensed", "Roboto", "Helvetica", "Arial", sans-serif;
      font-weight: 700;
      vertical-align: middle;
      font-size: 36px;
      line-height: 42px;
    }

    .h2 {
      font-family: "GT America Medium", "Roboto", "Helvetica", "Arial", sans-serif;
      font-weight: 600;
      vertical-align: middle;
      font-size: 16px;
      line-height: 24px;
    }

    .text {
      font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
      font-weight: 400;
      font-size: 16px;
      line-height: 21px;
    }

    .text-list {
      font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
      font-weight: 400;
      font-size: 16px;
      line-height: 25px;
    }

    .textSmall {
      font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
      font-weight: 400;
      font-size: 14px;
    }

    .text-xsmall {
      font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
      font-size: 11px;
      text-transform: uppercase;
      line-height: 22px;
      letter-spacing: 1px;
    }

    .text-bold {
      font-weight: 600;
    }

    .text-link {
      text-decoration: underline;
    }

    .text-linkNoUnderline {
      text-decoration: none;
    }

    .text-strike {
      text-decoration: line-through;
    }

    /* FONT COLORS */

    .textColorDark {
      color: #23233e;
    }

    .textColorNormal {
      color: #4f4f65;
    }

    .textColorBlue {
      color: #2020c0;
    }

    .textColorGrayDark {
      color: #7B7B8B;
    }

    .textColorGray {
      color: #A5A8AD;
    }

    .textColorWhite {
      color: #FFFFFF;
    }

    .textColorRed {
      color: #df3232;
    }

    /* BUTTON */

    .Button-primary-wrapper {
      border-radius: 3px;
      background-color: #2020C0;
    }

    .Button-primary {
      font-family: "GT America Medium", "Roboto", "Helvetica", "Arial", sans-serif;
      border-radius: 3px;
      border: 1px solid #2020C0;
      color: #ffffff;
      display: block;
      font-size: 16px;
      font-weight: 600;
      padding: 18px;
      text-decoration: none;
    }

    .Button-secondary-wrapper {
      border-radius: 3px;
      background-color: #ffffff;
    }

    .Button-secondary {
      font-family: "GT America Medium", "Roboto", "Helvetica", "Arial", sans-serif;
      border-radius: 3px;
      border: 1px solid #2020C0;
      color: #2020C0;
      display: block;
      font-size: 16px;
      font-weight: 600;
      padding: 18px;
      text-decoration: none;
    }

    /* LAYOUT */

    .Content-container {
      padding-left: 60px;
      padding-right: 60px;
    }

    .Content-container--main {
      padding-top: 54px;
      padding-bottom: 60px;
    }

    .Content {
      width: 580px;
      margin: 0 auto;
    }

    .wrapper {
      max-width: 600px;
    }

    .section {
      padding: 24px 0px;
      border-bottom: 1px solid #d3d3d8;
    }

    .section--noBorder {
      padding: 24px 0px 0;
    }

    .section--last {
      padding: 24px 0px;
    }

    .message {
      background-color: #F4F4F5;
      padding: 18px;
    }

    .card {
      border: 1px solid #d3d3d8;
      padding: 18px;
    }

    /* HEADER */

    .header-tockLogoImage {
      display: block;
      color: #F0F0F0;
    }

    .header-heroImage {
      padding-bottom: 24px;
    }

    /* PREHEADER */

    .preheader {
      display: none;
      font-size: 1px;
      color: #FFFFFF;
      line-height: 1px;
      max-height: 0px;
      max-width: 0px;
      opacity: 0;
      overflow: hidden;
    }

    /* BANNER */

    .notice {
      padding: 12px;
      background: #23233E;
      color: #FFFFFF;
      display: block;
      font-size: 14px;
      font-family: "GT America Medium", "Roboto", "Helvetica", "Arial", sans-serif;
      font-weight: 600;
    }

    /* INTRO */

    .section--intro {
      padding-bottom: 48px;
    }

    /* BOOKING INFO */

    .business-logo__container {
      width: 48px;
      height: 48px;
      border-radius: 3px;
      border: 1px solid #d3d3d8;
      overflow: hidden;
    }

    .business-logo__image {
      border: 1px solid transparent;
      border-radius: 3px;
      width: 48px;
      height: 48px;
      display: block;
    }

    .business-address--address {
      width: 50%;
    }

    .business-address--map {
      width: 50%;
    }

    .business-address--map-image {
      width: 100%;
    }

    /* MOBILE TICKETS */

    .mobile-ticket--description {
      width: 65%;
      margin-top: 12px;
      margin-right: 5%;
    }

    .mobile-ticket--code {
      width: 30%;
    }

    .mobile-ticket--code-image {
      width: 100%;
    }

    /* RESERVATION ACTIONS */

    .linksTable {
      border-bottom: 1px solid #d3d3d8;
    }

    .linksTableRow {
      padding: 24px 12px;
    }

    .actions-icon {
      vertical-align: middle;
    }

    .actions-text {
      vertical-align: middle;
    }

    /* RECEIPT */

    .receipt__container {
      border: 1px solid #d3d3d8;
      padding: 24px;
    }

    .receipt__row {
      border-top: 1px solid #d3d3d8;
    }

    /* FEEDBACK ICONS */

    .feedback-link {
      border: 1px solid #d4d5da;
      border-radius: 3px;
      display: inline-block;
      width: calc(32% - 2px);
      padding: 10px 0;
    }

    .feedback-link-bumper {
      display: inline-block;
      width: 1%;
    }

    .feedback-link img {
      height: 50px;
      width: 50px;
    }

    /* SOCIAL ICONS */

    .social-link {
      display: inline-block;
      width: auto;
    }

    .social-link-text {
      padding: 14px 24px 14px 14px;
    }

    /* TABLET STYLES */

    @media screen and (max-width: 648px) {
      /* DEVICE-SPECIFIC RESET */
      div[style*="margin: 16px 0;"] {
        margin: 0 !important;
      }
      /* ANDROID CENTER FIX */
      /* LAYOUT */
      .wrapper {
        width: 100% !important;
        max-width: 100% !important;
      }
      .Content {
        width: 90% !important;
      }
      .Content-container {
        padding-left: 36px !important;
        padding-right: 36px !important;
      }
      .Content-container--main {
        padding-top: 30px !important;
        padding-bottom: 42px !important;
      }
      .responsiveTable {
        width: 100% !important;
      }
      /* RESERVATION ACTIONS */
      .linksTableRow {
        padding-left: 0 !important;
        padding-right: 0 !important;
        padding-top: 12px !important;
        padding-bottom: 12px !important;
      }
      .linksTableRow--borderRight {
        border-right: none !important;
        padding-left: 0 !important;
        padding-right: 0 !important;
      }
      /* FEEDBACK LINK */
      .feedback-link img {
        height: 38px !important;
        width: 38px !important;
      }
    }

    /* MOBILE STYLES */

    @media screen and (max-width: 480px) {
      /* TYPOGRAPHY */
      .h1 {
        font-size: 30px !important;
        line-height: 30px !important;
      }
      .text {
        font-size: 16px !important;
        line-height: 22px !important;
      }
      /* BUTTON */
      .mobile-buttonContainer {
        width: 100% !important;
      }
      /* LAYOUT */
      .Content {
        width: 100% !important;
      }
      .Content-container {
        padding-left: 18px !important;
        padding-right: 18px !important;
      }
      .Content-container--main {
        padding-top: 24px !important;
        padding-bottom: 30px !important;
      }
      .section {
        padding: 18px 0 !important;
      }
      .section--last {
        padding: 18px 0 !important;
      }
      .header {
        padding: 0 18px !important;
      }
      .business-address--address {
        width: 100% !important;
      }
      .business-address--map {
        margin-top: 30px !important;
        width: 100% !important;
      }
      .mobile-ticket--description {
        width: 100% !important;
        margin-top: 0px !important;
      }
      .mobile-ticket--code {
        margin-top: 30px !important;
        margin-left: 0;
        width: 100% !important;
      }
      /* RECEIPT */
      .receipt__container {
        padding: 12px !important;
      }
      /* SOCIAL ICONS */
      .social-link {
        display: block !important;
        width: 100% !important;
        border-bottom: 1px solid #d3d3d8 !important;
      }
      /* INTRO */
      .section--intro {
        padding-top: 18px !important;
        padding-bottom: 18px !important;
      }
    }
  </style>



   
  <!--[if mso]>
    <style type="text/css">
.h1 {font-family: "Helvetica", "Arial", sans-serif !important; font-weight: 700 !important; vertical-align: middle !important; font-size: 36px !important; mso-line-height-rule: exactly;line-height: 42px !important;}
.h2 {font-family: "Helvetica", "Arial", sans-serif !important;font-weight: 600 !important;vertical-align: middle !important;font-size: 16px !important;mso-line-height-rule: exactly;line-height: 24px !important;}
.text {font-family: "Helvetica", "Arial", sans-serif !important;font-weight: 400 !important;font-size: 16px !important;mso-line-height-rule: exactly;line-height: 21px !important;}
.text-list {font-family: "Helvetica", "Arial", sans-serif !important;font-weight: 400 !important;font-size: 16px !important;mso-line-height-rule: exactly;line-height: 25px !important;}
.textSmall {font-family: "Helvetica", "Arial", sans-serif !important;font-weight: 400 !important;font-size: 14px !important;}
.text-xsmall {font-family: "Helvetica", "Arial", sans-serif !important;font-size: 11px !important;text-transform: uppercase !important;mso-line-height-rule: exactly;line-height: 22px !important;letter-spacing: 1px !important;}
.text-bold {font-weight: 600 !important;}
.text-link {text-decoration: underline !important;}
.text-linkNoUnderline {text-decoration: none !important;}
.text-strike {text-decoration: line-through !important;}
.textColorDark {color: #23233e !important;}
.textColorNormal {color: #4f4f65 !important;}
.textColorBlue {color: #2020c0 !important;}
.textColorGray {color: #A5A8AD !important;}
.textColorWhite {color: #FFFFFF !important;}
.Button-primary {font-family: "Helvetica", "Arial", sans-serif !important;border-radius: 3px !important;border: 1px solid #2020C0 !important;color: #ffffff !important;display: block !important;font-size: 16px !important;font-weight: 600 !important;padding: 18px !important;text-decoration: none !important;}
.Button-secondary {font-family: "Helvetica", "Arial", sans-serif !important;border-radius: 3px !important;border: 1px solid #2020C0 !important;color: #2020C0 !important;display: block !important;font-size: 16px !important;font-weight: 600 !important;padding: 18px !important;text-decoration: none !important;}
    </style>
    <![endif]-->
  <!-- HIDDEN PREHEADER TEXT -->
  </head><body><div class="preheader" style="display: none; font-size: 1px; color: rgb(255, 255, 255); line-height: 1px; max-height: 0px; max-width: 0px; opacity: 0; overflow: hidden;">
  </div>
  <table border="0" cellpadding="0" cellspacing="0" width="100%" class=" mainTable  " style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; background-color: rgb(240, 240, 240);">
    <tbody><tr><td style="display:none !important;
 visibility:hidden;
 mso-hide:all;
 font-size:1px;
 color:#ffffff;
 line-height:1px;
 max-height:0px;
 max-width:0px;
 opacity:0;
 overflow:hidden; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;"> We are thrilled that you will be joining us. If yo... </td>
    <!-- HEADER -->
    </tr><tr>
      <td align="center" class="header" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
        <!--[if (gte mso 9)|(IE)]>
    <table align="center" border="0" cellspacing="0" cellpadding="0" width="600">
    <tr>
    <td align="center" valign="top" width="600">
    <![endif]-->
        <table border="0" cellpadding="0" cellspacing="0" width="100%" class="Content" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; width: 580px; margin: 0 auto;">
          <tbody><tr class="spacer">
            <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
          </tr>
          <tr class="spacer">
            <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
          </tr>
          <tr>
            <td align="left" valign="middle" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;"> <h1 style="font-size: 33px;font-weight: 800;line-height: 30px;">Dstricts</h1>               </td>
          </tr>
          <tr class="spacer">
            <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
          </tr>
          <tr class="spacer">
            <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
          </tr>
        </tbody></table>
        <!--[if (gte mso 9)|(IE)]>
    </td>
    </tr>
    </table>
    <![endif]-->
      </td>
    </tr>
    <!-- CONTENT -->
    <tr>
      <td align="center" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
        <!--[if (gte mso 9)|(IE)]>
    <table align="center" border="0" cellspacing="0" cellpadding="0" width="600">
    <tr>
    <td align="center" valign="top" width="600">
    <![endif]-->
        <table border="0" cellpadding="0" cellspacing="0" width="100%" class="Content bg-white" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; background-color: white; width: 580px; margin: 0 auto;">
          <tbody><tr>
            <td class="Content-container Content-container--main text textColorNormal" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell; font-family: &quot;GT America Regular&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-weight: 400; font-size: 16px; line-height: 21px; color: rgb(79, 79, 101); padding-left: 60px; padding-right: 60px; padding-top: 54px; padding-bottom: 60px;">
              <table width="100%" border="0" cellspacing="0" cellpadding="0" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
                <!-- RESTAURANT INFO -->
                <tbody><tr>
                  <td valign="top" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                    <table align="left" border="0" cellpadding="0" cellspacing="0" width="100%" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
                      <tbody><tr>
                        
                        <td width="12" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
                        <td align="left" valign="middle" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;"> <span class="h2 textColorDark" style="font-family: &quot;GT America Medium&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-weight: 600; vertical-align: middle; font-size: 16px; line-height: 24px; color: rgb(35, 35, 62);">Completed</span>                          </td>
                      </tr>
                      <tr class="spacer">
                        <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
                      </tr>
                      <tr class="spacer">
                        <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
                      </tr>
                    </tbody></table>
                  </td>
                </tr>
                <!-- INTRO -->
                <tr>
                  <td valign="top" align="left" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                    <table width="100%" border="0" cellspacing="0" cellpadding="0" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
                      <tbody><tr>
                        <td align="left" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;"> <span class="h1 textColorDark" style="font-family: &quot;GT America Condensed Bold&quot;, &quot;Roboto Condensed&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-weight: 700; vertical-align: middle; font-size: 36px; line-height: 42px; color: rgb(35, 35, 62);">Your room has been cleaned</span>                          </td>
                      </tr>
                      <tr class="spacer">
                        <td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
                      </tr>
                      <tr>
                        <td align="left" colspan="2" valign="top" width="100%" height="1" class="hr" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell; background-color: rgb(211, 211, 216); border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; mso-line-height-rule: exactly; line-height: 1px;">
                          <!--[if gte mso 15]>&nbsp;<![endif]-->
                        </td>
                      </tr>
                      <tr class="spacer">
                        <td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
                      </tr>
                    </tbody></table>
                  </td>
                </tr>
                <!-- MESSAGE -->
                
                
                
                
                
                
                <!-- BOOKING INFO -->
                
                <!-- ADDRESS -->
                <tr>
                  <td align="center" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                    <table border="0" cellpadding="0" cellspacing="0" width="100%" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
                      <tbody>
                      
                      
                      <tr class="spacer">
                        <td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
                      </tr>
                      <tr class="spacer">
                        <td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
                      </tr>
                      <tr>
                        <td align="left" valign="middle" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                          <table border="0" cellpadding="0" cellspacing="0" width="100%" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
                            <tbody><tr>
                              <td style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                <table align="left" border="0" cellpadding="0" cellspacing="0" width="230" class="business-address--address" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; width: 70%;">
                                  <tbody><tr>
                                    <td align="left" width="100%" class="text-list textColorNormal" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell; font-family: &quot;GT America Regular&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-weight: 400; font-size: 16px; line-height: 25px; color: rgb(79, 79, 101);">
                                    <span class="h2 textColorDark" style="font-family: &quot;GT America Medium&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-weight: 600; vertical-align: middle; font-size: 16px; line-height: 24px; color: rgb(35, 35, 62);">We regret for inconvenience. Your room is cleaned now you can proceed to your room.</span>                                         </td>
                                  </tr>
                                </tbody></table>
                                <!--[if mso]></td><td><![endif]-->
                                <table align="right" border="0" cellpadding="0" cellspacing="0" width="230" class="business-address--map" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; width: 50%;">
                                  <tbody><tr>
                                    
                                  </tr>
                                </tbody></table>
                              </td>
                            </tr>
                          </tbody></table>
                        </td>
                      </tr>
                    </tbody></table>
                  </td>
                </tr>
                <tr class="spacer">
                  <td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
                </tr>
                <tr class="spacer">
                  <td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
                </tr>
                
                
                
                <!-- RECEIPT -->
                
                
                
                <!-- EDIT RECEIPT -->
                <!-- CANCELLATION POLICY -->
                
                
                
                <!-- QUESTIONS -->
                
              </tbody></table>
            </td>
          </tr>
        </tbody></table>
      </td>
    </tr>
    <!-- FOOTER -->
    <tr>
      <td align="center" class="Content" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell; width: 580px; margin: 0 auto;">
        <!-- Will most likely required a feature flag -->
        <!--[if (gte mso 9)|(IE)]>
<table align="center" border="0" cellspacing="0" cellpadding="0" width="600">
<tr>
<td align="center" valign="top" width="600">
<![endif]-->
        <table width="100%" border="0" cellspacing="0" cellpadding="0" align="center" class="Content-container" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; padding-left: 60px; padding-right: 60px;">
          <tbody><tr class="spacer">
            <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
          </tr>
          <tr class="spacer">
            <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
          </tr>
          <tr class="spacer">
            <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
          </tr>
          <tr>
            <td align="center" valign="top" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;"> <a href="https://www.exploretock.com" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%;"> <img src="https://storage.googleapis.com/tock-public-assets/images-email-template/tock-brandmark-color.png" width="30" height="30" alt="Tock" border="0" style="-ms-interpolation-mode: bicubic; border: 0; height: auto; line-height: 100%; outline: none; text-decoration: none; display: block;"> </a>              </td>
          </tr>
          <tr class="spacer">
            <td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
          </tr>
          <tr>
            <td align="center" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
              <div class="text-xsmall textColorNormal" style="font-family: &quot;GT America Regular&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-size: 11px; text-transform: uppercase; line-height: 22px; letter-spacing: 1px; color: rgb(79, 79, 101);">
                © 2019 Tock, Inc.
              </div>
              <div class="text-xsmall textColorNormal" style="font-family: &quot;GT America Regular&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-size: 11px; text-transform: uppercase; line-height: 22px; letter-spacing: 1px; color: rgb(79, 79, 101);">
                All Rights Reserved
              </div>
            </td>
          </tr>
          <tr class="spacer">
            <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
          </tr>
          <tr class="spacer">
            <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
          </tr>
          <tr class="spacer">
            <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
          </tr>
        </tbody></table>
        <!--[if (gte mso 9)|(IE)]>
</td>
</tr>
</table>
<![endif]-->
      </td>
    </tr>
  </tbody></table>



</body></html>';
				sendEmail($subject, $to, $emailContent); 
				}	

			
			$stmt->close();
			$dbCon->close();
			return 1;
			 
		}
		
		
		
		function hotelBookingListForCleningStaff($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select location_id,concat_ws(' ',first_name,last_name) as name from user_company_profile left join user_logins on user_logins.id=user_company_profile.user_login_id where company_id=? and user_login_id=?");
			$stmt->bind_param("ii",$data['company_id'],$data['user_id']);
			$stmt->execute();
			$result2 = $stmt->get_result();
			$row2 = $result2->fetch_assoc();
			 
			$today=strtotime(date('Y-m-d'));
			 
			$stmt = $dbCon->prepare("select room_name,passport_image,hotel_checkout_detail.id,concat_ws(' ',first_name,last_name) as name,checkin_booking_date,checkout_booking_date,room_cleaning_date,room_cleaning_status,room_cleaning_allocated,room_cleaning_staff_id from hotel_checkout_detail left join user_logins on user_logins.id=hotel_checkout_detail.user_id left join hotel_room_detail on hotel_room_detail.id=hotel_checkout_detail.room_id where is_paid=1 and checked_in=1 and key_received=1 and hotel_checkout_detail.property_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $row2['location_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			while($row = $result->fetch_assoc())
			{
				if($today<$row['checkin_booking_date'] || $today>$row['checkout_booking_date'])
				{
					continue;
				}
				
				if($today>$row['room_cleaning_date'])
				{
					$stmt = $dbCon->prepare("update hotel_checkout_detail set room_cleaning_status=0 where id=?");
			
					/* bind parameters for markers */
					$stmt->bind_param("i", $row['id']);
					$stmt->execute();
					$row['room_cleaning_status']=0;
					$row['room_cleaning_allocated']=0;
					$row['started_by']='Not started';
					$row['name_assigned']='';
				}
				
				if($today==$row['room_cleaning_date'] && $row['room_cleaning_status']==1)
				{
					continue; 
				}
				
				if($today==$row['room_cleaning_date'] && $row['room_cleaning_allocated']==1)
				{
					$stmt = $dbCon->prepare("select location_id,concat_ws(' ',first_name,last_name) as name from user_company_profile left join user_logins on user_logins.id=user_company_profile.user_login_id where company_id=? and user_login_id=?");
					$stmt->bind_param("ii",$data['company_id'],$row['room_cleaning_staff_id']);
					$stmt->execute();
					$resultStarted = $stmt->get_result();
					$rowStarted = $resultStarted->fetch_assoc();
					$row['name_assigned']=html_entity_decode($rowStarted['name'],ENT_NOQUOTES, 'UTF-8'); 
					$row['started_by']='Started by - '.html_entity_decode($rowStarted['name'],ENT_NOQUOTES, 'UTF-8'); 
				}
				
				if($row['passport_image']=="" || $row['passport_image']==null)
				{
					$row['user_image']='https://www.safeqloud.com/html/usercontent/images/person-male.png';
				}
				else
				{
				$filename="../estorecss/".$row['passport_image'].".txt"; $value_a=file_get_contents("../estorecss/".$row['passport_image'].".txt"); $value_a=str_replace('"','',$value_a); $row['passport_image'] = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$row['passport_image'].'.jpg' );
				$row['user_image']=str_replace('../','https://www.safeqloud.com/',$row['passport_image']);
				}
				$row['name']=html_entity_decode($row['name'],ENT_NOQUOTES, 'UTF-8'); 
				array_push($org,$row);
			}
			$stmt->close();
			$dbCon->close();
			 
			return $org;
		}

		
		
		function hotelBookingListForFrontDeskCheckout($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select location_id from user_company_profile where company_id=? and user_login_id=?");
			$stmt->bind_param("ii",$data['company_id'],$data['user_id']);
			$stmt->execute();
			$result2 = $stmt->get_result();
			$row2 = $result2->fetch_assoc();
			 
			$today=strtotime(date('Y-m-d'));
			 
			$stmt = $dbCon->prepare("select passport_image,hotel_checkout_detail.id,concat_ws(' ',first_name,last_name) as name,checkin_booking_date,checkout_booking_date  from hotel_checkout_detail left join user_logins on user_logins.id=hotel_checkout_detail.user_id where is_paid=1 and checked_in=1 and key_received=1 and property_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $row2['location_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			while($row = $result->fetch_assoc())
			{
				
				if($row['passport_image']=="" || $row['passport_image']==null)
				{
					$row['user_image']='https://www.safeqloud.com/html/usercontent/images/person-male.png';
				}
				else
				{
				$filename="../estorecss/".$row['passport_image'].".txt"; $value_a=file_get_contents("../estorecss/".$row['passport_image'].".txt"); $value_a=str_replace('"','',$value_a); $row['passport_image'] = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$row['passport_image'].'.jpg' );
				$row['user_image']=str_replace('../','https://www.safeqloud.com/',$row['passport_image']);
				}
				$row['name']=html_entity_decode($row['name'],ENT_NOQUOTES, 'UTF-8'); 
				array_push($org,$row);
			}
			$stmt->close();
			$dbCon->close();
			 
			return $org;
		}

		function hotelBookingListForFrontDeskKeyhandling($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select location_id from user_company_profile where company_id=? and user_login_id=?");
			$stmt->bind_param("ii",$data['company_id'],$data['user_id']);
			$stmt->execute();
			$result2 = $stmt->get_result();
			$row2 = $result2->fetch_assoc();
			 
			$today=strtotime(date('Y-m-d'));
			 
			$stmt = $dbCon->prepare("select passport_image,hotel_checkout_detail.id,concat_ws(' ',first_name,last_name) as name,checkin_booking_date,checkout_booking_date  from hotel_checkout_detail left join user_logins on user_logins.id=hotel_checkout_detail.user_id where is_paid=1 and checked_in=1 and key_received=0 and property_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $row2['location_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			while($row = $result->fetch_assoc())
			{
				if($today<$row['checkin_booking_date'] || $today>$row['checkout_booking_date'])
				{
					continue;
				}
				if($row['passport_image']=="" || $row['passport_image']==null)
				{
					$row['user_image']='https://www.safeqloud.com/html/usercontent/images/person-male.png';
				}
				else
				{
				$filename="../estorecss/".$row['passport_image'].".txt"; $value_a=file_get_contents("../estorecss/".$row['passport_image'].".txt"); $value_a=str_replace('"','',$value_a); $row['passport_image'] = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$row['passport_image'].'.jpg' );
				$row['user_image']=str_replace('../','https://www.safeqloud.com/',$row['passport_image']);
				}
				$row['name']=html_entity_decode($row['name'],ENT_NOQUOTES, 'UTF-8'); 
				array_push($org,$row);
			}
			$stmt->close();
			$dbCon->close();
			 
			return $org;
		}

		function hotelBookingListForFrontDeskReceivedKey($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select location_id from user_company_profile where company_id=? and user_login_id=?");
			$stmt->bind_param("ii",$data['company_id'],$data['user_id']);
			$stmt->execute();
			$result2 = $stmt->get_result();
			$row2 = $result2->fetch_assoc();
			 
			$today=strtotime(date('Y-m-d'));
			 
			$stmt = $dbCon->prepare("select passport_image,hotel_checkout_detail.id,concat_ws(' ',first_name,last_name) as name,checkin_booking_date,checkout_booking_date  from hotel_checkout_detail left join user_logins on user_logins.id=hotel_checkout_detail.user_id where is_paid=1 and checked_in=1 and key_received=1 and property_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $row2['location_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			while($row = $result->fetch_assoc())
			{
				if($today<$row['checkin_booking_date'] || $today>$row['checkout_booking_date'])
				{
					continue;
				}
				if($row['passport_image']=="" || $row['passport_image']==null)
				{
					$row['user_image']='https://www.safeqloud.com/html/usercontent/images/person-male.png';
				}
				else
				{
				$filename="../estorecss/".$row['passport_image'].".txt"; $value_a=file_get_contents("../estorecss/".$row['passport_image'].".txt"); $value_a=str_replace('"','',$value_a); $row['passport_image'] = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$row['passport_image'].'.jpg' );
				$row['user_image']=str_replace('../','https://www.safeqloud.com/',$row['passport_image']);
				}
				$row['name']=html_entity_decode($row['name'],ENT_NOQUOTES, 'UTF-8'); 
				array_push($org,$row);
			}
			$stmt->close();
			$dbCon->close();
			 
			return $org;
		}

		function isHotel($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select id from property_location where company_id=? and is_headquarter=1");
			$stmt->bind_param("i",$data['company_id']);
			$stmt->execute();
			$result2 = $stmt->get_result();
			$rowHeadquarter = $result2->fetch_assoc();
			
			$stmt = $dbCon->prepare("select id,location_id from user_company_profile where company_id=? and user_login_id=?");
			$stmt->bind_param("ii",$data['company_id'],$data['user_id']);
			$stmt->execute();
			$result2 = $stmt->get_result();
			$row2 = $result2->fetch_assoc();
			if(empty($row2))
			{
			$stmt = $dbCon->prepare("insert into user_company_profile (company_id,user_login_id,location_id) values (?,?,?)");
			$stmt->bind_param("iii",$data['company_id'],$data['user_id'],$rowHeadquarter['id']);
			$stmt->execute();
			}
			if($row2['location_id']=='' || $row2['location_id']==null)
			{
			$stmt = $dbCon->prepare("update user_company_profile set location_id where id=?");
			$stmt->bind_param("ii",$rowHeadquarter['id'],$row2['id']);
			$stmt->execute();	
			}
			
			$stmt = $dbCon->prepare("select id from hotel_basic_information where property_id=(select location_id from user_company_profile where company_id=? and user_login_id=?)");
			$stmt->bind_param("ii",$data['company_id'],$data['user_id']);
			$stmt->execute();
			$result2 = $stmt->get_result();
			$row2 = $result2->fetch_assoc();
			 if(empty($row2))
			 {
				$stmt->close();
				$dbCon->close();
				return 0;		
			 }
			 else
			 {
				$stmt->close();
				$dbCon->close();
				return 1;
			 }
			
		}

		function hotelBookingListForKeyGeneration($data)
		{
			$dbCon = AppModel::createConnection();
			$id=$this->encrypt_decrypt('decrypt',$data['id']);
			 
			$stmt = $dbCon->prepare("select property_id from hotel_basic_information where id=?");
			$stmt->bind_param("i",$id);
			$stmt->execute();
			$result2 = $stmt->get_result();
			$row2 = $result2->fetch_assoc();
		 
			$stmt = $dbCon->prepare("select id,checkin_code from hotel_checkout_detail where room_type_id in (select id from company_hotel_room_type_detail where location_id=?) and checked_in=0 and checkin_code is not null and hotel_checkout_detail.id not in (select booking_id from hotel_insta_boxes where hotel_id=? and booking_id is not null)");
			
			/* bind parameters for markers */
			$stmt->bind_param("ii", $row2['property_id'],$id);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			$org=array();
			while($row = $result->fetch_assoc())
			{
				array_push($org,$row);
			}
			$stmt->close();
			$dbCon->close();
			 
			return $org;
			 }
			 
			 
		function hotelBookingInstaBoxListForKeyGeneration($data)
		{
			$dbCon = AppModel::createConnection();
			$id=$this->encrypt_decrypt('decrypt',$data['id']);
			 
			 
			$org =array();
			$stmt = $dbCon->prepare("select id,box_number from hotel_insta_boxes where hotel_id=? and in_use=0 and is_active=1");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $id);
			$stmt->execute();
			$result = $stmt->get_result();
			 
			while($row = $result->fetch_assoc())
			{
				$row['instaBox']='# 100-'.$row['box_number'];
				array_push($org,$row);
			}
			$stmt->close();
			$dbCon->close();
			return $org;
			 }
			 
			 	 
		 
  
	function checkEmployeeReference($data)
    {
		
		$dbCon = AppModel::createConnection();
		$stmt = $dbCon->prepare("select id,login_status,login_started_at from hotel_basic_information where login_ip=?");
		/* bind parameters for markers */
		$stmt->bind_param("s", $_POST['orderRef']);
		$stmt->execute();
		$result = $stmt->get_result();
		$row = $result->fetch_assoc();
		
		if(empty($row))
		{
			 
			$stmt->close();
			$dbCon->close();
			return 0; 
			
		}
		else
		{
			 
			$LoginTime=strtotime($row['login_started_at']);
			$currentTime=strtotime(date('Y-m-d H:i:s'));
			$minutes = round(abs($currentTime - $LoginTime) / 60,2); 
			 
			if($minutes>=4)
			{
			$stmt = $dbCon->prepare("update hotel_basic_information set login_ip=null,login_status=0,login_started_at=null where id=?");
				/* bind parameters for markers */
			$stmt->bind_param("i",$row['id']);
			$stmt->execute(); 
			$stmt->close();
			$dbCon->close();
			return 0; 			
			
			}
		}
			
		 
			$stmt->close();
			$dbCon->close();
			return $row['login_status']; 
		 
    }
	
	
	function verifEmployeeInfo($data)
		{
			$dbCon = AppModel::createConnection();
			$id=$this->encrypt_decrypt('decrypt',$data['id']);
			$stmt = $dbCon->prepare("select location_id from user_company_profile where user_login_id=? and company_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("ii", $data['user_id'],$data['company_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			
			$stmt = $dbCon->prepare("select property_id,login_status,login_started_at from hotel_basic_information where id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i",$id);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowProperty = $result->fetch_assoc();
			$LoginTime=strtotime($rowProperty['login_started_at']);
			$currentTime=strtotime(date('Y-m-d H:i:s'));
			$minutes = round(abs($currentTime - $LoginTime) / 60,2); 
			
			if($minutes>=4)
			{
			$stmt = $dbCon->prepare("update hotel_basic_information set login_ip=null,login_status=0,login_started_at=null where id=?");
				/* bind parameters for markers */
			$stmt->bind_param("i",$id);
			$stmt->execute(); 	
			
			$stmt = $dbCon->prepare("select property_id,login_status,login_started_at from hotel_basic_information where id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i",$id);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowProperty = $result->fetch_assoc();
			}
			
			if($rowProperty['login_status']>0)
			{
			$stmt->close();
			$dbCon->close();
			return 0;
			}
			
			if($row['location_id']==$rowProperty['property_id'])
			{
			$stmt = $dbCon->prepare("update hotel_basic_information set login_ip=?,login_status=1,login_started_at=now() where id=?");
				/* bind parameters for markers */
			$stmt->bind_param("si",$data['ip'],$id);
			$stmt->execute(); 	
			$stmt->close();
			$dbCon->close();
			return 1;
			}
			else
			{
			$stmt->close();
			$dbCon->close();
			return 0;	
			}
			
		}
		
		
		function generateKeyForInstaBox($data)
		{
			$dbCon = AppModel::createConnection();
			$id=$this->encrypt_decrypt('decrypt',$data['id']);
			 
			$stmt = $dbCon->prepare("update hotel_basic_information set login_status=2,booking_id=?,insta_box_id=?,checkout_room_id=? where id=?");
				/* bind parameters for markers */
			$stmt->bind_param("iiii",$data['booking_id'],$data['insta_box_id'],$data['room_id'],$id);
			$stmt->execute(); 	
			$stmt->close();
			$dbCon->close();
			return 1;
			 
			
		}
		
		
		function countryCode()
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select id,country_code from phone_country_code order by country_code");
			
			/* bind parameters for markers */
			 
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			while($row = $result->fetch_assoc())
			{
				$row['country_code']='+'.$row['country_code'];
			array_push($org,$row);	
			}
			
			$stmt->close();
			$dbCon->close();
			return $org;
		}
		
		function resendInvitation($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select invitation_type from hotel_checkout_invitation_info where id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['id']);
			$stmt->execute();
			$resultCode = $stmt->get_result();
			$rowCountryCode = $resultCode->fetch_assoc();
			if($rowCountryCode['invitation_type']==1)
			{
			$result = $this->resendPhoneIinviteAdultForCheckin($data);	
			}
			else
			{
			$result = $this->resendEmailIinviteAdultForCheckin($data);	
			}
			$stmt->close();
			$dbCon->close();
			return 1;
		}
		
		function verifyUserInvitationInfo($data)
		{
			$dbCon = AppModel::createConnection();
			$invitation_id=$this->encrypt_decrypt('decrypt',$data['id']);
			
			$stmt = $dbCon->prepare("select * from hotel_checkout_invitation_info where id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $invitation_id);
			$stmt->execute();
			$resultCode = $stmt->get_result();
			$rowCountryCode = $resultCode->fetch_assoc();
			
			if($rowCountryCode['is_verified']==0)
			{
			$stmt->close();
			$dbCon->close();
			return 0;	
			}
			
			$stmt = $dbCon->prepare("select id,checkin_code,guest_adult,guest_children,checkin_date,checkout_date from hotel_checkout_detail where id=?");
			$stmt->bind_param("i",$rowCountryCode['hotel_checkout_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			$row = $result->fetch_assoc();
			$today=strtotime(date('Y-m-d'));
			$booking_date=strtotime($row['checkin_date']);
			$booking_overdate=strtotime($row['checkout_date']);
				
			if($today<$booking_date || $today>$booking_overdate)
			{
			$stmt->close();
			$dbCon->close();
			return 2;
			}
			
			if($rowCountryCode['is_confirmed']==1)
			{
			$stmt->close();
			$dbCon->close();
			return 1;	
			}
			
			if($rowCountryCode['invitation_type']==2)
			{
			$stmt = $dbCon->prepare("select id as user_id from user_logins where email=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("s", $rowCountryCode['email']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			
			}
			else if($rowCountryCode['invitation_type']==1)
			{
			$stmt = $dbCon->prepare("select user_logins_id as user_id,country_of_residence from user_profiles left join user_logins on user_logins.id=user_profiles.user_logins_id where country_of_residence=? and phone_number=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("is", $rowCountryCode['country_id'], $rowCountryCode['phone_number']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			
			}
			
			if($row['user_id']==$data['user_id'])
			{
				$stmt = $dbCon->prepare("select count(id) as num from user_address where user_id=?");
				
				$stmt->bind_param("i",$data['user_id']);
				$stmt->execute();
				$result1 = $stmt->get_result();
				$row = $result1->fetch_assoc();	
				if($row['num']==0)
				{
				$stmt->close();
				$dbCon->close();
				return 4;	
				}
				
				$stmt = $dbCon->prepare("select count(id) as num from user_cards where user_login_id=?");
				$stmt->bind_param("i",$data['user_id']);
				$stmt->execute();
				$result1 = $stmt->get_result();
				$row = $result1->fetch_assoc();
				if($row['num']==0)
				{
				$stmt->close();
				$dbCon->close();
				return 4;	
				}
				
				$stmt = $dbCon->prepare("select count(id) as num from user_identification where user_id=?");
				
				$stmt->bind_param("i",$data['user_id']);
				$stmt->execute();
				$result1 = $stmt->get_result();
				$row = $result1->fetch_assoc();		
				
				if($row['num']==0)
				{
				$stmt->close();
				$dbCon->close();
				return 4;	
				}
				
			$stmt = $dbCon->prepare("update hotel_checkout_invitation_info set invited_user_id=? where id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("ii",$data['user_id'], $invitation_id);
			$stmt->execute();
			
			$stmt->close();
			$dbCon->close();
			return $rowCountryCode['verification_code'];	
			}
			else
			{
			$stmt->close();
			$dbCon->close();
			return 0;	
			}
			
		}
		
		
		function confirmUserInvitationInfo($data)
		{
			$dbCon = AppModel::createConnection();
			$invitation_id=$this->encrypt_decrypt('decrypt',$data['id']);
			$stmt = $dbCon->prepare("update hotel_checkout_invitation_info set is_confirmed=1 where id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $invitation_id);
			$stmt->execute();
			$stmt->close();
			$dbCon->close();
			return 1;
		}
		
		
		function resendPhoneIinviteAdultForCheckin($data)
		{
			 
			$dbCon = AppModel::createConnection();
			 
			
			$stmt = $dbCon->prepare("select buyer_id,is_buyer_company,hotel_checkout_detail.user_id,visiting_address,port_number,visiting_city,visiting_state,property_location.id as p_id,room_type_id,total_days,price,hotel_name,fdesk_country_code,fdesk_phone_number from hotel_checkout_detail left join company_hotel_room_type_detail on company_hotel_room_type_detail.id= hotel_checkout_detail.room_type_id left join hotel_basic_information on hotel_basic_information.property_id=company_hotel_room_type_detail.location_id left join property_location on property_location.id=hotel_basic_information.property_id where hotel_checkout_detail.id=(select hotel_checkout_id from hotel_checkout_invitation_info where id=?)");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowInfo = $result->fetch_assoc();
			 
			$stmt = $dbCon->prepare("select * from hotel_images where property_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $rowInfo['p_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowImage = $result->fetch_assoc();
			
			$filename="../estorecss/".$rowImage['image_path'].".txt"; $value_a=file_get_contents("../estorecss/".$rowImage['image_path'].".txt"); $value_a=str_replace('"','',$value_a); $rowImage['image_path'] = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$rowImage['image_path'].'.jpg' );
			$rowInfo['image_path']=str_replace('../','https://www.safeqloud.com/',$rowImage['image_path']);
			
			$stmt = $dbCon->prepare("select concat_ws(' ', first_name,last_name) as name,email from user_logins where id = ?");
        
				/* bind parameters for markers */
			$stmt->bind_param("i", $rowInfo['user_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowUser    = $result->fetch_assoc();
				 
		  
			 
			$stmt = $dbCon->prepare("select country_code,phone_number,verification_code from hotel_checkout_invitation_info where id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['id']);
			$stmt->execute();
			$resultCode = $stmt->get_result();
			
			$rowCountryCode = $resultCode->fetch_assoc();
			 $id1=$this -> encrypt_decrypt('encrypt',$data['id']); 
			if(isset($data['precheck']))
			{
			$url="https://www.dstricts.com/public/index.php/Hotel/verifyInvitationPreCheckin/".$id1;	
			}
			else
			{
			$url="https://www.dstricts.com/public/index.php/Hotel/verifyInvitationCheckin/".$id1;	
			}
			$surl=getShortUrl($url);
			
			$phone="+".trim($rowCountryCode['country_code'])."".trim($rowCountryCode['phone_number']);
			
			$subject='You have an invitation for checkin';
			$to=$phone;
			$html='Hi you have invitation to checkin in hotel : '.$rowInfo['hotel_name'].' from '.$rowInfo['name'].'. please open link in browser and use dstrict and Qloud ID app to verify using code :'.$rowCountryCode['verification_code'].' '.$surl;
			//echo $html; die;
			$res=sendSms($subject, $to, $html);
			 
			$stmt->close();
			$dbCon->close();
			return 1;
		}
		
		
		function resendEmailIinviteAdultForCheckin($data)
		{
			 
			$dbCon = AppModel::createConnection();
			 
			 
			$stmt = $dbCon->prepare("select buyer_id,is_buyer_company,hotel_checkout_detail.user_id,visiting_address,port_number,visiting_city,visiting_state,property_location.id as p_id,room_type_id,total_days,price,hotel_name,fdesk_country_code,fdesk_phone_number from hotel_checkout_detail left join company_hotel_room_type_detail on company_hotel_room_type_detail.id= hotel_checkout_detail.room_type_id left join hotel_basic_information on hotel_basic_information.property_id=company_hotel_room_type_detail.location_id left join property_location on property_location.id=hotel_basic_information.property_id where hotel_checkout_detail.id=(select hotel_checkout_id from hotel_checkout_invitation_info where id=?)");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowInfo = $result->fetch_assoc();
			 
			$stmt = $dbCon->prepare("select * from hotel_images where property_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $rowInfo['p_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowImage = $result->fetch_assoc();
			
			$filename="../estorecss/".$rowImage['image_path'].".txt"; $value_a=file_get_contents("../estorecss/".$rowImage['image_path'].".txt"); $value_a=str_replace('"','',$value_a); $rowImage['image_path'] = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$rowImage['image_path'].'.jpg' );
			$rowInfo['image_path']=str_replace('../','https://www.safeqloud.com/',$rowImage['image_path']);
			
			$stmt = $dbCon->prepare("select concat_ws(' ', first_name,last_name) as name,email from user_logins where id = ?");
        
				/* bind parameters for markers */
			$stmt->bind_param("i", $rowInfo['user_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowUser    = $result->fetch_assoc();
				 
		  
			 
			$stmt = $dbCon->prepare("select country_code,phone_number,verification_code,email from hotel_checkout_invitation_info where id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['id']);
			$stmt->execute();
			$resultCode = $stmt->get_result();
			
			$rowCountryCode = $resultCode->fetch_assoc();
			 
			$code=$rowCountryCode['verification_code'];
			 $data['email']=$rowCountryCode['email'];
			 $id1=$this -> encrypt_decrypt('encrypt',$data['id']); 
			 if(isset($data['precheck']))
			{
			$url="https://www.dstricts.com/public/index.php/Hotel/verifyInvitationPreCheckin/".$id1;	
			}
			else
			{
			$url="https://www.dstricts.com/public/index.php/Hotel/verifyInvitationCheckin/".$id1;	
			}
			 
			$surl=getShortUrl($url);
			
			$to      = $data['email'];
			$emailContent='<html xmlns="http://www.w3.org/1999/xhtml" style="background-color: rgb(240, 240, 240);"><head>
					  <title>Reservation confirmed</title>
					  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
					  <meta charset="utf-8">
					  <meta name="viewport" content="width=device-width, initial-scale=1">
					  <meta http-equiv="X-UA-Compatible" content="IE=edge">
					  <style type="text/css">
						/* GT AMERICA */

						@font-face {
						  font-display: fallback;
						  font-family: "GT America Regular";
						  font-weight: 400;
						  src: url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Regular.woff2") format("woff2"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Regular.woff") format("woff"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Regular.ttf") format("truetype");
						}

						@font-face {
						  font-display: fallback;
						  font-family: "GT America Medium";
						  font-weight: 600;
						  src: url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Medium.woff2") format("woff2"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Medium.woff") format("woff"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Medium.ttf") format("truetype");
						}

						@font-face {
						  font-display: fallback;
						  font-family: "GT America Condensed Bold";
						  font-weight: 700;
						  src: url("https://www.exploretock.com/fonts/gt-america/GT-America-Condensed-Bold.woff2") format("woff2"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Condensed-Bold.woff") format("woff"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Condensed-Bold.ttf") format("truetype");
						}

						/* CLIENT-SPECIFIC RESET */

						body,
						table,
						td,
						a {
						  -webkit-text-size-adjust: 100%;
						  -ms-text-size-adjust: 100%;
						}

						/* Prevent WebKit and Windows mobile changing default text sizes */

						table,
						td {
						  mso-table-lspace: 0pt;
						  mso-table-rspace: 0pt;
						}

						/* Remove spacing between tables in Outlook 2007 and up */

						img {
						  -ms-interpolation-mode: bicubic;
						}

						/* Allow smoother rendering of resized image in Internet Explorer */

						.im {
						  color: inherit !important;
						}

						/* DEVICE-SPECIFIC RESET */

						a[x-apple-data-detectors] {
						  color: inherit !important;
						  text-decoration: none !important;
						  font-size: inherit !important;
						  font-family: inherit !important;
						  font-weight: inherit !important;
						  line-height: inherit !important;
						}

						/* iOS BLUE LINKS */

						/* RESET */

						img {
						  border: 0;
						  height: auto;
						  line-height: 100%;
						  outline: none;
						  text-decoration: none;
						  display: block;
						}

						table {
						  border-collapse: collapse;
						}

						table td {
						  border-collapse: collapse;
						  display: table-cell;
						}

						body {
						  height: 100% !important;
						  margin: 0 !important;
						  padding: 0 !important;
						  width: 100% !important;
						}

						/* BG COLORS */

						.mainTable {
						  background-color: #F0F0F0;
						}

						.mainTable--hospitality {
						  background-color: #f7f2ed;
						}

						html {
						  background-color: #F0F0F0;
						}

						/* VARIABLES */

						.bg-white {
						  background-color: white;
						}

						.hr {
						  /* Cross-client horizontal rule. Adapted from https://litmus.com/community/discussions/4633-is-there-a-reliable-1px-horizontal-rule-method */
						  background-color: #d3d3d8;
						  border-collapse: collapse;
						  mso-table-lspace: 0pt;
						  mso-table-rspace: 0pt;
						  mso-line-height-rule: exactly;
						  line-height: 1px;
						}

						.textAlignLeft {
						  text-align: left !important;
						}

						.textAlignRight {
						  text-align: right !important;
						}

						.textAlignCenter {
						  text-align: center !important;
						}

						.mt1 {
						  margin-top: 6px;
						}

						.list {
						  padding-left: 18px;
						  margin: 0;
						}

						/* TYPOGRAPHY */

						body {
						  font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
						  font-weight: 400;
						  color: #4f4f65;
						  -webkit-font-smoothing: antialiased;
						  -ms-text-size-adjust: 100%;
						  -moz-osx-font-smoothing: grayscale;
						  font-smoothing: always;
						  text-rendering: optimizeLegibility;
						}

						.h1 {
						  font-family: "GT America Condensed Bold", "Roboto Condensed", "Roboto", "Helvetica", "Arial", sans-serif;
						  font-weight: 700;
						  vertical-align: middle;
						  font-size: 36px;
						  line-height: 42px;
						}

						.h2 {
						  font-family: "GT America Medium", "Roboto", "Helvetica", "Arial", sans-serif;
						  font-weight: 600;
						  vertical-align: middle;
						  font-size: 16px;
						  line-height: 24px;
						}

						.text {
						  font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
						  font-weight: 400;
						  font-size: 16px;
						  line-height: 21px;
						}

						.text-list {
						  font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
						  font-weight: 400;
						  font-size: 16px;
						  line-height: 25px;
						}

						.textSmall {
						  font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
						  font-weight: 400;
						  font-size: 14px;
						}

						.text-xsmall {
						  font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
						  font-size: 11px;
						  text-transform: uppercase;
						  line-height: 22px;
						  letter-spacing: 1px;
						}

						.text-bold {
						  font-weight: 600;
						}

						.text-link {
						  text-decoration: underline;
						}

						.text-linkNoUnderline {
						  text-decoration: none;
						}

						.text-strike {
						  text-decoration: line-through;
						}

						/* FONT COLORS */

						.textColorDark {
						  color: #23233e;
						}

						.textColorNormal {
						  color: #4f4f65;
						}

						.textColorBlue {
						  color: #2020c0;
						}

						.textColorGrayDark {
						  color: #7B7B8B;
						}

						.textColorGray {
						  color: #A5A8AD;
						}

						.textColorWhite {
						  color: #FFFFFF;
						}

						.textColorRed {
						  color: #df3232;
						}

						/* BUTTON */

						.Button-primary-wrapper {
						  border-radius: 3px;
						  background-color: #2020C0;
						}

						.Button-primary {
						  font-family: "GT America Medium", "Roboto", "Helvetica", "Arial", sans-serif;
						  border-radius: 3px;
						  border: 1px solid #2020C0;
						  color: #ffffff;
						  display: block;
						  font-size: 16px;
						  font-weight: 600;
						  padding: 18px;
						  text-decoration: none;
						}

						.Button-secondary-wrapper {
						  border-radius: 3px;
						  background-color: #ffffff;
						}

						.Button-secondary {
						  font-family: "GT America Medium", "Roboto", "Helvetica", "Arial", sans-serif;
						  border-radius: 3px;
						  border: 1px solid #2020C0;
						  color: #2020C0;
						  display: block;
						  font-size: 16px;
						  font-weight: 600;
						  padding: 18px;
						  text-decoration: none;
						}

						/* LAYOUT */

						.Content-container {
						  padding-left: 60px;
						  padding-right: 60px;
						}

						.Content-container--main {
						  padding-top: 54px;
						  padding-bottom: 60px;
						}

						.Content {
						  width: 580px;
						  margin: 0 auto;
						}

						.wrapper {
						  max-width: 600px;
						}

						.section {
						  padding: 24px 0px;
						  border-bottom: 1px solid #d3d3d8;
						}

						.section--noBorder {
						  padding: 24px 0px 0;
						}

						.section--last {
						  padding: 24px 0px;
						}

						.message {
						  background-color: #F4F4F5;
						  padding: 18px;
						}

						.card {
						  border: 1px solid #d3d3d8;
						  padding: 18px;
						}

						/* HEADER */

						.header-tockLogoImage {
						  display: block;
						  color: #F0F0F0;
						}

						.header-heroImage {
						  padding-bottom: 24px;
						}

						/* PREHEADER */

						.preheader {
						  display: none;
						  font-size: 1px;
						  color: #FFFFFF;
						  line-height: 1px;
						  max-height: 0px;
						  max-width: 0px;
						  opacity: 0;
						  overflow: hidden;
						}

						/* BANNER */

						.notice {
						  padding: 12px;
						  background: #23233E;
						  color: #FFFFFF;
						  display: block;
						  font-size: 14px;
						  font-family: "GT America Medium", "Roboto", "Helvetica", "Arial", sans-serif;
						  font-weight: 600;
						}

						/* INTRO */

						.section--intro {
						  padding-bottom: 48px;
						}

						/* BOOKING INFO */

						.business-logo__container {
						  width: 48px;
						  height: 48px;
						  border-radius: 3px;
						  border: 1px solid #d3d3d8;
						  overflow: hidden;
						}

						.business-logo__image {
						  border: 1px solid transparent;
						  border-radius: 3px;
						  width: 48px;
						  height: 48px;
						  display: block;
						}

						.business-address--address {
						  width: 50%;
						}

						.business-address--map {
						  width: 50%;
						}

						.business-address--map-image {
						  width: 100%;
						}

						/* MOBILE TICKETS */

						.mobile-ticket--description {
						  width: 65%;
						  margin-top: 12px;
						  margin-right: 5%;
						}

						.mobile-ticket--code {
						  width: 30%;
						}

						.mobile-ticket--code-image {
						  width: 100%;
						}

						/* RESERVATION ACTIONS */

						.linksTable {
						  border-bottom: 1px solid #d3d3d8;
						}

						.linksTableRow {
						  padding: 24px 12px;
						}

						.actions-icon {
						  vertical-align: middle;
						}

						.actions-text {
						  vertical-align: middle;
						}

						/* RECEIPT */

						.receipt__container {
						  border: 1px solid #d3d3d8;
						  padding: 24px;
						}

						.receipt__row {
						  border-top: 1px solid #d3d3d8;
						}

						/* FEEDBACK ICONS */

						.feedback-link {
						  border: 1px solid #d4d5da;
						  border-radius: 3px;
						  display: inline-block;
						  width: calc(32% - 2px);
						  padding: 10px 0;
						}

						.feedback-link-bumper {
						  display: inline-block;
						  width: 1%;
						}

						.feedback-link img {
						  height: 50px;
						  width: 50px;
						}

						/* SOCIAL ICONS */

						.social-link {
						  display: inline-block;
						  width: auto;
						}

						.social-link-text {
						  padding: 14px 24px 14px 14px;
						}

						/* TABLET STYLES */

						@media screen and (max-width: 648px) {
						  /* DEVICE-SPECIFIC RESET */
						  div[style*="margin: 16px 0;"] {
							margin: 0 !important;
						  }
						  /* ANDROID CENTER FIX */
						  /* LAYOUT */
						  .wrapper {
							width: 100% !important;
							max-width: 100% !important;
						  }
						  .Content {
							width: 90% !important;
						  }
						  .Content-container {
							padding-left: 36px !important;
							padding-right: 36px !important;
						  }
						  .Content-container--main {
							padding-top: 30px !important;
							padding-bottom: 42px !important;
						  }
						  .responsiveTable {
							width: 100% !important;
						  }
						  /* RESERVATION ACTIONS */
						  .linksTableRow {
							padding-left: 0 !important;
							padding-right: 0 !important;
							padding-top: 12px !important;
							padding-bottom: 12px !important;
						  }
						  .linksTableRow--borderRight {
							border-right: none !important;
							padding-left: 0 !important;
							padding-right: 0 !important;
						  }
						  /* FEEDBACK LINK */
						  .feedback-link img {
							height: 38px !important;
							width: 38px !important;
						  }
						}

						/* MOBILE STYLES */

						@media screen and (max-width: 480px) {
						  /* TYPOGRAPHY */
						  .h1 {
							font-size: 30px !important;
							line-height: 30px !important;
						  }
						  .text {
							font-size: 16px !important;
							line-height: 22px !important;
						  }
						  /* BUTTON */
						  .mobile-buttonContainer {
							width: 100% !important;
						  }
						  /* LAYOUT */
						  .Content {
							width: 100% !important;
						  }
						  .Content-container {
							padding-left: 18px !important;
							padding-right: 18px !important;
						  }
						  .Content-container--main {
							padding-top: 24px !important;
							padding-bottom: 30px !important;
						  }
						  .section {
							padding: 18px 0 !important;
						  }
						  .section--last {
							padding: 18px 0 !important;
						  }
						  .header {
							padding: 0 18px !important;
						  }
						  .business-address--address {
							width: 100% !important;
						  }
						  .business-address--map {
							margin-top: 30px !important;
							width: 100% !important;
						  }
						  .mobile-ticket--description {
							width: 100% !important;
							margin-top: 0px !important;
						  }
						  .mobile-ticket--code {
							margin-top: 30px !important;
							margin-left: 0;
							width: 100% !important;
						  }
						  /* RECEIPT */
						  .receipt__container {
							padding: 12px !important;
						  }
						  /* SOCIAL ICONS */
						  .social-link {
							display: block !important;
							width: 100% !important;
							border-bottom: 1px solid #d3d3d8 !important;
						  }
						  /* INTRO */
						  .section--intro {
							padding-top: 18px !important;
							padding-bottom: 18px !important;
						  }
						}
					  </style>
					</head>

					<body style="margin: 0 !important; padding: 0 !important; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; height: 100%; margin: 0; padding: 0; width: 100%; font-family: &quot;GT America Regular&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-weight: 400; color: rgb(79, 79, 101); -webkit-font-smoothing: antialiased; -ms-text-size-adjust: 100%; -moz-osx-font-smoothing: grayscale; font-smoothing: always; text-rendering: optimizeLegibility;">
					   
					  <!--[if mso]>
						<style type="text/css">
					.h1 {font-family: "Helvetica", "Arial", sans-serif !important; font-weight: 700 !important; vertical-align: middle !important; font-size: 36px !important; mso-line-height-rule: exactly;line-height: 42px !important;}
					.h2 {font-family: "Helvetica", "Arial", sans-serif !important;font-weight: 600 !important;vertical-align: middle !important;font-size: 16px !important;mso-line-height-rule: exactly;line-height: 24px !important;}
					.text {font-family: "Helvetica", "Arial", sans-serif !important;font-weight: 400 !important;font-size: 16px !important;mso-line-height-rule: exactly;line-height: 21px !important;}
					.text-list {font-family: "Helvetica", "Arial", sans-serif !important;font-weight: 400 !important;font-size: 16px !important;mso-line-height-rule: exactly;line-height: 25px !important;}
					.textSmall {font-family: "Helvetica", "Arial", sans-serif !important;font-weight: 400 !important;font-size: 14px !important;}
					.text-xsmall {font-family: "Helvetica", "Arial", sans-serif !important;font-size: 11px !important;text-transform: uppercase !important;mso-line-height-rule: exactly;line-height: 22px !important;letter-spacing: 1px !important;}
					.text-bold {font-weight: 600 !important;}
					.text-link {text-decoration: underline !important;}
					.text-linkNoUnderline {text-decoration: none !important;}
					.text-strike {text-decoration: line-through !important;}
					.textColorDark {color: #23233e !important;}
					.textColorNormal {color: #4f4f65 !important;}
					.textColorBlue {color: #2020c0 !important;}
					.textColorGray {color: #A5A8AD !important;}
					.textColorWhite {color: #FFFFFF !important;}
					.Button-primary {font-family: "Helvetica", "Arial", sans-serif !important;border-radius: 3px !important;border: 1px solid #2020C0 !important;color: #ffffff !important;display: block !important;font-size: 16px !important;font-weight: 600 !important;padding: 18px !important;text-decoration: none !important;}
					.Button-secondary {font-family: "Helvetica", "Arial", sans-serif !important;border-radius: 3px !important;border: 1px solid #2020C0 !important;color: #2020C0 !important;display: block !important;font-size: 16px !important;font-weight: 600 !important;padding: 18px !important;text-decoration: none !important;}
						</style>
						<![endif]-->
					  <!-- HIDDEN PREHEADER TEXT -->
					  <div class="preheader" style="display: none; font-size: 1px; color: rgb(255, 255, 255); line-height: 1px; max-height: 0px; max-width: 0px; opacity: 0; overflow: hidden;">
					  </div>
					  <table border="0" cellpadding="0" cellspacing="0" width="100%" class=" mainTable  " style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; background-color: rgb(240, 240, 240);">
						<tbody><tr><td style="display:none !important;
					 visibility:hidden;
					 mso-hide:all;
					 font-size:1px;
					 color:#ffffff;
					 line-height:1px;
					 max-height:0px;
					 max-width:0px;
					 opacity:0;
					 overflow:hidden; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;"> We are thrilled that you will be joining us. If yo... </td>
						<!-- HEADER -->
						</tr><tr>
						  <td align="center" class="header" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
							<!--[if (gte mso 9)|(IE)]>
						<table align="center" border="0" cellspacing="0" cellpadding="0" width="600">
						<tr>
						<td align="center" valign="top" width="600">
						<![endif]-->
							<table border="0" cellpadding="0" cellspacing="0" width="100%" class="Content" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; width: 580px; margin: 0 auto;">
							  <tbody><tr class="spacer">
								<td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
							  </tr>
							  <tr class="spacer">
								<td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
							  </tr>
							  <tr>
								<td align="left" valign="middle" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;"> <h1 style="font-size: 33px;font-weight: 800;line-height: 30px;">Dstricts</h1>               </td>
							  </tr>
							  <tr class="spacer">
								<td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
							  </tr>
							  <tr class="spacer">
								<td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
							  </tr>
							</tbody></table>
							<!--[if (gte mso 9)|(IE)]>
						</td>
						</tr>
						</table>
						<![endif]-->
						  </td>
						</tr>
						<!-- CONTENT -->
						<tr>
						  <td align="center" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
							<!--[if (gte mso 9)|(IE)]>
						<table align="center" border="0" cellspacing="0" cellpadding="0" width="600">
						<tr>
						<td align="center" valign="top" width="600">
						<![endif]-->
							<table border="0" cellpadding="0" cellspacing="0" width="100%" class="Content bg-white" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; background-color: white; width: 580px; margin: 0 auto;">
							  <tbody><tr>
								<td class="Content-container Content-container--main text textColorNormal" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell; font-family: &quot;GT America Regular&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-weight: 400; font-size: 16px; line-height: 21px; color: rgb(79, 79, 101); padding-left: 60px; padding-right: 60px; padding-top: 54px; padding-bottom: 60px;">
								  <table width="100%" border="0" cellspacing="0" cellpadding="0" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
									<!-- RESTAURANT INFO -->
									<tbody><tr>
									  <td valign="top" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
										<table align="left" border="0" cellpadding="0" cellspacing="0" width="100%" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
										  <tbody><tr>
											<td align="left" valign="center" width="48" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
											  <div class="business-logo__container" style="width: 48px; height: 48px; border-radius: 3px; border: 1px solid rgb(211, 211, 216); overflow: hidden;">
												<img src="'.$rowImage['image_path'].'" class="business-logo__image" width="48" height="48" alt="Logo" style="-ms-interpolation-mode: bicubic; border: 0; height: auto; line-height: 100%; outline: none; text-decoration: none; display: block; border: 1px solid transparent; border-radius: 3px; width: 48px; height: 48px; display: block;">
											  </div>
											</td>
											<td width="12" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
											<td align="left" valign="middle" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;"> <span class="h2 textColorDark" style="font-family: &quot;GT America Medium&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-weight: 600; vertical-align: middle; font-size: 16px; line-height: 24px; color: rgb(35, 35, 62);">'.$rowInfo["hotel_name"].'</span>                          </td>
										  </tr>
										  <tr class="spacer">
											<td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
										  </tr>
										  <tr class="spacer">
											<td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
										  </tr>
										</tbody></table>
									  </td>
									</tr>
									<!-- INTRO -->
									<tr>
									  <td valign="top" align="left" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
										<table width="100%" border="0" cellspacing="0" cellpadding="0" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
										  <tbody><tr>
											<td align="left" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;"> <span class="h1 textColorDark" style="font-family: &quot;GT America Condensed Bold&quot;, &quot;Roboto Condensed&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-weight: 700; vertical-align: middle; font-size: 36px; line-height: 42px; color: rgb(35, 35, 62);">Invitation received</span>                          </td>
										  </tr>
										  <tr class="spacer">
											<td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
										  </tr>
										  <tr>
											<td align="left" colspan="2" valign="top" width="100%" height="1" class="hr" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell; background-color: rgb(211, 211, 216); border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; mso-line-height-rule: exactly; line-height: 1px;">
											  <!--[if gte mso 15]>&nbsp;<![endif]-->
											</td>
										  </tr>
										  <tr class="spacer">
											<td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
										  </tr>
										</tbody></table>
									  </td>
									</tr>
									<!-- MESSAGE -->
									<tr class="spacer">
									  <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
									</tr>
									<tr>
									  <td align="left" class="message" valign="top" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell; background-color: rgb(244, 244, 245); padding: 18px;">
										<div class="text textColorNormal" style="font-family: &quot;GT America Regular&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-weight: 400; font-size: 16px; line-height: 21px; color: rgb(79, 79, 101);">
										  <span class="text-bold textColorDark" style="font-weight: 600; color: rgb(35, 35, 62);">A message from '.$rowInfo["name"].'</span>
										  <br>I have successfully checked in the hotel. I am waiting for you to check in here using your dstrict app. Find the link to check in using the confirmation code </div>
									  </td>
									</tr>
									<tr class="spacer">
									  <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
									</tr>
									<tr class="spacer">
									  <td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
									</tr>
									<tr>
									  <td align="left" colspan="2" valign="top" width="100%" height="1" class="hr" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell; background-color: rgb(211, 211, 216); border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; mso-line-height-rule: exactly; line-height: 1px;">
										<!--[if gte mso 15]>&nbsp;<![endif]-->
									  </td>
									</tr>
									<tr class="spacer">
									  <td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
									</tr>
									<!-- BOOKING INFO -->
									<tr>
									  <td valign="top" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
										<table align="left" border="0" cellpadding="0" cellspacing="0" width="100%" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
										  <tbody><tr>
											<td align="left" valign="middle" width="468" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
											  <div class="text-list textColorNormal" style="font-family: &quot;GT America Regular&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-weight: 400; font-size: 16px; line-height: 25px; color: rgb(79, 79, 101);">
												<span class="text-bold textColorDark" style="font-weight: 600; color: rgb(35, 35, 62);">'.date("F j, Y, g:i a").'</span>
												<br> Party of 2 for Smiles Davis 
												<br> Confirmation code #: '.$code.'
												<br> Reservation × 2
												<br>
											  </div>
											</td>
										  </tr>
										  <tr class="spacer">
											<td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
										  </tr>
										  <tr class="spacer">
											<td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
										  </tr>
										  

					<tr>
											<td align="center" valign="center" width="100%" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
											  <table border="0" cellspacing="0" cellpadding="0" width="100%" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
												<tbody><tr>
												  <td align="center" valign="center" width="100%" class="Button-primary-wrapper" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell; border-radius: 3px; background-color: rgb(32, 32, 192);">
												  <a href="'.$url.'" target="_blank" class="Button-primary" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; font-family: &quot;GT America Medium&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; border-radius: 3px; border: 1px solid rgb(32, 32, 192); color: rgb(255, 255, 255); display: block; font-size: 16px; font-weight: 600; padding: 18px; text-decoration: none;"> Manage your reservation </a>                                </td>
												</tr>
											  </tbody></table>
											</td>
										  </tr><tr class="spacer">
											<td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
										  </tr>

					<tr class="spacer">
											<td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
										  </tr>

					<tr>
											<td align="center" valign="center" width="100%" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
											  <table border="0" cellspacing="0" cellpadding="0" width="100%" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
												<tbody><tr>
												  <td align="center" valign="center" width="100%" class="Button-primary-wrapper" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell; border-radius: 3px; background-color: rgb(32, 32, 192);">
												  <a href="'.$url.'" target="_blank" class="Button-primary" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; font-family: &quot;GT America Medium&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; border-radius: 3px; border: 1px solid rgb(32, 32, 192); color: rgb(255, 255, 255); display: block; font-size: 16px; font-weight: 600; padding: 18px; text-decoration: none;"> Checkin with app</a>                                </td>
												</tr>
											  </tbody></table>
											</td>
										  </tr>
										</tbody></table>
									  </td>
									</tr>
									<!-- ADDRESS -->
									<tr>
									  <td align="center" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
										<table border="0" cellpadding="0" cellspacing="0" width="100%" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
										  <tbody><tr class="spacer">
											<td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
										  </tr>
										  <tr class="spacer">
											<td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
										  </tr>
										  <tr>
											<td align="left" colspan="2" valign="top" width="100%" height="1" class="hr" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell; background-color: rgb(211, 211, 216); border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; mso-line-height-rule: exactly; line-height: 1px;">
											  <!--[if gte mso 15]>&nbsp;<![endif]-->
											</td>
										  </tr>
										  <tr class="spacer">
											<td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
										  </tr>
										  <tr class="spacer">
											<td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
										  </tr>
										  <tr>
											<td align="left" valign="middle" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
											  <table border="0" cellpadding="0" cellspacing="0" width="100%" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
												<tbody><tr>
												  <td style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
													<table align="left" border="0" cellpadding="0" cellspacing="0" width="230" class="business-address--address" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; width: 50%;">
													  <tbody><tr>
														<td align="left" width="100%" class="text-list textColorNormal" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell; font-family: &quot;GT America Regular&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-weight: 400; font-size: 16px; line-height: 25px; color: rgb(79, 79, 101);">
														<span class="h2 textColorDark" style="font-family: &quot;GT America Medium&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-weight: 600; vertical-align: middle; font-size: 16px; line-height: 24px; color: rgb(35, 35, 62);">'.$rowInfo["hotel_name"].'</span><br>'.$rowInfo["visiting_address"].' '.$rowInfo["port_number"].'<br>'.$rowInfo["visiting_city"].' '.$rowInfo["visiting_state"].'<br> <a href="tel:+' .$rowInfo[" fdesk_country_code"].'="" '.$rowinfo["fdesk_phone_number"].'"="">+'.$rowInfo["fdesk_country_code"].' '.$rowInfo["fdesk_phone_number"].'</a><br> <br> <a href="https://www.google.com/maps/dir//'.$rowInfo['visiting_address'].' '.$rowInfo['port_number'].'/" class="text text-link textColorBlue" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; font-family: &quot;GT America Regular&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-weight: 400; font-size: 16px; line-height: 21px; text-decoration: underline; color: rgb(32, 32, 192);" target="_blank">Get directions</a>                                      </td>
													  </tr>
													</tbody></table>
													<!--[if mso]></td><td><![endif]-->
													<table align="right" border="0" cellpadding="0" cellspacing="0" width="230" class="business-address--map" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; width: 50%;">
													  <tbody><tr>
														<td width="100%" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;"> <a href="https://www.google.com/maps/dir//1350+W+Randolph%2C+Chicago%2C+IL%2C+US+60607/" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%;"> <img width="230" class="business-address--map-image" height="auto" alt="Map of Elske" src="https://maps.googleapis.com/maps/api/staticmap?key=AIzaSyCPd%2DxSabI7QOfKX5NxVVup6bPfcovwFiQ&amp;center=1350+W+Randolph%2C+Chicago%2C+IL%2C+US+60607&amp;size=300x200&amp;zoom=15&amp;scale=2&amp;format=png&amp;visual%5Frefresh=true&amp;markers=scale%3A2%7Cicon%3Ahttps%3A%2F%2Fstorage.googleapis.com%2Ftock%2Dpublic%2Dassets%2Fimages%2Demail%2Dtemplate%2Femail%2Dmap%2Dmarker.png%7Cshadow%3Afalse%7C1350+W+Randolph%2C+Chicago%2C+IL%2C+US+60607&amp;style=feature%3Aall%7Celement%3Alabels.text.fill%7Ccolor%3A0x4b505b&amp;style=feature%3Aall%7Celement%3Alabels.text.stroke%7Ccolor%3A0xffffff%7Cvisibility%3Aon&amp;style=feature%3Aadministrative.land%5Fparcel%7Celement%3Aall%7Cvisibility%3Aoff&amp;style=feature%3Alandscape.man%5Fmade%7Celement%3Aall%7Cvisibility%3Aon&amp;style=feature%3Alandscape.man%5Fmade%7Celement%3Ageometry.fill%7Ccolor%3A0xe9e9eb&amp;style=feature%3Apoi%7Celement%3Aall%7Cvisibility%3Aoff&amp;style=feature%3Aroad%7Celement%3Ageometry.fill%7Ccolor%3A0xffffff&amp;style=feature%3Aroad%7Celement%3Alabels.text.fill%7Ccolor%3A0x787c84&amp;style=feature%3Aroad%7Celement%3Alabels.icon%7Cvisibility%3Aoff&amp;style=feature%3Aroad.highway%7Celement%3Ageometry.fill%7Ccolor%3A0xffbe32&amp;style=feature%3Aroad.highway%7Celement%3Ageometry.stroke%7Ccolor%3A0xffbe32&amp;style=feature%3Atransit%7Celement%3Alabels.text.fill%7Cvisibility%3Aon%7Ccolor%3A0x787c84&amp;style=feature%3Atransit.line%7Celement%3Ageometry.fill%7Ccolor%3A0xd2d4d6&amp;signature=3yCSyIXfsSilvB5wcd4OElw40QU=" style="-ms-interpolation-mode: bicubic; border: 0; height: auto; line-height: 100%; outline: none; text-decoration: none; display: block; width: 100%;"> </a>                                      </td>
													  </tr>
													</tbody></table>
												  </td>
												</tr>
											  </tbody></table>
											</td>
										  </tr>
										</tbody></table>
									  </td>
									</tr>
									<tr class="spacer">
									  <td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
									</tr>
									<tr class="spacer">
									  <td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
									</tr>
									<tr>
									  <td align="left" colspan="2" valign="top" width="100%" height="1" class="hr" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell; background-color: rgb(211, 211, 216); border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; mso-line-height-rule: exactly; line-height: 1px;">
										<!--[if gte mso 15]>&nbsp;<![endif]-->
									  </td>
									</tr>
									
									
									<!-- RECEIPT -->
									
									<tr class="spacer">
									  <td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
									</tr>
									<tr class="spacer">
									  <td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
									</tr>
									<!-- EDIT RECEIPT -->
									<!-- CANCELLATION POLICY -->
									<tr>
									  <td valign="top" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
										<table border="0" cellpadding="0" cellspacing="0" width="100%" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
										  <tbody><tr>
											<td align="left" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
											  <div class="text text-bold textColorDark" style="font-family: &quot;GT America Regular&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-weight: 400; font-size: 16px; line-height: 21px; font-weight: 600; color: rgb(35, 35, 62);">
												Cancellation policy
											  </div>
											</td>
										  </tr>
										  <tr>
											<td align="left" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
											  <div class="text textColorNormal mt1" style="margin-top: 6px; font-family: &quot;GT America Regular&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-weight: 400; font-size: 16px; line-height: 21px; color: rgb(79, 79, 101);">
												<span>This invitation can be accepted only if you have installed dstrict and Qloud ID pay. </span>
												<span>You can not transfer your invitation to another person.</span>
											  </div>
											</td>
										  </tr>
										</tbody></table>
									  </td>
									</tr>
									<tr class="spacer">
									  <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
									</tr>
									<tr class="spacer">
									  <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
									</tr>
									<!-- QUESTIONS -->
									<tr>
									  <td valign="top" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
										<table border="0" cellpadding="0" cellspacing="0" width="100%" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
										  <tbody><tr>
											<td align="left" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
											  <div class="text text-bold textColorDark" style="font-family: &quot;GT America Regular&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-weight: 400; font-size: 16px; line-height: 21px; font-weight: 600; color: rgb(35, 35, 62);">
												Questions?
											  </div>
											</td>
										  </tr>
										  <tr>
											<td align="left" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
											  <div class="text textColorNormal mt1" style="margin-top: 6px; font-family: &quot;GT America Regular&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-weight: 400; font-size: 16px; line-height: 21px; color: rgb(79, 79, 101);">
												If you have questions about your reservation, contact us at&nbsp;
												<a href="mailto:'.$rowInfo['fdesk_email'].'">'.$rowInfo["fdesk_email"].'</a>                            or by calling
												<a href="tel:+'.$rowInfo[" fdesk_country_code"].'="" '.$rowinfo["fdesk_phone_number"].'"="">+'.$rowInfo["fdesk_country_code"].' '.$rowInfo["fdesk_phone_number"].'</a>.
											  </div>
											</td>
										  </tr>
										</tbody></table>
									  </td>
									</tr>
								  </tbody></table>
								</td>
							  </tr>
							</tbody></table>
						  </td>
						</tr>
						<!-- FOOTER -->
						<tr>
						  <td align="center" class="Content" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell; width: 580px; margin: 0 auto;">
							<!-- Will most likely required a feature flag -->
							<!--[if (gte mso 9)|(IE)]>
					<table align="center" border="0" cellspacing="0" cellpadding="0" width="600">
					<tr>
					<td align="center" valign="top" width="600">
					<![endif]-->
							<table width="100%" border="0" cellspacing="0" cellpadding="0" align="center" class="Content-container" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; padding-left: 60px; padding-right: 60px;">
							  <tbody><tr class="spacer">
								<td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
							  </tr>
							  <tr class="spacer">
								<td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
							  </tr>
							  <tr class="spacer">
								<td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
							  </tr>
							  <tr>
								<td align="center" valign="top" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;"> <a href="https://www.exploretock.com" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%;"> <img src="https://storage.googleapis.com/tock-public-assets/images-email-template/tock-brandmark-color.png" width="30" height="30" alt="Tock" border="0" style="-ms-interpolation-mode: bicubic; border: 0; height: auto; line-height: 100%; outline: none; text-decoration: none; display: block;"> </a>              </td>
							  </tr>
							  <tr class="spacer">
								<td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
							  </tr>
							  <tr>
								<td align="center" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
								  <div class="text-xsmall textColorNormal" style="font-family: &quot;GT America Regular&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-size: 11px; text-transform: uppercase; line-height: 22px; letter-spacing: 1px; color: rgb(79, 79, 101);">
									© 2019 Tock, Inc.
								  </div>
								  <div class="text-xsmall textColorNormal" style="font-family: &quot;GT America Regular&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-size: 11px; text-transform: uppercase; line-height: 22px; letter-spacing: 1px; color: rgb(79, 79, 101);">
									All Rights Reserved
								  </div>
								</td>
							  </tr>
							  <tr class="spacer">
								<td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
							  </tr>
							  <tr class="spacer">
								<td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
							  </tr>
							  <tr class="spacer">
								<td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
							  </tr>
							</tbody></table>
							<!--[if (gte mso 9)|(IE)]>
					</td>
					</tr>
					</table>
					<![endif]-->
						  </td>
						</tr>
					  </tbody></table><title>Reservation confirmed</title>
					  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
					  <meta charset="utf-8">
					  <meta name="viewport" content="width=device-width, initial-scale=1">
					  <meta http-equiv="X-UA-Compatible" content="IE=edge">
					  <style type="text/css">
						/* GT AMERICA */

						@font-face {
						  font-display: fallback;
						  font-family: "GT America Regular";
						  font-weight: 400;
						  src: url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Regular.woff2") format("woff2"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Regular.woff") format("woff"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Regular.ttf") format("truetype");
						}

						@font-face {
						  font-display: fallback;
						  font-family: "GT America Medium";
						  font-weight: 600;
						  src: url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Medium.woff2") format("woff2"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Medium.woff") format("woff"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Medium.ttf") format("truetype");
						}

						@font-face {
						  font-display: fallback;
						  font-family: "GT America Condensed Bold";
						  font-weight: 700;
						  src: url("https://www.exploretock.com/fonts/gt-america/GT-America-Condensed-Bold.woff2") format("woff2"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Condensed-Bold.woff") format("woff"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Condensed-Bold.ttf") format("truetype");
						}

						/* CLIENT-SPECIFIC RESET */

						body,
						table,
						td,
						a {
						  -webkit-text-size-adjust: 100%;
						  -ms-text-size-adjust: 100%;
						}

						/* Prevent WebKit and Windows mobile changing default text sizes */

						table,
						td {
						  mso-table-lspace: 0pt;
						  mso-table-rspace: 0pt;
						}

						/* Remove spacing between tables in Outlook 2007 and up */

						img {
						  -ms-interpolation-mode: bicubic;
						}

						/* Allow smoother rendering of resized image in Internet Explorer */

						.im {
						  color: inherit !important;
						}

						/* DEVICE-SPECIFIC RESET */

						a[x-apple-data-detectors] {
						  color: inherit !important;
						  text-decoration: none !important;
						  font-size: inherit !important;
						  font-family: inherit !important;
						  font-weight: inherit !important;
						  line-height: inherit !important;
						}

						/* iOS BLUE LINKS */

						/* RESET */

						img {
						  border: 0;
						  height: auto;
						  line-height: 100%;
						  outline: none;
						  text-decoration: none;
						  display: block;
						}

						table {
						  border-collapse: collapse;
						}

						table td {
						  border-collapse: collapse;
						  display: table-cell;
						}

						body {
						  height: 100% !important;
						  margin: 0 !important;
						  padding: 0 !important;
						  width: 100% !important;
						}

						/* BG COLORS */

						.mainTable {
						  background-color: #F0F0F0;
						}

						.mainTable--hospitality {
						  background-color: #f7f2ed;
						}

						html {
						  background-color: #F0F0F0;
						}

						/* VARIABLES */

						.bg-white {
						  background-color: white;
						}

						.hr {
						  /* Cross-client horizontal rule. Adapted from https://litmus.com/community/discussions/4633-is-there-a-reliable-1px-horizontal-rule-method */
						  background-color: #d3d3d8;
						  border-collapse: collapse;
						  mso-table-lspace: 0pt;
						  mso-table-rspace: 0pt;
						  mso-line-height-rule: exactly;
						  line-height: 1px;
						}

						.textAlignLeft {
						  text-align: left !important;
						}

						.textAlignRight {
						  text-align: right !important;
						}

						.textAlignCenter {
						  text-align: center !important;
						}

						.mt1 {
						  margin-top: 6px;
						}

						.list {
						  padding-left: 18px;
						  margin: 0;
						}

						/* TYPOGRAPHY */

						body {
						  font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
						  font-weight: 400;
						  color: #4f4f65;
						  -webkit-font-smoothing: antialiased;
						  -ms-text-size-adjust: 100%;
						  -moz-osx-font-smoothing: grayscale;
						  font-smoothing: always;
						  text-rendering: optimizeLegibility;
						}

						.h1 {
						  font-family: "GT America Condensed Bold", "Roboto Condensed", "Roboto", "Helvetica", "Arial", sans-serif;
						  font-weight: 700;
						  vertical-align: middle;
						  font-size: 36px;
						  line-height: 42px;
						}

						.h2 {
						  font-family: "GT America Medium", "Roboto", "Helvetica", "Arial", sans-serif;
						  font-weight: 600;
						  vertical-align: middle;
						  font-size: 16px;
						  line-height: 24px;
						}

						.text {
						  font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
						  font-weight: 400;
						  font-size: 16px;
						  line-height: 21px;
						}

						.text-list {
						  font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
						  font-weight: 400;
						  font-size: 16px;
						  line-height: 25px;
						}

						.textSmall {
						  font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
						  font-weight: 400;
						  font-size: 14px;
						}

						.text-xsmall {
						  font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
						  font-size: 11px;
						  text-transform: uppercase;
						  line-height: 22px;
						  letter-spacing: 1px;
						}

						.text-bold {
						  font-weight: 600;
						}

						.text-link {
						  text-decoration: underline;
						}

						.text-linkNoUnderline {
						  text-decoration: none;
						}

						.text-strike {
						  text-decoration: line-through;
						}

						/* FONT COLORS */

						.textColorDark {
						  color: #23233e;
						}

						.textColorNormal {
						  color: #4f4f65;
						}

						.textColorBlue {
						  color: #2020c0;
						}

						.textColorGrayDark {
						  color: #7B7B8B;
						}

						.textColorGray {
						  color: #A5A8AD;
						}

						.textColorWhite {
						  color: #FFFFFF;
						}

						.textColorRed {
						  color: #df3232;
						}

						/* BUTTON */

						.Button-primary-wrapper {
						  border-radius: 3px;
						  background-color: #2020C0;
						}

						.Button-primary {
						  font-family: "GT America Medium", "Roboto", "Helvetica", "Arial", sans-serif;
						  border-radius: 3px;
						  border: 1px solid #2020C0;
						  color: #ffffff;
						  display: block;
						  font-size: 16px;
						  font-weight: 600;
						  padding: 18px;
						  text-decoration: none;
						}

						.Button-secondary-wrapper {
						  border-radius: 3px;
						  background-color: #ffffff;
						}

						.Button-secondary {
						  font-family: "GT America Medium", "Roboto", "Helvetica", "Arial", sans-serif;
						  border-radius: 3px;
						  border: 1px solid #2020C0;
						  color: #2020C0;
						  display: block;
						  font-size: 16px;
						  font-weight: 600;
						  padding: 18px;
						  text-decoration: none;
						}

						/* LAYOUT */

						.Content-container {
						  padding-left: 60px;
						  padding-right: 60px;
						}

						.Content-container--main {
						  padding-top: 54px;
						  padding-bottom: 60px;
						}

						.Content {
						  width: 580px;
						  margin: 0 auto;
						}

						.wrapper {
						  max-width: 600px;
						}

						.section {
						  padding: 24px 0px;
						  border-bottom: 1px solid #d3d3d8;
						}

						.section--noBorder {
						  padding: 24px 0px 0;
						}

						.section--last {
						  padding: 24px 0px;
						}

						.message {
						  background-color: #F4F4F5;
						  padding: 18px;
						}

						.card {
						  border: 1px solid #d3d3d8;
						  padding: 18px;
						}

						/* HEADER */

						.header-tockLogoImage {
						  display: block;
						  color: #F0F0F0;
						}

						.header-heroImage {
						  padding-bottom: 24px;
						}

						/* PREHEADER */

						.preheader {
						  display: none;
						  font-size: 1px;
						  color: #FFFFFF;
						  line-height: 1px;
						  max-height: 0px;
						  max-width: 0px;
						  opacity: 0;
						  overflow: hidden;
						}

						/* BANNER */

						.notice {
						  padding: 12px;
						  background: #23233E;
						  color: #FFFFFF;
						  display: block;
						  font-size: 14px;
						  font-family: "GT America Medium", "Roboto", "Helvetica", "Arial", sans-serif;
						  font-weight: 600;
						}

						/* INTRO */

						.section--intro {
						  padding-bottom: 48px;
						}

						/* BOOKING INFO */

						.business-logo__container {
						  width: 48px;
						  height: 48px;
						  border-radius: 3px;
						  border: 1px solid #d3d3d8;
						  overflow: hidden;
						}

						.business-logo__image {
						  border: 1px solid transparent;
						  border-radius: 3px;
						  width: 48px;
						  height: 48px;
						  display: block;
						}

						.business-address--address {
						  width: 50%;
						}

						.business-address--map {
						  width: 50%;
						}

						.business-address--map-image {
						  width: 100%;
						}

						/* MOBILE TICKETS */

						.mobile-ticket--description {
						  width: 65%;
						  margin-top: 12px;
						  margin-right: 5%;
						}

						.mobile-ticket--code {
						  width: 30%;
						}

						.mobile-ticket--code-image {
						  width: 100%;
						}

						/* RESERVATION ACTIONS */

						.linksTable {
						  border-bottom: 1px solid #d3d3d8;
						}

						.linksTableRow {
						  padding: 24px 12px;
						}

						.actions-icon {
						  vertical-align: middle;
						}

						.actions-text {
						  vertical-align: middle;
						}

						/* RECEIPT */

						.receipt__container {
						  border: 1px solid #d3d3d8;
						  padding: 24px;
						}

						.receipt__row {
						  border-top: 1px solid #d3d3d8;
						}

						/* FEEDBACK ICONS */

						.feedback-link {
						  border: 1px solid #d4d5da;
						  border-radius: 3px;
						  display: inline-block;
						  width: calc(32% - 2px);
						  padding: 10px 0;
						}

						.feedback-link-bumper {
						  display: inline-block;
						  width: 1%;
						}

						.feedback-link img {
						  height: 50px;
						  width: 50px;
						}

						/* SOCIAL ICONS */

						.social-link {
						  display: inline-block;
						  width: auto;
						}

						.social-link-text {
						  padding: 14px 24px 14px 14px;
						}

						/* TABLET STYLES */

						@media screen and (max-width: 648px) {
						  /* DEVICE-SPECIFIC RESET */
						  div[style*="margin: 16px 0;"] {
							margin: 0 !important;
						  }
						  /* ANDROID CENTER FIX */
						  /* LAYOUT */
						  .wrapper {
							width: 100% !important;
							max-width: 100% !important;
						  }
						  .Content {
							width: 90% !important;
						  }
						  .Content-container {
							padding-left: 36px !important;
							padding-right: 36px !important;
						  }
						  .Content-container--main {
							padding-top: 30px !important;
							padding-bottom: 42px !important;
						  }
						  .responsiveTable {
							width: 100% !important;
						  }
						  /* RESERVATION ACTIONS */
						  .linksTableRow {
							padding-left: 0 !important;
							padding-right: 0 !important;
							padding-top: 12px !important;
							padding-bottom: 12px !important;
						  }
						  .linksTableRow--borderRight {
							border-right: none !important;
							padding-left: 0 !important;
							padding-right: 0 !important;
						  }
						  /* FEEDBACK LINK */
						  .feedback-link img {
							height: 38px !important;
							width: 38px !important;
						  }
						}

						/* MOBILE STYLES */

						@media screen and (max-width: 480px) {
						  /* TYPOGRAPHY */
						  .h1 {
							font-size: 30px !important;
							line-height: 30px !important;
						  }
						  .text {
							font-size: 16px !important;
							line-height: 22px !important;
						  }
						  /* BUTTON */
						  .mobile-buttonContainer {
							width: 100% !important;
						  }
						  /* LAYOUT */
						  .Content {
							width: 100% !important;
						  }
						  .Content-container {
							padding-left: 18px !important;
							padding-right: 18px !important;
						  }
						  .Content-container--main {
							padding-top: 24px !important;
							padding-bottom: 30px !important;
						  }
						  .section {
							padding: 18px 0 !important;
						  }
						  .section--last {
							padding: 18px 0 !important;
						  }
						  .header {
							padding: 0 18px !important;
						  }
						  .business-address--address {
							width: 100% !important;
						  }
						  .business-address--map {
							margin-top: 30px !important;
							width: 100% !important;
						  }
						  .mobile-ticket--description {
							width: 100% !important;
							margin-top: 0px !important;
						  }
						  .mobile-ticket--code {
							margin-top: 30px !important;
							margin-left: 0;
							width: 100% !important;
						  }
						  /* RECEIPT */
						  .receipt__container {
							padding: 12px !important;
						  }
						  /* SOCIAL ICONS */
						  .social-link {
							display: block !important;
							width: 100% !important;
							border-bottom: 1px solid #d3d3d8 !important;
						  }
						  /* INTRO */
						  .section--intro {
							padding-top: 18px !important;
							padding-bottom: 18px !important;
						  }
						}
					  </style>



					   
					  <!--[if mso]>
						<style type="text/css">
					.h1 {font-family: "Helvetica", "Arial", sans-serif !important; font-weight: 700 !important; vertical-align: middle !important; font-size: 36px !important; mso-line-height-rule: exactly;line-height: 42px !important;}
					.h2 {font-family: "Helvetica", "Arial", sans-serif !important;font-weight: 600 !important;vertical-align: middle !important;font-size: 16px !important;mso-line-height-rule: exactly;line-height: 24px !important;}
					.text {font-family: "Helvetica", "Arial", sans-serif !important;font-weight: 400 !important;font-size: 16px !important;mso-line-height-rule: exactly;line-height: 21px !important;}
					.text-list {font-family: "Helvetica", "Arial", sans-serif !important;font-weight: 400 !important;font-size: 16px !important;mso-line-height-rule: exactly;line-height: 25px !important;}
					.textSmall {font-family: "Helvetica", "Arial", sans-serif !important;font-weight: 400 !important;font-size: 14px !important;}
					.text-xsmall {font-family: "Helvetica", "Arial", sans-serif !important;font-size: 11px !important;text-transform: uppercase !important;mso-line-height-rule: exactly;line-height: 22px !important;letter-spacing: 1px !important;}
					.text-bold {font-weight: 600 !important;}
					.text-link {text-decoration: underline !important;}
					.text-linkNoUnderline {text-decoration: none !important;}
					.text-strike {text-decoration: line-through !important;}
					.textColorDark {color: #23233e !important;}
					.textColorNormal {color: #4f4f65 !important;}
					.textColorBlue {color: #2020c0 !important;}
					.textColorGray {color: #A5A8AD !important;}
					.textColorWhite {color: #FFFFFF !important;}
					.Button-primary {font-family: "Helvetica", "Arial", sans-serif !important;border-radius: 3px !important;border: 1px solid #2020C0 !important;color: #ffffff !important;display: block !important;font-size: 16px !important;font-weight: 600 !important;padding: 18px !important;text-decoration: none !important;}
					.Button-secondary {font-family: "Helvetica", "Arial", sans-serif !important;border-radius: 3px !important;border: 1px solid #2020C0 !important;color: #2020C0 !important;display: block !important;font-size: 16px !important;font-weight: 600 !important;padding: 18px !important;text-decoration: none !important;}
						</style>
						<![endif]-->
					  <!-- HIDDEN PREHEADER TEXT -->
					  <div class="preheader" style="display: none; font-size: 1px; color: rgb(255, 255, 255); line-height: 1px; max-height: 0px; max-width: 0px; opacity: 0; overflow: hidden;">
					  </div>
					  



					</body></html>';
			
			sendEmail($subject, $to, $emailContent);
			 
			$stmt->close();
			$dbCon->close();
			return 1;
		}
		

		function phoneIinviteAdultForCheckin($data)
		{
			 
			$dbCon = AppModel::createConnection();
			 
			$stmt = $dbCon->prepare("select user_logins_id,country_of_residence from user_profiles left join user_logins on user_logins.id=user_profiles.user_logins_id where country_of_residence=? and phone_number=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("is", $data['country_id'], $data['phone_number']);
			$stmt->execute();
			$resultUser = $stmt->get_result();
			
			$rowUser = $resultUser->fetch_assoc();
			if(empty($rowUser))
			{
				$user=0;
			}
			else
			{
			if($rowUser['user_logins_id']==$data['user_id']) 
			{
			$stmt->close();
			$dbCon->close();
			return 0;	
			}	
			$user=$rowUser['user_logins_id'];
			}
			
			 
			
			$stmt = $dbCon->prepare("select buyer_id,is_buyer_company,hotel_checkout_detail.user_id,visiting_address,port_number,visiting_city,visiting_state,property_location.id as p_id,room_type_id,total_days,price,hotel_name,fdesk_country_code,fdesk_phone_number from hotel_checkout_detail left join company_hotel_room_type_detail on company_hotel_room_type_detail.id= hotel_checkout_detail.room_type_id left join hotel_basic_information on hotel_basic_information.property_id=company_hotel_room_type_detail.location_id left join property_location on property_location.id=hotel_basic_information.property_id where hotel_checkout_detail.id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['checkid']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowInfo = $result->fetch_assoc();
			
			$code=mt_rand(111111,999999); 
			$stmt = $dbCon->prepare("select * from hotel_images where property_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $rowInfo['p_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowImage = $result->fetch_assoc();
			
			$filename="../estorecss/".$rowImage['image_path'].".txt"; $value_a=file_get_contents("../estorecss/".$rowImage['image_path'].".txt"); $value_a=str_replace('"','',$value_a); $rowImage['image_path'] = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$rowImage['image_path'].'.jpg' );
			$rowInfo['image_path']=str_replace('../','https://www.safeqloud.com/',$rowImage['image_path']);
			
			$stmt = $dbCon->prepare("select concat_ws(' ', first_name,last_name) as name,email from user_logins where id = ?");
        
				/* bind parameters for markers */
			$stmt->bind_param("i", $data['user_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowUser    = $result->fetch_assoc();
				 
		
			 
			$stmt = $dbCon->prepare("select country_code from phone_country_code where id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['country_id']);
			$stmt->execute();
			$resultCode = $stmt->get_result();
			
			$rowCountryCode = $resultCode->fetch_assoc();
			  
			$type=1;
			$stmt = $dbCon->prepare("insert into hotel_checkout_invitation_info(verification_code,invitation_type,country_id,country_code,phone_number,invited_user_id,hotel_checkout_id)
			values(?,?,?,?,?,?,?)");
			$stmt->bind_param("iiiisii",$code,$type,$data['country_id'],$rowCountryCode['country_code'],$data['phone_number'],$user,$data['checkid']);
			$stmt->execute();
			$id=$stmt->insert_id; 
			$id1=$this -> encrypt_decrypt('encrypt',$id); 
			if(isset($data['precheck']))
			{
			$url="https://www.dstricts.com/public/index.php/Hotel/verifyInvitationPreCheckin/".$id1;	
			}
			else
			{
			$url="https://www.dstricts.com/public/index.php/Hotel/verifyInvitationCheckin/".$id1;	
			}
			
			$surl=getShortUrl($url);
			
			$phone="+".trim($rowCountryCode['country_code'])."".trim($data['phone_number']);
			
			$subject='You have an invitation for checkin';
			$to=$phone;
			$html='Hi you have invitation to checkin in hotel : '.$rowInfo['hotel_name'].' from '.$rowInfo['name'].'. please open link in browser and use dstrict and Qloud ID app to verify using code :'.$code.' '.$surl;
			//echo $html; die;
			$res=sendSms($subject, $to, $html);
			$stmt->close();
			$dbCon->close();
			return $id;
		}
		
		function emailIinviteAdultForCheckin($data)
		{
			 
			$dbCon = AppModel::createConnection();
			
			$stmt = $dbCon->prepare("select id from user_logins where email=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("s", $data['email']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			
			if(empty($row))
			{
			$user=0;
			}
			else
			{
			if($row['id']==$data['user_id']) 
			{
			$stmt->close();
			$dbCon->close();
			return 0;	
			}
			$user=$row['id'];
			}
			
			
			$stmt = $dbCon->prepare("select buyer_id,is_buyer_company,hotel_checkout_detail.user_id,visiting_address,port_number,visiting_city,visiting_state,property_location.id as p_id,room_type_id,total_days,price,hotel_name,fdesk_country_code,fdesk_phone_number from hotel_checkout_detail left join company_hotel_room_type_detail on company_hotel_room_type_detail.id= hotel_checkout_detail.room_type_id left join hotel_basic_information on hotel_basic_information.property_id=company_hotel_room_type_detail.location_id left join property_location on property_location.id=hotel_basic_information.property_id where hotel_checkout_detail.id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['checkid']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowInfo = $result->fetch_assoc();
			$code=mt_rand(111111,999999); 
			$stmt = $dbCon->prepare("select * from hotel_images where property_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $rowInfo['p_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowImage = $result->fetch_assoc();
			
			$filename="../estorecss/".$rowImage['image_path'].".txt"; $value_a=file_get_contents("../estorecss/".$rowImage['image_path'].".txt"); $value_a=str_replace('"','',$value_a); $rowImage['image_path'] = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$rowImage['image_path'].'.jpg' );
			$rowInfo['image_path']=str_replace('../','https://www.safeqloud.com/',$rowImage['image_path']);
			
			$stmt = $dbCon->prepare("select concat_ws(' ', first_name,last_name) as name,email from user_logins where id = ?");
        
				/* bind parameters for markers */
			$stmt->bind_param("i", $buyer);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowUser    = $result->fetch_assoc();
				 
			$rowInfo['name']=$rowUser['name'];
			
			 
			$type=2;
			$stmt = $dbCon->prepare("insert into hotel_checkout_invitation_info(verification_code,invitation_type,email,invited_user_id,hotel_checkout_id)
			values(?,?,?,?,?)");
			$stmt->bind_param("iisii",$code,$type,$data['email'],$user,$data['checkid']);
			$stmt->execute();
			$id=$stmt->insert_id; 
			$id1=$this -> encrypt_decrypt('encrypt',$id); 
			if(isset($data['precheck']))
			{
			$url="https://www.dstricts.com/public/index.php/Hotel/verifyInvitationPreCheckin/".$id1;	
			}
			else
			{
			$url="https://www.dstricts.com/public/index.php/Hotel/verifyInvitationCheckin/".$id1;	
			}
		 
			
			$surl=getShortUrl($url);
			$to      = $data['email'];
			$emailContent='<html xmlns="http://www.w3.org/1999/xhtml" style="background-color: rgb(240, 240, 240);"><head>
					  <title>Reservation confirmed</title>
					  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
					  <meta charset="utf-8">
					  <meta name="viewport" content="width=device-width, initial-scale=1">
					  <meta http-equiv="X-UA-Compatible" content="IE=edge">
					  <style type="text/css">
						/* GT AMERICA */

						@font-face {
						  font-display: fallback;
						  font-family: "GT America Regular";
						  font-weight: 400;
						  src: url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Regular.woff2") format("woff2"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Regular.woff") format("woff"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Regular.ttf") format("truetype");
						}

						@font-face {
						  font-display: fallback;
						  font-family: "GT America Medium";
						  font-weight: 600;
						  src: url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Medium.woff2") format("woff2"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Medium.woff") format("woff"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Medium.ttf") format("truetype");
						}

						@font-face {
						  font-display: fallback;
						  font-family: "GT America Condensed Bold";
						  font-weight: 700;
						  src: url("https://www.exploretock.com/fonts/gt-america/GT-America-Condensed-Bold.woff2") format("woff2"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Condensed-Bold.woff") format("woff"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Condensed-Bold.ttf") format("truetype");
						}

						/* CLIENT-SPECIFIC RESET */

						body,
						table,
						td,
						a {
						  -webkit-text-size-adjust: 100%;
						  -ms-text-size-adjust: 100%;
						}

						/* Prevent WebKit and Windows mobile changing default text sizes */

						table,
						td {
						  mso-table-lspace: 0pt;
						  mso-table-rspace: 0pt;
						}

						/* Remove spacing between tables in Outlook 2007 and up */

						img {
						  -ms-interpolation-mode: bicubic;
						}

						/* Allow smoother rendering of resized image in Internet Explorer */

						.im {
						  color: inherit !important;
						}

						/* DEVICE-SPECIFIC RESET */

						a[x-apple-data-detectors] {
						  color: inherit !important;
						  text-decoration: none !important;
						  font-size: inherit !important;
						  font-family: inherit !important;
						  font-weight: inherit !important;
						  line-height: inherit !important;
						}

						/* iOS BLUE LINKS */

						/* RESET */

						img {
						  border: 0;
						  height: auto;
						  line-height: 100%;
						  outline: none;
						  text-decoration: none;
						  display: block;
						}

						table {
						  border-collapse: collapse;
						}

						table td {
						  border-collapse: collapse;
						  display: table-cell;
						}

						body {
						  height: 100% !important;
						  margin: 0 !important;
						  padding: 0 !important;
						  width: 100% !important;
						}

						/* BG COLORS */

						.mainTable {
						  background-color: #F0F0F0;
						}

						.mainTable--hospitality {
						  background-color: #f7f2ed;
						}

						html {
						  background-color: #F0F0F0;
						}

						/* VARIABLES */

						.bg-white {
						  background-color: white;
						}

						.hr {
						  /* Cross-client horizontal rule. Adapted from https://litmus.com/community/discussions/4633-is-there-a-reliable-1px-horizontal-rule-method */
						  background-color: #d3d3d8;
						  border-collapse: collapse;
						  mso-table-lspace: 0pt;
						  mso-table-rspace: 0pt;
						  mso-line-height-rule: exactly;
						  line-height: 1px;
						}

						.textAlignLeft {
						  text-align: left !important;
						}

						.textAlignRight {
						  text-align: right !important;
						}

						.textAlignCenter {
						  text-align: center !important;
						}

						.mt1 {
						  margin-top: 6px;
						}

						.list {
						  padding-left: 18px;
						  margin: 0;
						}

						/* TYPOGRAPHY */

						body {
						  font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
						  font-weight: 400;
						  color: #4f4f65;
						  -webkit-font-smoothing: antialiased;
						  -ms-text-size-adjust: 100%;
						  -moz-osx-font-smoothing: grayscale;
						  font-smoothing: always;
						  text-rendering: optimizeLegibility;
						}

						.h1 {
						  font-family: "GT America Condensed Bold", "Roboto Condensed", "Roboto", "Helvetica", "Arial", sans-serif;
						  font-weight: 700;
						  vertical-align: middle;
						  font-size: 36px;
						  line-height: 42px;
						}

						.h2 {
						  font-family: "GT America Medium", "Roboto", "Helvetica", "Arial", sans-serif;
						  font-weight: 600;
						  vertical-align: middle;
						  font-size: 16px;
						  line-height: 24px;
						}

						.text {
						  font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
						  font-weight: 400;
						  font-size: 16px;
						  line-height: 21px;
						}

						.text-list {
						  font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
						  font-weight: 400;
						  font-size: 16px;
						  line-height: 25px;
						}

						.textSmall {
						  font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
						  font-weight: 400;
						  font-size: 14px;
						}

						.text-xsmall {
						  font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
						  font-size: 11px;
						  text-transform: uppercase;
						  line-height: 22px;
						  letter-spacing: 1px;
						}

						.text-bold {
						  font-weight: 600;
						}

						.text-link {
						  text-decoration: underline;
						}

						.text-linkNoUnderline {
						  text-decoration: none;
						}

						.text-strike {
						  text-decoration: line-through;
						}

						/* FONT COLORS */

						.textColorDark {
						  color: #23233e;
						}

						.textColorNormal {
						  color: #4f4f65;
						}

						.textColorBlue {
						  color: #2020c0;
						}

						.textColorGrayDark {
						  color: #7B7B8B;
						}

						.textColorGray {
						  color: #A5A8AD;
						}

						.textColorWhite {
						  color: #FFFFFF;
						}

						.textColorRed {
						  color: #df3232;
						}

						/* BUTTON */

						.Button-primary-wrapper {
						  border-radius: 3px;
						  background-color: #2020C0;
						}

						.Button-primary {
						  font-family: "GT America Medium", "Roboto", "Helvetica", "Arial", sans-serif;
						  border-radius: 3px;
						  border: 1px solid #2020C0;
						  color: #ffffff;
						  display: block;
						  font-size: 16px;
						  font-weight: 600;
						  padding: 18px;
						  text-decoration: none;
						}

						.Button-secondary-wrapper {
						  border-radius: 3px;
						  background-color: #ffffff;
						}

						.Button-secondary {
						  font-family: "GT America Medium", "Roboto", "Helvetica", "Arial", sans-serif;
						  border-radius: 3px;
						  border: 1px solid #2020C0;
						  color: #2020C0;
						  display: block;
						  font-size: 16px;
						  font-weight: 600;
						  padding: 18px;
						  text-decoration: none;
						}

						/* LAYOUT */

						.Content-container {
						  padding-left: 60px;
						  padding-right: 60px;
						}

						.Content-container--main {
						  padding-top: 54px;
						  padding-bottom: 60px;
						}

						.Content {
						  width: 580px;
						  margin: 0 auto;
						}

						.wrapper {
						  max-width: 600px;
						}

						.section {
						  padding: 24px 0px;
						  border-bottom: 1px solid #d3d3d8;
						}

						.section--noBorder {
						  padding: 24px 0px 0;
						}

						.section--last {
						  padding: 24px 0px;
						}

						.message {
						  background-color: #F4F4F5;
						  padding: 18px;
						}

						.card {
						  border: 1px solid #d3d3d8;
						  padding: 18px;
						}

						/* HEADER */

						.header-tockLogoImage {
						  display: block;
						  color: #F0F0F0;
						}

						.header-heroImage {
						  padding-bottom: 24px;
						}

						/* PREHEADER */

						.preheader {
						  display: none;
						  font-size: 1px;
						  color: #FFFFFF;
						  line-height: 1px;
						  max-height: 0px;
						  max-width: 0px;
						  opacity: 0;
						  overflow: hidden;
						}

						/* BANNER */

						.notice {
						  padding: 12px;
						  background: #23233E;
						  color: #FFFFFF;
						  display: block;
						  font-size: 14px;
						  font-family: "GT America Medium", "Roboto", "Helvetica", "Arial", sans-serif;
						  font-weight: 600;
						}

						/* INTRO */

						.section--intro {
						  padding-bottom: 48px;
						}

						/* BOOKING INFO */

						.business-logo__container {
						  width: 48px;
						  height: 48px;
						  border-radius: 3px;
						  border: 1px solid #d3d3d8;
						  overflow: hidden;
						}

						.business-logo__image {
						  border: 1px solid transparent;
						  border-radius: 3px;
						  width: 48px;
						  height: 48px;
						  display: block;
						}

						.business-address--address {
						  width: 50%;
						}

						.business-address--map {
						  width: 50%;
						}

						.business-address--map-image {
						  width: 100%;
						}

						/* MOBILE TICKETS */

						.mobile-ticket--description {
						  width: 65%;
						  margin-top: 12px;
						  margin-right: 5%;
						}

						.mobile-ticket--code {
						  width: 30%;
						}

						.mobile-ticket--code-image {
						  width: 100%;
						}

						/* RESERVATION ACTIONS */

						.linksTable {
						  border-bottom: 1px solid #d3d3d8;
						}

						.linksTableRow {
						  padding: 24px 12px;
						}

						.actions-icon {
						  vertical-align: middle;
						}

						.actions-text {
						  vertical-align: middle;
						}

						/* RECEIPT */

						.receipt__container {
						  border: 1px solid #d3d3d8;
						  padding: 24px;
						}

						.receipt__row {
						  border-top: 1px solid #d3d3d8;
						}

						/* FEEDBACK ICONS */

						.feedback-link {
						  border: 1px solid #d4d5da;
						  border-radius: 3px;
						  display: inline-block;
						  width: calc(32% - 2px);
						  padding: 10px 0;
						}

						.feedback-link-bumper {
						  display: inline-block;
						  width: 1%;
						}

						.feedback-link img {
						  height: 50px;
						  width: 50px;
						}

						/* SOCIAL ICONS */

						.social-link {
						  display: inline-block;
						  width: auto;
						}

						.social-link-text {
						  padding: 14px 24px 14px 14px;
						}

						/* TABLET STYLES */

						@media screen and (max-width: 648px) {
						  /* DEVICE-SPECIFIC RESET */
						  div[style*="margin: 16px 0;"] {
							margin: 0 !important;
						  }
						  /* ANDROID CENTER FIX */
						  /* LAYOUT */
						  .wrapper {
							width: 100% !important;
							max-width: 100% !important;
						  }
						  .Content {
							width: 90% !important;
						  }
						  .Content-container {
							padding-left: 36px !important;
							padding-right: 36px !important;
						  }
						  .Content-container--main {
							padding-top: 30px !important;
							padding-bottom: 42px !important;
						  }
						  .responsiveTable {
							width: 100% !important;
						  }
						  /* RESERVATION ACTIONS */
						  .linksTableRow {
							padding-left: 0 !important;
							padding-right: 0 !important;
							padding-top: 12px !important;
							padding-bottom: 12px !important;
						  }
						  .linksTableRow--borderRight {
							border-right: none !important;
							padding-left: 0 !important;
							padding-right: 0 !important;
						  }
						  /* FEEDBACK LINK */
						  .feedback-link img {
							height: 38px !important;
							width: 38px !important;
						  }
						}

						/* MOBILE STYLES */

						@media screen and (max-width: 480px) {
						  /* TYPOGRAPHY */
						  .h1 {
							font-size: 30px !important;
							line-height: 30px !important;
						  }
						  .text {
							font-size: 16px !important;
							line-height: 22px !important;
						  }
						  /* BUTTON */
						  .mobile-buttonContainer {
							width: 100% !important;
						  }
						  /* LAYOUT */
						  .Content {
							width: 100% !important;
						  }
						  .Content-container {
							padding-left: 18px !important;
							padding-right: 18px !important;
						  }
						  .Content-container--main {
							padding-top: 24px !important;
							padding-bottom: 30px !important;
						  }
						  .section {
							padding: 18px 0 !important;
						  }
						  .section--last {
							padding: 18px 0 !important;
						  }
						  .header {
							padding: 0 18px !important;
						  }
						  .business-address--address {
							width: 100% !important;
						  }
						  .business-address--map {
							margin-top: 30px !important;
							width: 100% !important;
						  }
						  .mobile-ticket--description {
							width: 100% !important;
							margin-top: 0px !important;
						  }
						  .mobile-ticket--code {
							margin-top: 30px !important;
							margin-left: 0;
							width: 100% !important;
						  }
						  /* RECEIPT */
						  .receipt__container {
							padding: 12px !important;
						  }
						  /* SOCIAL ICONS */
						  .social-link {
							display: block !important;
							width: 100% !important;
							border-bottom: 1px solid #d3d3d8 !important;
						  }
						  /* INTRO */
						  .section--intro {
							padding-top: 18px !important;
							padding-bottom: 18px !important;
						  }
						}
					  </style>
					</head>

					<body style="margin: 0 !important; padding: 0 !important; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; height: 100%; margin: 0; padding: 0; width: 100%; font-family: &quot;GT America Regular&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-weight: 400; color: rgb(79, 79, 101); -webkit-font-smoothing: antialiased; -ms-text-size-adjust: 100%; -moz-osx-font-smoothing: grayscale; font-smoothing: always; text-rendering: optimizeLegibility;">
					   
					  <!--[if mso]>
						<style type="text/css">
					.h1 {font-family: "Helvetica", "Arial", sans-serif !important; font-weight: 700 !important; vertical-align: middle !important; font-size: 36px !important; mso-line-height-rule: exactly;line-height: 42px !important;}
					.h2 {font-family: "Helvetica", "Arial", sans-serif !important;font-weight: 600 !important;vertical-align: middle !important;font-size: 16px !important;mso-line-height-rule: exactly;line-height: 24px !important;}
					.text {font-family: "Helvetica", "Arial", sans-serif !important;font-weight: 400 !important;font-size: 16px !important;mso-line-height-rule: exactly;line-height: 21px !important;}
					.text-list {font-family: "Helvetica", "Arial", sans-serif !important;font-weight: 400 !important;font-size: 16px !important;mso-line-height-rule: exactly;line-height: 25px !important;}
					.textSmall {font-family: "Helvetica", "Arial", sans-serif !important;font-weight: 400 !important;font-size: 14px !important;}
					.text-xsmall {font-family: "Helvetica", "Arial", sans-serif !important;font-size: 11px !important;text-transform: uppercase !important;mso-line-height-rule: exactly;line-height: 22px !important;letter-spacing: 1px !important;}
					.text-bold {font-weight: 600 !important;}
					.text-link {text-decoration: underline !important;}
					.text-linkNoUnderline {text-decoration: none !important;}
					.text-strike {text-decoration: line-through !important;}
					.textColorDark {color: #23233e !important;}
					.textColorNormal {color: #4f4f65 !important;}
					.textColorBlue {color: #2020c0 !important;}
					.textColorGray {color: #A5A8AD !important;}
					.textColorWhite {color: #FFFFFF !important;}
					.Button-primary {font-family: "Helvetica", "Arial", sans-serif !important;border-radius: 3px !important;border: 1px solid #2020C0 !important;color: #ffffff !important;display: block !important;font-size: 16px !important;font-weight: 600 !important;padding: 18px !important;text-decoration: none !important;}
					.Button-secondary {font-family: "Helvetica", "Arial", sans-serif !important;border-radius: 3px !important;border: 1px solid #2020C0 !important;color: #2020C0 !important;display: block !important;font-size: 16px !important;font-weight: 600 !important;padding: 18px !important;text-decoration: none !important;}
						</style>
						<![endif]-->
					  <!-- HIDDEN PREHEADER TEXT -->
					  <div class="preheader" style="display: none; font-size: 1px; color: rgb(255, 255, 255); line-height: 1px; max-height: 0px; max-width: 0px; opacity: 0; overflow: hidden;">
					  </div>
					  <table border="0" cellpadding="0" cellspacing="0" width="100%" class=" mainTable  " style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; background-color: rgb(240, 240, 240);">
						<tbody><tr><td style="display:none !important;
					 visibility:hidden;
					 mso-hide:all;
					 font-size:1px;
					 color:#ffffff;
					 line-height:1px;
					 max-height:0px;
					 max-width:0px;
					 opacity:0;
					 overflow:hidden; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;"> We are thrilled that you will be joining us. If yo... </td>
						<!-- HEADER -->
						</tr><tr>
						  <td align="center" class="header" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
							<!--[if (gte mso 9)|(IE)]>
						<table align="center" border="0" cellspacing="0" cellpadding="0" width="600">
						<tr>
						<td align="center" valign="top" width="600">
						<![endif]-->
							<table border="0" cellpadding="0" cellspacing="0" width="100%" class="Content" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; width: 580px; margin: 0 auto;">
							  <tbody><tr class="spacer">
								<td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
							  </tr>
							  <tr class="spacer">
								<td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
							  </tr>
							  <tr>
								<td align="left" valign="middle" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;"> <h1 style="font-size: 33px;font-weight: 800;line-height: 30px;">Dstricts</h1>               </td>
							  </tr>
							  <tr class="spacer">
								<td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
							  </tr>
							  <tr class="spacer">
								<td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
							  </tr>
							</tbody></table>
							<!--[if (gte mso 9)|(IE)]>
						</td>
						</tr>
						</table>
						<![endif]-->
						  </td>
						</tr>
						<!-- CONTENT -->
						<tr>
						  <td align="center" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
							<!--[if (gte mso 9)|(IE)]>
						<table align="center" border="0" cellspacing="0" cellpadding="0" width="600">
						<tr>
						<td align="center" valign="top" width="600">
						<![endif]-->
							<table border="0" cellpadding="0" cellspacing="0" width="100%" class="Content bg-white" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; background-color: white; width: 580px; margin: 0 auto;">
							  <tbody><tr>
								<td class="Content-container Content-container--main text textColorNormal" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell; font-family: &quot;GT America Regular&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-weight: 400; font-size: 16px; line-height: 21px; color: rgb(79, 79, 101); padding-left: 60px; padding-right: 60px; padding-top: 54px; padding-bottom: 60px;">
								  <table width="100%" border="0" cellspacing="0" cellpadding="0" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
									<!-- RESTAURANT INFO -->
									<tbody><tr>
									  <td valign="top" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
										<table align="left" border="0" cellpadding="0" cellspacing="0" width="100%" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
										  <tbody><tr>
											<td align="left" valign="center" width="48" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
											  <div class="business-logo__container" style="width: 48px; height: 48px; border-radius: 3px; border: 1px solid rgb(211, 211, 216); overflow: hidden;">
												<img src="'.$rowImage['image_path'].'" class="business-logo__image" width="48" height="48" alt="Logo" style="-ms-interpolation-mode: bicubic; border: 0; height: auto; line-height: 100%; outline: none; text-decoration: none; display: block; border: 1px solid transparent; border-radius: 3px; width: 48px; height: 48px; display: block;">
											  </div>
											</td>
											<td width="12" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
											<td align="left" valign="middle" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;"> <span class="h2 textColorDark" style="font-family: &quot;GT America Medium&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-weight: 600; vertical-align: middle; font-size: 16px; line-height: 24px; color: rgb(35, 35, 62);">'.$rowInfo["hotel_name"].'</span>                          </td>
										  </tr>
										  <tr class="spacer">
											<td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
										  </tr>
										  <tr class="spacer">
											<td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
										  </tr>
										</tbody></table>
									  </td>
									</tr>
									<!-- INTRO -->
									<tr>
									  <td valign="top" align="left" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
										<table width="100%" border="0" cellspacing="0" cellpadding="0" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
										  <tbody><tr>
											<td align="left" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;"> <span class="h1 textColorDark" style="font-family: &quot;GT America Condensed Bold&quot;, &quot;Roboto Condensed&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-weight: 700; vertical-align: middle; font-size: 36px; line-height: 42px; color: rgb(35, 35, 62);">Invitation received</span>                          </td>
										  </tr>
										  <tr class="spacer">
											<td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
										  </tr>
										  <tr>
											<td align="left" colspan="2" valign="top" width="100%" height="1" class="hr" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell; background-color: rgb(211, 211, 216); border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; mso-line-height-rule: exactly; line-height: 1px;">
											  <!--[if gte mso 15]>&nbsp;<![endif]-->
											</td>
										  </tr>
										  <tr class="spacer">
											<td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
										  </tr>
										</tbody></table>
									  </td>
									</tr>
									<!-- MESSAGE -->
									<tr class="spacer">
									  <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
									</tr>
									<tr>
									  <td align="left" class="message" valign="top" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell; background-color: rgb(244, 244, 245); padding: 18px;">
										<div class="text textColorNormal" style="font-family: &quot;GT America Regular&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-weight: 400; font-size: 16px; line-height: 21px; color: rgb(79, 79, 101);">
										  <span class="text-bold textColorDark" style="font-weight: 600; color: rgb(35, 35, 62);">A message from '.$rowInfo["name"].'</span>
										  <br>I have successfully checked in the hotel. I am waiting for you to check in here using your dstrict app. Find the link to check in using the confirmation code </div>
									  </td>
									</tr>
									<tr class="spacer">
									  <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
									</tr>
									<tr class="spacer">
									  <td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
									</tr>
									<tr>
									  <td align="left" colspan="2" valign="top" width="100%" height="1" class="hr" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell; background-color: rgb(211, 211, 216); border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; mso-line-height-rule: exactly; line-height: 1px;">
										<!--[if gte mso 15]>&nbsp;<![endif]-->
									  </td>
									</tr>
									<tr class="spacer">
									  <td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
									</tr>
									<!-- BOOKING INFO -->
									<tr>
									  <td valign="top" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
										<table align="left" border="0" cellpadding="0" cellspacing="0" width="100%" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
										  <tbody><tr>
											<td align="left" valign="middle" width="468" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
											  <div class="text-list textColorNormal" style="font-family: &quot;GT America Regular&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-weight: 400; font-size: 16px; line-height: 25px; color: rgb(79, 79, 101);">
												<span class="text-bold textColorDark" style="font-weight: 600; color: rgb(35, 35, 62);">'.date("F j, Y, g:i a").'</span>
												<br> Party of 2 for Smiles Davis 
												<br> Confirmation code #: '.$code.'
												<br> Reservation × 2
												<br>
											  </div>
											</td>
										  </tr>
										  <tr class="spacer">
											<td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
										  </tr>
										  <tr class="spacer">
											<td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
										  </tr>
										  

					<tr>
											<td align="center" valign="center" width="100%" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
											  <table border="0" cellspacing="0" cellpadding="0" width="100%" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
												<tbody><tr>
												  <td align="center" valign="center" width="100%" class="Button-primary-wrapper" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell; border-radius: 3px; background-color: rgb(32, 32, 192);">
												  <a href="'.$url.'" target="_blank" class="Button-primary" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; font-family: &quot;GT America Medium&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; border-radius: 3px; border: 1px solid rgb(32, 32, 192); color: rgb(255, 255, 255); display: block; font-size: 16px; font-weight: 600; padding: 18px; text-decoration: none;"> Manage your reservation </a>                                </td>
												</tr>
											  </tbody></table>
											</td>
										  </tr><tr class="spacer">
											<td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
										  </tr>

					<tr class="spacer">
											<td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
										  </tr>

					<tr>
											<td align="center" valign="center" width="100%" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
											  <table border="0" cellspacing="0" cellpadding="0" width="100%" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
												<tbody><tr>
												  <td align="center" valign="center" width="100%" class="Button-primary-wrapper" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell; border-radius: 3px; background-color: rgb(32, 32, 192);">
												  <a href="'.$url.'" target="_blank" class="Button-primary" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; font-family: &quot;GT America Medium&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; border-radius: 3px; border: 1px solid rgb(32, 32, 192); color: rgb(255, 255, 255); display: block; font-size: 16px; font-weight: 600; padding: 18px; text-decoration: none;"> Checkin with app</a>                                </td>
												</tr>
											  </tbody></table>
											</td>
										  </tr>
										</tbody></table>
									  </td>
									</tr>
									<!-- ADDRESS -->
									<tr>
									  <td align="center" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
										<table border="0" cellpadding="0" cellspacing="0" width="100%" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
										  <tbody><tr class="spacer">
											<td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
										  </tr>
										  <tr class="spacer">
											<td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
										  </tr>
										  <tr>
											<td align="left" colspan="2" valign="top" width="100%" height="1" class="hr" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell; background-color: rgb(211, 211, 216); border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; mso-line-height-rule: exactly; line-height: 1px;">
											  <!--[if gte mso 15]>&nbsp;<![endif]-->
											</td>
										  </tr>
										  <tr class="spacer">
											<td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
										  </tr>
										  <tr class="spacer">
											<td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
										  </tr>
										  <tr>
											<td align="left" valign="middle" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
											  <table border="0" cellpadding="0" cellspacing="0" width="100%" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
												<tbody><tr>
												  <td style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
													<table align="left" border="0" cellpadding="0" cellspacing="0" width="230" class="business-address--address" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; width: 50%;">
													  <tbody><tr>
														<td align="left" width="100%" class="text-list textColorNormal" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell; font-family: &quot;GT America Regular&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-weight: 400; font-size: 16px; line-height: 25px; color: rgb(79, 79, 101);">
														<span class="h2 textColorDark" style="font-family: &quot;GT America Medium&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-weight: 600; vertical-align: middle; font-size: 16px; line-height: 24px; color: rgb(35, 35, 62);">'.$rowInfo["hotel_name"].'</span><br>'.$rowInfo["visiting_address"].' '.$rowInfo["port_number"].'<br>'.$rowInfo["visiting_city"].' '.$rowInfo["visiting_state"].'<br> <a href="tel:+' .$rowInfo[" fdesk_country_code"].'="" '.$rowinfo["fdesk_phone_number"].'"="">+'.$rowInfo["fdesk_country_code"].' '.$rowInfo["fdesk_phone_number"].'</a><br> <br> <a href="https://www.google.com/maps/dir//'.$rowInfo['visiting_address'].' '.$rowInfo['port_number'].'/" class="text text-link textColorBlue" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; font-family: &quot;GT America Regular&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-weight: 400; font-size: 16px; line-height: 21px; text-decoration: underline; color: rgb(32, 32, 192);" target="_blank">Get directions</a>                                      </td>
													  </tr>
													</tbody></table>
													<!--[if mso]></td><td><![endif]-->
													<table align="right" border="0" cellpadding="0" cellspacing="0" width="230" class="business-address--map" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; width: 50%;">
													  <tbody><tr>
														<td width="100%" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;"> <a href="https://www.google.com/maps/dir//1350+W+Randolph%2C+Chicago%2C+IL%2C+US+60607/" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%;"> <img width="230" class="business-address--map-image" height="auto" alt="Map of Elske" src="https://maps.googleapis.com/maps/api/staticmap?key=AIzaSyCPd%2DxSabI7QOfKX5NxVVup6bPfcovwFiQ&amp;center=1350+W+Randolph%2C+Chicago%2C+IL%2C+US+60607&amp;size=300x200&amp;zoom=15&amp;scale=2&amp;format=png&amp;visual%5Frefresh=true&amp;markers=scale%3A2%7Cicon%3Ahttps%3A%2F%2Fstorage.googleapis.com%2Ftock%2Dpublic%2Dassets%2Fimages%2Demail%2Dtemplate%2Femail%2Dmap%2Dmarker.png%7Cshadow%3Afalse%7C1350+W+Randolph%2C+Chicago%2C+IL%2C+US+60607&amp;style=feature%3Aall%7Celement%3Alabels.text.fill%7Ccolor%3A0x4b505b&amp;style=feature%3Aall%7Celement%3Alabels.text.stroke%7Ccolor%3A0xffffff%7Cvisibility%3Aon&amp;style=feature%3Aadministrative.land%5Fparcel%7Celement%3Aall%7Cvisibility%3Aoff&amp;style=feature%3Alandscape.man%5Fmade%7Celement%3Aall%7Cvisibility%3Aon&amp;style=feature%3Alandscape.man%5Fmade%7Celement%3Ageometry.fill%7Ccolor%3A0xe9e9eb&amp;style=feature%3Apoi%7Celement%3Aall%7Cvisibility%3Aoff&amp;style=feature%3Aroad%7Celement%3Ageometry.fill%7Ccolor%3A0xffffff&amp;style=feature%3Aroad%7Celement%3Alabels.text.fill%7Ccolor%3A0x787c84&amp;style=feature%3Aroad%7Celement%3Alabels.icon%7Cvisibility%3Aoff&amp;style=feature%3Aroad.highway%7Celement%3Ageometry.fill%7Ccolor%3A0xffbe32&amp;style=feature%3Aroad.highway%7Celement%3Ageometry.stroke%7Ccolor%3A0xffbe32&amp;style=feature%3Atransit%7Celement%3Alabels.text.fill%7Cvisibility%3Aon%7Ccolor%3A0x787c84&amp;style=feature%3Atransit.line%7Celement%3Ageometry.fill%7Ccolor%3A0xd2d4d6&amp;signature=3yCSyIXfsSilvB5wcd4OElw40QU=" style="-ms-interpolation-mode: bicubic; border: 0; height: auto; line-height: 100%; outline: none; text-decoration: none; display: block; width: 100%;"> </a>                                      </td>
													  </tr>
													</tbody></table>
												  </td>
												</tr>
											  </tbody></table>
											</td>
										  </tr>
										</tbody></table>
									  </td>
									</tr>
									<tr class="spacer">
									  <td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
									</tr>
									<tr class="spacer">
									  <td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
									</tr>
									<tr>
									  <td align="left" colspan="2" valign="top" width="100%" height="1" class="hr" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell; background-color: rgb(211, 211, 216); border-collapse: collapse; mso-table-lspace: 0pt; mso-table-rspace: 0pt; mso-line-height-rule: exactly; line-height: 1px;">
										<!--[if gte mso 15]>&nbsp;<![endif]-->
									  </td>
									</tr>
									
									
									<!-- RECEIPT -->
									
									<tr class="spacer">
									  <td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
									</tr>
									<tr class="spacer">
									  <td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
									</tr>
									<!-- EDIT RECEIPT -->
									<!-- CANCELLATION POLICY -->
									<tr>
									  <td valign="top" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
										<table border="0" cellpadding="0" cellspacing="0" width="100%" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
										  <tbody><tr>
											<td align="left" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
											  <div class="text text-bold textColorDark" style="font-family: &quot;GT America Regular&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-weight: 400; font-size: 16px; line-height: 21px; font-weight: 600; color: rgb(35, 35, 62);">
												Cancellation policy
											  </div>
											</td>
										  </tr>
										  <tr>
											<td align="left" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
											  <div class="text textColorNormal mt1" style="margin-top: 6px; font-family: &quot;GT America Regular&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-weight: 400; font-size: 16px; line-height: 21px; color: rgb(79, 79, 101);">
												<span>This invitation can be accepted only if you have installed dstrict and Qloud ID pay. </span>
												<span>You can not transfer your invitation to another person.</span>
											  </div>
											</td>
										  </tr>
										</tbody></table>
									  </td>
									</tr>
									<tr class="spacer">
									  <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
									</tr>
									<tr class="spacer">
									  <td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
									</tr>
									<!-- QUESTIONS -->
									<tr>
									  <td valign="top" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
										<table border="0" cellpadding="0" cellspacing="0" width="100%" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
										  <tbody><tr>
											<td align="left" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
											  <div class="text text-bold textColorDark" style="font-family: &quot;GT America Regular&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-weight: 400; font-size: 16px; line-height: 21px; font-weight: 600; color: rgb(35, 35, 62);">
												Questions?
											  </div>
											</td>
										  </tr>
										  <tr>
											<td align="left" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
											  <div class="text textColorNormal mt1" style="margin-top: 6px; font-family: &quot;GT America Regular&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-weight: 400; font-size: 16px; line-height: 21px; color: rgb(79, 79, 101);">
												If you have questions about your reservation, contact us at&nbsp;
												<a href="mailto:'.$rowInfo['fdesk_email'].'">'.$rowInfo["fdesk_email"].'</a>                            or by calling
												<a href="tel:+'.$rowInfo[" fdesk_country_code"].'="" '.$rowinfo["fdesk_phone_number"].'"="">+'.$rowInfo["fdesk_country_code"].' '.$rowInfo["fdesk_phone_number"].'</a>.
											  </div>
											</td>
										  </tr>
										</tbody></table>
									  </td>
									</tr>
								  </tbody></table>
								</td>
							  </tr>
							</tbody></table>
						  </td>
						</tr>
						<!-- FOOTER -->
						<tr>
						  <td align="center" class="Content" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell; width: 580px; margin: 0 auto;">
							<!-- Will most likely required a feature flag -->
							<!--[if (gte mso 9)|(IE)]>
					<table align="center" border="0" cellspacing="0" cellpadding="0" width="600">
					<tr>
					<td align="center" valign="top" width="600">
					<![endif]-->
							<table width="100%" border="0" cellspacing="0" cellpadding="0" align="center" class="Content-container" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; padding-left: 60px; padding-right: 60px;">
							  <tbody><tr class="spacer">
								<td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
							  </tr>
							  <tr class="spacer">
								<td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
							  </tr>
							  <tr class="spacer">
								<td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
							  </tr>
							  <tr>
								<td align="center" valign="top" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;"> <a href="https://www.exploretock.com" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%;"> <img src="https://storage.googleapis.com/tock-public-assets/images-email-template/tock-brandmark-color.png" width="30" height="30" alt="Tock" border="0" style="-ms-interpolation-mode: bicubic; border: 0; height: auto; line-height: 100%; outline: none; text-decoration: none; display: block;"> </a>              </td>
							  </tr>
							  <tr class="spacer">
								<td height="18px" colspan="2" style="font-size: 18px; line-height:18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
							  </tr>
							  <tr>
								<td align="center" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
								  <div class="text-xsmall textColorNormal" style="font-family: &quot;GT America Regular&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-size: 11px; text-transform: uppercase; line-height: 22px; letter-spacing: 1px; color: rgb(79, 79, 101);">
									© 2019 Tock, Inc.
								  </div>
								  <div class="text-xsmall textColorNormal" style="font-family: &quot;GT America Regular&quot;, &quot;Roboto&quot;, &quot;Helvetica&quot;, &quot;Arial&quot;, sans-serif; font-size: 11px; text-transform: uppercase; line-height: 22px; letter-spacing: 1px; color: rgb(79, 79, 101);">
									All Rights Reserved
								  </div>
								</td>
							  </tr>
							  <tr class="spacer">
								<td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
							  </tr>
							  <tr class="spacer">
								<td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
							  </tr>
							  <tr class="spacer">
								<td height="12px" colspan="2" style="font-size: 12px; line-height:12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">&nbsp;</td>
							  </tr>
							</tbody></table>
							<!--[if (gte mso 9)|(IE)]>
					</td>
					</tr>
					</table>
					<![endif]-->
						  </td>
						</tr>
					  </tbody></table><title>Reservation confirmed</title>
					  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
					  <meta charset="utf-8">
					  <meta name="viewport" content="width=device-width, initial-scale=1">
					  <meta http-equiv="X-UA-Compatible" content="IE=edge">
					  <style type="text/css">
						/* GT AMERICA */

						@font-face {
						  font-display: fallback;
						  font-family: "GT America Regular";
						  font-weight: 400;
						  src: url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Regular.woff2") format("woff2"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Regular.woff") format("woff"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Regular.ttf") format("truetype");
						}

						@font-face {
						  font-display: fallback;
						  font-family: "GT America Medium";
						  font-weight: 600;
						  src: url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Medium.woff2") format("woff2"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Medium.woff") format("woff"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Medium.ttf") format("truetype");
						}

						@font-face {
						  font-display: fallback;
						  font-family: "GT America Condensed Bold";
						  font-weight: 700;
						  src: url("https://www.exploretock.com/fonts/gt-america/GT-America-Condensed-Bold.woff2") format("woff2"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Condensed-Bold.woff") format("woff"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Condensed-Bold.ttf") format("truetype");
						}

						/* CLIENT-SPECIFIC RESET */

						body,
						table,
						td,
						a {
						  -webkit-text-size-adjust: 100%;
						  -ms-text-size-adjust: 100%;
						}

						/* Prevent WebKit and Windows mobile changing default text sizes */

						table,
						td {
						  mso-table-lspace: 0pt;
						  mso-table-rspace: 0pt;
						}

						/* Remove spacing between tables in Outlook 2007 and up */

						img {
						  -ms-interpolation-mode: bicubic;
						}

						/* Allow smoother rendering of resized image in Internet Explorer */

						.im {
						  color: inherit !important;
						}

						/* DEVICE-SPECIFIC RESET */

						a[x-apple-data-detectors] {
						  color: inherit !important;
						  text-decoration: none !important;
						  font-size: inherit !important;
						  font-family: inherit !important;
						  font-weight: inherit !important;
						  line-height: inherit !important;
						}

						/* iOS BLUE LINKS */

						/* RESET */

						img {
						  border: 0;
						  height: auto;
						  line-height: 100%;
						  outline: none;
						  text-decoration: none;
						  display: block;
						}

						table {
						  border-collapse: collapse;
						}

						table td {
						  border-collapse: collapse;
						  display: table-cell;
						}

						body {
						  height: 100% !important;
						  margin: 0 !important;
						  padding: 0 !important;
						  width: 100% !important;
						}

						/* BG COLORS */

						.mainTable {
						  background-color: #F0F0F0;
						}

						.mainTable--hospitality {
						  background-color: #f7f2ed;
						}

						html {
						  background-color: #F0F0F0;
						}

						/* VARIABLES */

						.bg-white {
						  background-color: white;
						}

						.hr {
						  /* Cross-client horizontal rule. Adapted from https://litmus.com/community/discussions/4633-is-there-a-reliable-1px-horizontal-rule-method */
						  background-color: #d3d3d8;
						  border-collapse: collapse;
						  mso-table-lspace: 0pt;
						  mso-table-rspace: 0pt;
						  mso-line-height-rule: exactly;
						  line-height: 1px;
						}

						.textAlignLeft {
						  text-align: left !important;
						}

						.textAlignRight {
						  text-align: right !important;
						}

						.textAlignCenter {
						  text-align: center !important;
						}

						.mt1 {
						  margin-top: 6px;
						}

						.list {
						  padding-left: 18px;
						  margin: 0;
						}

						/* TYPOGRAPHY */

						body {
						  font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
						  font-weight: 400;
						  color: #4f4f65;
						  -webkit-font-smoothing: antialiased;
						  -ms-text-size-adjust: 100%;
						  -moz-osx-font-smoothing: grayscale;
						  font-smoothing: always;
						  text-rendering: optimizeLegibility;
						}

						.h1 {
						  font-family: "GT America Condensed Bold", "Roboto Condensed", "Roboto", "Helvetica", "Arial", sans-serif;
						  font-weight: 700;
						  vertical-align: middle;
						  font-size: 36px;
						  line-height: 42px;
						}

						.h2 {
						  font-family: "GT America Medium", "Roboto", "Helvetica", "Arial", sans-serif;
						  font-weight: 600;
						  vertical-align: middle;
						  font-size: 16px;
						  line-height: 24px;
						}

						.text {
						  font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
						  font-weight: 400;
						  font-size: 16px;
						  line-height: 21px;
						}

						.text-list {
						  font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
						  font-weight: 400;
						  font-size: 16px;
						  line-height: 25px;
						}

						.textSmall {
						  font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
						  font-weight: 400;
						  font-size: 14px;
						}

						.text-xsmall {
						  font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
						  font-size: 11px;
						  text-transform: uppercase;
						  line-height: 22px;
						  letter-spacing: 1px;
						}

						.text-bold {
						  font-weight: 600;
						}

						.text-link {
						  text-decoration: underline;
						}

						.text-linkNoUnderline {
						  text-decoration: none;
						}

						.text-strike {
						  text-decoration: line-through;
						}

						/* FONT COLORS */

						.textColorDark {
						  color: #23233e;
						}

						.textColorNormal {
						  color: #4f4f65;
						}

						.textColorBlue {
						  color: #2020c0;
						}

						.textColorGrayDark {
						  color: #7B7B8B;
						}

						.textColorGray {
						  color: #A5A8AD;
						}

						.textColorWhite {
						  color: #FFFFFF;
						}

						.textColorRed {
						  color: #df3232;
						}

						/* BUTTON */

						.Button-primary-wrapper {
						  border-radius: 3px;
						  background-color: #2020C0;
						}

						.Button-primary {
						  font-family: "GT America Medium", "Roboto", "Helvetica", "Arial", sans-serif;
						  border-radius: 3px;
						  border: 1px solid #2020C0;
						  color: #ffffff;
						  display: block;
						  font-size: 16px;
						  font-weight: 600;
						  padding: 18px;
						  text-decoration: none;
						}

						.Button-secondary-wrapper {
						  border-radius: 3px;
						  background-color: #ffffff;
						}

						.Button-secondary {
						  font-family: "GT America Medium", "Roboto", "Helvetica", "Arial", sans-serif;
						  border-radius: 3px;
						  border: 1px solid #2020C0;
						  color: #2020C0;
						  display: block;
						  font-size: 16px;
						  font-weight: 600;
						  padding: 18px;
						  text-decoration: none;
						}

						/* LAYOUT */

						.Content-container {
						  padding-left: 60px;
						  padding-right: 60px;
						}

						.Content-container--main {
						  padding-top: 54px;
						  padding-bottom: 60px;
						}

						.Content {
						  width: 580px;
						  margin: 0 auto;
						}

						.wrapper {
						  max-width: 600px;
						}

						.section {
						  padding: 24px 0px;
						  border-bottom: 1px solid #d3d3d8;
						}

						.section--noBorder {
						  padding: 24px 0px 0;
						}

						.section--last {
						  padding: 24px 0px;
						}

						.message {
						  background-color: #F4F4F5;
						  padding: 18px;
						}

						.card {
						  border: 1px solid #d3d3d8;
						  padding: 18px;
						}

						/* HEADER */

						.header-tockLogoImage {
						  display: block;
						  color: #F0F0F0;
						}

						.header-heroImage {
						  padding-bottom: 24px;
						}

						/* PREHEADER */

						.preheader {
						  display: none;
						  font-size: 1px;
						  color: #FFFFFF;
						  line-height: 1px;
						  max-height: 0px;
						  max-width: 0px;
						  opacity: 0;
						  overflow: hidden;
						}

						/* BANNER */

						.notice {
						  padding: 12px;
						  background: #23233E;
						  color: #FFFFFF;
						  display: block;
						  font-size: 14px;
						  font-family: "GT America Medium", "Roboto", "Helvetica", "Arial", sans-serif;
						  font-weight: 600;
						}

						/* INTRO */

						.section--intro {
						  padding-bottom: 48px;
						}

						/* BOOKING INFO */

						.business-logo__container {
						  width: 48px;
						  height: 48px;
						  border-radius: 3px;
						  border: 1px solid #d3d3d8;
						  overflow: hidden;
						}

						.business-logo__image {
						  border: 1px solid transparent;
						  border-radius: 3px;
						  width: 48px;
						  height: 48px;
						  display: block;
						}

						.business-address--address {
						  width: 50%;
						}

						.business-address--map {
						  width: 50%;
						}

						.business-address--map-image {
						  width: 100%;
						}

						/* MOBILE TICKETS */

						.mobile-ticket--description {
						  width: 65%;
						  margin-top: 12px;
						  margin-right: 5%;
						}

						.mobile-ticket--code {
						  width: 30%;
						}

						.mobile-ticket--code-image {
						  width: 100%;
						}

						/* RESERVATION ACTIONS */

						.linksTable {
						  border-bottom: 1px solid #d3d3d8;
						}

						.linksTableRow {
						  padding: 24px 12px;
						}

						.actions-icon {
						  vertical-align: middle;
						}

						.actions-text {
						  vertical-align: middle;
						}

						/* RECEIPT */

						.receipt__container {
						  border: 1px solid #d3d3d8;
						  padding: 24px;
						}

						.receipt__row {
						  border-top: 1px solid #d3d3d8;
						}

						/* FEEDBACK ICONS */

						.feedback-link {
						  border: 1px solid #d4d5da;
						  border-radius: 3px;
						  display: inline-block;
						  width: calc(32% - 2px);
						  padding: 10px 0;
						}

						.feedback-link-bumper {
						  display: inline-block;
						  width: 1%;
						}

						.feedback-link img {
						  height: 50px;
						  width: 50px;
						}

						/* SOCIAL ICONS */

						.social-link {
						  display: inline-block;
						  width: auto;
						}

						.social-link-text {
						  padding: 14px 24px 14px 14px;
						}

						/* TABLET STYLES */

						@media screen and (max-width: 648px) {
						  /* DEVICE-SPECIFIC RESET */
						  div[style*="margin: 16px 0;"] {
							margin: 0 !important;
						  }
						  /* ANDROID CENTER FIX */
						  /* LAYOUT */
						  .wrapper {
							width: 100% !important;
							max-width: 100% !important;
						  }
						  .Content {
							width: 90% !important;
						  }
						  .Content-container {
							padding-left: 36px !important;
							padding-right: 36px !important;
						  }
						  .Content-container--main {
							padding-top: 30px !important;
							padding-bottom: 42px !important;
						  }
						  .responsiveTable {
							width: 100% !important;
						  }
						  /* RESERVATION ACTIONS */
						  .linksTableRow {
							padding-left: 0 !important;
							padding-right: 0 !important;
							padding-top: 12px !important;
							padding-bottom: 12px !important;
						  }
						  .linksTableRow--borderRight {
							border-right: none !important;
							padding-left: 0 !important;
							padding-right: 0 !important;
						  }
						  /* FEEDBACK LINK */
						  .feedback-link img {
							height: 38px !important;
							width: 38px !important;
						  }
						}

						/* MOBILE STYLES */

						@media screen and (max-width: 480px) {
						  /* TYPOGRAPHY */
						  .h1 {
							font-size: 30px !important;
							line-height: 30px !important;
						  }
						  .text {
							font-size: 16px !important;
							line-height: 22px !important;
						  }
						  /* BUTTON */
						  .mobile-buttonContainer {
							width: 100% !important;
						  }
						  /* LAYOUT */
						  .Content {
							width: 100% !important;
						  }
						  .Content-container {
							padding-left: 18px !important;
							padding-right: 18px !important;
						  }
						  .Content-container--main {
							padding-top: 24px !important;
							padding-bottom: 30px !important;
						  }
						  .section {
							padding: 18px 0 !important;
						  }
						  .section--last {
							padding: 18px 0 !important;
						  }
						  .header {
							padding: 0 18px !important;
						  }
						  .business-address--address {
							width: 100% !important;
						  }
						  .business-address--map {
							margin-top: 30px !important;
							width: 100% !important;
						  }
						  .mobile-ticket--description {
							width: 100% !important;
							margin-top: 0px !important;
						  }
						  .mobile-ticket--code {
							margin-top: 30px !important;
							margin-left: 0;
							width: 100% !important;
						  }
						  /* RECEIPT */
						  .receipt__container {
							padding: 12px !important;
						  }
						  /* SOCIAL ICONS */
						  .social-link {
							display: block !important;
							width: 100% !important;
							border-bottom: 1px solid #d3d3d8 !important;
						  }
						  /* INTRO */
						  .section--intro {
							padding-top: 18px !important;
							padding-bottom: 18px !important;
						  }
						}
					  </style>



					   
					  <!--[if mso]>
						<style type="text/css">
					.h1 {font-family: "Helvetica", "Arial", sans-serif !important; font-weight: 700 !important; vertical-align: middle !important; font-size: 36px !important; mso-line-height-rule: exactly;line-height: 42px !important;}
					.h2 {font-family: "Helvetica", "Arial", sans-serif !important;font-weight: 600 !important;vertical-align: middle !important;font-size: 16px !important;mso-line-height-rule: exactly;line-height: 24px !important;}
					.text {font-family: "Helvetica", "Arial", sans-serif !important;font-weight: 400 !important;font-size: 16px !important;mso-line-height-rule: exactly;line-height: 21px !important;}
					.text-list {font-family: "Helvetica", "Arial", sans-serif !important;font-weight: 400 !important;font-size: 16px !important;mso-line-height-rule: exactly;line-height: 25px !important;}
					.textSmall {font-family: "Helvetica", "Arial", sans-serif !important;font-weight: 400 !important;font-size: 14px !important;}
					.text-xsmall {font-family: "Helvetica", "Arial", sans-serif !important;font-size: 11px !important;text-transform: uppercase !important;mso-line-height-rule: exactly;line-height: 22px !important;letter-spacing: 1px !important;}
					.text-bold {font-weight: 600 !important;}
					.text-link {text-decoration: underline !important;}
					.text-linkNoUnderline {text-decoration: none !important;}
					.text-strike {text-decoration: line-through !important;}
					.textColorDark {color: #23233e !important;}
					.textColorNormal {color: #4f4f65 !important;}
					.textColorBlue {color: #2020c0 !important;}
					.textColorGray {color: #A5A8AD !important;}
					.textColorWhite {color: #FFFFFF !important;}
					.Button-primary {font-family: "Helvetica", "Arial", sans-serif !important;border-radius: 3px !important;border: 1px solid #2020C0 !important;color: #ffffff !important;display: block !important;font-size: 16px !important;font-weight: 600 !important;padding: 18px !important;text-decoration: none !important;}
					.Button-secondary {font-family: "Helvetica", "Arial", sans-serif !important;border-radius: 3px !important;border: 1px solid #2020C0 !important;color: #2020C0 !important;display: block !important;font-size: 16px !important;font-weight: 600 !important;padding: 18px !important;text-decoration: none !important;}
						</style>
						<![endif]-->
					  <!-- HIDDEN PREHEADER TEXT -->
					  <div class="preheader" style="display: none; font-size: 1px; color: rgb(255, 255, 255); line-height: 1px; max-height: 0px; max-width: 0px; opacity: 0; overflow: hidden;">
					  </div>
					  



					</body></html>';
			
			sendEmail($subject, $to, $emailContent);
			return $id;
			
		
	
		}
	
		
		
		
		function guestChildrenRemainingCount($data)
		{
			$dbCon = AppModel::createConnection();
			$checkout_id= $this -> encrypt_decrypt('decrypt',$data['checkid']);  
			$stmt = $dbCon->prepare("select guest_children from hotel_checkout_detail where id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $checkout_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowDate = $result->fetch_assoc();
			 
			$stmt = $dbCon->prepare("select count(id) as num from hotel_checkout_dependent_detail where hotel_checkout_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $checkout_id);
			$stmt->execute();
			$resultCount = $stmt->get_result();
			$rowDependentCount = $resultCount->fetch_assoc();
			$rowDate['guest_children']=$rowDate['guest_children']-$rowDependentCount['num'];
			 if($rowDate['guest_children']<0)
			 {
				 $rowDate['guest_children']=0;
			 }
			$stmt->close();
			$dbCon->close();
			return $rowDate['guest_children'];
		}

		function updateGuestRecord($data)
		{
			$dbCon = AppModel::createConnection();
			  
			$curl = curl_init();
			  curl_setopt_array($curl, array(
			  CURLOPT_URL => 'https://dstricts.com/user/index.php/DstrictsApp/updateGuestRecord',
			  CURLOPT_RETURNTRANSFER => true,
			  CURLOPT_ENCODING => '',
			  CURLOPT_MAXREDIRS => 10,
			  CURLOPT_TIMEOUT => 0,
			  CURLOPT_FOLLOWLOCATION => true,
			  CURLOPT_HTTP_VERSION => CURL_HTTP_VERSION_1_1,
			  CURLOPT_CUSTOMREQUEST => 'POST',
			  CURLOPT_POSTFIELDS => array('checkid' => $data['checkid'],'dstricts_user_id' => $data['dstricts_user_id'],'guest_adult' => $data['guest_adult'],'guest_children' => $data['guest_children']),
			));
			$response = curl_exec($curl);
			curl_close($curl);
			 
			$stmt = $dbCon->prepare("update hotel_checkout_detail set guest_adult=?,guest_children=? where id=?");
			/* bind parameters for markers */ 
			$stmt->bind_param("iii",$data['guest_adult'],$data['guest_children'],$data['checkid']);
			$stmt->execute();
			 
			$stmt->close();
			$dbCon->close();
			return 1;
			
			 
			
		}	
		
		
		function addDependentChekin($data)
		{
			$dbCon = AppModel::createConnection();
			
			$stmt = $dbCon->prepare("insert into hotel_checkout_dependent_detail(dependent_id,hotel_checkout_id,created_on) values (?, ?, now())");
			/* bind parameters for markers */
			$stmt->bind_param("ii",$data['child_id'],$data['checkid']);
			$stmt->execute();
			$id=$stmt->insert_id; 
			$stmt->close();
			$dbCon->close();
			return $id;
			
		}
		
		
		function verifyDependentChekin($data)
		{
			$dbCon = AppModel::createConnection();
			if(!isset($data['verification_info']))
			{
			$data['verification_info']=1;	
			}
			if($data['verification_info']==1)
			{
			$stmt = $dbCon->prepare("update hotel_checkout_dependent_detail set is_verified=1 where id=?");	
			}
			else
			{
			$stmt = $dbCon->prepare("update hotel_checkout_invitation_info set is_verified=1 where id=?");	
			}
			/* bind parameters for markers */
			$stmt->bind_param("i",$data['id']);
			$stmt->execute();
			$id=$stmt->insert_id; 
			$stmt->close();
			$dbCon->close();
			return 1;
			
			 
			
		}
		
		function verifyAdultChekin($data)
		{
			$dbCon = AppModel::createConnection();
			
			$stmt = $dbCon->prepare("update hotel_checkout_invitation_info set is_verified=1 where id=?");
			/* bind parameters for markers */
			$stmt->bind_param("i",$data['id']);
			$stmt->execute();
			$id=$stmt->insert_id; 
			$stmt->close();
			$dbCon->close();
			return 1;
			
			 
			
		}
		
		
		function dependentsCheckedInList($data)
		{
			 $dbCon = AppModel::createConnection();
			
			$stmt = $dbCon->prepare("delete from hotel_checkout_dependent_detail where hotel_checkout_id=? and is_verified=0");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['checkid']);
			$stmt->execute();	
			
			$stmt = $dbCon->prepare("select id,concat_ws(' ',first_name,last_name) as name  from dependents where id in (select dependent_id from hotel_checkout_dependent_detail where hotel_checkout_id=?) and dependent_type=1");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['checkid']);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			while($row = $result->fetch_assoc())
			{
			 
			$row['name']=html_entity_decode($row['name'],ENT_NOQUOTES, 'UTF-8'); 
			array_push($org,$row);
			}
			$stmt->close();
			$dbCon->close();
			return $org;
		}
		
		
		
		function adultsCheckedInList($data)
		{
			$dbCon = AppModel::createConnection();
			
			$stmt = $dbCon->prepare("select id,concat_ws(' ',first_name,last_name) as name from user_logins where id=(select user_id from hotel_checkout_detail where id=?)");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['checkid']);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			$row = $result->fetch_assoc();
			$row['is_confirmed']=1;
			$row['name']=html_entity_decode($row['name'],ENT_NOQUOTES, 'UTF-8');	 
			array_push($org,$row);
			
			$stmt = $dbCon->prepare("select hotel_checkout_invitation_info.id,concat_ws(' ',first_name,last_name) as name,is_confirmed,invitation_type,hotel_checkout_invitation_info.email,country_code,phone_number,pre_checked  from hotel_checkout_invitation_info left join user_logins on user_logins.id=hotel_checkout_invitation_info.invited_user_id where hotel_checkout_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['checkid']);
			$stmt->execute();
			$result = $stmt->get_result();
			 $j=1;
			while($row = $result->fetch_assoc())
			{
			 if($row['is_confirmed']==1)
			 {
				$row['name']=html_entity_decode($row['name'],ENT_NOQUOTES, 'UTF-8');	 
			 }
			 else
			 {
				if($row['invitation_type']==1)
				 {
					$row['name']='+'.$row['country_code'].'-'.$row['phone_number'];	
				 }	
				 else
				 {
					 $row['name']=$row['email'];	  
				 }
			 }
			 
			 $org[$j]['is_confirmed']=$row['is_confirmed'];
			 $org[$j]['name']=$row['name'];
			 $org[$j]['id']=$row['id'];
			$j++;
			}
			$stmt->close();
			$dbCon->close();
			return $org;
		}


		function dependentsListForCheckin($data)
		{
			 $dbCon = AppModel::createConnection();
			 $id=$this->encrypt_decrypt('decrypt',$data['id']);
			 
			$stmt = $dbCon->prepare("select id,concat_ws(' ',first_name,last_name) as name,ssn,first_name,email,dependent_type,created_on,image_path,address  from dependents where id in (select dependent_id from dependent_guardian where guardian_user_id=? and is_approved=1) and created_by=? and id not in (select dependent_id from hotel_checkout_dependent_detail where hotel_checkout_id=?) and dependent_type=1");
			
			/* bind parameters for markers */
			$stmt->bind_param("iii", $data['user_id'], $data['user_id'],$id);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			while($row = $result->fetch_assoc())
			{
			$filename="../estorecss/".$row ['image_path'].".txt"; if (file_exists($filename)) { $value_a=file_get_contents("../estorecss/".$row ['image_path'].".txt"); $value_a=str_replace('"','',$value_a);  $imgs = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$row ['image_path'].'.jpg' ); $imgs=str_replace('../','',$imgs); $imgs='https://www.safeqloud.com/'.$imgs; } 
			else {   $imgs= "https://www.safeqloud.com/html/usercontent/images/default-profile-pic.jpg"; }
			$row['child_image']=$imgs;
			$row['address']=html_entity_decode($row['address'],ENT_NOQUOTES, 'UTF-8'); 
			$row['name']=html_entity_decode($row['name'],ENT_NOQUOTES, 'UTF-8'); 
			array_push($org,$row);
			}
			$stmt->close();
			$dbCon->close();
			return $org;
		}
		
		
		function dependentsListForCheckinDstrict($data)
		{
			 $dbCon = AppModel::createConnection();
			  
			$stmt = $dbCon->prepare("select id,concat_ws(' ',first_name,last_name) as name,ssn,first_name,email,dependent_type,created_on,image_path,address  from dependents where id in (select dependent_id from dependent_guardian where guardian_user_id=? and is_approved=1) and created_by=? and id not in (select dependent_id from hotel_checkout_dependent_detail where hotel_checkout_id=?) and dependent_type=1");
			
			/* bind parameters for markers */
			$stmt->bind_param("iii", $data['user_id'], $data['user_id'],$data['checkid']);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			while($row = $result->fetch_assoc())
			{
			$filename="../estorecss/".$row ['image_path'].".txt"; if (file_exists($filename)) { $value_a=file_get_contents("../estorecss/".$row ['image_path'].".txt"); $value_a=str_replace('"','',$value_a);  $imgs = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$row ['image_path'].'.jpg' ); $imgs=str_replace('../','',$imgs); $imgs='https://www.safeqloud.com/'.$imgs; } 
			else {   $imgs= "https://www.safeqloud.com/html/usercontent/images/default-profile-pic.jpg"; }
			$row['child_image']=$imgs;
			if($row['address']=='' || $row['address']==null)
			{
				$row['address']='---';
			}
			$row['address']=html_entity_decode($row['address'],ENT_NOQUOTES, 'UTF-8'); 
			$row['name']=html_entity_decode($row['name'],ENT_NOQUOTES, 'UTF-8'); 
			array_push($org,$row);
			}
			$stmt->close();
			$dbCon->close();
			return $org;
		}

		function venueInfomationDetail($data)
		{
			$dbCon = AppModel::createConnection();
			  
		$stmt = $dbCon->prepare("select * from company_venue where id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['venue_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			$row['venue_name']=html_entity_decode($row['venue_name'],ENT_NOQUOTES, 'UTF-8'); 
			$row['venue_description']=html_entity_decode(trim(strip_tags($row['venue_description'])),ENT_NOQUOTES, 'UTF-8');
			
			$stmt = $dbCon->prepare("select * from company_venue_photos where venue_id=? and sorting_number=1");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $row['id']);
			$stmt->execute();
			$result2 = $stmt->get_result();
			$rowPhoto = $result2->fetch_assoc();
			 
			 $filename="../estorecss/".$rowPhoto['venue_photo_path'].".txt"; $value_a=file_get_contents("../estorecss/".$rowPhoto['venue_photo_path'].".txt"); $value_a=str_replace('"','',$value_a); $rowPhoto['image_path1'] = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$rowPhoto['venue_photo_path'].'.jpg' );
			 
			$row['image_path1']=str_replace('../','https://www.safeqloud.com/',$rowPhoto['image_path1']);
			$row['venue_type_details']=array();
			$a=explode(',',substr($row['venue_type'],0,-1));
			 
			$stmt = $dbCon->prepare("select id from venue_type");
			$stmt->execute();
			$result2 = $stmt->get_result();
			while($rowVenue = $result2->fetch_assoc())
			{
				if($rowVenue['id']==1)
				{
					$rowVenue['type_info']='Business meeting';
				}
				else if($rowVenue['id']==2)
				{
					$rowVenue['type_info']='Mingle atmosphere';
				}
				else if($rowVenue['id']==3)
				{
					$rowVenue['type_info']='Fest atmosphere';
				}
				
				
				if (in_array($rowVenue['id'], $a))
						{
						$rowVenue['available_type']='Yes';
						}
						else
						{
						$rowVenue['available_type']='No';
						}
						
						array_push($row['venue_type_details'],$rowVenue);
			}
			
			$row['food_type_details']=array();
			$a=explode(',',substr($row['food_and_drink'],0,-1));
			$stmt = $dbCon->prepare("select * from venue_food_type");
			$stmt->execute();
			$result2 = $stmt->get_result();
			while($rowVenue = $result2->fetch_assoc())
			{
				 
				if (in_array($rowVenue['id'], $a))
						{
						$rowVenue['available_type']='Yes';
						}
						else
						{
						$rowVenue['available_type']='No';
						}
						
						array_push($row['food_type_details'],$rowVenue);
			}
				
			$stmt->close();
			$dbCon->close();
			return $row;
		}
		function countWellnessOneToOneAvailableServices($data)
		{
			$dbCon = AppModel::createConnection();
			  
			$stmt = $dbCon->prepare("select count(service_id) as num from wellness_available_services left join dishes_detail_information on dishes_detail_information.id=wellness_available_services.service_id where wellness_id=? and is_bookable=1 and one_shared=1 and service_id not in (select dish_id from hotel_roomservice_item_ordered where wellness_id=? and booking_person_id=? and is_verified=0 and qloud_checkout_id=?)");
			/* bind parameters for markers */ 
			$stmt->bind_param("iiii",$data['wellness_id'],$data['wellness_id'],$data['dstricts_user_id'],$data['checkid']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row= $result->fetch_assoc();
			 
			$stmt->close();
			$dbCon->close();
			return $row['num'];
		}	



		function deleteWellnessAllCartItems($data)
		{
			$dbCon = AppModel::createConnection();
			  
			$curl = curl_init();
			  curl_setopt_array($curl, array(
			  CURLOPT_URL => 'https://dstricts.com/user/index.php/DstrictsApp/deleteWellnessAllCartItems',
			  CURLOPT_RETURNTRANSFER => true,
			  CURLOPT_ENCODING => '',
			  CURLOPT_MAXREDIRS => 10,
			  CURLOPT_TIMEOUT => 0,
			  CURLOPT_FOLLOWLOCATION => true,
			  CURLOPT_HTTP_VERSION => CURL_HTTP_VERSION_1_1,
			  CURLOPT_CUSTOMREQUEST => 'POST',
			  CURLOPT_POSTFIELDS => array('checkid' => $data['checkid'],'dstricts_user_id' => $data['dstricts_user_id'],'wellness_id' => $data['wellness_id']),
			));
			$response = curl_exec($curl);
			curl_close($curl);
			 
			$stmt = $dbCon->prepare("delete from hotel_roomservice_item_ordered where qloud_checkout_id=? and is_verified=0 and booking_person_id=?");
			/* bind parameters for markers */ 
			$stmt->bind_param("ii",$data['checkid'],$data['dstricts_user_id']);
			$stmt->execute();
			
			$stmt = $dbCon->prepare("select count(id) as num from hotel_roomservice_item_ordered where wellness_id=? and booking_person_id=? and is_verified=0 and qloud_checkout_id=?");
			/* bind parameters for markers */ 
			$stmt->bind_param("iii",$data['wellness_id'],$data['dstricts_user_id'],$data['checkid']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row= $result->fetch_assoc();
			 
			$stmt->close();
			$dbCon->close();
			return $row['num'];
			
			 
			
		}	

	function selectedWellnessCategoriesandMenu($data)
		{
			function base64_to_jpeg($base64_string, $output_file) {
			$ifp = fopen( $output_file, 'wb' ); 
			$data = explode( ',', $base64_string );
			fwrite( $ifp, base64_decode( $data[1] ) );
			fclose( $ifp ); 
			return $output_file; 
			}
			$dbCon = AppModel::createConnection();
			
			if($data['selected_services_type']==1)
			{
			$stmt = $dbCon->prepare("select * from bookable_service_categories where id in (select bookable_service_category_id from dishes_detail_information where id in (select service_id from wellness_available_services where wellness_id=?) and is_bookable=1 and one_shared=1)");
			$stmt->bind_param("i", $data['wellness_id']);
			}
			else if($data['selected_services_type']==2)
			{
			$stmt = $dbCon->prepare("select * from bookable_service_categories where id in (select bookable_service_category_id from dishes_detail_information where id in (select service_id from wellness_available_services where wellness_id=?) and is_bookable=1 and one_shared=2 and (one_shared_type =2 or one_shared_type =3))");
			$stmt->bind_param("i", $data['wellness_id']);	
			}
			else if($data['selected_services_type']==3)
			{
			$stmt = $dbCon->prepare("select * from bookable_service_categories where id in (select bookable_service_category_id from dishes_detail_information where id in (select service_id from wellness_available_services where wellness_id=?) and is_bookable=1 and one_shared=2 and (one_shared_type =1 or one_shared_type =3))");
			$stmt->bind_param("i", $data['wellness_id']);	
			}
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			$j=0;
			while($row= $result->fetch_assoc())
			{
				 
				array_push($org,$row);
				$org[$j]['menu']=array();
			if($data['selected_services_type']==1)
			{
			$stmt = $dbCon->prepare("select count(id) as num from hotel_roomservice_item_ordered where wellness_id=? and booking_person_id=? and one_shared=1 and is_verified=0 and qloud_checkout_id=?");
			$stmt->bind_param("iii", $data['wellness_id'],$data['dstricts_user_id'],$data['checkid']);
			$stmt->execute();
			$result2 = $stmt->get_result();
			$rowCount= $result2->fetch_assoc();
			if($rowCount['num']==0)
			{
			$stmt = $dbCon->prepare("select id,dish_name,dish_detail,dish_price,is_bookable,is_active,is_physical,one_shared,one_shared_type,recurring_event,open_event_date,open_total_person, dish_image from dishes_detail_information where id in (select service_id from wellness_available_services where wellness_id=?) and bookable_service_category_id=? and is_bookable=1 and one_shared=1");
			$stmt->bind_param("ii", $data['wellness_id'],$row['id']);	
			}
			else
			{
				$stmt = $dbCon->prepare("select id,dish_name,dish_detail,dish_price,is_bookable,is_active,is_physical,one_shared,one_shared_type,recurring_event,open_event_date,open_total_person, dish_image from dishes_detail_information where id in (select service_id from wellness_available_services where wellness_id=?) and bookable_service_category_id=? and is_bookable=1 and one_shared=1 and id not in (select dish_id from hotel_roomservice_item_ordered where wellness_id=? and booking_person_id=? and is_verified=0 and qloud_checkout_id=?)");
				$stmt->bind_param("iiiii", $data['wellness_id'],$row['id'], $data['wellness_id'],$data['dstricts_user_id'],$data['checkid']);
			}
			
			
			}
			else if($data['selected_services_type']==2)
			{
			$stmt = $dbCon->prepare("select id,dish_name,dish_detail,dish_price,is_bookable,is_active,is_physical,one_shared,one_shared_type,recurring_event,open_event_date,open_total_person, dish_image from dishes_detail_information where id in (select service_id from wellness_available_services where wellness_id=?) and bookable_service_category_id=? and is_bookable=1 and one_shared=2 and (one_shared_type =2 or one_shared_type =3)");
			$stmt->bind_param("ii", $data['wellness_id'],$row['id']);	
			}
			else if($data['selected_services_type']==3)
			{
			$stmt = $dbCon->prepare("select id,dish_name,dish_detail,dish_price,is_bookable,is_active,is_physical,one_shared,one_shared_type,recurring_event,open_event_date,open_total_person, dish_image from dishes_detail_information where id in (select service_id from wellness_available_services where wellness_id=?) and bookable_service_category_id=? and is_bookable=1 and one_shared=2 and (one_shared_type =1 or one_shared_type =3)");
			$stmt->bind_param("ii", $data['wellness_id'],$row['id']);
			}
			 
			 
			$stmt->execute();
			$result3 = $stmt->get_result();
			 
			while($row3= $result3->fetch_assoc())
			{
				if($data['selected_services_type']==2)
				{
					$row3['one_shared_type']=2;
				}
				if($data['selected_services_type']==3)
				{
				if($row3['one_shared']==2 && $row3['one_shared_type']==1 && $row3['recurring_event']==0)
				{
				$stmt = $dbCon->prepare("select sum(dish_quantity) as total_booked from hotel_roomservice_item_ordered where dish_id=? and service_type=5");
				$stmt->bind_param("i",$row3['id']);
				$stmt->execute();
				$result2 = $stmt->get_result();	
				$row2 = $result2->fetch_assoc();
				$row3['open_total_person']=$row3['open_total_person']-$row2['total_booked'];
				if($row3['open_total_person']==0)
					continue;
				}
				$row3['one_shared_type']=1;
				}
				$row3['service_category_name']=$row['service_category_name'];
				$row3['dish_detail']=str_replace('/r','',$row3['dish_detail']);
				$row3['dish_detail']=str_replace('/n','',$row3['dish_detail']);
				$row3['dish_detail']=strip_tags(trim($row3['dish_detail']));
				$filename="../estorecss/".$row3 ['dish_image'].".txt"; if (file_exists($filename)) { $value_a=file_get_contents("../estorecss/".$row3 ['dish_image'].".txt"); $value_a=str_replace('"','',$value_a);  $imgs = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$row3 ['dish_image'].'.jpg' );  $imgs='../../../../'.$imgs; } else { $value_a="../../../../../html/usercontent/images/default-profile-pic.jpg";  $imgs="../../../../../html/usercontent/images/default-profile-pic.jpg"; }
				$imgs=str_replace('../../../../../','https://www.safeqloud.com/',$imgs);
				$row3['dish_image']=$imgs;
				array_push($org[$j]['menu'],$row3);
				
			}
			$j++;
			}
			$stmt->close();
			$dbCon->close();
			return $org;
			
			
		}
	 
		 
	


	function wellnessSearchFollowingCount($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select count(id) as num from wellness_following_info where wellness_id=? and is_following=1");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['wellness_id']); 
			$stmt->execute();
			$result2 = $stmt->get_result();
			$row2 = $result2->fetch_assoc();
				 
			$stmt->close();
			$dbCon->close();
			return $row2['num'];
			
			
		}

	function wellnessUpdateFollowing($data)
		{
			$dbCon = AppModel::createConnection();
			
			$stmt = $dbCon->prepare("select  id,is_following from wellness_following_info where wellness_id=? and user_id=?");
			$stmt->bind_param("ii",$data['wellness_id'],$data['dstricts_user_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			if($row['is_following']==0)
			{
				$isFollowing=1;
			}
			else
			{
				$isFollowing=0;
			}
			$stmt = $dbCon->prepare("update wellness_following_info set is_following=?  where wellness_id=? and user_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("iii", $isFollowing,$data['wellness_id'],$data['dstricts_user_id']); 
			$stmt->execute();
			$result2 = $stmt->get_result();
			
			$stmt = $dbCon->prepare("select count(id) as num from wellness_following_info where wellness_id=? and is_following=1");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['wellness_id']); 
			$stmt->execute();
			$result2 = $stmt->get_result();
			$row2 = $result2->fetch_assoc();
			
			$stmt->close();
			$dbCon->close();
			return $row2['num'];
			
			
		}

	function wellnessSearchList($data)
		{
			$dbCon = AppModel::createConnection();
			$name='%'.htmlentities($data['name'],ENT_NOQUOTES, 'UTF-8').'%';
			$stmt = $dbCon->prepare("select id,center_name as name,center_name as first_name from wellness_center_information where center_name like ?");
			
			/* bind parameters for markers */
			$stmt->bind_param("s", $name); 
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			 
			while($row = $result->fetch_assoc())
			{
				
				$stmt = $dbCon->prepare("select count(id) as num from wellness_following_info where wellness_id=? and user_id=?");
			
				/* bind parameters for markers */
				$stmt->bind_param("ii", $row['id'],$data['dstricts_user_id']); 
				$stmt->execute();
				$result2 = $stmt->get_result();
				$row2 = $result2->fetch_assoc();
				 
				if($row2['num']==0)
				{
				
				$stmt = $dbCon->prepare("insert into wellness_following_info (wellness_id, user_id,created_on,modified_on) values (?,?,now(),now())");
			
				/* bind parameters for markers */
				$stmt->bind_param("ii", $row['id'],$data['dstricts_user_id']); 
				$stmt->execute();	
				}
				
				$stmt = $dbCon->prepare("select id,is_following from wellness_following_info where wellness_id=? and user_id=?");
			
				/* bind parameters for markers */
				$stmt->bind_param("ii", $row['id'],$data['dstricts_user_id']); 
				$stmt->execute();
				$result2 = $stmt->get_result();
				$row2 = $result2->fetch_assoc();
				$row['is_following']=$row2['is_following'];
				$row['id_following']=$row2['id'];
				$row['passport_image']="";
				$row['first_name']=html_entity_decode($row['first_name'],ENT_NOQUOTES, 'UTF-8');
				$row['name']=html_entity_decode($row['name'],ENT_NOQUOTES, 'UTF-8'); 
				$row['user_image']='https://www.safeqloud.com/html/usercontent/images/bg/hotel1.jpg';
				array_push($org,$row);
				 
			}
			 
			$stmt->close();
			$dbCon->close();
			return $org;
			
			
		}

	function resturantPackageComboList($data)
		{
			 
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select  * from resturant_package_info where resturant_id=?");
			$stmt->bind_param("i",$data['resturant_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			while($row = $result->fetch_assoc())
			{
			$stmt = $dbCon->prepare("select sum(active_category) as num from package_category_dishes where package_id=?");
			$stmt->bind_param("i",$row['id']);
			$stmt->execute();
			$result2 = $stmt->get_result();
			$row2 = $result2->fetch_assoc();
			if($row2['num']==0)
				continue;
			array_push($org,$row);
			}
			 
			 
			 
			$stmt->close();
			$dbCon->close();  
			return $org;
			
		}
		
		
		function resturantPackageCategoryList($data)
		{
			 
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select food_category_id,food_category  from package_category_dishes left join food_category on food_category.id=package_category_dishes.food_category_id where package_id=? and active_category=1");
			$stmt->bind_param("i",$data['package_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			while($row = $result->fetch_assoc())
			{
			array_push($org,$row);
			}
			$stmt->close();
			$dbCon->close();  
			return $org;
			
		}
		
		
		function resturantPackageCategoryDishesList($data)
		{
			 
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select id,dish_name,dish_detail,dish_image from dishes_detail_information where id in (select available_package_dishes  from package_category_dishes where package_id=? and active_category=1 and food_category_id=?)");
			$stmt->bind_param("ii",$data['package_id'],$data['food_category_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			while($rowDishes = $result->fetch_assoc())
			{
			$rowDishes['dish_detail']=strip_tags(trim($rowDishes['dish_detail']));
			$filename="../estorecss/".$rowDishes ['dish_image'].".txt"; if (file_exists($filename)) { $value_a=file_get_contents("../estorecss/".$rowDishes ['dish_image'].".txt"); $value_a=str_replace('"','',$value_a);  $imgs = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$rowDishes ['dish_image'].'.jpg' );  $imgs='../../../../'.$imgs; } else { $value_a="../../../../../html/usercontent/images/default-profile-pic.jpg";  $imgs="../../../../../html/usercontent/images/default-profile-pic.jpg"; }
			$imgs=str_replace('../../../../../','https://www.safeqloud.com/',$imgs);
			$rowDishes['dish_image']=$imgs;
			array_push($org,$rowDishes);
			}
			$stmt->close();
			$dbCon->close();  
			return $org;
			
		}


	function wellnessServiceInfoCount($data)
		{
			$dbCon = AppModel::createConnection();
			
			$stmt = $dbCon->prepare("select count(id) as num from dishes_detail_information where id in (select service_id from wellness_available_services where wellness_id=?) and is_bookable=1 and one_shared=2 and (one_shared_type =1 or one_shared_type =3)");
			/* bind parameters for markers */
			 
			$stmt->bind_param("i", $data['wellness_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			$org=array();
			
			$org['public_service']=$row['num'];
			$stmt = $dbCon->prepare("select count(id) as num  from dishes_detail_information where id in (select service_id from wellness_available_services where wellness_id=?) and is_bookable=1 and one_shared=2 and (one_shared_type =2 or one_shared_type =3)");
			/* bind parameters for markers */
			 
			$stmt->bind_param("i", $data['wellness_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			
			$org['private_service']=$row['num'];
			
			$stmt = $dbCon->prepare("select count(id) as num  from dishes_detail_information where id in (select service_id from wellness_available_services where wellness_id=?) and is_bookable=1 and one_shared=1");
			/* bind parameters for markers */
			 
			$stmt->bind_param("i", $data['wellness_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			
			$org['onetoone']=$row['num'];
			
			$stmt = $dbCon->prepare("select count(id) as num from hotel_roomservice_item_ordered where wellness_id=? and booking_person_id=? and one_shared=1 and is_verified=0 and qloud_checkout_id=?");
			$stmt->bind_param("iii", $data['wellness_id'],$data['dstricts_user_id'],$data['checkid']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowCount= $result->fetch_assoc();
			
			$org['onecart']=$rowCount['num'];
			
			$stmt->close();
			$dbCon->close();
			return $org;
			
		}
		
	 

	function addPublicServiceToCartApp($data)
		{
			$dbCon = AppModel::createConnection();
			  $isConfirmed=0;
			 $query="select property_id,company_id from wellness_center_information where id=".$data['wellness_id'];	
			 $result=(mysqli_query($dbCon,$query));
			 $rowCompany=mysqli_fetch_array($result);
			  
			   
			  $curl = curl_init();
			  curl_setopt_array($curl, array(
			  CURLOPT_URL => 'https://dstricts.com/user/index.php/DstrictsApp/addPublicServiceToCartApp',
			  CURLOPT_RETURNTRANSFER => true,
			  CURLOPT_ENCODING => '',
			  CURLOPT_MAXREDIRS => 10,
			  CURLOPT_TIMEOUT => 0,
			  CURLOPT_FOLLOWLOCATION => true,
			  CURLOPT_HTTP_VERSION => CURL_HTTP_VERSION_1_1,
			  CURLOPT_CUSTOMREQUEST => 'POST',
			  CURLOPT_POSTFIELDS => array('user_id' => $data['dstricts_user_id'],'checkout_id' => $data['checkid'],'company_id' => $rowCompany['company_id'],'dish_detail' => $data['dish_detail'],'dish_name' => $data['dish_name'],'dish_image' => $data['dish_image'],'price' => $data['price'],'quantity' => $data['quantity'],'location_id' => $rowCompany['property_id'],'item_id' => $data['item_id'],'service_type' => $data['service_type'],'shared_type' => $data['one_shared'],'shared_type_private' => $data['one_shared_type'],'wellness_id' => $data['wellness_id'],'is_confirmed' => $isConfirmed,'booking_date' => $data['open_event_date'],'booking_time' => $data['open_event_time']),
			));
 
			 
			
			$response = curl_exec($curl);
			curl_close($curl);
			 
			$t=$data['price']*$data['quantity'];
			$stmt = $dbCon->prepare("insert into hotel_roomservice_item_ordered(is_private,location_id,booking_person_id,one_shared,dish_price,dish_id,dish_quantity,dish_name,dish_image,dish_detail,total_price,created_on,service_type,wellness_id,qloud_checkout_id,is_confirmed_employee, booking_time, booking_date)
			values(?,?,?,?,?,?,?,?,?,?,?,now(),?,?,?,?,?,?)");
			$stmt->bind_param("iiiiiiisssiiiiiis",$data['one_shared_type'],$rowCompany['property_id'],$data['dstricts_user_id'],$data['one_shared'],$data['price'],$data['item_id'],$data['quantity'],$data['dish_name'],$data['dish_image'],$data['dish_detail'],$t,$data['service_type'],$data['wellness_id'],$data['checkid'],$isConfirmed,$data['open_event_time'],$data['open_event_date']);
			$stmt->execute();
			
			 
			$stmt->close();
			$dbCon->close();
			return 1;
				
		}
	
	
	
	function wellnessSelectedServiceInfo($data)
		{
			 
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select dishes_detail_information.id,dish_name,dish_detail,dish_price,is_bookable,is_active,is_physical,dish_image,one_shared,one_shared_type,recurring_event,open_event_date,open_total_person,open_event_time,work_time,open_price_per_person,private_price from dishes_detail_information left join working_hrs on working_hrs.id=dishes_detail_information.open_event_time where dishes_detail_information.id=?");
			$stmt->bind_param("i",$data['dish_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowDishes = $result->fetch_assoc();
			 
			if($rowDishes['one_shared']==2 && $rowDishes['one_shared_type']==1 && $rowDishes['recurring_event']==0)
			{
			$stmt = $dbCon->prepare("select sum(dish_quantity) as total_booked from hotel_roomservice_item_ordered where dish_id=? and service_type=5");
			$stmt->bind_param("i",$rowDishes['id']);
			$stmt->execute();
			$result2 = $stmt->get_result();	
			$row2 = $result2->fetch_assoc();
			$rowDishes['open_total_person']=$rowDishes['open_total_person']-$row2['total_booked'];
			$rowDishes['booking_date']=date('Y-m-d',$rowDishes['open_event_date']);
			}
			
			$rowDishes['dish_detail']=strip_tags(trim($rowDishes['dish_detail']));
			$filename="../estorecss/".$rowDishes ['dish_image'].".txt"; if (file_exists($filename)) { $value_a=file_get_contents("../estorecss/".$rowDishes ['dish_image'].".txt"); $value_a=str_replace('"','',$value_a);  $imgs = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$rowDishes ['dish_image'].'.jpg' );  $imgs='../../../../'.$imgs; } else { $value_a="../../../../../html/usercontent/images/default-profile-pic.jpg";  $imgs="../../../../../html/usercontent/images/default-profile-pic.jpg"; }
			$imgs=str_replace('../../../../../','https://www.safeqloud.com/',$imgs);
			$rowDishes['dish_image']=$imgs;
			 
			$stmt->close();
			$dbCon->close();  
			return $rowDishes;
			
		}

	function WellnessPrivateCalenderInfo($data)
	{
		$dbCon = AppModel::createConnection();
		
		$query="select property_id,company_id from wellness_center_information where id=".$data['wellness_id'];	
		$result=(mysqli_query($dbCon,$query));
		$rowCompany=mysqli_fetch_array($result);
		
		$query="select dish_id from hotel_roomservice_item_ordered where qloud_checkout_id=".$data['checkid']." and wellness_id=".$data['wellness_id']." and service_type=5 and is_verified=0 and booking_person_id=".$data['dstricts_user_id'];
		$result=(mysqli_query($dbCon,$query));
		$items='';
		while($row=mysqli_fetch_array($result))
		{
			
			$items=$items.$row['dish_id'].',';
		}
		$items=substr($items,0,-1);
		$b=explode(',',$items);
	   
		$query="select time_required,post_production_time,preparation_time,total_private_events from dishes_detail_information where id in ('".$items."')";
		$result=(mysqli_query($dbCon,$query));
		$timeRequired=0;
		$rowTime=mysqli_fetch_array($result);
	 
		$timeRequired=$timeRequired+$rowTime['time_required']+$rowTime['post_production_time']+$rowTime['preparation_time'];
		
		
		$org=array();
		$timeRequired=round($timeRequired/2);
		$startDate=date('d-m-Y',$data['date_id']);
		$weekDay=date('w', $data['date_id']); 
	 
		$queryBooked="select count(id) as num from hotel_roomservice_item_ordered where dish_id in (select dish_id from hotel_roomservice_item_ordered where booking_person_id=".$data['dstricts_user_id'].") and booking_date=".$startDate;
		$resultBooked=(mysqli_query($dbCon,$queryBooked));
		$rowBooked=mysqli_fetch_array($resultBooked);
		
		 
 
		if($rowBooked['num']==$rowTime['total_private_events'])
		{
			 
		return $org;	
		}
			
		 
		if($data['employee_id']==0)
		{
		$query="select id,services_available from employees where company_id=".$rowCompany['company_id']." and (user_login_id in (select user_login_id from user_company_profile where location_id=".$rowCompany['property_id'].") or user_login_id=43)";	
		}
		else
		{
			$query="select id,services_available from employees where id=".$data['employee_id'];
		}
		$result=(mysqli_query($dbCon,$query));
		$ids='';
		while($row=mysqli_fetch_array($result))
		{
			 
			$queryBooked="select count(id) as num from hotel_roomservice_item_ordered where booked_employee_id=".$row['id']." and one_shared=2 and booking_date=".$startDate;
			$resultBooked=(mysqli_query($dbCon,$queryBooked));
			$rowBooked=mysqli_fetch_array($resultBooked);
			
			
			$queryBooked="select shared_events_per_day from employee_service_booking_rules where employee_id=".$row['id'];
			$resultEmpBooked=(mysqli_query($dbCon,$queryBooked));
			$rowEmpBooked=mysqli_fetch_array($resultEmpBooked);
			
			
			
			if($rowBooked['num']==$rowEmpBooked['shared_events_per_day'])
			{
				continue;
			}
			 
			$query2="select working_day from employee_working_hrs where day_id=".$weekDay." and employee_id=".$row['id'];
			$result2=(mysqli_query($dbCon,$query2));
			$row2=mysqli_fetch_array($result2);
			 
			if($row2['working_day']==0)
			{
				continue;
			}
			$res=1;
			$c=explode(',',$row['services_available']);
			foreach($b as $key)
			{
					if (in_array($key, $c))
						{
						$res=1;
						}
						else
						{
						$res=0;
						break;
						}
							
			}
			if($res==1)
			{
			$ids=$ids.$row['id'].',';	
			}
		}
		
		 
		
		$ids=substr($ids,0,-1);
		$emps=explode(',',$ids);
		 
		$workId="0";
		
		foreach($emps as $key1)
		{
			 
		$bookedDate='0';
		$query2="select booking_time from hotel_roomservice_item_ordered where booked_employee_id=".$key1." and booking_date='".$startDate."'";
		$result2=(mysqli_query($dbCon,$query2));
		while($row2=mysqli_fetch_array($result2))
		{
			$bookedDate=$bookedDate.",".$row2['booking_time'];
		}
 
		  
		$query2="select work_start_time,work_end_time,lunch_start_time,lunch_end_time from employee_working_hrs where day_id=".$weekDay." and employee_id=".$key1;
		$result2=(mysqli_query($dbCon,$query2));
		$row2=mysqli_fetch_array($result2);
		$row2['lunch_end_time']=$row2['lunch_end_time']-1; 
		$query="select id,work_time from working_hrs where (id between ".$row2['work_start_time']." and ".$row2['work_end_time'].") and (id not between ".$row2['lunch_start_time']." and ".$row2['lunch_end_time'].")  and id not in (select id from working_hrs where id in (".$bookedDate."))";
		$result=(mysqli_query($dbCon,$query));
		$ids='';
		while($row=mysqli_fetch_array($result))
		{
		$workId=$workId.",".$row['id'];
		//$row['emp_id']=$key1;
		//array_push($org,$row);
		$ids=$ids.$row['id'].",";
		}
			
		$dataWork=explode(',',substr($ids,0,-1));
		$avail=1;
		$j=0;
		 
		foreach($dataWork as $key3)
		{
			for($t=0;$t<$timeRequired;$t++)
			{
				$value=(int)$key3+$t;
				if (in_array($value, $dataWork))
				{
				$avail=1;
				}
				else
				{
				$avail=0;
				break;
				}
			}
			
			if($avail==1)
			{
				$query="select id,work_time from working_hrs where id=".$key3;
				$result=(mysqli_query($dbCon,$query));
				$row=mysqli_fetch_array($result);
				$row['emp_id']=$key1;
				$reg=1;
			foreach($org as $vals)
			{
				if($vals['id']==$row['id'])
				{
					$reg=0;
					break;
				}
			}
			if($reg==1)
			{
			$row['time_required']=$timeRequired;
			$row['date']=$data['date_id'];
			$row['work_time']=html_entity_decode($row['work_time'],ENT_NOQUOTES, 'UTF-8');	
			array_push($org,$row);	
			}
			
			 //if(!in_array($row,$org))
				//array_push($org,$row);
			}
		}
		$key2 = array_column($org, 'id');

		array_multisort($key2, SORT_ASC, $org);
		}
		
	
		
	
	 
	$dbCon->close();  
	return $org;
	}
	
	function wellnessOpenCalenderInfo($data)
	{
		$dbCon = AppModel::createConnection();
		$query="select property_id,company_id from wellness_center_information where id=".$data['wellness_id'];	
		$result=(mysqli_query($dbCon,$query));
		$rowCompany=mysqli_fetch_array($result);
		$company_id=$rowCompany['company_id'];
		$location_id=$rowCompany['property_id']; 
		
		$query="select dish_id,dish_quantity from hotel_roomservice_item_ordered where service_type=5 and is_verified=0 and booking_person_id=".$data['dstricts_user_id'];
		$result=(mysqli_query($dbCon,$query));
		$row=mysqli_fetch_array($result);
		
		
		 $data['quantity']=$row['dish_quantity'];
		$items=$row['dish_id'];
		$query="select time_required,post_production_time,preparation_time,open_total_person from dishes_detail_information where id=".$items;
		$result=(mysqli_query($dbCon,$query));
		$timeRequired=0;
		$row=mysqli_fetch_array($result);
		$timeRequired=$timeRequired+$row['time_required']+$row['post_production_time']+$row['preparation_time'];
		$totalPerson=$row['open_total_person'];
		$org=array();
		$timeRequired=round($timeRequired/2);
		 
	$startDate=date('d-m-Y',$data['date_id']);

	 
	$weekDay=date('w', strtotime($startDate.' day')); 
	 
	 
	$query="select day_id,event_day,id,work_time from dish_service_recurring_information left join working_hrs on working_hrs.id=dish_service_recurring_information.event_start_time where day_id=".$weekDay." and dish_id=".$items;
	$result=(mysqli_query($dbCon,$query));
	$row=mysqli_fetch_array($result); 
	 
	if($row['event_day']==0)
		return $org;
	
					$stmt = $dbCon->prepare("select sum(dish_quantity) as total_booked from hotel_roomservice_item_ordered where dish_id=? and service_type=5");
					$stmt->bind_param("i",$items);
					$stmt->execute();
					$result2 = $stmt->get_result();	
					$row2 = $result2->fetch_assoc();
					if($row2['total_booked']==$totalPerson)
						return $org;
					if(($totalPerson-$row2['total_booked'])<$data['quantity'])
						return $org;
	
	 $row['work_time']=html_entity_decode($row['work_time'],ENT_NOQUOTES, 'UTF-8');	
	 $row['time_required']=$timeRequired;
	 $row['date']=$data['date_id'];	
	 $row['emp_id']=0;	 
	$stmt->close();
	$dbCon->close();  
	return $row;
	}
	
	
	
	
	function deleteWellnessSharedItems($data)
		{
			$dbCon = AppModel::createConnection();
			  
			  $curl = curl_init();
			  curl_setopt_array($curl, array(
			  CURLOPT_URL => 'https://dstricts.com/user/index.php/DstrictsApp/deleteWellnessSharedItems',
			  CURLOPT_RETURNTRANSFER => true,
			  CURLOPT_ENCODING => '',
			  CURLOPT_MAXREDIRS => 10,
			  CURLOPT_TIMEOUT => 0,
			  CURLOPT_FOLLOWLOCATION => true,
			  CURLOPT_HTTP_VERSION => CURL_HTTP_VERSION_1_1,
			  CURLOPT_CUSTOMREQUEST => 'POST',
			  CURLOPT_POSTFIELDS => array('checkid' => $data['checkid'],'service_type' => $data['service_type'],'wellness_id' => $data['wellness_id']),
			));
			$response = curl_exec($curl);
			curl_close($curl);
			 
			$stmt = $dbCon->prepare("delete from hotel_roomservice_item_ordered where qloud_checkout_id=? and is_verified=0 and service_type=? and wellness_id=? and one_shared=2");
			/* bind parameters for markers */ 
			$stmt->bind_param("iii",$data['checkid'],$data['service_type'],$data['wellness_id']);
			$stmt->execute();
			$stmt->close();
			$dbCon->close();
			return 1;
			
			 
			
		}	
		
		


		function wellnessCartBookingTimeUpdate($data)
		{
			$dbCon = AppModel::createConnection();
			
			$stmt = $dbCon->prepare("select id from working_hrs where work_time=?");
			/* bind parameters for markers */
			 
			$stmt->bind_param("s",$data['booking_time']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
 
			$bookingTime=$row['id'].',';//$data['booking_time'].',';
			 for($i=1;$i<$data['total_booking_time'];$i++)
			 {
				 $newTime=$row['id']+$i;//$data['booking_time']+$i;
				 $bookingTime=$bookingTime.$newTime.',';
			 }
			 $bookingTime=substr($bookingTime,0,-1);
			 
			 if($data['employee_id']==0)
			 {
				 $isConfirmed=0;
			 }
			 else
			 {
				$isConfirmed=1; 
			 }
			 
			 $curl = curl_init();
				curl_setopt_array($curl, array(
			  CURLOPT_URL => 'https://dstricts.com/user/index.php/DstrictsApp/wellnessCartBookingTimeUpdate',
			  CURLOPT_RETURNTRANSFER => true,
			  CURLOPT_ENCODING => '',
			  CURLOPT_MAXREDIRS => 10,
			  CURLOPT_TIMEOUT => 0,
			  CURLOPT_FOLLOWLOCATION => true,
			  CURLOPT_HTTP_VERSION => CURL_HTTP_VERSION_1_1,
			  CURLOPT_CUSTOMREQUEST => 'POST',
			  CURLOPT_POSTFIELDS => array('checkid' => $data['checkid'],'wellness_id' => $data['wellness_id'],'user_id' => $data['dstricts_user_id'],'booking_time' => $bookingTime,'booking_employee_id' => $data['booking_employee_id'],'is_confirmed' => $isConfirmed,'booking_date' => $data['booking_date']),
			));
				 
			$response = curl_exec($curl);
			curl_close($curl);
			 
			$stmt = $dbCon->prepare("update hotel_roomservice_item_ordered set is_confirmed_employee=?,booked_employee_id=?, booking_time=?, booking_date=?  where qloud_checkout_id=? and is_verified=0 and service_type=5 and booking_person_id=? and wellness_id=?");
			/* bind parameters for markers */
			$stmt->bind_param("iissiii",$isConfirmed,$data['booking_employee_id'],$bookingTime,$data['booking_date'],$data['checkid'],$data['dstricts_user_id'],$data['wellness_id']);
			$stmt->execute();
			
			$stmt->close();
			$dbCon->close();
			return 1;
			
			 
			
		}
	
	function UpdateWellnessCartItem($data)
		{
			$dbCon = AppModel::createConnection();
			  
			  $curl = curl_init();
			  curl_setopt_array($curl, array(
			  CURLOPT_URL => 'https://dstricts.com/user/index.php/DstrictsApp/UpdateWellnessCartItem',
			  CURLOPT_RETURNTRANSFER => true,
			  CURLOPT_ENCODING => '',
			  CURLOPT_MAXREDIRS => 10,
			  CURLOPT_TIMEOUT => 0,
			  CURLOPT_FOLLOWLOCATION => true,
			  CURLOPT_HTTP_VERSION => CURL_HTTP_VERSION_1_1,
			  CURLOPT_CUSTOMREQUEST => 'POST',
			  CURLOPT_POSTFIELDS => array('checkid' => $data['checkid'],'dish_id' => $data['dish_id'],'service_type' => $data['service_type'],'wellness_id' => $data['wellness_id'],'dstricts_user_id' => $data['dstricts_user_id']),
			));
			$response = curl_exec($curl);
			curl_close($curl);
			 
			$stmt = $dbCon->prepare("delete from hotel_roomservice_item_ordered where qloud_checkout_id=? and is_verified=0 and dish_id=? and service_type=? and wellness_id=? and booking_person_id");
			/* bind parameters for markers */ 
			$stmt->bind_param("iiiii",$data['checkid'],$data['dish_id'],$data['service_type'],$data['wellness_id'],$data['dstricts_user_id']);
			$stmt->execute();
			$stmt->close();
			$dbCon->close();
			return 1;
			
			 
			
		}
	
	
	
	function cartInfoWellnessList($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select * from hotel_roomservice_item_ordered where qloud_checkout_id=? and is_verified=0 and service_type=? and wellness_id=?");
			/* bind parameters for markers */
			 
			$stmt->bind_param("iii",$data['checkid'],$data['service_type'],$data['wellness_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			while($row = $result->fetch_assoc())
			{
				$row['dish_detail']=trim($row['dish_detail']);
				array_push($org,$row);
			}
			$stmt->close();
			$dbCon->close();
			return $org;
			
			 
			
		}
		
		
		function cartInfoWellnessListCount($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select count(id) as num from hotel_roomservice_item_ordered where qloud_checkout_id=? and is_verified=0 and service_type=? and wellness_id=?");
			/* bind parameters for markers */
			 
			$stmt->bind_param("iii",$data['checkid'],$data['service_type'],$data['wellness_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			$stmt->close();
			$dbCon->close();
			return $row;
			
			 
			
		}
		
		function UpdateAmenitycartItemCount($data)
		{
			$dbCon = AppModel::createConnection();
			 
			$stmt = $dbCon->prepare("select amenity_id,user_id,created_on,qloud_checkout_id,aminity_quantity,aminity_price,amenity_name from company_hotel_amenities_user_request where id=?");
			/* bind parameters for markers */
			 
			$stmt->bind_param("i",$data['id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			  $curl = curl_init();
			 curl_setopt_array($curl, array(
			  CURLOPT_URL => 'https://dstricts.com/user/index.php/DstrictsApp/UpdateAmenitycartItemCount',
			  CURLOPT_RETURNTRANSFER => true,
			  CURLOPT_ENCODING => '',
			  CURLOPT_MAXREDIRS => 10,
			  CURLOPT_TIMEOUT => 0,
			  CURLOPT_FOLLOWLOCATION => true,
			  CURLOPT_HTTP_VERSION => CURL_HTTP_VERSION_1_1,
			  CURLOPT_CUSTOMREQUEST => 'POST',
			  CURLOPT_POSTFIELDS => array('id' => $data['id']),
			));

			 
			
			$response = curl_exec($curl);
			curl_close($curl);
				 
			if($data['quantity']==0)
			{
			$stmt = $dbCon->prepare("delete from company_hotel_amenities_user_request where id=?");
			/* bind parameters for markers */
			 
			$stmt->bind_param("i",$data['id']);
			$stmt->execute();
			}
			else
			{
			$stmt = $dbCon->prepare("update company_hotel_amenities_user_request set aminity_quantity=?  where id=?");
			/* bind parameters for markers */
			 
			$stmt->bind_param("ii",$data['quantity'],$data['id']);
			$stmt->execute();
			}
			
			
			$stmt->close();
			$dbCon->close();
			return 1;
			
			 
			
		}
	
	function addServiceToCartApp($data)
		{
			$dbCon = AppModel::createConnection();
			 
			 $query="select property_id,company_id from wellness_center_information where id=".$data['wellness_id'];	
			 $result=(mysqli_query($dbCon,$query));
			 $rowCompany=mysqli_fetch_array($result);
			 
			  if($data['one_shared']==1)
			 {
				$data['one_shared_type']=0; 
			 }
			  $curl = curl_init();
			curl_setopt_array($curl, array(
			  CURLOPT_URL => 'https://dstricts.com/user/index.php/DstrictsApp/addServiceToCartApp',
			  CURLOPT_RETURNTRANSFER => true,
			  CURLOPT_ENCODING => '',
			  CURLOPT_MAXREDIRS => 10,
			  CURLOPT_TIMEOUT => 0,
			  CURLOPT_FOLLOWLOCATION => true,
			  CURLOPT_HTTP_VERSION => CURL_HTTP_VERSION_1_1,
			  CURLOPT_CUSTOMREQUEST => 'POST',
			  CURLOPT_POSTFIELDS => array('user_id' => $data['dstricts_user_id'],'checkout_id' => $data['checkid'],'company_id' => $rowCompany['company_id'],'dish_detail' => $data['dish_detail'],'dish_name' => $data['dish_name'],'dish_image' => $data['dish_image'],'price' => $data['price'],'quantity' => $data['quantity'],'location_id' => $rowCompany['property_id'],'item_id' => $data['item_id'],'service_type' => $data['service_type'],'shared_type' => $data['one_shared'],'shared_type_private' => $data['one_shared_type'],'wellness_id' => $data['wellness_id']),
			));
 
			 
			
			$response = curl_exec($curl);
			curl_close($curl);
			 
			$t=$data['price']*$data['quantity'];
			$stmt = $dbCon->prepare("insert into hotel_roomservice_item_ordered(is_private,location_id,booking_person_id,one_shared,dish_price,dish_id,dish_quantity,dish_name,dish_image,dish_detail,total_price,created_on,service_type,wellness_id,qloud_checkout_id)
			values(?,?,?,?,?,?,?,?,?,?,?,now(),?,?,?)");
			$stmt->bind_param("iiiiiiisssiiii",$data['one_shared_type'],$rowCompany['property_id'],$data['dstricts_user_id'],$data['one_shared'],$data['price'],$data['item_id'],$data['quantity'],$data['dish_name'],$data['dish_image'],$data['dish_detail'],$t,$data['service_type'],$data['wellness_id'],$data['checkid']);
			$stmt->execute();
			
			$stmt = $dbCon->prepare("select * from hotel_roomservice_item_ordered where qloud_checkout_id=? and is_verified=0 and service_type=? and wellness_id=?");
			/* bind parameters for markers */
			 
			$stmt->bind_param("iii",$data['checkid'],$data['service_type'],$data['wellness_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			while($row = $result->fetch_assoc())
			{
				$row['dish_detail']=trim($row['dish_detail']);
				array_push($org,$row);
			}
			$stmt->close();
			$dbCon->close();
			return $org;
				
		}
	
	
	function selectEmployeeForSelectedServices($data)
	{
		$dbCon = AppModel::createConnection();
		
		$query="select property_id,company_id from wellness_center_information where id=".$data['wellness_id'];	
		$result=(mysqli_query($dbCon,$query));
		$rowCompany=mysqli_fetch_array($result);
		 
		  
		$query="select dish_id from hotel_roomservice_item_ordered where service_type=5 and is_verified=0 and booking_person_id=".$data['dstricts_user_id']." and wellness_id=".$data['wellness_id']."  and qloud_checkout_id=".$data['checkid'];
		$result=(mysqli_query($dbCon,$query));
		$items='';
		while($row=mysqli_fetch_array($result))
		{
			
			$items=$items.$row['dish_id'].',';
		}
		$items=substr($items,0,-1);
		 
		$b=explode(',',$items); 
		$org=array();
		 
	  
		$query="select passport_image,employees.id,services_available,concat_ws(' ',employees.first_name,employees.last_name) as name, employees.email from employees left join user_logins on user_logins.id=employees.user_login_id where company_id=".$rowCompany['company_id']." and (user_login_id in (select user_login_id from user_company_profile where location_id=".$rowCompany['property_id'].") or user_login_id=43)";	
		 
		$result=(mysqli_query($dbCon,$query));
		 
		while($row=mysqli_fetch_array($result))
		{
			
			 
			$res=1;
			$c=explode(',',$row['services_available']);
			foreach($b as $key)
			{
					if (in_array($key, $c))
						{
						$res=1;
						}
						else
						{
						$res=0;
						break;
						}
							
			}
			
			if($res==1)
			{
				if($row['passport_image']=="" || $row['passport_image']==null)
				{
					$row['user_image']='https://www.safeqloud.com/html/usercontent/images/person-male.png';
				}
				else
				{
				$filename="../estorecss/".$row['passport_image'].".txt"; $value_a=file_get_contents("../estorecss/".$row['passport_image'].".txt"); $value_a=str_replace('"','',$value_a); $row['passport_image'] = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$row['passport_image'].'.jpg' );
				$row['user_image']=str_replace('../','https://www.safeqloud.com/',$row['passport_image']);
				}
			array_push($org,$row);	
			}
		}
	 
	$dbCon->close();  
	return $org;
	}
	
	function availableDatesForbooking()
	{
	$dbCon = AppModel::createConnection();
		
	$startDate=date('d-m-Y');
	$org=array();
	for($i=0;$i<=27;$i++)
	{		
	$org[$i]['date_id']=strtotime($startDate . ' +'.$i.' day');
	$org[$i]['date']=date('Y-m-d',strtotime($startDate . ' +'.$i.' day'));
 
	}
	 
	$dbCon->close();  
	return $org;
	}
	
	
	
	
	
	function employeeBookingCalenderInfoApp($data)
	{
		$dbCon = AppModel::createConnection();
		
		$query="select property_id,company_id from wellness_center_information where id=".$data['wellness_id'];	
		$result=(mysqli_query($dbCon,$query));
		$rowCompany=mysqli_fetch_array($result);
		 
		$query="select dish_id from hotel_roomservice_item_ordered where service_type=5 and is_verified=0 and booking_person_id=".$data['dstricts_user_id']." and wellness_id=".$data['wellness_id']."  and qloud_checkout_id=".$data['checkid'];
		$result=(mysqli_query($dbCon,$query));
		$items='';
		while($row=mysqli_fetch_array($result))
		{
			
			$items=$items.$row['dish_id'].',';
		}
		$items=substr($items,0,-1);
		$b=explode(',',$items);
	 
		$query="select time_required,post_production_time,preparation_time from dishes_detail_information where id in ('".$items."')";
		$result=(mysqli_query($dbCon,$query));
		$timeRequired=0;
		while($row=mysqli_fetch_array($result))
		{
			$timeRequired=$timeRequired+$row['time_required']+$row['post_production_time']+$row['preparation_time'];
		}
		
		$org=array();
		$timeRequired=round($timeRequired/2);
		//$flag=$data['date_id'];
	$startDate=date('d-m-Y',$data['date_id']);
 	$i=0;	
	//$org[$i]['timerequired']=$timeRequired;
	$date=strtotime($startDate);
	$weekDay=date('w', strtotime($startDate)); 
		if($data['employee_id']==0)
		{
		$query="select id,services_available from employees where company_id=".$rowCompany['company_id']." and (user_login_id in (select user_login_id from user_company_profile where location_id=".$rowCompany['property_id'].") or user_login_id=43)";	
		}
		else
		{
			$query="select id,services_available from employees where id=".$data['employee_id'];
		}
		$result=(mysqli_query($dbCon,$query));
		$ids='';
		while($row=mysqli_fetch_array($result))
		{
			   
			$query2="select working_day from employee_working_hrs where day_id=".$weekDay." and employee_id=".$row['id'];
			$result2=(mysqli_query($dbCon,$query2));
			$row2=mysqli_fetch_array($result2);
			 
			if($row2['working_day']==0)
			{
				continue;
			}
			$res=1;
			$c=explode(',',$row['services_available']);
			foreach($b as $key)
			{
					if (in_array($key, $c))
						{
						$res=1;
						}
						else
						{
						$res=0;
						break;
						}
							
			}
			if($res==1)
			{
			$ids=$ids.$row['id'].',';	
			}
		}
		if($ids=='')
		{
			$dbCon->close();  
			return $org;
		}
		$ids=substr($ids,0,-1);
		$emps=explode(',',$ids);
		 
		$workId="0";
		
		foreach($emps as $key1)
		{
			 
		$bookedDate='0';
		$query2="select booking_time from hotel_roomservice_item_ordered where booked_employee_id=".$key1." and booking_date='".$data['date_id']."'";
		$result2=(mysqli_query($dbCon,$query2));
		while($row2=mysqli_fetch_array($result2))
		{
			$bookedDate=$bookedDate.",".$row2['booking_time'];
		}
 
		  
		$query2="select work_start_time,work_end_time,lunch_start_time,lunch_end_time from employee_working_hrs where day_id=".$weekDay." and employee_id=".$key1;
		$result2=(mysqli_query($dbCon,$query2));
		$row2=mysqli_fetch_array($result2);
		$row2['lunch_end_time']=$row2['lunch_end_time']-1; 
		$query="select id,work_time from working_hrs where (id between ".$row2['work_start_time']." and ".$row2['work_end_time'].") and (id not between ".$row2['lunch_start_time']." and ".$row2['lunch_end_time'].")  and id not in (select id from working_hrs where id in (".$bookedDate."))";
		$result=(mysqli_query($dbCon,$query));
		$ids='';
		while($row=mysqli_fetch_array($result))
		{
		$workId=$workId.",".$row['id'];
		//$row['emp_id']=$key1;
		//array_push($org[$i]['work_time_info'],$row);
		$ids=$ids.$row['id'].",";
		}
		
		$dataWork=explode(',',substr($ids,0,-1));
		$avail=1;
		$j=0;
		 
		foreach($dataWork as $key3)
		{
			for($t=0;$t<$timeRequired;$t++)
			{
				$value=(int)$key3+$t;
				if (in_array($value, $dataWork))
				{
				$avail=1;
				}
				else
				{
				$avail=0;
				break;
				}
			}
			
			if($avail==1)
			{
				$query="select id,work_time from working_hrs where id=".$key3;
				$result=(mysqli_query($dbCon,$query));
				$row=mysqli_fetch_array($result);
				$row['emp_id']=$key1;
				$reg=1;
			foreach($org as $vals)
			{
				if($vals['id']==$row['id'])
				{
					$reg=0;
					break;
				}
			}
			if($reg==1)
			{
				$row['time_required']=$timeRequired;
				$row['date']=$date;
				$row['work_time']=html_entity_decode($row['work_time'],ENT_NOQUOTES, 'UTF-8');
				array_push($org,$row);
			}
			
			 //if(!in_array($row,$org[$i]['work_time_info']))
				//array_push($org[$i]['work_time_info'],$row);
			}
		}
		$key2 = array_column($org, 'id');

		array_multisort($key2, SORT_ASC, $org);
		}
		
	 
	 
	$dbCon->close();  
	return $org;
	}
	
	
	function selectedWellnessCategoriesSelection($data)
		{
			function base64_to_jpeg($base64_string, $output_file) {
			$ifp = fopen( $output_file, 'wb' ); 
			$data = explode( ',', $base64_string );
			fwrite( $ifp, base64_decode( $data[1] ) );
			fclose( $ifp ); 
			return $output_file; 
			}
			$dbCon = AppModel::createConnection();
			
			if($data['selected_services_type']==1)
			{
			$stmt = $dbCon->prepare("select * from bookable_service_categories where id in (select bookable_service_category_id from dishes_detail_information where id in (select service_id from wellness_available_services where wellness_id=?) and is_bookable=1 and one_shared=1)");
			$stmt->bind_param("i", $data['wellness_id']);
			}
			else if($data['selected_services_type']==2)
			{
			$stmt = $dbCon->prepare("select * from bookable_service_categories where id in (select bookable_service_category_id from dishes_detail_information where id in (select service_id from wellness_available_services where wellness_id=?) and is_bookable=1 and one_shared=2 and (one_shared_type =2 or one_shared_type =3))");
			$stmt->bind_param("i", $data['wellness_id']);	
			}
			else if($data['selected_services_type']==3)
			{
			$stmt = $dbCon->prepare("select * from bookable_service_categories where id in (select bookable_service_category_id from dishes_detail_information where id in (select service_id from wellness_available_services where wellness_id=?) and is_bookable=1 and one_shared=2 and (one_shared_type =1 or one_shared_type =3))");
			$stmt->bind_param("i", $data['wellness_id']);	
			}
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			while($row= $result->fetch_assoc())
			{
				 
				array_push($org,$row);
			}
			$stmt->close();
			$dbCon->close();
			return $org;
			
			
		}
	 
		 function selectedWellnessBookingAppMenuSelection($data)
		{
			function base64_to_jpeg($base64_string, $output_file) {
			$ifp = fopen( $output_file, 'wb' ); 
			$data = explode( ',', $base64_string );
			fwrite( $ifp, base64_decode( $data[1] ) );
			fclose( $ifp ); 
			return $output_file; 
			}
			 
			$dbCon = AppModel::createConnection();
			 
			if($data['selected_services_type']==1)
			{
			$stmt = $dbCon->prepare("select count(id) as num from hotel_roomservice_item_ordered where wellness_id=? and booking_person_id=? and one_shared=1 and is_verified=0 and qloud_checkout_id=?");
			$stmt->bind_param("iii", $data['wellness_id'],$data['dstricts_user_id'],$data['checkid']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowCount= $result->fetch_assoc();
			if($rowCount['num']==0)
			{
			$stmt = $dbCon->prepare("select id,dish_name,dish_detail,dish_price,is_bookable,is_active,is_physical,one_shared,one_shared_type,recurring_event,open_event_date,open_total_person, dish_image from dishes_detail_information where id in (select service_id from wellness_available_services where wellness_id=?) and bookable_service_category_id=? and is_bookable=1 and one_shared=1");
			$stmt->bind_param("ii", $data['wellness_id'],$data['bookable_service_id']);	
			}
			else
			{
				$stmt = $dbCon->prepare("select id,dish_name,dish_detail,dish_price,is_bookable,is_active,is_physical,one_shared,one_shared_type,recurring_event,open_event_date,open_total_person, dish_image from dishes_detail_information where id in (select service_id from wellness_available_services where wellness_id=?) and bookable_service_category_id=? and is_bookable=1 and one_shared=1 and id not in (select dish_id from hotel_roomservice_item_ordered where wellness_id=? and booking_person_id=? and is_verified=0 and qloud_checkout_id=?)");
				$stmt->bind_param("iiiii", $data['wellness_id'],$data['bookable_service_id'], $data['wellness_id'],$data['dstricts_user_id'],$data['checkid']);
			}
			
			
			}
			else if($data['selected_services_type']==2)
			{
			$stmt = $dbCon->prepare("select id,dish_name,dish_detail,dish_price,is_bookable,is_active,is_physical,one_shared,one_shared_type,recurring_event,open_event_date,open_total_person, dish_image from dishes_detail_information where id in (select service_id from wellness_available_services where wellness_id=?) and bookable_service_category_id=? and is_bookable=1 and one_shared=2 and (one_shared_type =2 or one_shared_type =3)");
			$stmt->bind_param("ii", $data['wellness_id'],$data['bookable_service_id']);	
			}
			else if($data['selected_services_type']==3)
			{
			$stmt = $dbCon->prepare("select id,dish_name,dish_detail,dish_price,is_bookable,is_active,is_physical,one_shared,one_shared_type,recurring_event,open_event_date,open_total_person, dish_image from dishes_detail_information where id in (select service_id from wellness_available_services where wellness_id=?) and bookable_service_category_id=? and is_bookable=1 and one_shared=2 and (one_shared_type =1 or one_shared_type =3)");
			$stmt->bind_param("ii", $data['wellness_id'],$data['bookable_service_id']);
			}
			 
			 
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			while($row= $result->fetch_assoc())
			{
				if($data['selected_services_type']==2)
				{
					$row['one_shared_type']=2;
				}
				if($data['selected_services_type']==3)
				{
				if($row['one_shared']==2 && $row['one_shared_type']==1 && $row['recurring_event']==0)
				{
				$stmt = $dbCon->prepare("select sum(dish_quantity) as total_booked from hotel_roomservice_item_ordered where dish_id=? and service_type=5");
				$stmt->bind_param("i",$row['id']);
				$stmt->execute();
				$result2 = $stmt->get_result();	
				$row2 = $result2->fetch_assoc();
				$row['open_total_person']=$row['open_total_person']-$row2['total_booked'];
				if($row['open_total_person']==0)
					continue;
				}
				$row['one_shared_type']=1;
				}
				
				$row['dish_detail']=str_replace('/r','',$row['dish_detail']);
				$row['dish_detail']=str_replace('/n','',$row['dish_detail']);
				$row['dish_detail']=strip_tags(trim($row['dish_detail']));
				$filename="../estorecss/".$row ['dish_image'].".txt"; if (file_exists($filename)) { $value_a=file_get_contents("../estorecss/".$row ['dish_image'].".txt"); $value_a=str_replace('"','',$value_a);  $imgs = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$row ['dish_image'].'.jpg' );  $imgs='../../../../'.$imgs; } else { $value_a="../../../../../html/usercontent/images/default-profile-pic.jpg";  $imgs="../../../../../html/usercontent/images/default-profile-pic.jpg"; }
				$imgs=str_replace('../../../../../','https://www.safeqloud.com/',$imgs);
				$row['dish_image']=$imgs;
				array_push($org,$row);
				
			}
			$stmt->close();
			$dbCon->close();
			return $org;
			
			
		}
	 
	
	 
	
	function selectedWellnessCategories($data)
		{
			function base64_to_jpeg($base64_string, $output_file) {
			$ifp = fopen( $output_file, 'wb' ); 
			$data = explode( ',', $base64_string );
			fwrite( $ifp, base64_decode( $data[1] ) );
			fclose( $ifp ); 
			return $output_file; 
			}
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select count(id) as num from hotel_roomservice_item_ordered where wellness_id=? and booking_person_id=? and one_shared=1 and is_verified=0");
			$stmt->bind_param("ii", $data['wellness_id'],$data['dstricts_user_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowCount= $result->fetch_assoc();
			 
			if($rowCount['num']==0)
			{
			$stmt = $dbCon->prepare("select * from bookable_service_categories where id in (select bookable_service_category_id from dishes_detail_information where id in (select service_id from wellness_available_services where wellness_id=?) and is_bookable=1)");
			$stmt->bind_param("i", $data['wellness_id']);
			}
			else
			{
			$stmt = $dbCon->prepare("select * from bookable_service_categories where id in (select bookable_service_category_id from dishes_detail_information where id in (select service_id from wellness_available_services where wellness_id=?) and is_bookable=1 and one_shared=1 and id not in (select dish_id from hotel_roomservice_item_ordered where wellness_id=? and booking_person_id=? and is_verified=0))");
			$stmt->bind_param("iii", $data['wellness_id'],$data['wellness_id'],$data['dstricts_user_id']);	
			}
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			while($row= $result->fetch_assoc())
			{
				array_push($org,$row);
			}
			$stmt->close();
			$dbCon->close();
			return $org;
			
			
		}
	 
	 
	 function selectedWellnessBookingAppMenu($data)
		{
			function base64_to_jpeg($base64_string, $output_file) {
			$ifp = fopen( $output_file, 'wb' ); 
			$data = explode( ',', $base64_string );
			fwrite( $ifp, base64_decode( $data[1] ) );
			fclose( $ifp ); 
			return $output_file; 
			}
			 
			$dbCon = AppModel::createConnection();
			 
			$stmt = $dbCon->prepare("select count(id) as num from hotel_roomservice_item_ordered where wellness_id=? and booking_person_id=? and one_shared=1 and is_verified=0");
			$stmt->bind_param("ii", $data['wellness_id'],$data['dstricts_user_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowCount= $result->fetch_assoc();
			 
			if($rowCount['num']==0)
			{
			$stmt = $dbCon->prepare("select id,dish_name,dish_detail,dish_price,is_bookable,is_active,is_physical,one_shared,one_shared_type,recurring_event,open_event_date,open_total_person, dish_image from dishes_detail_information where id in (select service_id from wellness_available_services where wellness_id=?) and bookable_service_category_id=?");
			$stmt->bind_param("ii", $data['wellness_id'],$data['bookable_service_id']);	
			}				
			else
			{
				$stmt = $dbCon->prepare("select id,dish_name,dish_detail,dish_price,is_bookable,is_active,is_physical,one_shared,one_shared_type,recurring_event,open_event_date,open_total_person, dish_image from dishes_detail_information where id in (select service_id from wellness_available_services where wellness_id=?) and bookable_service_category_id=? and one_shared=1 and id not in (select dish_id from hotel_roomservice_item_ordered where wellness_id=? and booking_person_id=? and is_verified=0)");
				$stmt->bind_param("iiii", $data['wellness_id'],$data['bookable_service_id'],$data['wellness_id'],$data['dstricts_user_id']);
			}
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			while($row= $result->fetch_assoc())
			{
				
				if($row['one_shared']==2 && $row['one_shared_type']==1 && $row['recurring_event']==0)
				{
				$stmt = $dbCon->prepare("select sum(dish_quantity) as total_booked from hotel_roomservice_item_ordered where dish_id=? and service_type=5");
				$stmt->bind_param("i",$row['id']);
				$stmt->execute();
				$result2 = $stmt->get_result();	
				$row2 = $result2->fetch_assoc();
				$row['open_total_person']=$row['open_total_person']-$row2['total_booked'];
				if($row['open_total_person']==0)
					continue;
				}
				
				$row['dish_detail']=str_replace('/r','',$row['dish_detail']);
				$row['dish_detail']=str_replace('/n','',$row['dish_detail']);
				$row['dish_detail']=strip_tags(trim($row['dish_detail']));
				$filename="../estorecss/".$row ['dish_image'].".txt"; if (file_exists($filename)) { $value_a=file_get_contents("../estorecss/".$row ['dish_image'].".txt"); $value_a=str_replace('"','',$value_a);  $imgs = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$row ['dish_image'].'.jpg' );  $imgs='../../../../'.$imgs; } else { $value_a="../../../../../html/usercontent/images/default-profile-pic.jpg";  $imgs="../../../../../html/usercontent/images/default-profile-pic.jpg"; }
			$imgs=str_replace('../../../../../','https://www.safeqloud.com/',$imgs);
			$row['dish_image']=$imgs;
				array_push($org,$row);
				
			}
			$stmt->close();
			$dbCon->close();
			return $org;
			
			
		}
	 

	
	
	
	
	
	function updateBookingTimeInfo()
		{
			$dbCon = AppModel::createConnection();
			 
			$stmt = $dbCon->prepare("update hotel_roomservice_item_ordered set is_confirmed_employee=?,booked_employee_id=?, booking_time=?, booking_date=?  where qloud_checkout_id=0 and is_verified=0 and service_type=5 and booking_person_id=?");
			/* bind parameters for markers */
			$stmt->bind_param("iisii",$_POST['is_confirmed'],$_POST['booking_employee_id'],$_POST['booking_time'],$_POST['booking_date'],$_POST['user_id']);
			$stmt->execute();
			
			$stmt->close();
			$dbCon->close();
			return 1;
		}
		
		function bookingPrivateCalenderInfo()
	{
		$dbCon = AppModel::createConnection();
		 
		$company_id=$this->encrypt_decrypt('decrypt',$_POST['company_id']);
		$location_id=$this->encrypt_decrypt('decrypt',$_POST['location_id']); 
		 
		$query="select dish_id from hotel_roomservice_item_ordered where service_type=5 and is_verified=0 and booking_person_id=".$_POST['user_id'];
		$result=(mysqli_query($dbCon,$query));
		$items='';
		while($row=mysqli_fetch_array($result))
		{
			
			$items=$items.$row['dish_id'].',';
		}
		$items=substr($items,0,-1);
		$b=explode(',',$items);
	  
		$query="select time_required,post_production_time,preparation_time,total_private_events from dishes_detail_information where id in ('".$items."')";
		$result=(mysqli_query($dbCon,$query));
		$timeRequired=0;
		$rowTime=mysqli_fetch_array($result);
	 
		$timeRequired=$timeRequired+$rowTime['time_required']+$rowTime['post_production_time']+$rowTime['preparation_time'];
		
		
		$org=array();
		$timeRequired=round($timeRequired/2);
		$flag=$_POST['date_flag']*7;
	$startDate=date('d-m-Y',strtotime(date('d-m-Y') . ' +'.$flag.' day'));

	for($i=0;$i<=6;$i++)
	{		
	$org[$i]['timerequired']=$timeRequired;
	$org[$i]['date']=strtotime($startDate . ' +'.$i.' day');
	$weekDay=date('w', strtotime($startDate . ' +'.$i.' day')); 
	$org[$i]['work_time_info']=array();
	$queryBooked="select count(id) as num from hotel_roomservice_item_ordered where dish_id in (select dish_id from hotel_roomservice_item_ordered where booking_person_id=".$_POST['user_id'].") and booking_date=".$org[$i]['date'];
	$resultBooked=(mysqli_query($dbCon,$queryBooked));
	$rowBooked=mysqli_fetch_array($resultBooked);
	
 
		if($rowBooked['num']==$rowTime['total_private_events'])
			continue;
		
		if($_POST['employee_id']==0)
		{
		$query="select id,services_available from employees where company_id=".$company_id." and user_login_id in (select user_login_id from user_company_profile where location_id=".$location_id.")";	
		}
		else
		{
			$query="select id,services_available from employees where id=".$_POST['employee_id'];
		}
		$result=(mysqli_query($dbCon,$query));
		$ids='';
		while($row=mysqli_fetch_array($result))
		{
			$queryBooked="select count(id) as num from hotel_roomservice_item_ordered where booked_employee_id=".$row['id']." and one_shared=2 and booking_date=".$org[$i]['date'];
			$resultBooked=(mysqli_query($dbCon,$queryBooked));
			$rowBooked=mysqli_fetch_array($resultBooked);
			
			
			$queryBooked="select shared_events_per_day from employee_service_booking_rules where employee_id=".$row['id'];
			$resultEmpBooked=(mysqli_query($dbCon,$queryBooked));
			$rowEmpBooked=mysqli_fetch_array($resultEmpBooked);
			
			if($rowBooked['num']==$rowEmpBooked['shared_events_per_day'])
			{
				continue;
			}
			
			$query2="select working_day from employee_working_hrs where day_id=".$weekDay." and employee_id=".$row['id'];
			$result2=(mysqli_query($dbCon,$query2));
			$row2=mysqli_fetch_array($result2);
			 
			if($row2['working_day']==0)
			{
				continue;
			}
			$res=1;
			$c=explode(',',$row['services_available']);
			foreach($b as $key)
			{
					if (in_array($key, $c))
						{
						$res=1;
						}
						else
						{
						$res=0;
						break;
						}
							
			}
			if($res==1)
			{
			$ids=$ids.$row['id'].',';	
			}
		}
		$ids=substr($ids,0,-1);
		$emps=explode(',',$ids);
		
		if($ids=='')
		{
			continue;
		}	
		$workId="0";
		
		foreach($emps as $key1)
		{
			 
		$bookedDate='0';
		$query2="select booking_time from hotel_roomservice_item_ordered where booked_employee_id=".$key1." and booking_date='".$org[$i]['date']."'";
		$result2=(mysqli_query($dbCon,$query2));
		while($row2=mysqli_fetch_array($result2))
		{
			$bookedDate=$bookedDate.",".$row2['booking_time'];
		}
 
		  
		$query2="select work_start_time,work_end_time,lunch_start_time,lunch_end_time from employee_working_hrs where day_id=".$weekDay." and employee_id=".$key1;
		$result2=(mysqli_query($dbCon,$query2));
		$row2=mysqli_fetch_array($result2);
		$row2['lunch_end_time']=$row2['lunch_end_time']-1; 
		$query="select id,work_time from working_hrs where (id between ".$row2['work_start_time']." and ".$row2['work_end_time'].") and (id not between ".$row2['lunch_start_time']." and ".$row2['lunch_end_time'].")  and id not in (select id from working_hrs where id in (".$bookedDate."))";
		$result=(mysqli_query($dbCon,$query));
		$ids='';
		while($row=mysqli_fetch_array($result))
		{
		$workId=$workId.",".$row['id'];
		//$row['emp_id']=$key1;
		//array_push($org[$i]['work_time_info'],$row);
		$ids=$ids.$row['id'].",";
		}
		
		$dataWork=explode(',',substr($ids,0,-1));
		$avail=1;
		$j=0;
		 
		foreach($dataWork as $key3)
		{
			for($t=0;$t<$timeRequired;$t++)
			{
				$value=(int)$key3+$t;
				if (in_array($value, $dataWork))
				{
				$avail=1;
				}
				else
				{
				$avail=0;
				break;
				}
			}
			
			if($avail==1)
			{
				$query="select id from working_hrs where id=".$key3;
				$result=(mysqli_query($dbCon,$query));
				$row=mysqli_fetch_array($result);
				$row['emp_id']=$key1;
				$reg=1;
			foreach($org[$i]['work_time_info'] as $vals)
			{
				if($vals['id']==$row['id'])
				{
					$reg=0;
					break;
				}
			}
			if($reg==1)
			array_push($org[$i]['work_time_info'],$row);
			 //if(!in_array($row,$org[$i]['work_time_info']))
				//array_push($org[$i]['work_time_info'],$row);
			}
		}
		$key2 = array_column($org[$i]['work_time_info'], 'id');

		array_multisort($key2, SORT_ASC, $org[$i]['work_time_info']);
		}
		
	
		
	}
	 
	print_r(json_encode($org,true));
	$stmt->close();
	$dbCon->close();  
	return json_encode($org,true);
	}
	
	function bookingCalenderInfo()
	{
		$dbCon = AppModel::createConnection();
		
		$company_id=$this->encrypt_decrypt('decrypt',$_POST['company_id']);
		$location_id=$this->encrypt_decrypt('decrypt',$_POST['location_id']); 
		
		$query="select dish_id from hotel_roomservice_item_ordered where service_type=5 and is_verified=0 and booking_person_id=".$_POST['user_id'];
		$result=(mysqli_query($dbCon,$query));
		$items='';
		while($row=mysqli_fetch_array($result))
		{
			
			$items=$items.$row['dish_id'].',';
		}
		$items=substr($items,0,-1);
		$b=explode(',',$items);
	 
		$query="select time_required,post_production_time,preparation_time from dishes_detail_information where id in ('".$items."')";
		$result=(mysqli_query($dbCon,$query));
		$timeRequired=0;
		while($row=mysqli_fetch_array($result))
		{
			$timeRequired=$timeRequired+$row['time_required']+$row['post_production_time']+$row['preparation_time'];
		}
		
		$org=array();
		$timeRequired=round($timeRequired/2);
		$flag=$_POST['date_flag']*7;
	$startDate=date('d-m-Y',strtotime(date('d-m-Y') . ' +'.$flag.' day'));

	for($i=0;$i<=6;$i++)
	{		
	$org[$i]['timerequired']=$timeRequired;
	$org[$i]['date']=strtotime($startDate . ' +'.$i.' day');
	$weekDay=date('w', strtotime($startDate . ' +'.$i.' day')); 
		if($_POST['employee_id']==0)
		{
		$query="select id,services_available from employees where company_id=".$company_id." and user_login_id in (select user_login_id from user_company_profile where location_id=".$location_id.")";	
		}
		else
		{
			$query="select id,services_available from employees where id=".$_POST['employee_id'];
		}
		$result=(mysqli_query($dbCon,$query));
		$ids='';
		while($row=mysqli_fetch_array($result))
		{
			 
			$query2="select working_day from employee_working_hrs where day_id=".$weekDay." and employee_id=".$row['id'];
			$result2=(mysqli_query($dbCon,$query2));
			$row2=mysqli_fetch_array($result2);
			 
			if($row2['working_day']==0)
			{
				continue;
			}
			$res=1;
			$c=explode(',',$row['services_available']);
			foreach($b as $key)
			{
					if (in_array($key, $c))
						{
						$res=1;
						}
						else
						{
						$res=0;
						break;
						}
							
			}
			if($res==1)
			{
			$ids=$ids.$row['id'].',';	
			}
		}
		$ids=substr($ids,0,-1);
		$emps=explode(',',$ids);
		$org[$i]['work_time_info']=array();
		if($ids=='')
		{
			continue;
		}	
		$workId="0";
		
		foreach($emps as $key1)
		{
			 
		$bookedDate='0';
		$query2="select booking_time from hotel_roomservice_item_ordered where booked_employee_id=".$key1." and booking_date='".$org[$i]['date']."'";
		$result2=(mysqli_query($dbCon,$query2));
		while($row2=mysqli_fetch_array($result2))
		{
			$bookedDate=$bookedDate.",".$row2['booking_time'];
		}
 
		  
		$query2="select work_start_time,work_end_time,lunch_start_time,lunch_end_time from employee_working_hrs where day_id=".$weekDay." and employee_id=".$key1;
		$result2=(mysqli_query($dbCon,$query2));
		$row2=mysqli_fetch_array($result2);
		$row2['lunch_end_time']=$row2['lunch_end_time']-1; 
		$query="select id,work_time from working_hrs where (id between ".$row2['work_start_time']." and ".$row2['work_end_time'].") and (id not between ".$row2['lunch_start_time']." and ".$row2['lunch_end_time'].")  and id not in (select id from working_hrs where id in (".$bookedDate."))";
		$result=(mysqli_query($dbCon,$query));
		$ids='';
		while($row=mysqli_fetch_array($result))
		{
		$workId=$workId.",".$row['id'];
		//$row['emp_id']=$key1;
		//array_push($org[$i]['work_time_info'],$row);
		$ids=$ids.$row['id'].",";
		}
		
		$dataWork=explode(',',substr($ids,0,-1));
		$avail=1;
		$j=0;
		 
		foreach($dataWork as $key3)
		{
			for($t=0;$t<$timeRequired;$t++)
			{
				$value=(int)$key3+$t;
				if (in_array($value, $dataWork))
				{
				$avail=1;
				}
				else
				{
				$avail=0;
				break;
				}
			}
			
			if($avail==1)
			{
				$query="select id from working_hrs where id=".$key3;
				$result=(mysqli_query($dbCon,$query));
				$row=mysqli_fetch_array($result);
				$row['emp_id']=$key1;
				$reg=1;
			foreach($org[$i]['work_time_info'] as $vals)
			{
				if($vals['id']==$row['id'])
				{
					$reg=0;
					break;
				}
			}
			if($reg==1)
			array_push($org[$i]['work_time_info'],$row);
			 //if(!in_array($row,$org[$i]['work_time_info']))
				//array_push($org[$i]['work_time_info'],$row);
			}
		}
		$key2 = array_column($org[$i]['work_time_info'], 'id');

		array_multisort($key2, SORT_ASC, $org[$i]['work_time_info']);
		}
		
	
		
	}
	print_r(json_encode($org,true));
	$stmt->close();
	$dbCon->close();  
	return json_encode($org,true);
	}
	
	function bookingOpenCalenderInfo()
	{
		$dbCon = AppModel::createConnection();
		
		$company_id=$this->encrypt_decrypt('decrypt',$_POST['company_id']);
		$location_id=$this->encrypt_decrypt('decrypt',$_POST['location_id']); 
		
		$query="select dish_id from hotel_roomservice_item_ordered where service_type=5 and is_verified=0 and booking_person_id=".$_POST['user_id'];
		$result=(mysqli_query($dbCon,$query));
		$row=mysqli_fetch_array($result);
		 
		$items=$row['dish_id'];
		 
		$_POST['quantity']=1;
		$query="select time_required,post_production_time,preparation_time,open_total_person from dishes_detail_information where id=".$items;
		$result=(mysqli_query($dbCon,$query));
		$timeRequired=0;
		$row=mysqli_fetch_array($result);
		$timeRequired=$timeRequired+$row['time_required']+$row['post_production_time']+$row['preparation_time'];
		$totalPerson=$row['open_total_person'];
		$org=array();
		$timeRequired=round($timeRequired/2);
		$flag=$_POST['date_flag']*7;
	$startDate=date('d-m-Y',strtotime(date('d-m-Y') . ' +'.$flag.' day'));

	for($i=0;$i<=6;$i++)
	{		
	$org[$i]['timerequired']=$timeRequired;
	$org[$i]['date']=strtotime($startDate . ' +'.$i.' day');
	$weekDay=date('w', strtotime($startDate . ' +'.$i.' day')); 
	$org[$i]['work_time_info']=array(); 
	 
	$query="select day_id,event_day,id from dish_service_recurring_information left join working_hrs on working_hrs.id=dish_service_recurring_information.event_start_time where day_id=".$weekDay." and dish_id=".$items;
	$result=(mysqli_query($dbCon,$query));
	$row=mysqli_fetch_array($result); 
	 
	if($row['event_day']==0)
		continue;
	
					$stmt = $dbCon->prepare("select sum(dish_quantity) as total_booked from hotel_roomservice_item_ordered where dish_id=? and service_type=5");
					$stmt->bind_param("i",$items);
					$stmt->execute();
					$result2 = $stmt->get_result();	
					$row2 = $result2->fetch_assoc();
					if($row2['total_booked']==$totalPerson)
						continue;
					if(($totalPerson-$row2['total_booked'])<$_POST['quantity'])
						continue;
	 array_push($org[$i]['work_time_info'],$row);
			 
	}
	 
	//echo '<pre>'; print_r(json_encode($org,true)); echo '</pre>';  die;
	$stmt->close();
	$dbCon->close();  
	return json_encode($org,true);
	}
	
	function selectEmployee()
	{
		$dbCon = AppModel::createConnection();
		
		$company_id=$this->encrypt_decrypt('decrypt',$_POST['company_id']);
		$location_id=$this->encrypt_decrypt('decrypt',$_POST['location_id']); 
		
		$query="select dish_id from hotel_roomservice_item_ordered where booking_person_id=".$_POST['user_id'];
		$result=(mysqli_query($dbCon,$query));
		$items='';
		while($row=mysqli_fetch_array($result))
		{
			
			$items=$items.$row['dish_id'].',';
		}
		$items=substr($items,0,-1);
		$b=explode(',',$items); 
		$org=array();
		 
	  
		$query="select id,services_available,concat_ws(' ',first_name,last_name) as name, email from employees where company_id=".$company_id." and user_login_id in (select user_login_id from user_company_profile where location_id=".$location_id.")";	
		 
		$result=(mysqli_query($dbCon,$query));
		 
		while($row=mysqli_fetch_array($result))
		{
			
			 
			$res=1;
			$c=explode(',',$row['services_available']);
			foreach($b as $key)
			{
					if (in_array($key, $c))
						{
						$res=1;
						}
						else
						{
						$res=0;
						break;
						}
							
			}
			
			if($res==1)
			{
			array_push($org,$row);	
			}
		}
	print_r(json_encode($org,true));	 
	$stmt->close();
	$dbCon->close();  
	return $org;
	}
	
	function getLocationInfo()
		{
			 
			$dbCon = AppModel::createConnection();
			$bookable_service_category_id=$this->encrypt_decrypt('decrypt',$_POST['id']);
			$company_id=$this->encrypt_decrypt('decrypt',$_POST['company_id']);
			$location_id=$this->encrypt_decrypt('decrypt',$_POST['location_id']); 
			$stmt = $dbCon->prepare("select property_location.id,property_location.visiting_address,company_name,telephone,company_profiles.phone,company_profiles.address,property_location.latitude,property_location.longitude from property_location left join companies on companies.id=property_location.company_id left join company_profiles on company_profiles.company_id=companies.id where property_location.id=?");
			$stmt->bind_param("i",$location_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			$stmt->close();
			$dbCon->close();  
			return $row;
			
		}
	
	 function getServices()
		{
			 
			$dbCon = AppModel::createConnection();
			$bookable_service_category_id=$this->encrypt_decrypt('decrypt',$_POST['id']);
			$company_id=$this->encrypt_decrypt('decrypt',$_POST['company_id']);
			$location_id=$this->encrypt_decrypt('decrypt',$_POST['location_id']);
			 
			$select="select services_available from employees where company_id=".$company_id." and (user_login_id in (select user_login_id from user_company_profile where location_id=".$location_id.") or user_login_id=43)";
			$resultService=mysqli_query($dbCon, $select); 
			$service=''; 
			while($rowService=mysqli_fetch_array($resultService))
			  {
				   
				  $service=$service.$rowService['services_available'];
			  }
		  
			$stmt = $dbCon->prepare("select id,dish_name,dish_detail,dish_price,is_bookable,is_active,is_physical,one_shared,one_shared_type,recurring_event,open_event_date,open_total_person from dishes_detail_information where is_physical=2 and is_bookable=1 and is_active=1 and find_in_set(id,?)");
			$stmt->bind_param("s",$service);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			$j=0;
			while($row = $result->fetch_assoc())
			{
			 if($row['one_shared']==2 && $row['one_shared_type']==1 && $row['recurring_event']==0)
			 {
				 $d=strtotime(date('Y-m-d'));
				 if($row['open_event_date']<=$d)
					 continue;
				 else
				 {
					$stmt = $dbCon->prepare("select sum(dish_quantity) as total_booked from hotel_roomservice_item_ordered where dish_id=? and service_type=5");
					$stmt->bind_param("i",$row['id']);
					$stmt->execute();
					$result2 = $stmt->get_result();	
					$row2 = $result2->fetch_assoc();
					if($row2['total_booked']==$row['open_total_person'])
						continue;
				 }
			 }
			array_push($org,$row);
			$org[$j]['enc']=$this->encrypt_decrypt('encrypt',$row['id']);	
			$j++;
			}
		 
			$stmt->close();
			$dbCon->close();  
			return $org;
			
		}
		
		
		function selectedServiceInfo()
		{
			 
			$dbCon = AppModel::createConnection();
			$item_id=$this->encrypt_decrypt('decrypt',$_POST['item_id']);
			 
			$stmt = $dbCon->prepare("select dishes_detail_information.id,dish_name,dish_detail,dish_price,is_bookable,is_active,is_physical,dish_image,one_shared,one_shared_type,recurring_event,open_event_date,open_total_person,open_event_time,work_time,open_price_per_person,private_price from dishes_detail_information left join working_hrs on working_hrs.id=dishes_detail_information.open_event_time where dishes_detail_information.id=?");
			$stmt->bind_param("i",$item_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowDishes = $result->fetch_assoc();
			if($row['one_shared']==2 && $row['one_shared_type']==1 && $row['recurring_event']==0)
			{
			$stmt = $dbCon->prepare("select sum(dish_quantity) as total_booked from hotel_roomservice_item_ordered where dish_id=? and service_type=5");
			$stmt->bind_param("i",$row['id']);
			$stmt->execute();
			$result2 = $stmt->get_result();	
			$row2 = $result2->fetch_assoc();
			$rowDishes['open_total_person']=$rowDishes['open_total_person']-$row2['total_booked'];
			}
			
			
			$filename="../estorecss/".$rowDishes ['dish_image'].".txt"; if (file_exists($filename)) { $value_a=file_get_contents("../estorecss/".$rowDishes ['dish_image'].".txt"); $value_a=str_replace('"','',$value_a);  $imgs = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$rowDishes ['dish_image'].'.jpg' );  $imgs='../../../../'.$imgs; } else { $value_a="../../../../../html/usercontent/images/default-profile-pic.jpg";  $imgs="../../../../../html/usercontent/images/default-profile-pic.jpg"; }
			$imgs=str_replace('../../../../../','https://www.safeqloud.com/',$imgs);
			$rowDishes['dish_image']=$imgs;
			 
			$stmt->close();
			$dbCon->close();  
			return $rowDishes;
			
		}
		
		
		 function getOneOnOneServices()
		{
			 
			$dbCon = AppModel::createConnection();
			$bookable_service_category_id=$this->encrypt_decrypt('decrypt',$_POST['id']);
			$company_id=$this->encrypt_decrypt('decrypt',$_POST['company_id']);
			$location_id=$this->encrypt_decrypt('decrypt',$_POST['location_id']);
			 
			$select="select services_available from employees where company_id=".$company_id." and user_login_id in (select user_login_id from user_company_profile where location_id=".$location_id.")";
			$resultService=mysqli_query($dbCon, $select); 
			$service=''; 
			while($rowService=mysqli_fetch_array($resultService))
			  {
				   
				  $service=$service.$rowService['services_available'];
			  }
		  
			$stmt = $dbCon->prepare("select id,dish_name,dish_detail,dish_price,is_bookable,is_active,is_physical from dishes_detail_information where is_physical=2 and is_bookable=1 and is_active=1 and find_in_set(id,?) and one_shared=1 and id not in (select dish_id from hotel_roomservice_item_ordered where booking_person_id=? and service_type=5 and is_verified=0)");
			$stmt->bind_param("si",$service,$_POST['user_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			$j=0;
			while($row = $result->fetch_assoc())
			{
			 
			array_push($org,$row);
			$org[$j]['enc']=$this->encrypt_decrypt('encrypt',$row['id']);	
			$j++;
			}
		 
			$stmt->close();
			$dbCon->close();  
			return $org;
			
		}
		
		
	
		function availableServiceCategories()
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select * from bookable_service_categories where id in(select bookable_service_category_id from dishes_detail_information where is_physical=2 and is_bookable=1 and is_active=1)");
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			while($row = $result->fetch_assoc())
			{
				$row['enc']=$this->encrypt_decrypt('encrypt',$row['id']);
				array_push($org,$row);
			}
			$stmt->close();
			$dbCon->close();  
			return $org;
			
		}
		
	
	function getServiceCompanies()
		{
			$dbCon = AppModel::createConnection();
			$bookable_service_category_id=$this->encrypt_decrypt('decrypt',$_POST['id']);
			
			$stmt = $dbCon->prepare("select companies.id,company_name,latitude,longitude,address,profile_pic from companies left join company_profiles on company_profiles.company_id=companies.id where companies.id in(select company_id from dishes_detail_information where is_physical=2 and is_bookable=1 and is_active=1 and bookable_service_category_id=?)");
			$stmt->bind_param("i",$bookable_service_category_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			$j=0;
			while($row = $result->fetch_assoc())
			{
			$select="select services_available from employees where company_id=".$row['id'];
			$resultService=mysqli_query($dbCon, $select); 
			$service=''; 
			while($rowService=mysqli_fetch_array($resultService))
			  {
				   
				  $service=$service.$rowService['services_available'];
			  }
			   
			 $select="select count(id) num from dishes_detail_information where is_physical=2 and is_bookable=1 and is_active=1 and bookable_service_category_id=".$bookable_service_category_id." and id in (".$service.")";
			 $resultCount=mysqli_query($dbCon, $select);  
			 $rowCount=mysqli_fetch_array($resultCount);
			 if($rowCount['num']==0)
			 {
				 continue;
			 }
			$stmt = $dbCon->prepare("select min(dish_price) as price from dishes_detail_information where is_physical=2 and is_bookable=1 and is_active=1 and bookable_service_category_id=? and company_id=?");
			$stmt->bind_param("ii",$bookable_service_category_id,$row['id']);
			$stmt->execute();
			$resultPrice = $stmt->get_result();
			$rowPrice = $resultPrice->fetch_assoc();
			  
				if($row['profile_pic']=="" || $row['profile_pic']==null)
				{
					$image='https://www.safeqloud.com/html/usercontent/images/random/officepng.png';
				}
				else
				{
				$filename="../estorecss/".$row['profile_pic'].".txt"; $value_a=file_get_contents("../estorecss/".$row['profile_pic'].".txt"); $value_a=str_replace('"','',$value_a); $image = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$row['profile_pic'].'.jpg' );
				$image=str_replace('../','https://www.safeqloud.com/',$image);	
				}
				
				array_push($org,$row);
				$org[$j]['price']=$rowPrice['price'];
				$org[$j]['image_path']=$image;
				$org[$j]['enc']=$this->encrypt_decrypt('encrypt',$row['id']);
				$j++;
			}
		 
			$stmt->close();
			$dbCon->close();  
			return $org;
			
		}
	
	
	
	function getServiceLocations()
		{
			 
			$dbCon = AppModel::createConnection();
			$bookable_service_category_id=$this->encrypt_decrypt('decrypt',$_POST['id']);
			$company_id=$this->encrypt_decrypt('decrypt',$_POST['company_id']);
			 
			$stmt = $dbCon->prepare("select property_location.city_v,property_location.id,property_location.visiting_address,company_name,telephone,company_profiles.phone,company_profiles.address,company_profiles.latitude,company_profiles.longitude from property_location left join companies on companies.id=property_location.company_id left join company_profiles on company_profiles.company_id=companies.id where property_location.company_id=?");
			$stmt->bind_param("i",$company_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			$j=0;
			while($row = $result->fetch_assoc())
			{
				 
			$select="select services_available from employees where company_id=".$company_id." and user_login_id in (select user_login_id from user_company_profile where location_id=".$row['id'].")";
			$resultService=mysqli_query($dbCon, $select); 
			$service=''; 
			while($rowService=mysqli_fetch_array($resultService))
			  {
				   
				  $service=$service.$rowService['services_available'];
			  }
			   
			 $select="select count(id) num from dishes_detail_information where is_physical=2 and is_bookable=1 and is_active=1 and bookable_service_category_id=".$bookable_service_category_id." and id in (".$service.")";
			 $resultCount=mysqli_query($dbCon, $select);  
			 $rowCount=mysqli_fetch_array($resultCount);
			  
			 if($rowCount['num']==0)
			 {
				 continue;
			 }
			 array_push($org,$row);
			$org[$j]['enc']=$this->encrypt_decrypt('encrypt',$row['id']);	
			$j++;
			}
		 
			$stmt->close();
			$dbCon->close();  
			return $org;
			
		}
	
	function updateDishStock($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("update resturant_available_dishes set temp_available_item=? where id=?");
			$stmt->bind_param("ii",$data['in_stock'], $data['available_dish_id']);
			$stmt->execute();	
			$stmt->close();
			$dbCon->close();
			return 1;
		}
	function deleteDishItem($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("delete from resturant_available_dishes where id=?");
			$stmt->bind_param("i",$data['available_dish_id']);
			$stmt->execute();	
			$stmt->close();
			$dbCon->close();
			return 1;
		}
	function availableResturantList($data)
		{
			$dbCon = AppModel::createConnection();
			 
			$stmt = $dbCon->prepare("select id,resturant_name from resturant_information where company_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['company_id']); 
			$stmt->execute();
			$resultRest = $stmt->get_result();
			$org=array();
			 $i=0;
			while($rowRest = $resultRest->fetch_assoc())
			{
				 
			$rowRest['resturant_name']=html_entity_decode($rowRest['resturant_name'],ENT_NOQUOTES, 'UTF-8');
			array_push($org,$rowRest);
			$stmt = $dbCon->prepare("select * from resturant_work_information where resturant_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $rowRest['id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			
			if(empty($row))
			{
			$stmt = $dbCon->prepare("insert into resturant_work_information(resturant_id,created_on)values(?, now())");
			$stmt->bind_param("i",$rowRest['id']);	
			$stmt->execute();
			$stmt = $dbCon->prepare("select * from resturant_work_information where resturant_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $rowRest['id']);
			
			$stmt->execute();
			$result = $stmt->get_result();
			
			$row = $result->fetch_assoc();	
			}
			
			$org[$i]['serve_types']=array();
			$j=0;
			 
			if($row['breakfast_available']==1)
			{
				$org[$i]['serve_types'][$j]['id']=1;
				$org[$i]['serve_types'][$j]['serve']='Breakfast';
				$org[$i]['serve_types'][$j]['serve_image']="https://www.safeqloud.com/html/usercontent/images/roomserviceImages/Breakfast.jpg";
				$stmt = $dbCon->prepare("select count(id) as num from resturant_available_dishes where resturant_id=? and serve_type=1");
			
				/* bind parameters for markers */
				$stmt->bind_param("i", $data['resturant_id']);
				
				$stmt->execute();
				$result2 = $stmt->get_result();
				
				$row2 = $result2->fetch_assoc();
				$org[$j]['num']=$row2['num'];			
				$j++;
			}
			if($row['brunch_available']==1)
			{
				$org[$i]['serve_types'][$j]['id']=2;
				$org[$i]['serve_types'][$j]['serve']='Brunch';
				$org[$i]['serve_types'][$j]['serve_image']="https://www.safeqloud.com/html/usercontent/images/roomserviceImages/Brunch.jpg";
				$stmt = $dbCon->prepare("select count(id) as num from resturant_available_dishes where resturant_id=? and serve_type=2");
			
				/* bind parameters for markers */
				$stmt->bind_param("i", $data['resturant_id']);
				
				$stmt->execute();
				$result2 = $stmt->get_result();
				
				$row2 = $result2->fetch_assoc();
				$org[$i]['serve_types'][$j]['num']=$row2['num'];
				$j++;
			 	
			}
			if($row['lunch_available']==1)
			{
				$org[$i]['serve_types'][$j]['id']=3;
				$org[$i]['serve_types'][$j]['serve']='Lunch';
				$org[$i]['serve_types'][$j]['serve_image']="https://www.safeqloud.com/html/usercontent/images/roomserviceImages/lunch.jpg";
				$stmt = $dbCon->prepare("select count(id) as num from resturant_available_dishes where resturant_id=? and serve_type=3");
			
				/* bind parameters for markers */
				$stmt->bind_param("i", $data['resturant_id']);
				
				$stmt->execute();
				$result2 = $stmt->get_result();
				
				$row2 = $result2->fetch_assoc();
				$org[$i]['serve_types'][$j]['num']=$row2['num'];
				$j++;
			 
			}
			if($row['dinner_available']==1)
			{
				$org[$i]['serve_types'][$j]['id']=4;
				$org[$i]['serve_types'][$j]['serve']='Dinner';
				$org[$i]['serve_types'][$j]['serve_image']="https://www.safeqloud.com/html/usercontent/images/roomserviceImages/dinner.jpg";
				$stmt = $dbCon->prepare("select count(id) as num from resturant_available_dishes where resturant_id=? and serve_type=4");
			
				/* bind parameters for markers */
				$stmt->bind_param("i", $data['resturant_id']);
				
				$stmt->execute();
				$result2 = $stmt->get_result();
				
				$row2 = $result2->fetch_assoc();
				$org[$i]['serve_types'][$j]['num']=$row2['num'];
				$j++;
			 	
			}
			if($row['alcohol_available']==1)
			{
				$org[$i]['serve_types'][$j]['id']=5;
				$org[$i]['serve_types'][$j]['serve']='Beverages';
				$org[$i]['serve_types'][$j]['serve_image']="https://www.safeqloud.com/html/usercontent/images/roomserviceImages/Beverage.jpg";
				$stmt = $dbCon->prepare("select count(id) as num from resturant_available_dishes where resturant_id=? and serve_type=5");
			
				/* bind parameters for markers */
				$stmt->bind_param("i", $data['resturant_id']);
				
				$stmt->execute();
				$result2 = $stmt->get_result();
				
				$row2 = $result2->fetch_assoc();
				$org[$i]['serve_types'][$j]['num']=$row2['num'];
				$j++;
			 
			}
				$i++;			
			}
			 
			$stmt->close();
			$dbCon->close();
			return $org;
			
			
		}
		
	 function ResturantMenu($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select distinct serve_type,serve_available from resturant_available_dishes where resturant_id=?");
			$stmt->bind_param("i", $data['resturant_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			 
			while($row= $result->fetch_assoc())
			{
				array_push($org,$row);
				$i=0;
				$stmt = $dbCon->prepare("select distinct category_food,food_category,place_of_display from resturant_available_dishes left join food_category on food_category.id=resturant_available_dishes.category_food where resturant_available_dishes.resturant_id=? and serve_type=? order by place_of_display");
				$stmt->bind_param("ii", $data['resturant_id'],$row['serve_type']);
				$stmt->execute();
				$result1 = $stmt->get_result();
				while($rowCategory = $result1->fetch_assoc())
				{
					$k=0;
					$org[$i]['dishes']=array();
					$stmt = $dbCon->prepare("select resturant_available_dishes.id,dish_name,dish_detail,dish_image,dish_price,temp_available_item from resturant_available_dishes left join dishes_detail_information on dishes_detail_information.id=resturant_available_dishes.dish_id where resturant_id=? and serve_type=? and category_food=?");
					$stmt->bind_param("iii", $data['resturant_id'],$row['serve_type'],$rowCategory['category_food']);
					$stmt->execute();
					$result2 = $stmt->get_result();
					while($rowDishes = $result2->fetch_assoc())
					{
						$rowDishes['dish_name']=html_entity_decode($rowDishes['dish_name'],ENT_NOQUOTES, 'UTF-8'); 
						$rowDishes['dish_detail']=html_entity_decode($rowDishes['dish_detail'],ENT_NOQUOTES, 'UTF-8'); 
						 $filename="../estorecss/".$rowDishes ['dish_image'].".txt"; if (file_exists($filename)) { $value_a=file_get_contents("../estorecss/".$rowDishes ['dish_image'].".txt"); $value_a=str_replace('"','',$value_a);  $imgs =$this-> base64_to_jpeg( $value_a, '../estorecss/tmp'.$rowDishes ['dish_image'].'.jpg' ); } else { $value_a="../html/usercontent/images/default-profile-pic.jpg";  $imgs="../html/usercontent/images/default-profile-pic.jpg"; }
						$imgs=str_replace('../','https://www.safeqloud.com/',$imgs);
						array_push($org[$i]['dishes'],$rowDishes);
						$org[$i]['dishes'][$k]['dish_image']=$imgs;
						$k++;
					}
					$i++;
				}
				 
			}
			$stmt->close();
			$dbCon->close();
			return $org;
			
			
		}
	 function resturantServeInfo($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select * from resturant_work_information where resturant_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['resturant_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			
			if(empty($row))
			{
			$stmt = $dbCon->prepare("insert into resturant_work_information(resturant_id,created_on)values(?, now())");
			$stmt->bind_param("i",$data['resturant_id']);	
			$stmt->execute();
			$stmt = $dbCon->prepare("select * from resturant_work_information where resturant_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['resturant_id']);
			
			$stmt->execute();
			$result = $stmt->get_result();
			
			$row = $result->fetch_assoc();	
			}
			
			$org=array();
			$j=0;
			 
			if($row['breakfast_available']==1)
			{
				$org[$j]['id']=1;
				$org[$j]['serve']='Breakfast';
				$org[$j]['serve_image']="https://www.safeqloud.com/html/usercontent/images/roomserviceImages/Breakfast.jpg";
				$stmt = $dbCon->prepare("select count(id) as num from resturant_available_dishes where resturant_id=? and serve_type=1");
			
				/* bind parameters for markers */
				$stmt->bind_param("i", $data['resturant_id']);
				
				$stmt->execute();
				$result2 = $stmt->get_result();
				
				$row2 = $result2->fetch_assoc();
				$org[$j]['num']=$row2['num'];			
				$j++;
			}
			if($row['brunch_available']==1)
			{
				$org[$j]['id']=2;
				$org[$j]['serve']='Brunch';
				$org[$j]['serve_image']="https://www.safeqloud.com/html/usercontent/images/roomserviceImages/Brunch.jpg";
				$stmt = $dbCon->prepare("select count(id) as num from resturant_available_dishes where resturant_id=? and serve_type=2");
			
				/* bind parameters for markers */
				$stmt->bind_param("i", $data['resturant_id']);
				
				$stmt->execute();
				$result2 = $stmt->get_result();
				
				$row2 = $result2->fetch_assoc();
				$org[$j]['num']=$row2['num'];
				$j++;
			 	
			}
			if($row['lunch_available']==1)
			{
				$org[$j]['id']=3;
				$org[$j]['serve']='Lunch';
				$org[$j]['serve_image']="https://www.safeqloud.com/html/usercontent/images/roomserviceImages/lunch.jpg";
				$stmt = $dbCon->prepare("select count(id) as num from resturant_available_dishes where resturant_id=? and serve_type=3");
			
				/* bind parameters for markers */
				$stmt->bind_param("i", $data['resturant_id']);
				
				$stmt->execute();
				$result2 = $stmt->get_result();
				
				$row2 = $result2->fetch_assoc();
				$org[$j]['num']=$row2['num'];
				$j++;
			 
			}
			if($row['dinner_available']==1)
			{
				$org[$j]['id']=4;
				$org[$j]['serve']='Dinner';
				$org[$j]['serve_image']="https://www.safeqloud.com/html/usercontent/images/roomserviceImages/dinner.jpg";
				$stmt = $dbCon->prepare("select count(id) as num from resturant_available_dishes where resturant_id=? and serve_type=4");
			
				/* bind parameters for markers */
				$stmt->bind_param("i", $data['resturant_id']);
				
				$stmt->execute();
				$result2 = $stmt->get_result();
				
				$row2 = $result2->fetch_assoc();
				$org[$j]['num']=$row2['num'];
				$j++;
			 	
			}
			if($row['alcohol_available']==1)
			{
				$org[$j]['id']=5;
				$org[$j]['serve']='Beverages';
				$org[$j]['serve_image']="https://www.safeqloud.com/html/usercontent/images/roomserviceImages/Beverage.jpg";
				$stmt = $dbCon->prepare("select count(id) as num from resturant_available_dishes where resturant_id=? and serve_type=5");
			
				/* bind parameters for markers */
				$stmt->bind_param("i", $data['resturant_id']);
				
				$stmt->execute();
				$result2 = $stmt->get_result();
				
				$row2 = $result2->fetch_assoc();
				$org[$j]['num']=$row2['num'];
				$j++;
			 
			}
			
			$stmt->close();
			$dbCon->close();
			return $org;
			
		}
		
	
	 function addGuestinfo($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select company_location_queue_info.id,queue_name,visiting_address,location_id from  company_location_queue_info  left join property_location on property_location.id=company_location_queue_info.location_id where company_location_queue_info.id=?");
			$stmt->bind_param("i", $data['qid']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowAddress = $result->fetch_assoc();
			 
			$location_id= $rowAddress['location_id'];
			$queue_id= $data['qid'];	

			$stmt = $dbCon->prepare("select first_name,concat_ws(' ', first_name, last_name) as name,last_name,email,passport_image,phone_number,country_of_residence from user_logins left join user_profiles on user_logins.id=user_profiles.user_logins_id where user_logins.id = ?");
			/* bind parameters for markers */
			$cont=1;
			$stmt->bind_param("i", $data['user_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowUser = $result->fetch_assoc();
			
			$fname=$rowUser['name'];
			  
			$stmt = $dbCon->prepare("select country_code from phone_country_code where id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $rowUser['country_of_residence']);
			$stmt->execute();
			$result = $stmt->get_result();
			
			$row = $result->fetch_assoc();
			
			$stmt = $dbCon->prepare("insert into company_dropin_queue_waitlist(guest_name,phone_number,country_id,created_on,location_id,queue_id,total_person,user_id)
			values(?,?,?,now(),?,?, ?, ?)");
			$stmt->bind_param("ssiiiii",$fname,$rowUser['phone_number'],$rowUser['country_of_residence'],$location_id,$queue_id,$data['total_person'],$data['user_id']);
			$stmt->execute();
			 
			 $id=$stmt->insert_id;
			 
			$data['lid']=$this -> encrypt_decrypt('encrypt',$location_id);
			
			$stmt = $dbCon->prepare("select count(id) as num from company_dropin_queue_waitlist where id<? and is_serviced=0");
			$stmt->bind_param("i", $id);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowAvailable = $result->fetch_assoc(); 
			$rank=$rowAvailable['num']+1;
			$enc_id= $this -> encrypt_decrypt('encrypt',$id);	
			$url="https://www.safeqloud.com/public/index.php/DropinQueue/waitingInformation/".$data['lid'].'/'.$enc_id;
			$surl=getShortUrl($url);
			$phone="+".trim($row['country_code'])."".trim($rowUser['phone_number']);
			
			$subject='You Are #'.$rank.' on the '.$rowAddress['queue_name'].' waitlist';
			$to=$phone;
			$html='Hi '.$fname.'! you are waitlisted to '.$rowAddress['queue_name'].' as #'.$rank.' in line. See live update at '.$surl;
			//echo $html; die;
			$res=sendSms($subject, $to, $html);
			$stmt->close();
			$dbCon->close();
			return 1;
			 
			
		}
		
	function waitlistResturant($data)
		{
			$dbCon = AppModel::createConnection();
		 
			$stmt = $dbCon->prepare("select * from company_location_queue_info where published_queue=1 and dining_id in (select id from resturant_dining_hall where resturant_id=?) and queue_type=? and is_active=1");
			$stmt->bind_param("ii", $data['resturant_id'],$data['queue_type']);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			while($row = $result->fetch_assoc())
			{
				 
				$ctime=date('H:i', strtotime($row['closing_time'])-($row['closing_time']*60));
				$crtime=date('H:i');
				if($row['opening_time']!==$row['closing_time'])
				{
					if($row['closing_time']=="00:00")
					{
						if($crtime<$row['opening_time'])
						{
							 
							continue;
						}
					}
					else 
					{
					if($crtime<$row['opening_time'] || $crtime>$ctime)
						{
							 
							continue;
						}	
					}
					
				}
				
				$stmt = $dbCon->prepare("select count(id) as num from company_dropin_queue_waitlist where queue_id=? and is_serviced=0");
				$stmt->bind_param("i", $row['id']);
				$stmt->execute();
				$resulta = $stmt->get_result();
				$rowAvailable = $resulta->fetch_assoc();
				$row['waiting_count']=$rowAvailable['num'];
				array_push($org,$row);
			}
			$stmt->close();
			$dbCon->close();
			return $org;
			
		}
		
		
		function publishedResturantInfo($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select publish_dropin,publish_book_table from resturant_work_information  where resturant_id=?");
			/* bind parameters for markers */
			$cont=1;
			$stmt->bind_param("i", $data['resturant_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			$stmt->close();
			$dbCon->close();
			return $row;
			
		}
	
	
	
	function cartAmenityInfoList($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select * from company_hotel_amenities_user_request where qloud_checkout_id=? and is_verified=0");
			/* bind parameters for markers */
			 
			$stmt->bind_param("i",$data['checkid']);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			while($row = $result->fetch_assoc())
			{
			 
			 $a=explode('_',$row['amenity_id']);
			 
				if($a[0]=='b')
				{
				$stmt = $dbCon->prepare("select is_order from company_hotel_bathroom_amenities where id=?");
				/* bind parameters for markers */
				 
				$stmt->bind_param("i",$a[1]);
				$stmt->execute();
				$resultA = $stmt->get_result();
				$rowA = $resultA->fetch_assoc();
				$row['amenity_type']='Bathroom';
				$row['is_order']=$rowA['is_order']; 
				}
				else if($a[0]=='c')
				{
				$stmt = $dbCon->prepare("select is_order from company_hotel_connectivity_amenities where id=?");
				/* bind parameters for markers */
				 
				$stmt->bind_param("i",$a[1]);
				$stmt->execute();
				$resultA = $stmt->get_result();
				$rowA = $resultA->fetch_assoc();
				$row['amenity_type']='Media';
				$row['is_order']=$rowA['is_order']; 
				}
				else if($a[0]=='g')
				{
				$stmt = $dbCon->prepare("select is_room,is_order from company_hotel_general_amenities where id=?");
				/* bind parameters for markers */
				 
				$stmt->bind_param("i",$a[1]);
				$stmt->execute();
				$resultA = $stmt->get_result();
				$rowA = $resultA->fetch_assoc();
				$row['is_order']=$rowA['is_order'];
				if($rowA['is_room']==1)
				$row['amenity_type']='Room';
				else
				$row['amenity_type']='Bed'; 
				}
				array_push($org,$row);
			}
			$stmt->close();
			$dbCon->close();
			return $org;
			
			 
			
		}
		
	function cartAmenityItemCount($data)
		{
			$dbCon = AppModel::createConnection();
			$org=array();
			$stmt = $dbCon->prepare("select count(id) as num from company_hotel_amenities_user_request where qloud_checkout_id=? and is_verified=0");
			/* bind parameters for markers */
			 
			$stmt->bind_param("i",$data['checkid']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			$stmt->close();
			$dbCon->close();
			return $row['num'];
			
			 
			
		}
		
	function orderHotelAppAmenity($data)
		{
			$dbCon = AppModel::createConnection();
			
			$stmt = $dbCon->prepare("select room_type_id,room_id from hotel_checkout_detail where id=?");
			$stmt->bind_param("i", $data['checkid']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowRoom= $result->fetch_assoc();
			//print_r($rowRoom); die;
			$stmt = $dbCon->prepare("select location_id  from company_hotel_room_type_detail where company_hotel_room_type_detail.id=(select room_type_id from hotel_checkout_detail where id=?) ");
			$stmt->bind_param("i", $data['checkid']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowProperty= $result->fetch_assoc();
			
			$hotel_id= $rowProperty['location_id'];
			$room_type_id= $rowRoom['room_type_id'];
			$room_id= $rowRoom['room_id'];
			
			$a_id= $this -> encrypt_decrypt('decrypt',$data['a_id']);
			$id= $data['checkid'];
			
			$stmt = $dbCon->prepare("select * from company_hotel_amenities_user_request where qloud_checkout_id=? and amenity_id=? and is_verified=0");
			$stmt->bind_param("is",$id,$a_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			 
			if(empty($row))
			{
			$t=0;
			$quantity=$data['quantity'];
			$stmt = $dbCon->prepare("insert into `company_hotel_amenities_user_request`(hotel_id,room_type_id,room_id,amenity_id,user_id,created_on,qloud_checkout_id,aminity_quantity,aminity_price,amenity_name) values ( ?, ?, ?, ?, ?, now(),?,?,?,?)");
			
			/* bind parameters for markers */
			$stmt->bind_param("iiisiiiis",$hotel_id,$room_type_id,$room_id,$a_id,$data['user_id'],$id,$quantity,$t,$data['aname']);
			$stmt->execute();
			$q_id= $stmt->insert_id;
			}
			else
			{
			$t=0;
			$quantity=$data['quantity'];
			$stmt = $dbCon->prepare("update company_hotel_amenities_user_request set aminity_quantity=?,aminity_price=? where id=?");
			$stmt->bind_param("iii",$quantity,$t,$row['id']);
			$stmt->execute();	
			$q_id=$row['id'];
			}
			
			
			$curl = curl_init();

			curl_setopt_array($curl, array(
			  CURLOPT_URL => 'https://www.safeqloud.com/user/index.php/DstrictsApp/orderHotelAppAmenity',
			  CURLOPT_RETURNTRANSFER => true,
			  CURLOPT_ENCODING => '',
			  CURLOPT_MAXREDIRS => 10,
			  CURLOPT_TIMEOUT => 0,
			  CURLOPT_FOLLOWLOCATION => true,
			  CURLOPT_HTTP_VERSION => CURL_HTTP_VERSION_1_1,
			  CURLOPT_CUSTOMREQUEST => 'POST',
			  CURLOPT_POSTFIELDS => array('id' => $hotel_id,'rid' => $room_type_id,'rmid' => $room_id,'aid' => $a_id,'user_id' => $data['user_id'],'qloud_checkout_id' => $data['checkid'],'aname' => $data['aname'],'quantity' => $data['quantity'],'q_id' => $q_id),
			));

			$response = curl_exec($curl);
  
			curl_close($curl);
			
			 
			
			
			$stmt->close();
			$dbCon->close();
			 
			return 1;
			
		}
		
	function hotelBathroomAppAmenities($data)
		{
			$dbCon = AppModel::createConnection();
			
			$stmt = $dbCon->prepare("select room_type_id,room_id from hotel_checkout_detail where id=?");
			$stmt->bind_param("i", $data['id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowRoom= $result->fetch_assoc();
			
			$stmt = $dbCon->prepare("select location_id  from company_hotel_room_type_detail where company_hotel_room_type_detail.id=(select room_type_id from hotel_checkout_detail where id=?) ");
			$stmt->bind_param("i", $data['id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowProperty= $result->fetch_assoc();
			
			$hotel_id= $rowProperty['location_id'];
			$room_type_id= $rowRoom['room_type_id'];
			$room_id= $rowRoom['room_id'];
			 
			$stmt = $dbCon->prepare("select hotel_bathroom_amenities from hotel_basic_information where property_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $hotel_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			
			$stmt = $dbCon->prepare("select bathroom_amenities_available from company_hotel_room_type_detail where id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $room_type_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowRtype = $result->fetch_assoc();
			
			$stmt = $dbCon->prepare("select room_bathroom_amenities from hotel_room_detail where id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $room_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowRoom = $result->fetch_assoc();
			$amenities=$row['hotel_bathroom_amenities'].''.$rowRtype['bathroom_amenities_available'].''.$rowRoom['room_bathroom_amenities'];
			 
			$stmt = $dbCon->prepare("select id,bathroom_amenities as amenity_name,is_order from company_hotel_bathroom_amenities where find_in_set(id,?) and is_order>0");
			
			/* bind parameters for markers */
			$stmt->bind_param("s", $amenities);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			$j=0;
			while($row  = $result->fetch_assoc())
			{
				$idcheck='b_'.$row['id'];
				$stmt = $dbCon->prepare("select aminity_quantity from company_hotel_amenities_user_request where qloud_checkout_id=? and is_verified=0 and amenity_id=?");
				/* bind parameters for markers */
				 
				$stmt->bind_param("is",$data['id'],$idcheck);
				$stmt->execute();
				$resultCount = $stmt->get_result();
				$rowCount = $resultCount->fetch_assoc();
				if($rowCount['aminity_quantity']==0 || $rowCount['aminity_quantity']==null)
				{
				$row['quantity']=0;	
				}
				else
				{
					$row['quantity']=$rowCount['aminity_quantity'];	
				}
				array_push($org,$row);
				$org[$j]['enc']=$this->encrypt_decrypt('encrypt','b_'.$row['id']);
				$j++;
			}
			
			return $org;
		}
	
	function hotelMediaAppAmenities($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select room_type_id,room_id from hotel_checkout_detail where id=?");
			$stmt->bind_param("i", $data['id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowRoom= $result->fetch_assoc();
			
			$stmt = $dbCon->prepare("select location_id  from company_hotel_room_type_detail where company_hotel_room_type_detail.id=(select room_type_id from hotel_checkout_detail where id=?) ");
			$stmt->bind_param("i", $data['id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowProperty= $result->fetch_assoc();
			
			$hotel_id= $rowProperty['location_id'];
			$room_type_id= $rowRoom['room_type_id'];
			$room_id= $rowRoom['room_id'];
			
			$stmt = $dbCon->prepare("select hotel_connectivity_amenities from hotel_basic_information where property_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $hotel_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			
			$stmt = $dbCon->prepare("select connectivity_amenities_available from company_hotel_room_type_detail where id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $room_type_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowRtype = $result->fetch_assoc();
			
			$stmt = $dbCon->prepare("select room_connectivity_amenities from hotel_room_detail where id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $room_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowRoom = $result->fetch_assoc();
			$amenities=$row['hotel_connectivity_amenities'].''.$rowRtype['connectivity_amenities_available'].''.$rowRoom['room_connectivity_amenities'];
			 
			$stmt = $dbCon->prepare("select id,connectivity_amenities as amenity_name,is_order from company_hotel_connectivity_amenities where find_in_set(id,?) and is_order>0");
			
			/* bind parameters for markers */
			$stmt->bind_param("s", $amenities);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			$j=0;
			while($row  = $result->fetch_assoc())
			{
				$idcheck='c_'.$row['id'];
				$stmt = $dbCon->prepare("select aminity_quantity from company_hotel_amenities_user_request where qloud_checkout_id=? and is_verified=0 and amenity_id=?");
				/* bind parameters for markers */
				 
				$stmt->bind_param("is",$data['id'],$idcheck);
				$stmt->execute();
				$resultCount = $stmt->get_result();
				$rowCount = $resultCount->fetch_assoc();
				if($rowCount['aminity_quantity']==0 || $rowCount['aminity_quantity']==null)
				{
				$row['quantity']=0;	
				}
				else
				{
					$row['quantity']=$rowCount['aminity_quantity'];	
				}
				array_push($org,$row);
				$org[$j]['enc']=$this->encrypt_decrypt('encrypt','c_'.$row['id']);
				$j++;
			}
			
			return $org;
		}
	
	function hotelRoomAppAmenities($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select room_type_id,room_id from hotel_checkout_detail where id=?");
			$stmt->bind_param("i", $data['id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowRoom= $result->fetch_assoc();
			
			$stmt = $dbCon->prepare("select location_id  from company_hotel_room_type_detail where company_hotel_room_type_detail.id=(select room_type_id from hotel_checkout_detail where id=?) ");
			$stmt->bind_param("i", $data['id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowProperty= $result->fetch_assoc();
			
			$hotel_id= $rowProperty['location_id'];
			$room_type_id= $rowRoom['room_type_id'];
			$room_id= $rowRoom['room_id'];
			 
			$stmt = $dbCon->prepare("select hotel_general_amenities from hotel_basic_information where property_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $hotel_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			
			$stmt = $dbCon->prepare("select general_amenities_available from company_hotel_room_type_detail where id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $room_type_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowRtype = $result->fetch_assoc();
			
			$stmt = $dbCon->prepare("select room_general_amenities from hotel_room_detail where id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $room_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowRoom = $result->fetch_assoc();
			$amenities=$row['hotel_general_amenities'].''.$rowRtype['general_amenities_available'].''.$rowRoom['room_general_amenities'];
			
			$stmt = $dbCon->prepare("select id,general_amenities as amenity_name,is_order from company_hotel_general_amenities where find_in_set(id,?) and is_order>0 and is_room=1");
			
			/* bind parameters for markers */
			$stmt->bind_param("s", $amenities);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			$j=0;
			while($row  = $result->fetch_assoc())
			{
				
				$idcheck='g_'.$row['id'];
				 
				$stmt = $dbCon->prepare("select aminity_quantity from company_hotel_amenities_user_request where qloud_checkout_id=? and is_verified=0 and amenity_id=?");
				/* bind parameters for markers */
				 
				$stmt->bind_param("is",$data['id'],$idcheck);
				$stmt->execute();
				$resultCount = $stmt->get_result();
				$rowCount = $resultCount->fetch_assoc();
				if($rowCount['aminity_quantity']==0 || $rowCount['aminity_quantity']==null)
				{
				$row['quantity']=0;	
				}
				else
				{
					$row['quantity']=$rowCount['aminity_quantity'];	
				}
				array_push($org,$row);
				$org[$j]['enc']=$this->encrypt_decrypt('encrypt','g_'.$row['id']);
				$j++;
			}
			
			return $org;
		}
	
		function hotelBedAppAmenities($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select room_type_id,room_id from hotel_checkout_detail where id=?");
			$stmt->bind_param("i", $data['id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowRoom= $result->fetch_assoc();
			
			$stmt = $dbCon->prepare("select location_id  from company_hotel_room_type_detail where company_hotel_room_type_detail.id=(select room_type_id from hotel_checkout_detail where id=?) ");
			$stmt->bind_param("i", $data['id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowProperty= $result->fetch_assoc();
			
			$hotel_id= $rowProperty['location_id'];
			$room_type_id= $rowRoom['room_type_id'];
			$room_id= $rowRoom['room_id'];
			 
			$stmt = $dbCon->prepare("select hotel_general_amenities from hotel_basic_information where property_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $hotel_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			
			$stmt = $dbCon->prepare("select general_amenities_available from company_hotel_room_type_detail where id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $room_type_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowRtype = $result->fetch_assoc();
			
			$stmt = $dbCon->prepare("select room_general_amenities from hotel_room_detail where id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $room_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowRoom = $result->fetch_assoc();
			$amenities=$row['hotel_general_amenities'].''.$rowRtype['general_amenities_available'].''.$rowRoom['room_general_amenities'];
			
			$stmt = $dbCon->prepare("select id,general_amenities as amenity_name,is_order from company_hotel_general_amenities where find_in_set(id,?) and is_order>0 and is_room=2");
			
			/* bind parameters for markers */
			$stmt->bind_param("s", $amenities);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			$j=0;
			while($row  = $result->fetch_assoc())
			{
				$idcheck='g_'.$row['id'];
				$stmt = $dbCon->prepare("select aminity_quantity from company_hotel_amenities_user_request where qloud_checkout_id=? and is_verified=0 and amenity_id=?");
				/* bind parameters for markers */
				 
				$stmt->bind_param("is",$data['checkid'],$idcheck);
				$stmt->execute();
				$resultCount = $stmt->get_result();
				$rowCount = $resultCount->fetch_assoc();
				if($rowCount['aminity_quantity']==0 || $rowCount['aminity_quantity']==null)
				{
				$row['quantity']=0;	
				}
				else
				{
					$row['quantity']=$rowCount['aminity_quantity'];	
				}
				array_push($org,$row);
				$org[$j]['enc']=$this->encrypt_decrypt('encrypt','g_'.$row['id']);
				$j++;
			}
			
			return $org;
		}
	
		
	 function ResturantServeBasedMenu($data)
		{
			$dbCon = AppModel::createConnection();
			$org=array();
				$i=0;
				$stmt = $dbCon->prepare("select distinct category_food,food_category,place_of_display from resturant_available_dishes left join food_category on food_category.id=resturant_available_dishes.category_food where resturant_available_dishes.resturant_id=? and serve_type=? order by place_of_display");
				$stmt->bind_param("ii", $data['resturant_id'],$data['serve_type']);
				$stmt->execute();
				$result1 = $stmt->get_result();
				while($rowCategory = $result1->fetch_assoc())
				{
					$rowCategory['food_category']=html_entity_decode($rowCategory['food_category'],ENT_NOQUOTES, 'UTF-8'); 
					array_push($org,$rowCategory);
					$k=0;
					$org[$i]['dishes']=array();
					$stmt = $dbCon->prepare("select resturant_available_dishes.id,dish_name,dish_detail,dish_image,dish_price,temp_available_item  from resturant_available_dishes left join dishes_detail_information on dishes_detail_information.id=resturant_available_dishes.dish_id where resturant_id=? and serve_type=? and category_food=?");
					$stmt->bind_param("iii", $data['resturant_id'],$data['serve_type'],$rowCategory['category_food']);
					$stmt->execute();
					$result2 = $stmt->get_result();
					while($rowDishes = $result2->fetch_assoc())
					{
						$rowDishes['category_food']=$rowCategory['category_food'];
						$rowDishes['food_category']=$rowCategory['food_category'];
						$rowDishes['width']=$data['width'];
						$rowDishes['height']=$data['height'];
						$rowDishes['dish_name']=html_entity_decode($rowDishes['dish_name'],ENT_NOQUOTES, 'UTF-8'); 
						$rowDishes['dish_detail']=html_entity_decode($rowDishes['dish_detail'],ENT_NOQUOTES, 'UTF-8'); 
						 $filename="../estorecss/".$rowDishes ['dish_image'].".txt"; if (file_exists($filename)) { $value_a=file_get_contents("../estorecss/".$rowDishes ['dish_image'].".txt"); $value_a=str_replace('"','',$value_a);  $imgs =$this-> base64_to_jpeg( $value_a, '../estorecss/tmp'.$rowDishes ['dish_image'].'.jpg' ); } else { $value_a="../html/usercontent/images/default-profile-pic.jpg";  $imgs="../html/usercontent/images/default-profile-pic.jpg"; }
						$imgs=str_replace('../','https://www.safeqloud.com/',$imgs);
						array_push($org[$i]['dishes'],$rowDishes);
						$org[$i]['dishes'][$k]['dish_image']=$imgs;
						$k++;
					}
					$i++;
				}
			$stmt->close();
			$dbCon->close();
			return $org;
			
			
		}
	 
	function editDishDetail($data)
		{
			$dbCon = AppModel::createConnection();
			$data1 = strip_tags($_POST['image-data1']);
			if($data1!='none')
			{
			define('UPLOAD_DIR','../estorecss/'); // image dir path
			$img_name1="new".microtime();
			file_put_contents(UPLOAD_DIR.$img_name1.".txt", $data1);
			}
			else 
			{
				$img_name1="";
			}
			
			$dish_name=htmlentities($data['dish_name'],ENT_NOQUOTES, 'ISO-8859-1');
			$dish_detail=htmlentities($data['dish_detail'],ENT_NOQUOTES, 'ISO-8859-1');
			$product_information=htmlentities($data['product_information'],ENT_NOQUOTES, 'ISO-8859-1');
			$stmt = $dbCon->prepare("update dishes_detail_information set dish_name=?, dish_detail=?, dish_image=?, dish_price=?,  dish_type=?, dish_warnings=?, modified_on=now(),product_information=?  where id=(select dish_id from resturant_available_dishes where id=?)");
			$stmt->bind_param("sssiissi",$dish_name,$dish_detail ,$img_name1 ,$data['dish_price'], $data['dish_type'],$data['food_type'],$product_information,$data['available_dish_id']);
			
			
			if($stmt->execute())
			{
				$stmt->close();
				$dbCon->close();
				return 1;
			}
			else
			{
				 
				$stmt->close();
				$dbCon->close();
				return 0;
			}
		
			
		}
		
	function selectedDish($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select * from dishes_detail_information where id=(select dish_id from resturant_available_dishes where id=?)");
			$stmt->bind_param("i", $data['available_dish_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			$stmt->close();
			$dbCon->close();
			return $row;
			
			
		}
		 function foodTypeInformationSelected($data)
		{
			$dbCon = AppModel::createConnection();
			$food_warning=explode(',',$data['warning']);
			 
			$stmt = $dbCon->prepare("select id,food_type from food_type");
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			$j=0;
			while($row = $result->fetch_assoc())
			{
				array_push($org,$row);
				if (in_array($row['id'], $food_warning))
				{
				$org[$j]['is_selected']= 1;
				}
				else
				{
				$org[$j]['is_selected']= 0;	
				}
				$j++;
			}
			 
			$stmt->close();
			$dbCon->close();
			return $org;
			
			
		}
	function updateServeNotAvailable($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select serve_available from resturant_available_dishes where serve_type=? and resturant_id=?");
			/* bind parameters for markers */
			$stmt->bind_param("ii", $data['serve_type'],$data['resturant_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			$stmt = $dbCon->prepare("upate resturant_available_dishes set serve_available=? where serve_type=? and resturant_id=?");
			$stmt->bind_param("iii",$row['serve_available'], $data['serve_type'],$data['resturant_id']);
			$stmt->execute();	
			$stmt->close();
			$dbCon->close();
			return 1;
		}
	function updateDishNotAvailable($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("upate resturant_available_dishes set is_available_item=0 where id=?");
			$stmt->bind_param("i", $data['available_dish_id']);
			$stmt->execute();	
			$stmt->close();
			$dbCon->close();
			return 1;
		}
	
		function resturantProfileInfo($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select  resturant_name,resturant_type,visiting_address,resturant_information.id,publish_dropin ,publish_book_table ,publish_menu  from resturant_information left join property_location on property_location.id=resturant_information.property_id left join resturant_work_information on resturant_work_information.resturant_id=resturant_information.id where resturant_information.id=?");
			$stmt->bind_param("i", $data['resturant_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowAvailable = $result->fetch_assoc();
			$rowAvailable['visiting_address']=html_entity_decode($rowAvailable['visiting_address'],ENT_NOQUOTES, 'UTF-8'); 	
			$rowAvailable['resturant_name']=html_entity_decode($rowAvailable['resturant_name'],ENT_NOQUOTES, 'UTF-8'); 
			$big="new0.09086000 1600564862";
			$small1="new0.13561200 1600564862";
			$small2="new0.15516700 1600564862";
			$stmt = $dbCon->prepare("select * from business_dashboard_images  where business_id=? and business_type=3");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['resturant_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			
			$rowImages = $result->fetch_assoc();
			 
			if(empty($row))
			{
			$btype=3;
			$stmt = $dbCon->prepare("INSERT INTO business_dashboard_images (business_id, business_type,created_on,big_image_path,small_image1_path, small_image2_path) VALUES (?, ?, now(), ?, ?, ?)");
			$stmt->bind_param("iisss", $data['resturant_id'],$btype,$big,$small1,$small2);
			$stmt->execute();	
			$stmt = $dbCon->prepare("select * from business_dashboard_images  where business_id=? and business_type=3");
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['resturant_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowImages = $result->fetch_assoc();
			}
			
			
			$bigImage=$rowImages['big_image_path'];	
			$filename="../estorecss/".$bigImage.".txt"; $value_a=file_get_contents("../estorecss/".$bigImage.".txt"); $value_a=str_replace('"','',$value_a); $rowImages['image_path'] = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$bigImage.'.jpg' );
			 
			$rowImages['image_path']=str_replace('../','https://www.safeqloud.com/',$rowImages['image_path']);
			$rowAvailable['big_image']=$rowImages['image_path'];
				
			$bigImage=$rowImages['small_image1_path'];	
			$filename="../estorecss/".$bigImage.".txt"; $value_a=file_get_contents("../estorecss/".$bigImage.".txt"); $value_a=str_replace('"','',$value_a); $rowImages['image_path'] = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$bigImage.'.jpg' );
			 
			$rowImages['image_path']=str_replace('../','https://www.safeqloud.com/',$rowImages['image_path']);
			$rowAvailable['small_image']=$rowImages['image_path'];
			
			$bigImage=$rowImages['small_image2_path'];	
			$filename="../estorecss/".$bigImage.".txt"; $value_a=file_get_contents("../estorecss/".$bigImage.".txt"); $value_a=str_replace('"','',$value_a); $rowImages['image_path'] = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$bigImage.'.jpg' );
			 
			$rowImages['image_path']=str_replace('../','https://www.safeqloud.com/',$rowImages['image_path']);
			$rowAvailable['small_image2']=$rowImages['image_path'];	
			
			
			
			$stmt->close();
			$dbCon->close();
			 
			return $rowAvailable;
			
			
		}
		
		function usersList($data)
		{
			$dbCon = AppModel::createConnection();
			$name='%'.htmlentities($data['name'],ENT_NOQUOTES, 'UTF-8').'%';
			$stmt = $dbCon->prepare("select user_logins.id,first_name,concat_ws(' ',first_name,last_name) as name,passport_image from user_logins where first_name like ?");
			
			/* bind parameters for markers */
			$stmt->bind_param("s", $name); 
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			 
			while($row = $result->fetch_assoc())
			{
				if($row['passport_image']=="" || $row['passport_image']==null)
				{
					$row['user_image']='https://www.safeqloud.com/html/usercontent/images/bg/beard.png';
				}
				else
				{
				$filename="../estorecss/".$row['passport_image'].".txt"; $value_a=file_get_contents("../estorecss/".$row['passport_image'].".txt"); $value_a=str_replace('"','',$value_a); $row['passport_image'] = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$row['passport_image'].'.jpg' );
				$row['user_image']=str_replace('../','https://www.safeqloud.com/',$row['passport_image']);
				}
				$row['name']=html_entity_decode($row['name'],ENT_NOQUOTES, 'UTF-8'); 	
				$row['first_name']=html_entity_decode($row['first_name'],ENT_NOQUOTES, 'UTF-8'); 
				array_push($org,$row);
				 
			}
			 
			$stmt->close();
			$dbCon->close();
			return $org;
			
			
		}
		function companyList($data)
		{
			$dbCon = AppModel::createConnection();
			
			$name='%'.htmlentities($data['name'],ENT_NOQUOTES, 'UTF-8').'%';
			$stmt = $dbCon->prepare("select companies.id,company_name as first_name,company_name as name,profile_pic as passport_image from companies left join company_profiles on companies.id=company_profiles.company_id where company_name like ?");
			
			/* bind parameters for markers */
			$stmt->bind_param("s", $name); 
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			 
			while($row = $result->fetch_assoc())
			{
				if($row['passport_image']=="" || $row['passport_image']==null)
				{
					$row['user_image']='https://www.safeqloud.com/html/usercontent/images/random/officepng.png';
				}
				else
				{
				$filename="../estorecss/".$row['passport_image'].".txt"; $value_a=file_get_contents("../estorecss/".$row['passport_image'].".txt"); $value_a=str_replace('"','',$value_a); $row['passport_image'] = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$row['passport_image'].'.jpg' );
				$row['user_image']=str_replace('../','https://www.safeqloud.com/',$row['passport_image']);	
				}
				$row['first_name']=html_entity_decode($row['first_name'],ENT_NOQUOTES, 'UTF-8');
				$row['name']=html_entity_decode($row['name'],ENT_NOQUOTES, 'UTF-8'); 
				array_push($org,$row);
				 
			}
			 
			$stmt->close();
			$dbCon->close();
			return $org;
			
			
		}
		
		
		function resturantSearchList($data)
		{
			$dbCon = AppModel::createConnection();
			$name='%'.htmlentities($data['name'],ENT_NOQUOTES, 'UTF-8').'%';
			$stmt = $dbCon->prepare("select id,resturant_name as name,resturant_name as first_name from resturant_information where resturant_name like ?");
			
			/* bind parameters for markers */
			$stmt->bind_param("s", $name); 
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			 
			while($row = $result->fetch_assoc())
			{
				$row['passport_image']="";
				$row['first_name']=html_entity_decode($row['first_name'],ENT_NOQUOTES, 'UTF-8');
				$row['name']=html_entity_decode($row['name'],ENT_NOQUOTES, 'UTF-8'); 
				$row['user_image']='https://www.safeqloud.com/html/usercontent/images/bg/hotel1.jpg';
				array_push($org,$row);
				 
			}
			 
			$stmt->close();
			$dbCon->close();
			return $org;
			
			
		}
		
		function reservationList($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select resturant_table_booking_info.id,company_size,concat_ws(' ',first_name,last_name) as name from resturant_table_booking_info left join user_logins on user_logins.id=resturant_table_booking_info.user_id where resturant_id=? and is_confirmed=0 limit 0,5");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['resturant_id']); 
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			 
			while($row = $result->fetch_assoc())
			{
				array_push($org,$row);
				 
			}
			 
			$stmt->close();
			$dbCon->close();
			return $org;
			
			
		}
	function resturantDetail($data)
		{
			$dbCon = AppModel::createConnection();
			 
			$stmt = $dbCon->prepare("select resturant_type,resturant_name,visiting_address,resturant_information.id  from resturant_information left join property_location on property_location.id=resturant_information.property_id where resturant_information.company_id=?");
			$stmt->bind_param("i", $data['company_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			$j=0;
			while($rowAvailable = $result->fetch_assoc())
			{
				array_push($org,$rowAvailable);
				 
			}
			$stmt->close();
			$dbCon->close();
			return $org;
			
			
		}
		
	function resturantWorkInfo($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select * from resturant_work_information where resturant_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['resturant_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			
			if(empty($row))
			{
			$stmt = $dbCon->prepare("insert into resturant_work_information(resturant_id,created_on)values(?, now())");
			$stmt->bind_param("i",$data['resturant_id']);	
			$stmt->execute();
			$stmt = $dbCon->prepare("select * from resturant_work_information where resturant_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['resturant_id']);
			
			$stmt->execute();
			$result = $stmt->get_result();
			
			$row = $result->fetch_assoc();	
			}
			
			$org=array();
			$j=0;
			if($row['breakfast_available']==1 && $row['breakfast_booking']==1)
			{
				$org[$j]['id']=1;
				$org[$j]['serve']='Breakfast';
				$j++;
			}
			if($row['brunch_available']==1  && $row['brunch_booking']==1)
			{
				$org[$j]['id']=2;
				$org[$j]['serve']='Brunch';
				$j++;
			 	
			}
			if($row['lunch_available']==1  && $row['lunch_booking']==1)
			{
				$org[$j]['id']=3;
				$org[$j]['serve']='Lunch';
				$j++;
			 
			}
			if($row['dinner_available']==1  && $row['dinner_booking']==1)
			{
				$org[$j]['id']=4;
				$org[$j]['serve']='Dinner';
				$j++;
			 	
			}
			if($row['alcohol_available']==1  && $row['alcohol_booking']==1)
			{
				$org[$j]['id']=5;
				$org[$j]['serve']='Beverages';
				$j++;
			 
			}
			
			$stmt->close();
			$dbCon->close();
			return $org;
			
		}
		
		
	function requestTableBooking($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select id,work_time from working_hrs where id=?");
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['time_detail']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowTime = $result->fetch_assoc();
			$data['dining_hall']=0;
			$stmt = $dbCon->prepare("insert into resturant_table_booking_info(resturant_id,dining_hall_id,serve_type,company_size,booking_date, booking_time, booking_time_id, user_id,created_on)values(?,?,?,?,?,?,?,?, now())");
			$stmt->bind_param("iiiissii",$data['resturant_id'],$data['dining_hall'],$data['serve_type'],$data['company_size'],$data['booking_date'],$rowTime['work_time'],$data['time_detail'],$data['user_id']);	
			$stmt->execute();
			$stmt->close();
			$dbCon->close();
			return 1;
			
		}
		function resturantTableAvailable($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select * from resturant_work_information where resturant_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['resturant_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			if($data['serve_type']==1)
			{
				$serve='breakfast';
			}
			else if($data['serve_type']==2)
			{
				$serve='brunch';
			}
			else if($data['serve_type']==3)
			{
				$serve='lunch';
			}
			else if($data['serve_type']==4)
			{
				$serve='dinner';
			}
			else if($data['serve_type']==5)
			{
				$serve='alcohol';
			}
			
			$data['dining_hall']=0;
			
			
			$stmt = $dbCon->prepare("select sum(table_info) as num from resturant_dining_hall_tables where dining_hall_id in (select id from resturant_dining_hall where resturant_id=?) ");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['resturant_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowTableCount = $result->fetch_assoc();	
			 
			
			if($data['company_size']>$rowTableCount['num'])
			{
			return 1;	
			}
			 
			$dateVal=strtolower(date('D',strtotime($data['booking_date'])));
			
			$indexVal=$serve.'_'.$dateVal.'_open';
			 $org=array();
			if($row[$indexVal]==0)
			{
				return $org;
			}
			else 
			{
				$currentHrs=date('H');
				$currentMinutes=date('i');
				 
				if($currentMinutes>0 and $currentMinutes<30)
				{
					$i='30';
				}
				else if($currentMinutes>30 and $currentMinutes<59)
				{
					$currentHrs=$currentHrs+1;
					$i='00';
				}
				else
				{
					$i=$currentMinutes;
				}					
					$time=$currentHrs.':'.$i;
					  
				$mini=$serve.'_minimum_time';
				$close=$serve.'_time_before_closing';
				$openIndex=$serve.'_'.$dateVal.'_open_time';
				$closeIndex=$serve.'_'.$dateVal.'_close_time';
				
				if($row[$openIndex]==$row[$closeIndex])
				{
					
					$closeId=49-$row[$close];
					if($data['date_today']==1)
					{
						$stmt = $dbCon->prepare("select id,work_time from working_hrs where work_time>?  and id<?");	
						$stmt->bind_param("si", $time,$closeId);	
					}
					else
					{
						$stmt = $dbCon->prepare("select id,work_time from working_hrs where id<?");	
						$stmt->bind_param("i", $closeId);
					}
				
				}
				else
				{
				$stmt = $dbCon->prepare("select id from working_hrs where work_time=?");
			
				/* bind parameters for markers */
				$stmt->bind_param("s", $row[$closeIndex]);
				$stmt->execute();
				$result = $stmt->get_result();
				$rowClose = $result->fetch_assoc();
				$closeId=$rowClose['id']-$row[$close];
					if($data['date_today']==1)
					{
					$stmt = $dbCon->prepare("select id,work_time from working_hrs where id>=(select id from working_hrs where work_time=? and work_time>?) and id<?");
				
					/* bind parameters for markers */
					$stmt->bind_param("ssi", $row[$openIndex],$time,$closeId);	
					}
					else
					{
					$stmt = $dbCon->prepare("select id,work_time from working_hrs where id>=(select id from working_hrs where work_time=?) and id<?");
				
					/* bind parameters for markers */
					$stmt->bind_param("si", $row[$openIndex],$closeId);	
					}
				}
				 
				$stmt->execute();
				$result = $stmt->get_result();
				$org=array();
				$i=0;
				while($rowTime = $result->fetch_assoc())
				{
					if($i==0)
					{
						
						$stmt = $dbCon->prepare("select sum(table_info) as num from resturant_dining_hall_tables where dining_hall_id in (select id from resturant_dining_hall where resturant_id=?) and id not in (select reserved_table_id from resturant_table_booking_confirmation_info where reservation_date=? and reservation_time_id=?)");
						
						/* bind parameters for markers */
						$stmt->bind_param("isi", $data['resturant_id'],$data['booking_date'],$rowTime['id']);
						$stmt->execute();
						$result2 = $stmt->get_result();
						$rowTableCount = $result2->fetch_assoc();	
						
					 
						if($data['company_size']>$rowTableCount['num'])
						{
						 
						}
						else
						{
						array_push($org,$rowTime);	
						}
						if($row[$mini]>1)
						$i++;
					}
					else
					{
						
						$i++;
						if($i>=$row[$mini])
						{
							$i=0;
						}
						 
						
						 
					}
				}
			}
			
			
			
			 
			$stmt->close();
			$dbCon->close();
			return $org;
			
		}
	
		function resturantDiningHall($data)
		{ 
		 
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select * from resturant_dining_hall where resturant_id=?");
			$stmt->bind_param("i", $data['resturant_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			while($row = $result->fetch_assoc())
			{
			array_push($org,$row);	
			}
			$stmt->close();
			$dbCon->close();
			return $org;	
		}
		
	function updateNoShow($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select  is_serviced from company_dropin_queue_waitlist where company_dropin_queue_waitlist.id=?");
			$stmt->bind_param("i", $data['guest_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowCount = $result->fetch_assoc();
			if($rowCount['is_serviced']==0)
			{
			$stmt = $dbCon->prepare("delete from company_dropin_queue_waitlist where id=?");
			$stmt->bind_param("i", $data['guest_id']);
			$stmt->execute();	
			}
			$stmt->close();
			$dbCon->close();
			return 1;
			
			
		}
		
		function updateInServicing($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select  is_serviced from company_dropin_queue_waitlist where company_dropin_queue_waitlist.id=?");
			$stmt->bind_param("i", $data['guest_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowCount = $result->fetch_assoc();
			if($rowCount['is_serviced']==0)
			{
			$stmt = $dbCon->prepare("update company_dropin_queue_waitlist set is_serviced=1,serving_user_id=?,modified_on=now() where id=?");
			$stmt->bind_param("ii", $data['user_id'],$data['guest_id']);
			$stmt->execute();	
			}
			$stmt->close();
			$dbCon->close();
			return 1;
			
			
		}
		
		
		function updateCloseService($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("update company_dropin_queue_waitlist set is_serviced=2 where id=?");
			$stmt->bind_param("i", $data['guest_id']);
			$stmt->execute();	
			
			$stmt->close();
			$dbCon->close();
			return 1;
			
			
		}
		
	
	function alertGuest($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select guest_name,country_code,phone_number from company_dropin_queue_waitlist left join phone_country_code on company_dropin_queue_waitlist.country_id=phone_country_code.id where company_dropin_queue_waitlist.id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i",  $data['guest_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			
			$row = $result->fetch_assoc();
			
			$stmt = $dbCon->prepare("select company_location_queue_info.id,queue_name,visiting_address from  company_location_queue_info  left join property_location on property_location.id=company_location_queue_info.location_id where company_location_queue_info.id=(select queue_id from company_dropin_queue_waitlist where id=?)");
			$stmt->bind_param("i",  $data['guest_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowAddress = $result->fetch_assoc();
			
			$stmt = $dbCon->prepare("select count(id) as num from company_dropin_queue_waitlist where id<? and is_serviced=0");
			$stmt->bind_param("i",  $data['guest_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowAvailable = $result->fetch_assoc(); 
			$rank=$rowAvailable['num']+1;
			$enc_id= $this -> encrypt_decrypt('encrypt', $data['guest_id']);	
			$url="https://www.safeqloud.com/public/index.php/DropinQueue/waitingInformation/".$data['lid'].'/'.$enc_id;
			$surl=getShortUrl($url);
			$phone="+".trim($row['country_code'])."".trim($row['phone_number']);
			
			$subject='You Are #'.$rank.' on the '.$rowAddress['queue_name'].' waitlist';
			$to=$phone;
			$html='Hi '.$row['guest_name'].'! you are waitlisted to '.$rowAddress['queue_name'].' as #'.$rank.' in line. See live update at '.$surl;
			 
			$res=sendSms($subject, $to, $html);
			$stmt->close();
			$dbCon->close();
			return 1;
			 
			
		}
		
		
		function queueGuestDetail($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select  * from company_dropin_queue_waitlist where company_dropin_queue_waitlist.id=?");
			$stmt->bind_param("i", $data['guest_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowAvailable = $result->fetch_assoc();
			if(!empty($rowAvailable))
			{
			$stmt = $dbCon->prepare("select  count(id) as num from company_dropin_queue_waitlist where company_dropin_queue_waitlist.id<? and is_serviced=0");
			$stmt->bind_param("i",  $data['guest_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowCount = $result->fetch_assoc();
			$rowAvailable['position_inline']=$rowCount['num']+1;
			if($rowAvailable['user_id']==null || $rowAvailable['user_id']=='' || $rowAvailable['user_id']==0)
			{
			$rowAvailable['user_image']="https://www.safeqloud.com/html/usercontent/images/person-male.png";	
			$rowAvailable['user_id']=0;
			}
			else
			{
				$stmt = $dbCon->prepare("select  passport_image from user_logins where id=?");
				$stmt->bind_param("i", $rowAvailable['user_id']);
				$stmt->execute();
				$result = $stmt->get_result();
				$rowPrice = $result->fetch_assoc();
				if($rowPrice['passport_image']==null || $rowPrice['passport_image']=='')
				{
				$rowAvailable['user_image']="https://www.safeqloud.com/html/usercontent/images/person-male.png";	
				}
				else
				{
				$filename="../estorecss/".$rowPrice['passport_image'].".txt"; $value_a=file_get_contents("../estorecss/".$rowPrice['passport_image'].".txt"); $value_a=str_replace('"','',$value_a); $rowPrice['passport_image'] = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$rowPrice['passport_image'].'.jpg' );
				$rowAvailable['user_image']=str_replace('../','https://www.safeqloud.com/',$rowPrice['passport_image']);	
				}
				
			}
				if($rowAvailable['email_id']==null || $rowAvailable['email_id']=="") 
				{
					$rowAvailable['email_id']="Email not available";
				}
				$rowAvailable['waiting_time']=round((strtotime(date('Y-m-d H:i:s'))-strtotime($rowAvailable['created_on']))/60,0).' Minutes';
			}
			$stmt->close();
			$dbCon->close();
			return $rowAvailable;
			
			
		}
	
	function queueServicingGuestDetail($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select  * from company_dropin_queue_waitlist where company_dropin_queue_waitlist.id=?");
			$stmt->bind_param("i", $data['guest_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowAvailable = $result->fetch_assoc();
			if(!empty($rowAvailable))
			{
			$stmt = $dbCon->prepare("select  count(id) as num from company_dropin_queue_waitlist where company_dropin_queue_waitlist.id<? and is_serviced=0");
			$stmt->bind_param("i",  $data['guest_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowCount = $result->fetch_assoc();
			$rowAvailable['position_inline']=$rowCount['num']+1;
			if($rowAvailable['user_id']==null || $rowAvailable['user_id']=='')
			{
			$rowAvailable['user_image']="https://www.safeqloud.com/html/usercontent/images/person-male.png";	
			}
			else
			{
				$stmt = $dbCon->prepare("select  passport_image from user_logins where id=?");
				$stmt->bind_param("i", $rowAvailable['user_id']);
				$stmt->execute();
				$result = $stmt->get_result();
				$rowPrice = $result->fetch_assoc();
				$filename="../estorecss/".$rowPrice['passport_image'].".txt"; $value_a=file_get_contents("../estorecss/".$rowPrice['passport_image'].".txt"); $value_a=str_replace('"','',$value_a); $rowPrice['passport_image'] = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$rowPrice['passport_image'].'.jpg' );
				$rowAvailable['user_image']=str_replace('../','https://www.safeqloud.com/',$rowPrice['passport_image']);
			}
			
			 
				$stmt = $dbCon->prepare("select  concat_ws(' ',first_name,last_name) as name from user_logins where id=?");
				$stmt->bind_param("i", $rowAvailable['serving_user_id']);
				$stmt->execute();
				$result = $stmt->get_result();
				$rowServer = $result->fetch_assoc();
				$rowAvailable['user_serving']=html_entity_decode($rowServer['name'],ENT_NOQUOTES, 'UTF-8');
				if($rowAvailable['email_id']==null || $rowAvailable['email_id']=="") 
				{
					$rowAvailable['email_id']="Email not available";
				}
				$rowAvailable['service_time']=round((strtotime(date('Y-m-d H:i:s'))-strtotime($rowAvailable['modified_on']))/60,0).' Minutes';
			}
			$stmt->close();
			$dbCon->close();
			return $rowAvailable;
			
			
		}
	
	function operatorQueueList($data)
		{
			$dbCon = AppModel::createConnection();
			 
			$stmt = $dbCon->prepare("select company_location_queue_info.id,queue_name,property_location.visiting_address as address,total_operators from company_location_queue_info left join property_location on property_location.id=company_location_queue_info.location_id where company_location_queue_info.location_id=(select location_id from user_company_profile where company_id=? and user_login_id=?)  and published_queue=1 and is_active=1");
			
			/* bind parameters for markers */
			$stmt->bind_param("ii",$data['company_id'], $data['user_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			$j=0;
			while($row = $result->fetch_assoc())
			{
			 
			$stmt = $dbCon->prepare("select count(id) as num from company_dropin_queue_waitlist where queue_id=? and is_serviced=0");
			
			/* bind parameters for markers */
			$stmt->bind_param("i",$row['id']);
			$stmt->execute();
			$resultCount = $stmt->get_result();
			$rowCount = $resultCount->fetch_assoc();
			$row['person_in_line']=$rowCount['num'];
			$row['address']=html_entity_decode($row['address'],ENT_NOQUOTES, 'UTF-8'); 	
			$row['queue_name']=html_entity_decode($row['queue_name'],ENT_NOQUOTES, 'UTF-8'); 	
			 
			array_push($org,$row);
			 
			}
			$stmt->close();
			$dbCon->close();
			return $org;
		}
		
		
		function operatorQueueWaitingList($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select id,guest_name,created_on,total_person from company_dropin_queue_waitlist where queue_id=? and is_serviced=0");
			/* bind parameters for markers */
			$stmt->bind_param("i",$data['queue_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			$j=0;
			while($row = $result->fetch_assoc())
			{
			$stmt = $dbCon->prepare("select  count(id) as num from company_dropin_queue_waitlist where queue_id=? and is_serviced=0");
			$stmt->bind_param("i",  $data['queue_id']);
			$stmt->execute();
			$result1 = $stmt->get_result();
			$rowCount = $result1->fetch_assoc();
			$row['waiting_count']=$rowCount['num'];
			$row['guest_name']=html_entity_decode($row['guest_name'],ENT_NOQUOTES, 'UTF-8'); 	
			array_push($org,$row);
			}
			$stmt->close();
			$dbCon->close();
			return $org;
		}
		function operatorQueueWaitingCount($data)
		{
			$dbCon = AppModel::createConnection();
			
			$stmt = $dbCon->prepare("select  count(id) as num from company_dropin_queue_waitlist where queue_id=? and is_serviced=0");
			$stmt->bind_param("i",  $data['queue_id']);
			$stmt->execute();
			$result1 = $stmt->get_result();
			$rowCount = $result1->fetch_assoc();
			$stmt->close();
			$dbCon->close();
			return $rowCount['num'];
		}
	
	function operatorQueueServingList($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select id,guest_name,created_on,total_person from company_dropin_queue_waitlist where queue_id=? and is_serviced=1");
			/* bind parameters for markers */
			$stmt->bind_param("i",$data['queue_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			$j=0;
			while($row = $result->fetch_assoc())
			{
			$stmt = $dbCon->prepare("select  count(id) as num from company_dropin_queue_waitlist where queue_id=? and is_serviced=0");
			$stmt->bind_param("i",  $data['queue_id']);
			$stmt->execute();
			$result1 = $stmt->get_result();
			$rowCount = $result1->fetch_assoc();
			$row['waiting_count']=$rowCount['num'];
			$row['guest_name']=html_entity_decode($row['guest_name'],ENT_NOQUOTES, 'UTF-8'); 	
			array_push($org,$row);
			}
			$stmt->close();
			$dbCon->close();
			return $org;
		}
	
	
	function operatorQueueServedList($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select id,guest_name,created_on,total_person from company_dropin_queue_waitlist where queue_id=? and is_serviced=2");
			/* bind parameters for markers */
			$stmt->bind_param("i",$data['queue_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			$j=0;
			while($row = $result->fetch_assoc())
			{
			$stmt = $dbCon->prepare("select  count(id) as num from company_dropin_queue_waitlist where queue_id=? and is_serviced=0");
			$stmt->bind_param("i",  $data['queue_id']);
			$stmt->execute();
			$result1 = $stmt->get_result();
			$rowCount = $result1->fetch_assoc();
			$row['waiting_count']=$rowCount['num'];
			$row['guest_name']=html_entity_decode($row['guest_name'],ENT_NOQUOTES, 'UTF-8'); 	
			array_push($org,$row);
			}
			$stmt->close();
			$dbCon->close();
			return $org;
		}
	
	
	function removeFromList($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select  is_serviced from company_dropin_queue_waitlist where company_dropin_queue_waitlist.id=?");
			$stmt->bind_param("i", $data['id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowCount = $result->fetch_assoc();
			if($rowCount['is_serviced']==0)
			{
			$stmt = $dbCon->prepare("delete from company_dropin_queue_waitlist where id=?");
			$stmt->bind_param("i", $data['id']);
			$stmt->execute();	
			}
			$stmt->close();
			$dbCon->close();
			return 1;
			
			
		}
		
	function userQueueList($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select is_serviced,company_dropin_queue_waitlist.id,queue_name as property_nickname,profile_pic as image_path,property_location.visiting_address as address,company_dropin_queue_waitlist.queue_id,company_name from company_dropin_queue_waitlist left join company_location_queue_info on company_location_queue_info.id=company_dropin_queue_waitlist.queue_id left join property_location on property_location.id=company_dropin_queue_waitlist.location_id left join company_profiles on company_profiles.company_id=property_location.company_id  left join companies on companies.id=property_location.company_id where company_dropin_queue_waitlist.user_id=? and is_serviced<2  and published_queue=1 and is_active=1");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['dstricts_user_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			$j=0;
			while($row = $result->fetch_assoc())
			{
			$row['address']=html_entity_decode($row['address'],ENT_NOQUOTES, 'UTF-8'); 	
			$row['property_nickname']=html_entity_decode($row['property_nickname'],ENT_NOQUOTES, 'UTF-8'); 	
			$row['company_name']=html_entity_decode($row['company_name'],ENT_NOQUOTES, 'UTF-8'); 
			$row['qloud_checkout_id']=0; 
			$row['enc']= 0; 
			$row['room_service']=0;	
			$stmt = $dbCon->prepare("select count(id) as num from company_dropin_queue_waitlist where company_dropin_queue_waitlist.id<? and queue_id=? and is_serviced=0");
			/* bind parameters for markers */
			$stmt->bind_param("ii", $row['id'],$row['queue_id']);
			$stmt->execute();
			$result2 = $stmt->get_result();
			$rowCount = $result2->fetch_assoc();	
			$row['waiting_count']=$rowCount['num'];
			array_push($org,$row);
			if($row['image_path']==null || $row['image_path']=='')
			{
			$org[$j]['image_path']="https://www.safeqloud.com/html/usercontent/images/undraw_queue_qt30.png";	
			}
			else
			{
			$image=$row['image_path'];
			$value_a=file_get_contents("../estorecss/".$image.".txt"); $value_a=str_replace('"','',$value_a); $row['image_path'] = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$image.'.jpg' );
			$row['image_path']=str_replace('../','https://www.safeqloud.com/',$row['image_path']);	
			$org[$j]['image_path']=$row['image_path'];	
			}
			$j++;	
			}
			$stmt->close();
			$dbCon->close();
			return $org;
		}
	
		function userQueueWaitingDetail($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select guest_name,is_serviced,company_dropin_queue_waitlist.id,queue_name,profile_pic as image_path,property_location.visiting_address as address,company_name,company_dropin_queue_waitlist.queue_id from company_dropin_queue_waitlist left join company_location_queue_info on company_location_queue_info.id=company_dropin_queue_waitlist.queue_id left join property_location on property_location.id=company_dropin_queue_waitlist.location_id left join company_profiles on company_profiles.company_id=property_location.company_id left join companies on companies.id=property_location.company_id where company_dropin_queue_waitlist.id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['id']);
			$stmt->execute();
			$result = $stmt->get_result();
			
			$row = $result->fetch_assoc();
			$row['company_name']=html_entity_decode($row['company_name'],ENT_NOQUOTES, 'UTF-8'); 	
			$row['address']=html_entity_decode($row['address'],ENT_NOQUOTES, 'UTF-8'); 	
			$row['queue_name']=html_entity_decode($row['queue_name'],ENT_NOQUOTES, 'UTF-8'); 	
			 
			if($row['image_path']==null || $row['image_path']=='')
			{
			$row['image_path']="https://www.safeqloud.com/html/usercontent/images/undraw_queue_qt30.png";	
			}
			else
			{
			$image=$row['image_path'];
			$value_a=file_get_contents("../estorecss/".$image.".txt"); $value_a=str_replace('"','',$value_a); $row['image_path'] = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$image.'.jpg' );
			$row['image_path']=str_replace('../','https://www.safeqloud.com/',$row['image_path']);	
			}
			if($row['is_serviced']==0)
			{
			 
			$stmt = $dbCon->prepare("select count(id) as num from company_dropin_queue_waitlist where company_dropin_queue_waitlist.id<? and queue_id=? and is_serviced=0");
			/* bind parameters for markers */
			$stmt->bind_param("ii", $data['id'],$row['queue_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowCount = $result->fetch_assoc();	
			$row['hash_tag']=$rowCount['num'];
			}
			else
			{
				$row['hash_tag']='In service';
			}
			$stmt->close();
			$dbCon->close();
			return $row;
		}
	
		
	function addPersonToDesiredQueue($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select concat_ws(' ',first_name,last_name) as name,country_of_residence,phone_number,country_code,email from user_logins left join user_profiles on user_profiles.user_logins_id=user_logins.id left join phone_country_code on phone_country_code.id=user_logins.country_of_residence where user_logins.id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['user_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowUser = $result->fetch_assoc();
			
			
			$stmt = $dbCon->prepare("select company_location_queue_info.id,queue_name,visiting_address,location_id from  company_location_queue_info  left join property_location on property_location.id=company_location_queue_info.location_id where company_location_queue_info.id=?");
			$stmt->bind_param("i", $data['id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowAddress = $result->fetch_assoc();
			
			$stmt = $dbCon->prepare("insert into company_dropin_queue_waitlist(guest_name,phone_number,country_id,created_on,location_id,queue_id,user_id,email_id)
			values(?,?,?,now(),?,?,?,?)");
			$stmt->bind_param("ssiiiis",$rowUser['name'],$rowUser['phone_number'],$rowUser['country_of_residence'],$rowAddress['location_id'],$data['id'],$data['user_id'],$rowUser['email']);
			$stmt->execute();
			 
			 $id=$stmt->insert_id;
			
			
			$stmt = $dbCon->prepare("select count(id) as num from company_dropin_queue_waitlist where id<? and is_serviced=0");
			$stmt->bind_param("i", $id);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowAvailable = $result->fetch_assoc(); 
			$rank=$rowAvailable['num']+1;
			$enc_id= $this -> encrypt_decrypt('encrypt',$id);	
			$data['lid']= $this -> encrypt_decrypt('encrypt',$rowAddress['location_id']);	
			$url="https://www.safeqloud.com/public/index.php/DropinQueue/waitingInformation/".$data['lid'].'/'.$enc_id;
			$surl=getShortUrl($url);
			$phone="+".trim($rowUser['country_code'])."".trim($rowUser['phone_number']);
			
			$subject='You Are #'.$rank.' on the '.$rowAddress['queue_name'].' waitlist';
			$to=$phone;
			$html='Hi '.$rowUser['name'].'! you are waitlisted to '.$rowAddress['queue_name'].' as #'.$rank.' in line. See live update at '.$surl;
			 
			$res=sendSms($subject, $to, $html);
			
			$stmt->close();
			$dbCon->close();
			return 1;
		}
	function avalibleQueueOnTheLocation($data)
		{
			 $dbCon = AppModel::createConnection();
			 $id=$this->encrypt_decrypt('decrypt',$data['id']);
			 
			$stmt = $dbCon->prepare("select id,queue_name from company_location_queue_info where location_id=?  and published_queue=1 and is_active=1");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $id);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			while($row = $result->fetch_assoc())
			{
			array_push($org,$row);
			}
			$stmt->close();
			$dbCon->close();
			return $org;
		}
	
	function encryptData($data)
		{
			
				$data1=$this->encrypt_decrypt('encrypt',$data);
				return  $data1;
		}
		
		function decryptData($data)
		{
			
				$data['enc']=$this->encrypt_decrypt('decrypt',$data['value_json']);
				return  $data['enc'];
		}
	function UpdatecartItemCount($data)
		{
			$dbCon = AppModel::createConnection();
			 
			$stmt = $dbCon->prepare("select dish_quantity,dish_price from hotel_roomservice_item_ordered where qloud_checkout_id=? and is_verified=0 and dish_id=? and service_type=1");
			/* bind parameters for markers */
			 
			$stmt->bind_param("ii",$data['checkid'],$data['dish_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			  $curl = curl_init();
			 curl_setopt_array($curl, array(
			  CURLOPT_URL => 'https://dstricts.com/user/index.php/DstrictsApp/UpdatecartItemCount',
			  CURLOPT_RETURNTRANSFER => true,
			  CURLOPT_ENCODING => '',
			  CURLOPT_MAXREDIRS => 10,
			  CURLOPT_TIMEOUT => 0,
			  CURLOPT_FOLLOWLOCATION => true,
			  CURLOPT_HTTP_VERSION => CURL_HTTP_VERSION_1_1,
			  CURLOPT_CUSTOMREQUEST => 'POST',
			  CURLOPT_POSTFIELDS => array('checkid' => $data['checkid'],'dish_id' => $data['dish_id'],'dish_quantity' => $data['dish_quantity']),
			));

			 
			
				$response = curl_exec($curl);
				curl_close($curl);
				 
			if($data['dish_quantity']==0)
			{
			$stmt = $dbCon->prepare("delete from hotel_roomservice_item_ordered where qloud_checkout_id=? and is_verified=0 and dish_id=? and service_type=1");
			/* bind parameters for markers */
			 
			$stmt->bind_param("ii",$data['checkid'],$data['dish_id']);
			$stmt->execute();
			}
			else
			{
				$total_price=$data['dish_quantity']*$row['dish_price'];
				$stmt = $dbCon->prepare("update hotel_roomservice_item_ordered set dish_quantity=?,total_price=? where qloud_checkout_id=? and is_verified=0 and dish_id=? and service_type=1");
			/* bind parameters for markers */
			 
			$stmt->bind_param("iiii",$data['dish_quantity'],$total_price,$data['checkid'],$data['dish_id']);
			$stmt->execute();
			}
			
			
			 $stmt->close();
			$dbCon->close();
			return 1;
			
			 
			
		}
	
	function UpdatecartItemCountInfo($data)
		{
			$dbCon = AppModel::createConnection();
			 
			$stmt = $dbCon->prepare("select dish_quantity,dish_price from hotel_roomservice_item_ordered where qloud_checkout_id=? and is_verified=0 and dish_id=? and service_type=?");
			/* bind parameters for markers */
			 
			$stmt->bind_param("iii",$data['checkid'],$data['dish_id'],$data['service_type']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			  $curl = curl_init();
			 curl_setopt_array($curl, array(
			  CURLOPT_URL => 'https://dstricts.com/user/index.php/DstrictsApp/UpdatecartItemCountInfo',
			  CURLOPT_RETURNTRANSFER => true,
			  CURLOPT_ENCODING => '',
			  CURLOPT_MAXREDIRS => 10,
			  CURLOPT_TIMEOUT => 0,
			  CURLOPT_FOLLOWLOCATION => true,
			  CURLOPT_HTTP_VERSION => CURL_HTTP_VERSION_1_1,
			  CURLOPT_CUSTOMREQUEST => 'POST',
			  CURLOPT_POSTFIELDS => array('checkid' => $data['checkid'],'dish_id' => $data['dish_id'],'dish_quantity' => $data['dish_quantity'],'service_type' => $data['service_type']),
			));

			 
			
				$response = curl_exec($curl);
				curl_close($curl);
				 
			if($data['dish_quantity']==0)
			{
			$stmt = $dbCon->prepare("delete from hotel_roomservice_item_ordered where qloud_checkout_id=? and is_verified=0 and dish_id=? and service_type=?");
			/* bind parameters for markers */
			 
			$stmt->bind_param("iii",$data['checkid'],$data['dish_id'],$data['service_type']);
			$stmt->execute();
			}
			else
			{
				$total_price=$data['dish_quantity']*$row['dish_price'];
				$stmt = $dbCon->prepare("update hotel_roomservice_item_ordered set dish_quantity=?,total_price=? where qloud_checkout_id=? and is_verified=0 and dish_id=? and service_type=?");
			/* bind parameters for markers */
			 
			$stmt->bind_param("iiiii",$data['dish_quantity'],$total_price,$data['checkid'],$data['dish_id'],$data['service_type']);
			$stmt->execute();
			}
			
			
			 $stmt->close();
			$dbCon->close();
			return 1;
			
			 
			
		}
	
	function cartItemCountInfo($data)
		{
			$dbCon = AppModel::createConnection();
			 
			$stmt = $dbCon->prepare("select count(id) as num from hotel_roomservice_item_ordered where qloud_checkout_id=? and is_verified=0 and service_type=?");
			/* bind parameters for markers */
			 
			$stmt->bind_param("ii",$data['checkid'],$data['service_type']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			$stmt->close();
			$dbCon->close();
			return $row['num'];
			
			 
			
		}
	function cartItemCount($data)
		{
			$dbCon = AppModel::createConnection();
			 
			$stmt = $dbCon->prepare("select count(id) as num from hotel_roomservice_item_ordered where qloud_checkout_id=? and is_verified=0 and service_type=1");
			/* bind parameters for markers */
			 
			$stmt->bind_param("i",$data['checkid']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			$stmt->close();
			$dbCon->close();
			return $row['num'];
			
			 
			
		}
		
		
		function payCartItemUsingApp($data)
		{
			$dbCon = AppModel::createConnection();
			
			$stmt = $dbCon->prepare("select user_logins.id,zipcode,first_name,last_name,email,country_of_residence,user_profiles.city,user_profiles.state,phone_number,address,port_number from user_logins left join user_profiles on user_profiles.user_logins_id=user_logins.id where user_logins.id=?");
			/* bind parameters for markers */
			 
			$stmt->bind_param("i",$data['user_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			  
			 
			if($data['qloud_id_pay']==1)
			{
			if($data['service_type']==5)
			{
			$stmt = $dbCon->prepare("select sum(total_price) as price from hotel_roomservice_item_ordered where qloud_checkout_id=? and is_verified=0 and service_type=? and wellness_id=? and booking_person_id=?");
			/* bind parameters for markers */
			 
			$stmt->bind_param("iiii",$data['checkid'],$data['service_type'],$data['wellness_id'],$data['user_id']);
			}
			else
			{
			$stmt = $dbCon->prepare("select sum(total_price) as price from hotel_roomservice_item_ordered where qloud_checkout_id=? and is_verified=0 and service_type=?");
			/* bind parameters for markers */
			 
			$stmt->bind_param("ii",$data['checkid'],$data['service_type']);	
			}
			$stmt->execute();
			$result = $stmt->get_result();
			$row_price = $result->fetch_assoc();
			
			$ch = curl_init();

			curl_setopt($ch, CURLOPT_URL, 'https://api.stripe.com/v1/tokens');
			curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
			curl_setopt($ch, CURLOPT_POST, 1);
			curl_setopt($ch, CURLOPT_POSTFIELDS, "card[number]=4242424242424242&card[exp_month]=2&card[exp_year]=2030&card[cvc]=314");
			curl_setopt($ch, CURLOPT_USERPWD, 'sk_test_mTVjBSZHopmJyA3wgvzRwUM2' . ':' . '');

			$headers = array();
			$headers[] = 'Content-Type: application/x-www-form-urlencoded';
			curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);

			$result = curl_exec($ch);
			if (curl_errno($ch)) {
				echo 'Error:' . curl_error($ch);
			}
			curl_close($ch);
			$a=json_decode($result,true);
			 
			$ch = curl_init();

			curl_setopt($ch, CURLOPT_URL, 'https://api.stripe.com/v1/customers');
			curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
			curl_setopt($ch, CURLOPT_POST, 1);
			curl_setopt($ch, CURLOPT_POSTFIELDS, "name=".$row['first_name']."&email=".$row['email']."&source=".$a['id']."&description=My");
			curl_setopt($ch, CURLOPT_USERPWD, 'sk_test_mTVjBSZHopmJyA3wgvzRwUM2' . ':' . '');

			$headers = array();
			$headers[] = 'Content-Type: application/x-www-form-urlencoded';
			curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);

			$result = curl_exec($ch);
			if (curl_errno($ch)) {
				echo 'Error:' . curl_error($ch);
			}
			curl_close($ch);
			$b=json_decode($result,true);
			$cuId=$b['id'];
			
			$total_price=$row_price['price']*100;
			if($total_price<500)
			{
				$total_price=500;
			}
			$ch = curl_init();

			curl_setopt($ch, CURLOPT_URL, 'https://api.stripe.com/v1/charges');
			curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
			curl_setopt($ch, CURLOPT_POST, 1);
			curl_setopt($ch, CURLOPT_POSTFIELDS, "customer=".$b['id']."&amount=".$total_price."&currency=sek&description=My");
			curl_setopt($ch, CURLOPT_USERPWD, 'sk_test_mTVjBSZHopmJyA3wgvzRwUM2' . ':' . '');

			$headers = array();
			$headers[] = 'Content-Type: application/x-www-form-urlencoded';
			curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);

			$result = curl_exec($ch);
			if (curl_errno($ch)) {
				echo 'Error:' . curl_error($ch);
			}
			curl_close($ch);			
			$c=json_decode($result,true);
			$Chargeid=$c['id'];	
 


 
	
		if($data['is_company']==0)
		{
		$stmt = $dbCon->prepare("select * from user_cards where id= ?");
        
        /* bind parameters for markers */
        $stmt->bind_param("i", $data['card_id']);
        $stmt->execute();
        $result = $stmt->get_result();
        $rowCards   = $result->fetch_assoc();	
		
		 $stmt = $dbCon->prepare("select phone_country_code.country_name,phone_country_code.country_code,zipcode,first_name,last_name,email,country_of_residence,user_profiles.invoice_city,user_profiles.state,phone_number,invoice_address,invoice_port,invoice_zipcode from user_logins left join user_profiles on user_profiles.user_logins_id=user_logins.id left join phone_country_code on user_logins.country_of_residence=phone_country_code.id where user_logins.id= ?");
        
        /* bind parameters for markers */
        $stmt->bind_param("i", $data['user_id']);
        $stmt->execute();
        $result = $stmt->get_result();
        $rowP    = $result->fetch_assoc();
		$rowP['user']=1;
		$rowP['buyer_id']=$row['id'];
		$rowP['card_id']=$data['card_id'];
		$rowP['user_id']=$row['id'];
		$rowP['customer_id']=$cuId;
		$rowP['charge_id']=$Chargeid; 
		$rowP['qloud_checkout_id']=$data['checkid'];
		 
		}
		else
		{
		$stmt = $dbCon->prepare("select * from company_cards where id= ?");
        
        /* bind parameters for markers */
        $stmt->bind_param("i", $data['card_id']);
        $stmt->execute();
        $result = $stmt->get_result();
        $rowCards   = $result->fetch_assoc();	
			
		 $stmt = $dbCon->prepare("select phone_country_code.country_name,phone_country_code.country_code,zipcode,first_name,last_name,email,country_of_residence,user_profiles.invoice_city,user_profiles.state,phone_number,invoice_address,invoice_port,invoice_zipcode from user_logins left join user_profiles on user_profiles.user_logins_id=user_logins.id left join phone_country_code on user_logins.country_of_residence=phone_country_code.id where user_logins.id= ?");
        
        /* bind parameters for markers */
        $stmt->bind_param("i", $data['user_id']);
        $stmt->execute();
        $result = $stmt->get_result();
        $rowUser    = $result->fetch_assoc();	
			
		$stmt = $dbCon->prepare("select phone_country_code.country_name,phone_country_code.country_code, companies.country_id,cid,company_profiles.phone,country_id,company_email,company_name,property_location.id,street_name_v, city_v, postal_code_v, property_location.d_port_number,street_name_i as invoice_address,city_i as invoice_city,postal_code_i as invoice_zipcode,property_location.i_port_number as invoice_port from  property_location left join companies on companies.id=property_location.company_id left join phone_country_code on companies.country_id=phone_country_code.id left join company_profiles on companies.id=company_profiles.company_id where property_location.id in (select location_id from employee_location where employee_id in (select id from employees where user_login_id=? and company_id =?))");
        
        /* bind parameters for markers */
        $stmt->bind_param("ii", $data['user_id'],$rowCards['company_id']);
        $stmt->execute();
        $result = $stmt->get_result();
        $rowP   = $result->fetch_assoc();
		$rowP['user']=0;
		$rowP['card_id']=$data['card_id'];
		$rowP['buyer_id']=$rowCards['company_id'];
		$rowP['user_id']=$row['id'];
		$rowP['qloud_checkout_id']=$data['checkid']; 
		$rowP['customer_id']=$cuId;
		$rowP['charge_id']=$Chargeid;
		}
		$rowP['is_paid']=1;
	 	 	 
 }
			else
			{
			$rowP['is_paid']=0;	
			$rowP['user']=1;
			$rowP['buyer_id']=$data['user_id'];
			$rowP['card_id']=0;
			$rowP['user_id']=$data['user_id'];
			$rowP['customer_id']='';
			$rowP['charge_id']=''; 
			$rowP['qloud_checkout_id']=$data['checkid']; 
			}
			$rowP['service_type']=$data['service_type']; 
			 
			if($rowP['service_type']==1 || $rowP['service_type']==2 || $rowP['service_type']==4)
			{
			$stmt = $dbCon->prepare("update hotel_roomservice_item_ordered set is_verified=1,is_paid=?, company_id=?, card_id=?,customer_id=?,charge_id=?,is_user=?,user_id=? where qloud_checkout_id=? and is_verified=0 and service_type=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("iiissiiii", $rowP['is_paid'], $rowP['buyer_id'],$rowP['card_id'],$rowP['customer_id'],$rowP['charge_id'],$rowP['user'],$rowP['user_id'],$data['checkid'],$data['service_type'] );
			$stmt->execute();	
				
			}
			else if($rowP['service_type']==5)
			{
			
			$stmt = $dbCon->prepare("select property_location.visiting_address,d_port_number,company_name,wellness_center_information.company_id,country_id,wellness_center_information.property_id from wellness_center_information left join companies on companies.id=wellness_center_information.company_id left join property_location on property_location.id=wellness_center_information.property_id where wellness_center_information.id=?");
			/* bind parameters for markers */
			$cont=1;
			$stmt->bind_param("i", $data['wellness_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowWellnessCompany= $result->fetch_assoc();
			
			$stmt = $dbCon->prepare("select user_logins.first_name,user_logins.last_name,user_logins.email,work_time,hotel_roomservice_item_ordered.id,wellness_id,booked_employee_id,one_shared,booking_date,booking_time,country_of_residence,phone_number from hotel_roomservice_item_ordered left join user_logins on user_logins.id=hotel_roomservice_item_ordered.booking_person_id left join user_profiles on user_logins.id=user_profiles.user_logins_id left join working_hrs on working_hrs.id=hotel_roomservice_item_ordered.booking_time where qloud_checkout_id=? and is_verified=0 and service_type=? and wellness_id=? and booking_person_id=?");
			/* bind parameters for markers */
			$stmt->bind_param("iiii", $data['checkid'],$data['service_type'],$data['wellness_id'],$rowP['user_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowRoomservice   = $result->fetch_assoc();
			
			
			$stmt = $dbCon->prepare("select manage_apps_permission.id from manage_apps_permission left join apps_detail on apps_detail.id=manage_apps_permission.app_id where country_id=?  and app_type=0 and is_mandatory=0 and app_id=2");
			/* bind parameters for markers */
			$cont=1;
			$stmt->bind_param("i", $rowWellnessCompany['country_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowPermi = $result->fetch_assoc();
			
			if(!empty($rowPermi))
			{
			$stmt = $dbCon->prepare("select count(id) as num from compnay_app_download where permission_id=? and company_id=?");
			/* bind parameters for markers */
			$cont=1;
			$stmt->bind_param("ii", $rowPermi['id'],$rowWellnessCompany['company_id']);
			$stmt->execute();
			$result_down = $stmt->get_result();
			$row_down = $result_down->fetch_assoc();
			
			if($row_down['num']>0)
			{
			$booking_date=date('Y-m-d',$rowRoomservice['booking_date']);
			if($rowRoomservice['one_shared']==1 || ($rowRoomservice['one_shared']==2 && $rowRoomservice['is_private']==2))
			{
				 
			$vrepeat=1;
			$stmt = $dbCon->prepare("insert into employee_invited_visitor (company_id,inviting_employee,first_name,visitor_email,visiting_date,visiting_time,created_on,repeating_cycle,country_id,phone_number,location_id ,visitdate_id,booking_type,booking_id) values ( ?, ?, ?, ?, ?, ?, now(), ?, ?,?,?,?,?,?)");
			/* bind parameters for markers */
			
			$stmt->bind_param("iissssiisisii",$rowWellnessCompany['company_id'],$rowRoomservice['booked_employee_id'],$rowRoomservice['first_name'],$rowRoomservice['email'],$booking_date,$rowRoomservice['work_time'],$vrepeat,$rowRoomservice['country_of_residence'],$rowRoomservice['phone_number'],$rowWellnessCompany['property_id'],$rowRoomservice['booking_date'],$vrepeat,$rowRoomservice['id']);
			$stmt->execute();
			$id=$stmt->insert_id;
			$url="https://www.safeqloud.com/public/index.php/VisitorsQR/visitorFrontDesk/".$this->encrypt_decrypt('encrypt',$rowWellnessCompany['property_id']);	
			$surl=getShortUrl($url);
		$to      = $rowRoomservice['email'];
		$subject = "Booking Confirmed";
		$emailContent ='<html><head>
        <title>Reservation confirmed</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <style type="text/css">
            /* GT AMERICA */

            @font-face {
                font-display: fallback;
                font-family: "GT America Regular";
                font-weight: 400;
                src: url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Regular.woff2") format("woff2"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Regular.woff") format("woff"),
                    url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Regular.ttf") format("truetype");
            }

            @font-face {
                font-display: fallback;
                font-family: "GT America Medium";
                font-weight: 600;
                src: url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Medium.woff2") format("woff2"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Medium.woff") format("woff"),
                    url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Medium.ttf") format("truetype");
            }

            @font-face {
                font-display: fallback;
                font-family: "GT America Condensed Bold";
                font-weight: 700;
                src: url("https://www.exploretock.com/fonts/gt-america/GT-America-Condensed-Bold.woff2") format("woff2"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Condensed-Bold.woff") format("woff"),
                    url("https://www.exploretock.com/fonts/gt-america/GT-America-Condensed-Bold.ttf") format("truetype");
            }

            /* CLIENT-SPECIFIC RESET */

            body,
            table,
            td,
            a {
                -webkit-text-size-adjust: 100%;
                -ms-text-size-adjust: 100%;
            }

            /* Prevent WebKit and Windows mobile changing default text sizes */

            table,
            td {
                mso-table-lspace: 0pt;
                mso-table-rspace: 0pt;
            }

            /* Remove spacing between tables in Outlook 2007 and up */

            img {
                -ms-interpolation-mode: bicubic;
            }

            /* Allow smoother rendering of resized image in Internet Explorer */

            .im {
                color: inherit !important;
            }

            /* DEVICE-SPECIFIC RESET */

            a[x-apple-data-detectors] {
                color: inherit !important;
                text-decoration: none !important;
                font-size: inherit !important;
                font-family: inherit !important;
                font-weight: inherit !important;
                line-height: inherit !important;
            }

            /* iOS BLUE LINKS */

            /* RESET */

            img {
                border: 0;
                height: auto;
                line-height: 100%;
                outline: none;
                text-decoration: none;
                display: block;
            }

            table {
                border-collapse: collapse;
            }

            table td {
                border-collapse: collapse;
                display: table-cell;
            }

            body {
                height: 100% !important;
                margin: 0 !important;
                padding: 0 !important;
                width: 100% !important;
            }

            /* BG COLORS */

            .mainTable {
                background-color: #f0f0f0;
            }

            .mainTable--hospitality {
                background-color: #f7f2ed;
            }

            html {
                background-color: #f0f0f0;
            }

            /* VARIABLES */

            .bg-white {
                background-color: white;
            }

            .hr {
                /* Cross-client horizontal rule. Adapted from https://litmus.com/community/discussions/4633-is-there-a-reliable-1px-horizontal-rule-method */
                background-color: #d3d3d8;
                border-collapse: collapse;
                mso-table-lspace: 0pt;
                mso-table-rspace: 0pt;
                mso-line-height-rule: exactly;
                line-height: 1px;
            }

            .textAlignLeft {
                text-align: left !important;
            }

            .textAlignRight {
                text-align: right !important;
            }

            .textAlignCenter {
                text-align: center !important;
            }

            .mt1 {
                margin-top: 6px;
            }

            .list {
                padding-left: 18px;
                margin: 0;
            }

            /* TYPOGRAPHY */

            body {
                font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
                font-weight: 400;
                color: #4f4f65;
                -webkit-font-smoothing: antialiased;
                -ms-text-size-adjust: 100%;
                -moz-osx-font-smoothing: grayscale;
                font-smoothing: always;
                text-rendering: optimizeLegibility;
            }

            .h1 {
                font-family: "GT America Condensed Bold", "Roboto Condensed", "Roboto", "Helvetica", "Arial", sans-serif;
                font-weight: 700;
                vertical-align: middle;
                font-size: 36px;
                line-height: 42px;
            }

            .h2 {
                font-family: "GT America Medium", "Roboto", "Helvetica", "Arial", sans-serif;
                font-weight: 600;
                vertical-align: middle;
                font-size: 16px;
                line-height: 24px;
            }

            .text {
                font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
                font-weight: 400;
                font-size: 16px;
                line-height: 21px;
            }

            .text-list {
                font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
                font-weight: 400;
                font-size: 16px;
                line-height: 25px;
            }

            .textSmall {
                font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
                font-weight: 400;
                font-size: 14px;
            }

            .text-xsmall {
                font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
                font-size: 11px;
                text-transform: uppercase;
                line-height: 22px;
                letter-spacing: 1px;
            }

            .text-bold {
                font-weight: 600;
            }

            .text-link {
                text-decoration: underline;
            }

            .text-linkNoUnderline {
                text-decoration: none;
            }

            .text-strike {
                text-decoration: line-through;
            }

            /* FONT COLORS */

            .textColorDark {
                color: #23233e;
            }

            .textColorNormal {
                color: #4f4f65;
            }

            .textColorBlue {
                color: #2020c0;
            }

            .textColorGrayDark {
                color: #7b7b8b;
            }

            .textColorGray {
                color: #a5a8ad;
            }

            .textColorWhite {
                color: #ffffff;
            }

            .textColorRed {
                color: #df3232;
            }

            /* BUTTON */

            .Button-primary-wrapper {
                border-radius: 3px;
                background-color: #2020c0;
            }

            .Button-primary {
                font-family: "GT America Medium", "Roboto", "Helvetica", "Arial", sans-serif;
                border-radius: 3px;
                border: 1px solid #2020c0;
                color: #ffffff;
                display: block;
                font-size: 16px;
                font-weight: 600;
                padding: 18px;
                text-decoration: none;
            }

            .Button-secondary-wrapper {
                border-radius: 3px;
                background-color: #ffffff;
            }

            .Button-secondary {
                font-family: "GT America Medium", "Roboto", "Helvetica", "Arial", sans-serif;
                border-radius: 3px;
                border: 1px solid #2020c0;
                color: #2020c0;
                display: block;
                font-size: 16px;
                font-weight: 600;
                padding: 18px;
                text-decoration: none;
            }

            /* LAYOUT */

            .Content-container {
                padding-left: 60px;
                padding-right: 60px;
            }

            .Content-container--main {
                padding-top: 54px;
                padding-bottom: 60px;
            }

            .Content {
                width: 580px;
                margin: 0 auto;
            }

            .wrapper {
                max-width: 600px;
            }

            .section {
                padding: 24px 0px;
                border-bottom: 1px solid #d3d3d8;
            }

            .section--noBorder {
                padding: 24px 0px 0;
            }

            .section--last {
                padding: 24px 0px;
            }

            .message {
                background-color: #f4f4f5;
                padding: 18px;
            }

            .card {
                border: 1px solid #d3d3d8;
                padding: 18px;
            }

            /* HEADER */

            .header-tockLogoImage {
                display: block;
                color: #f0f0f0;
            }

            .header-heroImage {
                padding-bottom: 24px;
            }

            /* PREHEADER */

            .preheader {
                display: none;
                font-size: 1px;
                color: #ffffff;
                line-height: 1px;
                max-height: 0px;
                max-width: 0px;
                opacity: 0;
                overflow: hidden;
            }

            /* BANNER */

            .notice {
                padding: 12px;
                background: #23233e;
                color: #ffffff;
                display: block;
                font-size: 14px;
                font-family: "GT America Medium", "Roboto", "Helvetica", "Arial", sans-serif;
                font-weight: 600;
            }

            /* INTRO */

            .section--intro {
                padding-bottom: 48px;
            }

            /* BOOKING INFO */

            .business-logo__container {
                width: 48px;
                height: 48px;
                border-radius: 3px;
                border: 1px solid #d3d3d8;
                overflow: hidden;
            }

            .business-logo__image {
                border: 1px solid transparent;
                border-radius: 3px;
                width: 48px;
                height: 48px;
                display: block;
            }

            .business-address--address {
                width: 50%;
            }

            .business-address--map {
                width: 50%;
            }

            .business-address--map-image {
                width: 100%;
            }

            /* MOBILE TICKETS */

            .mobile-ticket--description {
                width: 65%;
                margin-top: 12px;
                margin-right: 5%;
            }

            .mobile-ticket--code {
                width: 30%;
            }

            .mobile-ticket--code-image {
                width: 100%;
            }

            /* RESERVATION ACTIONS */

            .linksTable {
                border-bottom: 1px solid #d3d3d8;
            }

            .linksTableRow {
                padding: 24px 12px;
            }

            .actions-icon {
                vertical-align: middle;
            }

            .actions-text {
                vertical-align: middle;
            }

            /* RECEIPT */

            .receipt__container {
                border: 1px solid #d3d3d8;
                padding: 24px;
            }

            .receipt__row {
                border-top: 1px solid #d3d3d8;
            }

            /* FEEDBACK ICONS */

            .feedback-link {
                border: 1px solid #d4d5da;
                border-radius: 3px;
                display: inline-block;
                width: calc(32% - 2px);
                padding: 10px 0;
            }

            .feedback-link-bumper {
                display: inline-block;
                width: 1%;
            }

            .feedback-link img {
                height: 50px;
                width: 50px;
            }

            /* SOCIAL ICONS */

            .social-link {
                display: inline-block;
                width: auto;
            }

            .social-link-text {
                padding: 14px 24px 14px 14px;
            }

            /* TABLET STYLES */

            @media screen and (max-width: 648px) {
                /* DEVICE-SPECIFIC RESET */
                div[style*="margin: 16px 0;"] {
                    margin: 0 !important;
                }
                /* ANDROID CENTER FIX */
                /* LAYOUT */
                .wrapper {
                    width: 100% !important;
                    max-width: 100% !important;
                }
                .Content {
                    width: 90% !important;
                }
                .Content-container {
                    padding-left: 36px !important;
                    padding-right: 36px !important;
                }
                .Content-container--main {
                    padding-top: 30px !important;
                    padding-bottom: 42px !important;
                }
                .responsiveTable {
                    width: 100% !important;
                }
                /* RESERVATION ACTIONS */
                .linksTableRow {
                    padding-left: 0 !important;
                    padding-right: 0 !important;
                    padding-top: 12px !important;
                    padding-bottom: 12px !important;
                }
                .linksTableRow--borderRight {
                    border-right: none !important;
                    padding-left: 0 !important;
                    padding-right: 0 !important;
                }
                /* FEEDBACK LINK */
                .feedback-link img {
                    height: 38px !important;
                    width: 38px !important;
                }
            }

            /* MOBILE STYLES */

            @media screen and (max-width: 480px) {
                /* TYPOGRAPHY */
                .h1 {
                    font-size: 30px !important;
                    line-height: 30px !important;
                }
                .text {
                    font-size: 16px !important;
                    line-height: 22px !important;
                }
                /* BUTTON */
                .mobile-buttonContainer {
                    width: 100% !important;
                }
                /* LAYOUT */
                .Content {
                    width: 100% !important;
                }
                .Content-container {
                    padding-left: 18px !important;
                    padding-right: 18px !important;
                }
                .Content-container--main {
                    padding-top: 24px !important;
                    padding-bottom: 30px !important;
                }
                .section {
                    padding: 18px 0 !important;
                }
                .section--last {
                    padding: 18px 0 !important;
                }
                .header {
                    padding: 0 18px !important;
                }
                .business-address--address {
                    width: 100% !important;
                }
                .business-address--map {
                    margin-top: 30px !important;
                    width: 100% !important;
                }
                .mobile-ticket--description {
                    width: 100% !important;
                    margin-top: 0px !important;
                }
                .mobile-ticket--code {
                    margin-top: 30px !important;
                    margin-left: 0;
                    width: 100% !important;
                }
                /* RECEIPT */
                .receipt__container {
                    padding: 12px !important;
                }
                /* SOCIAL ICONS */
                .social-link {
                    display: block !important;
                    width: 100% !important;
                    border-bottom: 1px solid #d3d3d8 !important;
                }
                /* INTRO */
                .section--intro {
                    padding-top: 18px !important;
                    padding-bottom: 18px !important;
                }
            }
        </style>

        <!--[if mso]>
            <style type="text/css">
                .h1 {
                    font-family: "Helvetica", "Arial", sans-serif !important;
                    font-weight: 700 !important;
                    vertical-align: middle !important;
                    font-size: 36px !important;
                    mso-line-height-rule: exactly;
                    line-height: 42px !important;
                }
                .h2 {
                    font-family: "Helvetica", "Arial", sans-serif !important;
                    font-weight: 600 !important;
                    vertical-align: middle !important;
                    font-size: 16px !important;
                    mso-line-height-rule: exactly;
                    line-height: 24px !important;
                }
                .text {
                    font-family: "Helvetica", "Arial", sans-serif !important;
                    font-weight: 400 !important;
                    font-size: 16px !important;
                    mso-line-height-rule: exactly;
                    line-height: 21px !important;
                }
                .text-list {
                    font-family: "Helvetica", "Arial", sans-serif !important;
                    font-weight: 400 !important;
                    font-size: 16px !important;
                    mso-line-height-rule: exactly;
                    line-height: 25px !important;
                }
                .textSmall {
                    font-family: "Helvetica", "Arial", sans-serif !important;
                    font-weight: 400 !important;
                    font-size: 14px !important;
                }
                .text-xsmall {
                    font-family: "Helvetica", "Arial", sans-serif !important;
                    font-size: 11px !important;
                    text-transform: uppercase !important;
                    mso-line-height-rule: exactly;
                    line-height: 22px !important;
                    letter-spacing: 1px !important;
                }
                .text-bold {
                    font-weight: 600 !important;
                }
                .text-link {
                    text-decoration: underline !important;
                }
                .text-linkNoUnderline {
                    text-decoration: none !important;
                }
                .text-strike {
                    text-decoration: line-through !important;
                }
                .textColorDark {
                    color: #23233e !important;
                }
                .textColorNormal {
                    color: #4f4f65 !important;
                }
                .textColorBlue {
                    color: #2020c0 !important;
                }
                .textColorGray {
                    color: #a5a8ad !important;
                }
                .textColorWhite {
                    color: #ffffff !important;
                }
                .Button-primary {
                    font-family: "Helvetica", "Arial", sans-serif !important;
                    border-radius: 3px !important;
                    border: 1px solid #2020c0 !important;
                    color: #ffffff !important;
                    display: block !important;
                    font-size: 16px !important;
                    font-weight: 600 !important;
                    padding: 18px !important;
                    text-decoration: none !important;
                }
                .Button-secondary {
                    font-family: "Helvetica", "Arial", sans-serif !important;
                    border-radius: 3px !important;
                    border: 1px solid #2020c0 !important;
                    color: #2020c0 !important;
                    display: block !important;
                    font-size: 16px !important;
                    font-weight: 600 !important;
                    padding: 18px !important;
                    text-decoration: none !important;
                }
            </style>
        <![endif]-->
        <!-- HIDDEN PREHEADER TEXT -->
    </head>
    <body>
        <div class="preheader" style="display: none; font-size: 1px; color: rgb(255, 255, 255); line-height: 1px; max-height: 0px; max-width: 0px; opacity: 0; overflow: hidden;"></div>
        <table border="0" cellpadding="0" cellspacing="0" width="100%" class="mainTable" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; background-color: rgb(240, 240, 240);">
            <tbody>
                <tr>
                    <td style="
                            display: none !important;
                            visibility: hidden;
                            mso-hide: all;
                            font-size: 1px;
                            color: #ffffff;
                            line-height: 1px;
                            max-height: 0px;
                            max-width: 0px;
                            opacity: 0;
                            overflow: hidden;
                            -webkit-text-size-adjust: 100%;
                            -ms-text-size-adjust: 100%;
                            mso-table-lspace: 0pt;
                            mso-table-rspace: 0pt;
                            border-collapse: collapse;
                            display: table-cell;
                        ">
                        We are thrilled that you will be joining us. If yo...
                    </td>
                    <!-- HEADER -->
                </tr>
                <tr>
                    <td align="center" class="header" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                        <!--[if (gte mso 9)|(IE)]>
    <table align="center" border="0" cellspacing="0" cellpadding="0" width="600">
    <tr>
    <td align="center" valign="top" width="600">
    <![endif]-->
                        <table border="0" cellpadding="0" cellspacing="0" width="100%" class="Content" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; width: 580px; margin: 0 auto;">
                            <tbody>
                                <tr class="spacer">
                                    <td height="12px" colspan="2" style="font-size: 12px; line-height: 12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        &nbsp;
                                    </td>
                                </tr>
                                <tr class="spacer">
                                    <td height="12px" colspan="2" style="font-size: 12px; line-height: 12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        &nbsp;
                                    </td>
                                </tr>
                                <tr>
                                    <td align="left" valign="middle" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        <h1 style="font-size: 33px; font-weight: 800; line-height: 30px;">Dstricts</h1>
                                    </td>
                                </tr>
                                <tr class="spacer">
                                    <td height="12px" colspan="2" style="font-size: 12px; line-height: 12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        &nbsp;
                                    </td>
                                </tr>
                                <tr class="spacer">
                                    <td height="12px" colspan="2" style="font-size: 12px; line-height: 12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        &nbsp;
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <!--[if (gte mso 9)|(IE)]>
    </td>
    </tr>
    </table>
    <![endif]-->
                    </td>
                </tr>
                <!-- CONTENT -->
                <tr>
                    <td align="center" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                        <!--[if (gte mso 9)|(IE)]>
    <table align="center" border="0" cellspacing="0" cellpadding="0" width="600">
    <tr>
    <td align="center" valign="top" width="600">
    <![endif]-->
                        <table border="0" cellpadding="0" cellspacing="0" width="100%" class="Content bg-white" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; background-color: white; width: 580px; margin: 0 auto;">
                            <tbody>
                                <tr>
                                    <td class="Content-container Content-container--main text textColorNormal" style="
                                            -webkit-text-size-adjust: 100%;
                                            -ms-text-size-adjust: 100%;
                                            mso-table-lspace: 0pt;
                                            mso-table-rspace: 0pt;
                                            border-collapse: collapse;
                                            display: table-cell;
                                            font-family: GT America Regular, Roboto, Helvetica, Arial, sans-serif;
                                            font-weight: 400;
                                            font-size: 16px;
                                            line-height: 21px;
                                            color: rgb(79, 79, 101);
                                            padding-left: 60px;
                                            padding-right: 60px;
                                            padding-top: 54px;
                                            padding-bottom: 60px;
                                        ">
                                        <table width="100%" border="0" cellspacing="0" cellpadding="0" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
                                            <!-- RESTAURANT INFO -->
                                            <tbody>
                                                <tr>
                                                    <td valign="top" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                                        <table align="left" border="0" cellpadding="0" cellspacing="0" width="100%" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
                                                            <tbody>
                                                                <tr>
                                                                    <td width="12" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                                                        &nbsp;
                                                                    </td>
                                                                    <td align="left" valign="middle" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                                                        <span class="h2 textColorDark" style="
                                                                                font-family: GT America Medium, Roboto, Helvetica, Arial, sans-serif;
                                                                                font-weight: 600;
                                                                                vertical-align: middle;
                                                                                font-size: 16px;
                                                                                line-height: 24px;
                                                                                color: rgb(35, 35, 62);
                                                                            ">
                                                                            '.htmlentities($rowRoomservice['first_name'],ENT_NOQUOTES, 'ISO-8859-1').'
                                                                        </span>
                                                                    </td>
                                                                </tr>
                                                                <tr class="spacer">
                                                                    <td height="12px" colspan="2" style="
                                                                            font-size: 12px;
                                                                            line-height: 12px;
                                                                            -webkit-text-size-adjust: 100%;
                                                                            -ms-text-size-adjust: 100%;
                                                                            mso-table-lspace: 0pt;
                                                                            mso-table-rspace: 0pt;
                                                                            border-collapse: collapse;
                                                                            display: table-cell;
                                                                        ">
                                                                        &nbsp;
                                                                    </td>
                                                                </tr>
                                                                <tr class="spacer">
                                                                    <td height="12px" colspan="2" style="
                                                                            font-size: 12px;
                                                                            line-height: 12px;
                                                                            -webkit-text-size-adjust: 100%;
                                                                            -ms-text-size-adjust: 100%;
                                                                            mso-table-lspace: 0pt;
                                                                            mso-table-rspace: 0pt;
                                                                            border-collapse: collapse;
                                                                            display: table-cell;
                                                                        ">
                                                                        &nbsp;
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </td>
                                                </tr>
                                                <!-- INTRO -->
                                                <tr>
                                                    <td valign="top" align="left" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                                        <table width="100%" border="0" cellspacing="0" cellpadding="0" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
                                                            <tbody>
                                                                <tr>
                                                                    <td align="left" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                                                        <span class="h1 textColorDark" style="
                                                                                font-family: GT America Condensed Bold, Roboto Condensed, Roboto, Helvetica, Arial, sans-serif;
                                                                                font-weight: 700;
                                                                                vertical-align: middle;
                                                                                font-size: 36px;
                                                                                line-height: 42px;
                                                                                color: rgb(35, 35, 62);
                                                                            ">
                                                                            Your booking have been confirmed at '.$rowWellnessCompany['company_name'].'
                                                                        </span>
                                                                    </td>
                                                                </tr>
                                                                <tr class="spacer">
                                                                    <td height="18px" colspan="2" style="
                                                                            font-size: 18px;
                                                                            line-height: 18px;
                                                                            -webkit-text-size-adjust: 100%;
                                                                            -ms-text-size-adjust: 100%;
                                                                            mso-table-lspace: 0pt;
                                                                            mso-table-rspace: 0pt;
                                                                            border-collapse: collapse;
                                                                            display: table-cell;
                                                                        ">
                                                                        &nbsp;
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td align="left" colspan="2" valign="top" width="100%" height="1" class="hr" style="
                                                                            -webkit-text-size-adjust: 100%;
                                                                            -ms-text-size-adjust: 100%;
                                                                            mso-table-lspace: 0pt;
                                                                            mso-table-rspace: 0pt;
                                                                            border-collapse: collapse;
                                                                            display: table-cell;
                                                                            background-color: rgb(211, 211, 216);
                                                                            border-collapse: collapse;
                                                                            mso-table-lspace: 0pt;
                                                                            mso-table-rspace: 0pt;
                                                                            mso-line-height-rule: exactly;
                                                                            line-height: 1px;
                                                                        ">
                                                                        <!--[if gte mso 15]>&nbsp;<![endif]-->
                                                                    </td>
                                                                </tr>
                                                                <tr class="spacer">
                                                                    <td height="18px" colspan="2" style="
                                                                            font-size: 18px;
                                                                            line-height: 18px;
                                                                            -webkit-text-size-adjust: 100%;
                                                                            -ms-text-size-adjust: 100%;
                                                                            mso-table-lspace: 0pt;
                                                                            mso-table-rspace: 0pt;
                                                                            border-collapse: collapse;
                                                                            display: table-cell;
                                                                        ">
                                                                        &nbsp;
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </td>
                                                </tr>
                                                <!-- MESSAGE -->

                                                <!-- BOOKING INFO -->
                                                <tr>
                                                    <td valign="top" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                                        <table align="left" border="0" cellpadding="0" cellspacing="0" width="100%" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
                                                            <tbody>
                                                                <tr>
                                                                    <td align="left" valign="middle" width="468" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;"></td>
                                                                </tr>

                                                                <tr class="spacer">
                                                                    <td height="12px" colspan="2" style="
                                                                            font-size: 12px;
                                                                            line-height: 12px;
                                                                            -webkit-text-size-adjust: 100%;
                                                                            -ms-text-size-adjust: 100%;
                                                                            mso-table-lspace: 0pt;
                                                                            mso-table-rspace: 0pt;
                                                                            border-collapse: collapse;
                                                                            display: table-cell;
                                                                        ">
                                                                        &nbsp;
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td align="center" valign="center" width="100%" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                                                        <table border="0" cellspacing="0" cellpadding="0" width="100%" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
                                                                            <tbody>
                                                                                <tr>
                                                                                    <td align="center" valign="center" width="100%" class="Button-primary-wrapper" style="
                                                                                            -webkit-text-size-adjust: 100%;
                                                                                            -ms-text-size-adjust: 100%;
                                                                                            mso-table-lspace: 0pt;
                                                                                            mso-table-rspace: 0pt;
                                                                                            border-collapse: collapse;
                                                                                            display: table-cell;
                                                                                            border-radius: 3px;
                                                                                            background-color: rgb(32, 32, 192);
                                                                                        ">
                                                                                        <a href="'.$url.'" target="_blank" class="Button-primary" style="
                                                                                                -webkit-text-size-adjust: 100%;
                                                                                                -ms-text-size-adjust: 100%;
                                                                                                font-family: GT America Medium, Roboto, Helvetica, Arial, sans-serif;
                                                                                                border-radius: 3px;
                                                                                                border: 1px solid rgb(32, 32, 192);
                                                                                                color: rgb(255, 255, 255);
                                                                                                display: block;
                                                                                                font-size: 16px;
                                                                                                font-weight: 600;
                                                                                                padding: 18px;
                                                                                                text-decoration: none;
                                                                                            ">
                                                                                            Manage your Meeting
                                                                                        </a>
                                                                                    </td>
                                                                                </tr>
                                                                            </tbody>
                                                                        </table>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </td>
                                                </tr>
                                                <!-- ADDRESS -->
                                                <tr>
                                                    <td align="center" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                                        <table border="0" cellpadding="0" cellspacing="0" width="100%" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
                                                            <tbody>
                                                                <tr class="spacer">
                                                                    <td height="18px" colspan="2" style="
                                                                            font-size: 18px;
                                                                            line-height: 18px;
                                                                            -webkit-text-size-adjust: 100%;
                                                                            -ms-text-size-adjust: 100%;
                                                                            mso-table-lspace: 0pt;
                                                                            mso-table-rspace: 0pt;
                                                                            border-collapse: collapse;
                                                                            display: table-cell;
                                                                        ">
                                                                        &nbsp;
                                                                    </td>
                                                                </tr>
                                                                <tr class="spacer">
                                                                    <td height="18px" colspan="2" style="
                                                                            font-size: 18px;
                                                                            line-height: 18px;
                                                                            -webkit-text-size-adjust: 100%;
                                                                            -ms-text-size-adjust: 100%;
                                                                            mso-table-lspace: 0pt;
                                                                            mso-table-rspace: 0pt;
                                                                            border-collapse: collapse;
                                                                            display: table-cell;
                                                                        ">
                                                                        &nbsp;
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td align="left" colspan="2" valign="top" width="100%" height="1" class="hr" style="
                                                                            -webkit-text-size-adjust: 100%;
                                                                            -ms-text-size-adjust: 100%;
                                                                            mso-table-lspace: 0pt;
                                                                            mso-table-rspace: 0pt;
                                                                            border-collapse: collapse;
                                                                            display: table-cell;
                                                                            background-color: rgb(211, 211, 216);
                                                                            border-collapse: collapse;
                                                                            mso-table-lspace: 0pt;
                                                                            mso-table-rspace: 0pt;
                                                                            mso-line-height-rule: exactly;
                                                                            line-height: 1px;
                                                                        ">
                                                                        <!--[if gte mso 15]>&nbsp;<![endif]-->
                                                                    </td>
                                                                </tr>
                                                                <tr class="spacer">
                                                                    <td height="18px" colspan="2" style="
                                                                            font-size: 18px;
                                                                            line-height: 18px;
                                                                            -webkit-text-size-adjust: 100%;
                                                                            -ms-text-size-adjust: 100%;
                                                                            mso-table-lspace: 0pt;
                                                                            mso-table-rspace: 0pt;
                                                                            border-collapse: collapse;
                                                                            display: table-cell;
                                                                        ">
                                                                        &nbsp;
                                                                    </td>
                                                                </tr>
                                                                <tr class="spacer">
                                                                    <td height="18px" colspan="2" style="
                                                                            font-size: 18px;
                                                                            line-height: 18px;
                                                                            -webkit-text-size-adjust: 100%;
                                                                            -ms-text-size-adjust: 100%;
                                                                            mso-table-lspace: 0pt;
                                                                            mso-table-rspace: 0pt;
                                                                            border-collapse: collapse;
                                                                            display: table-cell;
                                                                        ">
                                                                        &nbsp;
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td align="left" valign="middle" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                                                        <table border="0" cellpadding="0" cellspacing="0" width="100%" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
                                                                            <tbody>
                                                                                <tr>
                                                                                    <td style="
                                                                                            -webkit-text-size-adjust: 100%;
                                                                                            -ms-text-size-adjust: 100%;
                                                                                            mso-table-lspace: 0pt;
                                                                                            mso-table-rspace: 0pt;
                                                                                            border-collapse: collapse;
                                                                                            display: table-cell;
                                                                                        ">
                                                                                        <table align="left" border="0" cellpadding="0" cellspacing="0" width="230" class="business-address--address" style="
                                                                                                -webkit-text-size-adjust: 100%;
                                                                                                -ms-text-size-adjust: 100%;
                                                                                                mso-table-lspace: 0pt;
                                                                                                mso-table-rspace: 0pt;
                                                                                                border-collapse: collapse;
                                                                                                width: 70%;
                                                                                            ">
                                                                                            <tbody>
                                                                                                <tr>
                                                                                                    <td align="left" width="100%" class="text-list textColorNormal" style="
                                                                                                            -webkit-text-size-adjust: 100%;
                                                                                                            -ms-text-size-adjust: 100%;
                                                                                                            mso-table-lspace: 0pt;
                                                                                                            mso-table-rspace: 0pt;
                                                                                                            border-collapse: collapse;
                                                                                                            display: table-cell;
                                                                                                            font-family: GT America Regular, Roboto, Helvetica, Arial, sans-serif;
                                                                                                            font-weight: 400;
                                                                                                            font-size: 16px;
                                                                                                            line-height: 25px;
                                                                                                            color: rgb(79, 79, 101);
                                                                                                        ">
                                                                                                        <span class="h2 textColorDark" style="
                                                                                                                font-family: GT America Medium, Roboto, Helvetica, Arial, sans-serif;
                                                                                                                font-weight: 600;
                                                                                                                vertical-align: middle;
                                                                                                                font-size: 16px;
                                                                                                                line-height: 24px;
                                                                                                                color: rgb(35, 35, 62);
                                                                                                            ">
                                                                                                            If button dont work please copy and paste the link in browser: '.$surl.'
                                                                                                        </span>
                                                                                                    </td>
                                                                                                </tr>
                                                                                            </tbody>
                                                                                        </table>
                                                                                        <!--[if mso]></td><td><![endif]-->
                                                                                        <table align="right" border="0" cellpadding="0" cellspacing="0" width="230" class="business-address--map" style="
                                                                                                -webkit-text-size-adjust: 100%;
                                                                                                -ms-text-size-adjust: 100%;
                                                                                                mso-table-lspace: 0pt;
                                                                                                mso-table-rspace: 0pt;
                                                                                                border-collapse: collapse;
                                                                                                width: 50%;
                                                                                            ">
                                                                                            <tbody>
                                                                                                <tr></tr>
                                                                                            </tbody>
                                                                                        </table>
                                                                                    </td>
                                                                                </tr>
                                                                            </tbody>
                                                                        </table>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </td>
                                                </tr>
                                                <tr class="spacer">
                                                    <td height="18px" colspan="2" style="
                                                            font-size: 18px;
                                                            line-height: 18px;
                                                            -webkit-text-size-adjust: 100%;
                                                            -ms-text-size-adjust: 100%;
                                                            mso-table-lspace: 0pt;
                                                            mso-table-rspace: 0pt;
                                                            border-collapse: collapse;
                                                            display: table-cell;
                                                        ">
                                                        &nbsp;
                                                    </td>
                                                </tr>
                                                <tr class="spacer">
                                                    <td height="18px" colspan="2" style="
                                                            font-size: 18px;
                                                            line-height: 18px;
                                                            -webkit-text-size-adjust: 100%;
                                                            -ms-text-size-adjust: 100%;
                                                            mso-table-lspace: 0pt;
                                                            mso-table-rspace: 0pt;
                                                            border-collapse: collapse;
                                                            display: table-cell;
                                                        ">
                                                        &nbsp;
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td align="left" colspan="2" valign="top" width="100%" height="1" class="hr" style="
                                                            -webkit-text-size-adjust: 100%;
                                                            -ms-text-size-adjust: 100%;
                                                            mso-table-lspace: 0pt;
                                                            mso-table-rspace: 0pt;
                                                            border-collapse: collapse;
                                                            display: table-cell;
                                                            background-color: rgb(211, 211, 216);
                                                            border-collapse: collapse;
                                                            mso-table-lspace: 0pt;
                                                            mso-table-rspace: 0pt;
                                                            mso-line-height-rule: exactly;
                                                            line-height: 1px;
                                                        ">
                                                        <!--[if gte mso 15]>&nbsp;<![endif]-->
                                                    </td>
                                                </tr>

                                                <!-- RECEIPT -->

                                                <tr class="spacer">
                                                    <td height="18px" colspan="2" style="
                                                            font-size: 18px;
                                                            line-height: 18px;
                                                            -webkit-text-size-adjust: 100%;
                                                            -ms-text-size-adjust: 100%;
                                                            mso-table-lspace: 0pt;
                                                            mso-table-rspace: 0pt;
                                                            border-collapse: collapse;
                                                            display: table-cell;
                                                        ">
                                                        &nbsp;
                                                    </td>
                                                </tr>
                                                <!-- EDIT RECEIPT -->
                                                <!-- CANCELLATION POLICY -->
                                                <tr>
                                                    <td valign="top" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                                        <table border="0" cellpadding="0" cellspacing="0" width="100%" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
                                                            <tbody>
                                                                <tr>
                                                                    <td align="left" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                                                        <div class="text text-bold textColorDark" style="
                                                                                font-family: GT America Regular, Roboto, Helvetica, Arial, sans-serif;
                                                                                font-weight: 400;
                                                                                font-size: 16px;
                                                                                line-height: 21px;
                                                                                font-weight: 600;
                                                                                color: rgb(35, 35, 62);
                                                                            ">
                                                                            Address for meeting
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td align="left" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                                                        <div class="text textColorNormal mt1" style="
                                                                                margin-top: 6px;
                                                                                font-family: GT America Regular, Roboto,Helvetica, Arial, sans-serif;
                                                                                font-weight: 400;
                                                                                font-size: 16px;
                                                                                line-height: 21px;
                                                                                color: rgb(79, 79, 101);
                                                                            ">
                                                                            <span>'.$rowWellnessCompany['visiting_address'].' '.$rowWellnessCompany['d_port_number'].'</span>
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </td>
                                                </tr>
                                                <tr class="spacer">
                                                    <td height="12px" colspan="2" style="
                                                            font-size: 12px;
                                                            line-height: 12px;
                                                            -webkit-text-size-adjust: 100%;
                                                            -ms-text-size-adjust: 100%;
                                                            mso-table-lspace: 0pt;
                                                            mso-table-rspace: 0pt;
                                                            border-collapse: collapse;
                                                            display: table-cell;
                                                        ">
                                                        &nbsp;
                                                    </td>
                                                </tr>
                                                <tr class="spacer">
                                                    <td height="12px" colspan="2" style="
                                                            font-size: 12px;
                                                            line-height: 12px;
                                                            -webkit-text-size-adjust: 100%;
                                                            -ms-text-size-adjust: 100%;
                                                            mso-table-lspace: 0pt;
                                                            mso-table-rspace: 0pt;
                                                            border-collapse: collapse;
                                                            display: table-cell;
                                                        ">
                                                        &nbsp;
                                                    </td>
                                                </tr>
                                                <!-- QUESTIONS -->
                                            </tbody>
                                        </table>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </td>
                </tr>
                <!-- FOOTER -->
                <tr>
                    <td align="center" class="Content" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell; width: 580px; margin: 0 auto;">
                        <!-- Will most likely required a feature flag -->
                        <!--[if (gte mso 9)|(IE)]>
<table align="center" border="0" cellspacing="0" cellpadding="0" width="600">
<tr>
<td align="center" valign="top" width="600">
<![endif]-->
                        <table width="100%" border="0" cellspacing="0" cellpadding="0" align="center" class="Content-container" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; padding-left: 60px; padding-right: 60px;">
                            <tbody>
                                <tr class="spacer">
                                    <td height="12px" colspan="2" style="font-size: 12px; line-height: 12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        &nbsp;
                                    </td>
                                </tr>
                                <tr class="spacer">
                                    <td height="12px" colspan="2" style="font-size: 12px; line-height: 12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        &nbsp;
                                    </td>
                                </tr>
                                <tr class="spacer">
                                    <td height="12px" colspan="2" style="font-size: 12px; line-height: 12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        &nbsp;
                                    </td>
                                </tr>
                                <tr>
                                    <td align="center" valign="top" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        <a href="https://www.exploretock.com" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%;">
                                            <img src="https://storage.googleapis.com/tock-public-assets/images-email-template/tock-brandmark-color.png" width="30" height="30" alt="Tock" border="0" style="-ms-interpolation-mode: bicubic; border: 0; height: auto; line-height: 100%; outline: none; text-decoration: none; display: block;">
                                        </a>
                                    </td>
                                </tr>
                                <tr class="spacer">
                                    <td height="18px" colspan="2" style="font-size: 18px; line-height: 18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        &nbsp;
                                    </td>
                                </tr>
                                <tr>
                                    <td align="center" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        <div class="text-xsmall textColorNormal" style="font-family: GT America Regular, Roboto,Helvetica, Arial, sans-serif; font-size: 11px; text-transform: uppercase; line-height: 22px; letter-spacing: 1px; color: rgb(79, 79, 101);">
                                            © 2019 Tock, Inc.
                                        </div>
                                        <div class="text-xsmall textColorNormal" style="font-family: GT America Regular, Roboto,Helvetica, Arial, sans-serif; font-size: 11px; text-transform: uppercase; line-height: 22px; letter-spacing: 1px; color: rgb(79, 79, 101);">
                                            All Rights Reserved
                                        </div>
                                    </td>
                                </tr>
                                <tr class="spacer">
                                    <td height="12px" colspan="2" style="font-size: 12px; line-height: 12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        &nbsp;
                                    </td>
                                </tr>
                                <tr class="spacer">
                                    <td height="12px" colspan="2" style="font-size: 12px; line-height: 12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        &nbsp;
                                    </td>
                                </tr>
                                <tr class="spacer">
                                    <td height="12px" colspan="2" style="font-size: 12px; line-height: 12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        &nbsp;
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <!--[if (gte mso 9)|(IE)]>
</td>
</tr>
</table>
<![endif]-->
                    </td>
                </tr>
            </tbody>
        </table>
    
</body></html>';
				try {
					 sendEmail($subject, $to, $emailContent);
					}

					 
					catch(Exception $e) {
					   
					}
				$stmt = $dbCon->prepare("select country_code from phone_country_code where id=?");
				
				/* bind parameters for markers */
				$stmt->bind_param("i", $rowRoomservice['country_of_residence']);
				$stmt->execute();
				$result_phone = $stmt->get_result();
				$row_phone = $result_phone->fetch_assoc();
				
				$to            = '+'.trim($row_phone['country_code']).''.trim($rowRoomservice['phone_number']);
				$surl=getShortUrl($url);
				$emailContent ="Your booking has been confirmed at ".$rowWellnessCompany['company_name']." please scan qr code on reception to confirm your visit. you can check qr code here: ".$surl;
				$res=sendSms($subject, $to, $emailContent);
			
			}
			else
			{
				$to      = $rowRoomservice['email'];
				$subject = "Booking Confirmed";
				$emailContent ='<html><head>
        <title>Reservation confirmed</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <style type="text/css">
            /* GT AMERICA */

            @font-face {
                font-display: fallback;
                font-family: "GT America Regular";
                font-weight: 400;
                src: url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Regular.woff2") format("woff2"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Regular.woff") format("woff"),
                    url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Regular.ttf") format("truetype");
            }

            @font-face {
                font-display: fallback;
                font-family: "GT America Medium";
                font-weight: 600;
                src: url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Medium.woff2") format("woff2"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Medium.woff") format("woff"),
                    url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Medium.ttf") format("truetype");
            }

            @font-face {
                font-display: fallback;
                font-family: "GT America Condensed Bold";
                font-weight: 700;
                src: url("https://www.exploretock.com/fonts/gt-america/GT-America-Condensed-Bold.woff2") format("woff2"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Condensed-Bold.woff") format("woff"),
                    url("https://www.exploretock.com/fonts/gt-america/GT-America-Condensed-Bold.ttf") format("truetype");
            }

            /* CLIENT-SPECIFIC RESET */

            body,
            table,
            td,
            a {
                -webkit-text-size-adjust: 100%;
                -ms-text-size-adjust: 100%;
            }

            /* Prevent WebKit and Windows mobile changing default text sizes */

            table,
            td {
                mso-table-lspace: 0pt;
                mso-table-rspace: 0pt;
            }

            /* Remove spacing between tables in Outlook 2007 and up */

            img {
                -ms-interpolation-mode: bicubic;
            }

            /* Allow smoother rendering of resized image in Internet Explorer */

            .im {
                color: inherit !important;
            }

            /* DEVICE-SPECIFIC RESET */

            a[x-apple-data-detectors] {
                color: inherit !important;
                text-decoration: none !important;
                font-size: inherit !important;
                font-family: inherit !important;
                font-weight: inherit !important;
                line-height: inherit !important;
            }

            /* iOS BLUE LINKS */

            /* RESET */

            img {
                border: 0;
                height: auto;
                line-height: 100%;
                outline: none;
                text-decoration: none;
                display: block;
            }

            table {
                border-collapse: collapse;
            }

            table td {
                border-collapse: collapse;
                display: table-cell;
            }

            body {
                height: 100% !important;
                margin: 0 !important;
                padding: 0 !important;
                width: 100% !important;
            }

            /* BG COLORS */

            .mainTable {
                background-color: #f0f0f0;
            }

            .mainTable--hospitality {
                background-color: #f7f2ed;
            }

            html {
                background-color: #f0f0f0;
            }

            /* VARIABLES */

            .bg-white {
                background-color: white;
            }

            .hr {
                /* Cross-client horizontal rule. Adapted from https://litmus.com/community/discussions/4633-is-there-a-reliable-1px-horizontal-rule-method */
                background-color: #d3d3d8;
                border-collapse: collapse;
                mso-table-lspace: 0pt;
                mso-table-rspace: 0pt;
                mso-line-height-rule: exactly;
                line-height: 1px;
            }

            .textAlignLeft {
                text-align: left !important;
            }

            .textAlignRight {
                text-align: right !important;
            }

            .textAlignCenter {
                text-align: center !important;
            }

            .mt1 {
                margin-top: 6px;
            }

            .list {
                padding-left: 18px;
                margin: 0;
            }

            /* TYPOGRAPHY */

            body {
                font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
                font-weight: 400;
                color: #4f4f65;
                -webkit-font-smoothing: antialiased;
                -ms-text-size-adjust: 100%;
                -moz-osx-font-smoothing: grayscale;
                font-smoothing: always;
                text-rendering: optimizeLegibility;
            }

            .h1 {
                font-family: "GT America Condensed Bold", "Roboto Condensed", "Roboto", "Helvetica", "Arial", sans-serif;
                font-weight: 700;
                vertical-align: middle;
                font-size: 36px;
                line-height: 42px;
            }

            .h2 {
                font-family: "GT America Medium", "Roboto", "Helvetica", "Arial", sans-serif;
                font-weight: 600;
                vertical-align: middle;
                font-size: 16px;
                line-height: 24px;
            }

            .text {
                font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
                font-weight: 400;
                font-size: 16px;
                line-height: 21px;
            }

            .text-list {
                font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
                font-weight: 400;
                font-size: 16px;
                line-height: 25px;
            }

            .textSmall {
                font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
                font-weight: 400;
                font-size: 14px;
            }

            .text-xsmall {
                font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
                font-size: 11px;
                text-transform: uppercase;
                line-height: 22px;
                letter-spacing: 1px;
            }

            .text-bold {
                font-weight: 600;
            }

            .text-link {
                text-decoration: underline;
            }

            .text-linkNoUnderline {
                text-decoration: none;
            }

            .text-strike {
                text-decoration: line-through;
            }

            /* FONT COLORS */

            .textColorDark {
                color: #23233e;
            }

            .textColorNormal {
                color: #4f4f65;
            }

            .textColorBlue {
                color: #2020c0;
            }

            .textColorGrayDark {
                color: #7b7b8b;
            }

            .textColorGray {
                color: #a5a8ad;
            }

            .textColorWhite {
                color: #ffffff;
            }

            .textColorRed {
                color: #df3232;
            }

            /* BUTTON */

            .Button-primary-wrapper {
                border-radius: 3px;
                background-color: #2020c0;
            }

            .Button-primary {
                font-family: "GT America Medium", "Roboto", "Helvetica", "Arial", sans-serif;
                border-radius: 3px;
                border: 1px solid #2020c0;
                color: #ffffff;
                display: block;
                font-size: 16px;
                font-weight: 600;
                padding: 18px;
                text-decoration: none;
            }

            .Button-secondary-wrapper {
                border-radius: 3px;
                background-color: #ffffff;
            }

            .Button-secondary {
                font-family: "GT America Medium", "Roboto", "Helvetica", "Arial", sans-serif;
                border-radius: 3px;
                border: 1px solid #2020c0;
                color: #2020c0;
                display: block;
                font-size: 16px;
                font-weight: 600;
                padding: 18px;
                text-decoration: none;
            }

            /* LAYOUT */

            .Content-container {
                padding-left: 60px;
                padding-right: 60px;
            }

            .Content-container--main {
                padding-top: 54px;
                padding-bottom: 60px;
            }

            .Content {
                width: 580px;
                margin: 0 auto;
            }

            .wrapper {
                max-width: 600px;
            }

            .section {
                padding: 24px 0px;
                border-bottom: 1px solid #d3d3d8;
            }

            .section--noBorder {
                padding: 24px 0px 0;
            }

            .section--last {
                padding: 24px 0px;
            }

            .message {
                background-color: #f4f4f5;
                padding: 18px;
            }

            .card {
                border: 1px solid #d3d3d8;
                padding: 18px;
            }

            /* HEADER */

            .header-tockLogoImage {
                display: block;
                color: #f0f0f0;
            }

            .header-heroImage {
                padding-bottom: 24px;
            }

            /* PREHEADER */

            .preheader {
                display: none;
                font-size: 1px;
                color: #ffffff;
                line-height: 1px;
                max-height: 0px;
                max-width: 0px;
                opacity: 0;
                overflow: hidden;
            }

            /* BANNER */

            .notice {
                padding: 12px;
                background: #23233e;
                color: #ffffff;
                display: block;
                font-size: 14px;
                font-family: "GT America Medium", "Roboto", "Helvetica", "Arial", sans-serif;
                font-weight: 600;
            }

            /* INTRO */

            .section--intro {
                padding-bottom: 48px;
            }

            /* BOOKING INFO */

            .business-logo__container {
                width: 48px;
                height: 48px;
                border-radius: 3px;
                border: 1px solid #d3d3d8;
                overflow: hidden;
            }

            .business-logo__image {
                border: 1px solid transparent;
                border-radius: 3px;
                width: 48px;
                height: 48px;
                display: block;
            }

            .business-address--address {
                width: 50%;
            }

            .business-address--map {
                width: 50%;
            }

            .business-address--map-image {
                width: 100%;
            }

            /* MOBILE TICKETS */

            .mobile-ticket--description {
                width: 65%;
                margin-top: 12px;
                margin-right: 5%;
            }

            .mobile-ticket--code {
                width: 30%;
            }

            .mobile-ticket--code-image {
                width: 100%;
            }

            /* RESERVATION ACTIONS */

            .linksTable {
                border-bottom: 1px solid #d3d3d8;
            }

            .linksTableRow {
                padding: 24px 12px;
            }

            .actions-icon {
                vertical-align: middle;
            }

            .actions-text {
                vertical-align: middle;
            }

            /* RECEIPT */

            .receipt__container {
                border: 1px solid #d3d3d8;
                padding: 24px;
            }

            .receipt__row {
                border-top: 1px solid #d3d3d8;
            }

            /* FEEDBACK ICONS */

            .feedback-link {
                border: 1px solid #d4d5da;
                border-radius: 3px;
                display: inline-block;
                width: calc(32% - 2px);
                padding: 10px 0;
            }

            .feedback-link-bumper {
                display: inline-block;
                width: 1%;
            }

            .feedback-link img {
                height: 50px;
                width: 50px;
            }

            /* SOCIAL ICONS */

            .social-link {
                display: inline-block;
                width: auto;
            }

            .social-link-text {
                padding: 14px 24px 14px 14px;
            }

            /* TABLET STYLES */

            @media screen and (max-width: 648px) {
                /* DEVICE-SPECIFIC RESET */
                div[style*="margin: 16px 0;"] {
                    margin: 0 !important;
                }
                /* ANDROID CENTER FIX */
                /* LAYOUT */
                .wrapper {
                    width: 100% !important;
                    max-width: 100% !important;
                }
                .Content {
                    width: 90% !important;
                }
                .Content-container {
                    padding-left: 36px !important;
                    padding-right: 36px !important;
                }
                .Content-container--main {
                    padding-top: 30px !important;
                    padding-bottom: 42px !important;
                }
                .responsiveTable {
                    width: 100% !important;
                }
                /* RESERVATION ACTIONS */
                .linksTableRow {
                    padding-left: 0 !important;
                    padding-right: 0 !important;
                    padding-top: 12px !important;
                    padding-bottom: 12px !important;
                }
                .linksTableRow--borderRight {
                    border-right: none !important;
                    padding-left: 0 !important;
                    padding-right: 0 !important;
                }
                /* FEEDBACK LINK */
                .feedback-link img {
                    height: 38px !important;
                    width: 38px !important;
                }
            }

            /* MOBILE STYLES */

            @media screen and (max-width: 480px) {
                /* TYPOGRAPHY */
                .h1 {
                    font-size: 30px !important;
                    line-height: 30px !important;
                }
                .text {
                    font-size: 16px !important;
                    line-height: 22px !important;
                }
                /* BUTTON */
                .mobile-buttonContainer {
                    width: 100% !important;
                }
                /* LAYOUT */
                .Content {
                    width: 100% !important;
                }
                .Content-container {
                    padding-left: 18px !important;
                    padding-right: 18px !important;
                }
                .Content-container--main {
                    padding-top: 24px !important;
                    padding-bottom: 30px !important;
                }
                .section {
                    padding: 18px 0 !important;
                }
                .section--last {
                    padding: 18px 0 !important;
                }
                .header {
                    padding: 0 18px !important;
                }
                .business-address--address {
                    width: 100% !important;
                }
                .business-address--map {
                    margin-top: 30px !important;
                    width: 100% !important;
                }
                .mobile-ticket--description {
                    width: 100% !important;
                    margin-top: 0px !important;
                }
                .mobile-ticket--code {
                    margin-top: 30px !important;
                    margin-left: 0;
                    width: 100% !important;
                }
                /* RECEIPT */
                .receipt__container {
                    padding: 12px !important;
                }
                /* SOCIAL ICONS */
                .social-link {
                    display: block !important;
                    width: 100% !important;
                    border-bottom: 1px solid #d3d3d8 !important;
                }
                /* INTRO */
                .section--intro {
                    padding-top: 18px !important;
                    padding-bottom: 18px !important;
                }
            }
        </style>

        <!--[if mso]>
            <style type="text/css">
                .h1 {
                    font-family: "Helvetica", "Arial", sans-serif !important;
                    font-weight: 700 !important;
                    vertical-align: middle !important;
                    font-size: 36px !important;
                    mso-line-height-rule: exactly;
                    line-height: 42px !important;
                }
                .h2 {
                    font-family: "Helvetica", "Arial", sans-serif !important;
                    font-weight: 600 !important;
                    vertical-align: middle !important;
                    font-size: 16px !important;
                    mso-line-height-rule: exactly;
                    line-height: 24px !important;
                }
                .text {
                    font-family: "Helvetica", "Arial", sans-serif !important;
                    font-weight: 400 !important;
                    font-size: 16px !important;
                    mso-line-height-rule: exactly;
                    line-height: 21px !important;
                }
                .text-list {
                    font-family: "Helvetica", "Arial", sans-serif !important;
                    font-weight: 400 !important;
                    font-size: 16px !important;
                    mso-line-height-rule: exactly;
                    line-height: 25px !important;
                }
                .textSmall {
                    font-family: "Helvetica", "Arial", sans-serif !important;
                    font-weight: 400 !important;
                    font-size: 14px !important;
                }
                .text-xsmall {
                    font-family: "Helvetica", "Arial", sans-serif !important;
                    font-size: 11px !important;
                    text-transform: uppercase !important;
                    mso-line-height-rule: exactly;
                    line-height: 22px !important;
                    letter-spacing: 1px !important;
                }
                .text-bold {
                    font-weight: 600 !important;
                }
                .text-link {
                    text-decoration: underline !important;
                }
                .text-linkNoUnderline {
                    text-decoration: none !important;
                }
                .text-strike {
                    text-decoration: line-through !important;
                }
                .textColorDark {
                    color: #23233e !important;
                }
                .textColorNormal {
                    color: #4f4f65 !important;
                }
                .textColorBlue {
                    color: #2020c0 !important;
                }
                .textColorGray {
                    color: #a5a8ad !important;
                }
                .textColorWhite {
                    color: #ffffff !important;
                }
                .Button-primary {
                    font-family: "Helvetica", "Arial", sans-serif !important;
                    border-radius: 3px !important;
                    border: 1px solid #2020c0 !important;
                    color: #ffffff !important;
                    display: block !important;
                    font-size: 16px !important;
                    font-weight: 600 !important;
                    padding: 18px !important;
                    text-decoration: none !important;
                }
                .Button-secondary {
                    font-family: "Helvetica", "Arial", sans-serif !important;
                    border-radius: 3px !important;
                    border: 1px solid #2020c0 !important;
                    color: #2020c0 !important;
                    display: block !important;
                    font-size: 16px !important;
                    font-weight: 600 !important;
                    padding: 18px !important;
                    text-decoration: none !important;
                }
            </style>
        <![endif]-->
        <!-- HIDDEN PREHEADER TEXT -->
    </head>
    <body>
        <div class="preheader" style="display: none; font-size: 1px; color: rgb(255, 255, 255); line-height: 1px; max-height: 0px; max-width: 0px; opacity: 0; overflow: hidden;"></div>
        <table border="0" cellpadding="0" cellspacing="0" width="100%" class="mainTable" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; background-color: rgb(240, 240, 240);">
            <tbody>
                <tr>
                    <td style="
                            display: none !important;
                            visibility: hidden;
                            mso-hide: all;
                            font-size: 1px;
                            color: #ffffff;
                            line-height: 1px;
                            max-height: 0px;
                            max-width: 0px;
                            opacity: 0;
                            overflow: hidden;
                            -webkit-text-size-adjust: 100%;
                            -ms-text-size-adjust: 100%;
                            mso-table-lspace: 0pt;
                            mso-table-rspace: 0pt;
                            border-collapse: collapse;
                            display: table-cell;
                        ">
                        We are thrilled that you will be joining us. If yo...
                    </td>
                    <!-- HEADER -->
                </tr>
                <tr>
                    <td align="center" class="header" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                        <!--[if (gte mso 9)|(IE)]>
    <table align="center" border="0" cellspacing="0" cellpadding="0" width="600">
    <tr>
    <td align="center" valign="top" width="600">
    <![endif]-->
                        <table border="0" cellpadding="0" cellspacing="0" width="100%" class="Content" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; width: 580px; margin: 0 auto;">
                            <tbody>
                                <tr class="spacer">
                                    <td height="12px" colspan="2" style="font-size: 12px; line-height: 12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        &nbsp;
                                    </td>
                                </tr>
                                <tr class="spacer">
                                    <td height="12px" colspan="2" style="font-size: 12px; line-height: 12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        &nbsp;
                                    </td>
                                </tr>
                                <tr>
                                    <td align="left" valign="middle" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        <h1 style="font-size: 33px; font-weight: 800; line-height: 30px;">Dstricts</h1>
                                    </td>
                                </tr>
                                <tr class="spacer">
                                    <td height="12px" colspan="2" style="font-size: 12px; line-height: 12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        &nbsp;
                                    </td>
                                </tr>
                                <tr class="spacer">
                                    <td height="12px" colspan="2" style="font-size: 12px; line-height: 12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        &nbsp;
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <!--[if (gte mso 9)|(IE)]>
    </td>
    </tr>
    </table>
    <![endif]-->
                    </td>
                </tr>
                <!-- CONTENT -->
                <tr>
                    <td align="center" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                        <!--[if (gte mso 9)|(IE)]>
    <table align="center" border="0" cellspacing="0" cellpadding="0" width="600">
    <tr>
    <td align="center" valign="top" width="600">
    <![endif]-->
                        <table border="0" cellpadding="0" cellspacing="0" width="100%" class="Content bg-white" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; background-color: white; width: 580px; margin: 0 auto;">
                            <tbody>
                                <tr>
                                    <td class="Content-container Content-container--main text textColorNormal" style="
                                            -webkit-text-size-adjust: 100%;
                                            -ms-text-size-adjust: 100%;
                                            mso-table-lspace: 0pt;
                                            mso-table-rspace: 0pt;
                                            border-collapse: collapse;
                                            display: table-cell;
                                            font-family: GT America Regular, Roboto, Helvetica, Arial, sans-serif;
                                            font-weight: 400;
                                            font-size: 16px;
                                            line-height: 21px;
                                            color: rgb(79, 79, 101);
                                            padding-left: 60px;
                                            padding-right: 60px;
                                            padding-top: 54px;
                                            padding-bottom: 60px;
                                        ">
                                        <table width="100%" border="0" cellspacing="0" cellpadding="0" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
                                            <!-- RESTAURANT INFO -->
                                            <tbody>
                                                <tr>
                                                    <td valign="top" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                                        <table align="left" border="0" cellpadding="0" cellspacing="0" width="100%" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
                                                            <tbody>
                                                                <tr>
                                                                    <td width="12" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                                                        &nbsp;
                                                                    </td>
                                                                    <td align="left" valign="middle" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                                                        <span class="h2 textColorDark" style="
                                                                                font-family: GT America Medium, Roboto, Helvetica, Arial, sans-serif;
                                                                                font-weight: 600;
                                                                                vertical-align: middle;
                                                                                font-size: 16px;
                                                                                line-height: 24px;
                                                                                color: rgb(35, 35, 62);
                                                                            ">
                                                                            '.htmlentities($rowRoomservice['first_name'],ENT_NOQUOTES, 'ISO-8859-1').'
                                                                        </span>
                                                                    </td>
                                                                </tr>
                                                                <tr class="spacer">
                                                                    <td height="12px" colspan="2" style="
                                                                            font-size: 12px;
                                                                            line-height: 12px;
                                                                            -webkit-text-size-adjust: 100%;
                                                                            -ms-text-size-adjust: 100%;
                                                                            mso-table-lspace: 0pt;
                                                                            mso-table-rspace: 0pt;
                                                                            border-collapse: collapse;
                                                                            display: table-cell;
                                                                        ">
                                                                        &nbsp;
                                                                    </td>
                                                                </tr>
                                                                <tr class="spacer">
                                                                    <td height="12px" colspan="2" style="
                                                                            font-size: 12px;
                                                                            line-height: 12px;
                                                                            -webkit-text-size-adjust: 100%;
                                                                            -ms-text-size-adjust: 100%;
                                                                            mso-table-lspace: 0pt;
                                                                            mso-table-rspace: 0pt;
                                                                            border-collapse: collapse;
                                                                            display: table-cell;
                                                                        ">
                                                                        &nbsp;
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </td>
                                                </tr>
                                                <!-- INTRO -->
                                                <tr>
                                                    <td valign="top" align="left" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                                        <table width="100%" border="0" cellspacing="0" cellpadding="0" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
                                                            <tbody>
                                                                <tr>
                                                                    <td align="left" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                                                        <span class="h1 textColorDark" style="
                                                                                font-family: GT America Condensed Bold, Roboto Condensed, Roboto, Helvetica, Arial, sans-serif;
                                                                                font-weight: 700;
                                                                                vertical-align: middle;
                                                                                font-size: 36px;
                                                                                line-height: 42px;
                                                                                color: rgb(35, 35, 62);
                                                                            ">
                                                                            Your booking have been confirmed at '.$rowWellnessCompany['company_name'].'
                                                                        </span>
                                                                    </td>
                                                                </tr>
                                                                
                                                                
                                                                
                                                            </tbody>
                                                        </table>
                                                    </td>
                                                </tr>
                                                <!-- MESSAGE -->

                                                <!-- BOOKING INFO -->
                                                
                                                <!-- ADDRESS -->
                                                <tr>
                                                    <td align="center" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                                        <table border="0" cellpadding="0" cellspacing="0" width="100%" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
                                                            <tbody>
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                            </tbody>
                                                        </table>
                                                    </td>
                                                </tr>
                                                <tr class="spacer">
                                                    <td height="18px" colspan="2" style="
                                                            font-size: 18px;
                                                            line-height: 18px;
                                                            -webkit-text-size-adjust: 100%;
                                                            -ms-text-size-adjust: 100%;
                                                            mso-table-lspace: 0pt;
                                                            mso-table-rspace: 0pt;
                                                            border-collapse: collapse;
                                                            display: table-cell;
                                                        ">
                                                        &nbsp;
                                                    </td>
                                                </tr>
                                                <tr class="spacer">
                                                    <td height="18px" colspan="2" style="
                                                            font-size: 18px;
                                                            line-height: 18px;
                                                            -webkit-text-size-adjust: 100%;
                                                            -ms-text-size-adjust: 100%;
                                                            mso-table-lspace: 0pt;
                                                            mso-table-rspace: 0pt;
                                                            border-collapse: collapse;
                                                            display: table-cell;
                                                        ">
                                                        &nbsp;
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td align="left" colspan="2" valign="top" width="100%" height="1" class="hr" style="
                                                            -webkit-text-size-adjust: 100%;
                                                            -ms-text-size-adjust: 100%;
                                                            mso-table-lspace: 0pt;
                                                            mso-table-rspace: 0pt;
                                                            border-collapse: collapse;
                                                            display: table-cell;
                                                            background-color: rgb(211, 211, 216);
                                                            border-collapse: collapse;
                                                            mso-table-lspace: 0pt;
                                                            mso-table-rspace: 0pt;
                                                            mso-line-height-rule: exactly;
                                                            line-height: 1px;
                                                        ">
                                                        <!--[if gte mso 15]>&nbsp;<![endif]-->
                                                    </td>
                                                </tr>

                                                <!-- RECEIPT -->

                                                <tr class="spacer">
                                                    <td height="18px" colspan="2" style="
                                                            font-size: 18px;
                                                            line-height: 18px;
                                                            -webkit-text-size-adjust: 100%;
                                                            -ms-text-size-adjust: 100%;
                                                            mso-table-lspace: 0pt;
                                                            mso-table-rspace: 0pt;
                                                            border-collapse: collapse;
                                                            display: table-cell;
                                                        ">
                                                        &nbsp;
                                                    </td>
                                                </tr>
                                                <!-- EDIT RECEIPT -->
                                                <!-- CANCELLATION POLICY -->
                                                <tr>
                                                    <td valign="top" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                                        <table border="0" cellpadding="0" cellspacing="0" width="100%" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
                                                            <tbody>
                                                                <tr>
                                                                    <td align="left" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                                                        <div class="text text-bold textColorDark" style="
                                                                                font-family: GT America Regular, Roboto, Helvetica, Arial, sans-serif;
                                                                                font-weight: 400;
                                                                                font-size: 16px;
                                                                                line-height: 21px;
                                                                                font-weight: 600;
                                                                                color: rgb(35, 35, 62);
                                                                            ">
                                                                            Address for meeting
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td align="left" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                                                        <div class="text textColorNormal mt1" style="
                                                                                margin-top: 6px;
                                                                                font-family: GT America Regular, Roboto,Helvetica, Arial, sans-serif;
                                                                                font-weight: 400;
                                                                                font-size: 16px;
                                                                                line-height: 21px;
                                                                                color: rgb(79, 79, 101);
                                                                            ">
                                                                            <span>'.$rowWellnessCompany['visiting_address'].' '.$rowWellnessCompany['d_port_number'].'</span>
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </td>
                                                </tr>
                                                <tr class="spacer">
                                                    <td height="12px" colspan="2" style="
                                                            font-size: 12px;
                                                            line-height: 12px;
                                                            -webkit-text-size-adjust: 100%;
                                                            -ms-text-size-adjust: 100%;
                                                            mso-table-lspace: 0pt;
                                                            mso-table-rspace: 0pt;
                                                            border-collapse: collapse;
                                                            display: table-cell;
                                                        ">
                                                        &nbsp;
                                                    </td>
                                                </tr>
                                                <tr class="spacer">
                                                    <td height="12px" colspan="2" style="
                                                            font-size: 12px;
                                                            line-height: 12px;
                                                            -webkit-text-size-adjust: 100%;
                                                            -ms-text-size-adjust: 100%;
                                                            mso-table-lspace: 0pt;
                                                            mso-table-rspace: 0pt;
                                                            border-collapse: collapse;
                                                            display: table-cell;
                                                        ">
                                                        &nbsp;
                                                    </td>
                                                </tr>
                                                <!-- QUESTIONS -->
                                            </tbody>
                                        </table>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </td>
                </tr>
                <!-- FOOTER -->
                <tr>
                    <td align="center" class="Content" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell; width: 580px; margin: 0 auto;">
                        <!-- Will most likely required a feature flag -->
                        <!--[if (gte mso 9)|(IE)]>
<table align="center" border="0" cellspacing="0" cellpadding="0" width="600">
<tr>
<td align="center" valign="top" width="600">
<![endif]-->
                        <table width="100%" border="0" cellspacing="0" cellpadding="0" align="center" class="Content-container" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; padding-left: 60px; padding-right: 60px;">
                            <tbody>
                                <tr class="spacer">
                                    <td height="12px" colspan="2" style="font-size: 12px; line-height: 12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        &nbsp;
                                    </td>
                                </tr>
                                <tr class="spacer">
                                    <td height="12px" colspan="2" style="font-size: 12px; line-height: 12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        &nbsp;
                                    </td>
                                </tr>
                                <tr class="spacer">
                                    <td height="12px" colspan="2" style="font-size: 12px; line-height: 12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        &nbsp;
                                    </td>
                                </tr>
                                <tr>
                                    <td align="center" valign="top" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        <a href="https://www.exploretock.com" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%;">
                                            <img src="https://storage.googleapis.com/tock-public-assets/images-email-template/tock-brandmark-color.png" width="30" height="30" alt="Tock" border="0" style="-ms-interpolation-mode: bicubic; border: 0; height: auto; line-height: 100%; outline: none; text-decoration: none; display: block;">
                                        </a>
                                    </td>
                                </tr>
                                <tr class="spacer">
                                    <td height="18px" colspan="2" style="font-size: 18px; line-height: 18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        &nbsp;
                                    </td>
                                </tr>
                                <tr>
                                    <td align="center" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        <div class="text-xsmall textColorNormal" style="font-family: GT America Regular, Roboto,Helvetica, Arial, sans-serif; font-size: 11px; text-transform: uppercase; line-height: 22px; letter-spacing: 1px; color: rgb(79, 79, 101);">
                                            © 2019 Tock, Inc.
                                        </div>
                                        <div class="text-xsmall textColorNormal" style="font-family: GT America Regular, Roboto,Helvetica, Arial, sans-serif; font-size: 11px; text-transform: uppercase; line-height: 22px; letter-spacing: 1px; color: rgb(79, 79, 101);">
                                            All Rights Reserved
                                        </div>
                                    </td>
                                </tr>
                                <tr class="spacer">
                                    <td height="12px" colspan="2" style="font-size: 12px; line-height: 12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        &nbsp;
                                    </td>
                                </tr>
                                <tr class="spacer">
                                    <td height="12px" colspan="2" style="font-size: 12px; line-height: 12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        &nbsp;
                                    </td>
                                </tr>
                                <tr class="spacer">
                                    <td height="12px" colspan="2" style="font-size: 12px; line-height: 12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        &nbsp;
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <!--[if (gte mso 9)|(IE)]>
</td>
</tr>
</table>
<![endif]-->
                    </td>
                </tr>
            </tbody>
        </table>
    
</body></html>';	
				try {
					 sendEmail($subject, $to, $emailContent);
					}

					 
					catch(Exception $e) {
					   
					}
			}
			
			}
			else
			{
				$to      = $rowRoomservice['email'];
				$subject = "Booking Confirmed";
				$emailContent ='<html><head>
        <title>Reservation confirmed</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <style type="text/css">
            /* GT AMERICA */

            @font-face {
                font-display: fallback;
                font-family: "GT America Regular";
                font-weight: 400;
                src: url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Regular.woff2") format("woff2"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Regular.woff") format("woff"),
                    url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Regular.ttf") format("truetype");
            }

            @font-face {
                font-display: fallback;
                font-family: "GT America Medium";
                font-weight: 600;
                src: url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Medium.woff2") format("woff2"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Medium.woff") format("woff"),
                    url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Medium.ttf") format("truetype");
            }

            @font-face {
                font-display: fallback;
                font-family: "GT America Condensed Bold";
                font-weight: 700;
                src: url("https://www.exploretock.com/fonts/gt-america/GT-America-Condensed-Bold.woff2") format("woff2"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Condensed-Bold.woff") format("woff"),
                    url("https://www.exploretock.com/fonts/gt-america/GT-America-Condensed-Bold.ttf") format("truetype");
            }

            /* CLIENT-SPECIFIC RESET */

            body,
            table,
            td,
            a {
                -webkit-text-size-adjust: 100%;
                -ms-text-size-adjust: 100%;
            }

            /* Prevent WebKit and Windows mobile changing default text sizes */

            table,
            td {
                mso-table-lspace: 0pt;
                mso-table-rspace: 0pt;
            }

            /* Remove spacing between tables in Outlook 2007 and up */

            img {
                -ms-interpolation-mode: bicubic;
            }

            /* Allow smoother rendering of resized image in Internet Explorer */

            .im {
                color: inherit !important;
            }

            /* DEVICE-SPECIFIC RESET */

            a[x-apple-data-detectors] {
                color: inherit !important;
                text-decoration: none !important;
                font-size: inherit !important;
                font-family: inherit !important;
                font-weight: inherit !important;
                line-height: inherit !important;
            }

            /* iOS BLUE LINKS */

            /* RESET */

            img {
                border: 0;
                height: auto;
                line-height: 100%;
                outline: none;
                text-decoration: none;
                display: block;
            }

            table {
                border-collapse: collapse;
            }

            table td {
                border-collapse: collapse;
                display: table-cell;
            }

            body {
                height: 100% !important;
                margin: 0 !important;
                padding: 0 !important;
                width: 100% !important;
            }

            /* BG COLORS */

            .mainTable {
                background-color: #f0f0f0;
            }

            .mainTable--hospitality {
                background-color: #f7f2ed;
            }

            html {
                background-color: #f0f0f0;
            }

            /* VARIABLES */

            .bg-white {
                background-color: white;
            }

            .hr {
                /* Cross-client horizontal rule. Adapted from https://litmus.com/community/discussions/4633-is-there-a-reliable-1px-horizontal-rule-method */
                background-color: #d3d3d8;
                border-collapse: collapse;
                mso-table-lspace: 0pt;
                mso-table-rspace: 0pt;
                mso-line-height-rule: exactly;
                line-height: 1px;
            }

            .textAlignLeft {
                text-align: left !important;
            }

            .textAlignRight {
                text-align: right !important;
            }

            .textAlignCenter {
                text-align: center !important;
            }

            .mt1 {
                margin-top: 6px;
            }

            .list {
                padding-left: 18px;
                margin: 0;
            }

            /* TYPOGRAPHY */

            body {
                font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
                font-weight: 400;
                color: #4f4f65;
                -webkit-font-smoothing: antialiased;
                -ms-text-size-adjust: 100%;
                -moz-osx-font-smoothing: grayscale;
                font-smoothing: always;
                text-rendering: optimizeLegibility;
            }

            .h1 {
                font-family: "GT America Condensed Bold", "Roboto Condensed", "Roboto", "Helvetica", "Arial", sans-serif;
                font-weight: 700;
                vertical-align: middle;
                font-size: 36px;
                line-height: 42px;
            }

            .h2 {
                font-family: "GT America Medium", "Roboto", "Helvetica", "Arial", sans-serif;
                font-weight: 600;
                vertical-align: middle;
                font-size: 16px;
                line-height: 24px;
            }

            .text {
                font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
                font-weight: 400;
                font-size: 16px;
                line-height: 21px;
            }

            .text-list {
                font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
                font-weight: 400;
                font-size: 16px;
                line-height: 25px;
            }

            .textSmall {
                font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
                font-weight: 400;
                font-size: 14px;
            }

            .text-xsmall {
                font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
                font-size: 11px;
                text-transform: uppercase;
                line-height: 22px;
                letter-spacing: 1px;
            }

            .text-bold {
                font-weight: 600;
            }

            .text-link {
                text-decoration: underline;
            }

            .text-linkNoUnderline {
                text-decoration: none;
            }

            .text-strike {
                text-decoration: line-through;
            }

            /* FONT COLORS */

            .textColorDark {
                color: #23233e;
            }

            .textColorNormal {
                color: #4f4f65;
            }

            .textColorBlue {
                color: #2020c0;
            }

            .textColorGrayDark {
                color: #7b7b8b;
            }

            .textColorGray {
                color: #a5a8ad;
            }

            .textColorWhite {
                color: #ffffff;
            }

            .textColorRed {
                color: #df3232;
            }

            /* BUTTON */

            .Button-primary-wrapper {
                border-radius: 3px;
                background-color: #2020c0;
            }

            .Button-primary {
                font-family: "GT America Medium", "Roboto", "Helvetica", "Arial", sans-serif;
                border-radius: 3px;
                border: 1px solid #2020c0;
                color: #ffffff;
                display: block;
                font-size: 16px;
                font-weight: 600;
                padding: 18px;
                text-decoration: none;
            }

            .Button-secondary-wrapper {
                border-radius: 3px;
                background-color: #ffffff;
            }

            .Button-secondary {
                font-family: "GT America Medium", "Roboto", "Helvetica", "Arial", sans-serif;
                border-radius: 3px;
                border: 1px solid #2020c0;
                color: #2020c0;
                display: block;
                font-size: 16px;
                font-weight: 600;
                padding: 18px;
                text-decoration: none;
            }

            /* LAYOUT */

            .Content-container {
                padding-left: 60px;
                padding-right: 60px;
            }

            .Content-container--main {
                padding-top: 54px;
                padding-bottom: 60px;
            }

            .Content {
                width: 580px;
                margin: 0 auto;
            }

            .wrapper {
                max-width: 600px;
            }

            .section {
                padding: 24px 0px;
                border-bottom: 1px solid #d3d3d8;
            }

            .section--noBorder {
                padding: 24px 0px 0;
            }

            .section--last {
                padding: 24px 0px;
            }

            .message {
                background-color: #f4f4f5;
                padding: 18px;
            }

            .card {
                border: 1px solid #d3d3d8;
                padding: 18px;
            }

            /* HEADER */

            .header-tockLogoImage {
                display: block;
                color: #f0f0f0;
            }

            .header-heroImage {
                padding-bottom: 24px;
            }

            /* PREHEADER */

            .preheader {
                display: none;
                font-size: 1px;
                color: #ffffff;
                line-height: 1px;
                max-height: 0px;
                max-width: 0px;
                opacity: 0;
                overflow: hidden;
            }

            /* BANNER */

            .notice {
                padding: 12px;
                background: #23233e;
                color: #ffffff;
                display: block;
                font-size: 14px;
                font-family: "GT America Medium", "Roboto", "Helvetica", "Arial", sans-serif;
                font-weight: 600;
            }

            /* INTRO */

            .section--intro {
                padding-bottom: 48px;
            }

            /* BOOKING INFO */

            .business-logo__container {
                width: 48px;
                height: 48px;
                border-radius: 3px;
                border: 1px solid #d3d3d8;
                overflow: hidden;
            }

            .business-logo__image {
                border: 1px solid transparent;
                border-radius: 3px;
                width: 48px;
                height: 48px;
                display: block;
            }

            .business-address--address {
                width: 50%;
            }

            .business-address--map {
                width: 50%;
            }

            .business-address--map-image {
                width: 100%;
            }

            /* MOBILE TICKETS */

            .mobile-ticket--description {
                width: 65%;
                margin-top: 12px;
                margin-right: 5%;
            }

            .mobile-ticket--code {
                width: 30%;
            }

            .mobile-ticket--code-image {
                width: 100%;
            }

            /* RESERVATION ACTIONS */

            .linksTable {
                border-bottom: 1px solid #d3d3d8;
            }

            .linksTableRow {
                padding: 24px 12px;
            }

            .actions-icon {
                vertical-align: middle;
            }

            .actions-text {
                vertical-align: middle;
            }

            /* RECEIPT */

            .receipt__container {
                border: 1px solid #d3d3d8;
                padding: 24px;
            }

            .receipt__row {
                border-top: 1px solid #d3d3d8;
            }

            /* FEEDBACK ICONS */

            .feedback-link {
                border: 1px solid #d4d5da;
                border-radius: 3px;
                display: inline-block;
                width: calc(32% - 2px);
                padding: 10px 0;
            }

            .feedback-link-bumper {
                display: inline-block;
                width: 1%;
            }

            .feedback-link img {
                height: 50px;
                width: 50px;
            }

            /* SOCIAL ICONS */

            .social-link {
                display: inline-block;
                width: auto;
            }

            .social-link-text {
                padding: 14px 24px 14px 14px;
            }

            /* TABLET STYLES */

            @media screen and (max-width: 648px) {
                /* DEVICE-SPECIFIC RESET */
                div[style*="margin: 16px 0;"] {
                    margin: 0 !important;
                }
                /* ANDROID CENTER FIX */
                /* LAYOUT */
                .wrapper {
                    width: 100% !important;
                    max-width: 100% !important;
                }
                .Content {
                    width: 90% !important;
                }
                .Content-container {
                    padding-left: 36px !important;
                    padding-right: 36px !important;
                }
                .Content-container--main {
                    padding-top: 30px !important;
                    padding-bottom: 42px !important;
                }
                .responsiveTable {
                    width: 100% !important;
                }
                /* RESERVATION ACTIONS */
                .linksTableRow {
                    padding-left: 0 !important;
                    padding-right: 0 !important;
                    padding-top: 12px !important;
                    padding-bottom: 12px !important;
                }
                .linksTableRow--borderRight {
                    border-right: none !important;
                    padding-left: 0 !important;
                    padding-right: 0 !important;
                }
                /* FEEDBACK LINK */
                .feedback-link img {
                    height: 38px !important;
                    width: 38px !important;
                }
            }

            /* MOBILE STYLES */

            @media screen and (max-width: 480px) {
                /* TYPOGRAPHY */
                .h1 {
                    font-size: 30px !important;
                    line-height: 30px !important;
                }
                .text {
                    font-size: 16px !important;
                    line-height: 22px !important;
                }
                /* BUTTON */
                .mobile-buttonContainer {
                    width: 100% !important;
                }
                /* LAYOUT */
                .Content {
                    width: 100% !important;
                }
                .Content-container {
                    padding-left: 18px !important;
                    padding-right: 18px !important;
                }
                .Content-container--main {
                    padding-top: 24px !important;
                    padding-bottom: 30px !important;
                }
                .section {
                    padding: 18px 0 !important;
                }
                .section--last {
                    padding: 18px 0 !important;
                }
                .header {
                    padding: 0 18px !important;
                }
                .business-address--address {
                    width: 100% !important;
                }
                .business-address--map {
                    margin-top: 30px !important;
                    width: 100% !important;
                }
                .mobile-ticket--description {
                    width: 100% !important;
                    margin-top: 0px !important;
                }
                .mobile-ticket--code {
                    margin-top: 30px !important;
                    margin-left: 0;
                    width: 100% !important;
                }
                /* RECEIPT */
                .receipt__container {
                    padding: 12px !important;
                }
                /* SOCIAL ICONS */
                .social-link {
                    display: block !important;
                    width: 100% !important;
                    border-bottom: 1px solid #d3d3d8 !important;
                }
                /* INTRO */
                .section--intro {
                    padding-top: 18px !important;
                    padding-bottom: 18px !important;
                }
            }
        </style>

        <!--[if mso]>
            <style type="text/css">
                .h1 {
                    font-family: "Helvetica", "Arial", sans-serif !important;
                    font-weight: 700 !important;
                    vertical-align: middle !important;
                    font-size: 36px !important;
                    mso-line-height-rule: exactly;
                    line-height: 42px !important;
                }
                .h2 {
                    font-family: "Helvetica", "Arial", sans-serif !important;
                    font-weight: 600 !important;
                    vertical-align: middle !important;
                    font-size: 16px !important;
                    mso-line-height-rule: exactly;
                    line-height: 24px !important;
                }
                .text {
                    font-family: "Helvetica", "Arial", sans-serif !important;
                    font-weight: 400 !important;
                    font-size: 16px !important;
                    mso-line-height-rule: exactly;
                    line-height: 21px !important;
                }
                .text-list {
                    font-family: "Helvetica", "Arial", sans-serif !important;
                    font-weight: 400 !important;
                    font-size: 16px !important;
                    mso-line-height-rule: exactly;
                    line-height: 25px !important;
                }
                .textSmall {
                    font-family: "Helvetica", "Arial", sans-serif !important;
                    font-weight: 400 !important;
                    font-size: 14px !important;
                }
                .text-xsmall {
                    font-family: "Helvetica", "Arial", sans-serif !important;
                    font-size: 11px !important;
                    text-transform: uppercase !important;
                    mso-line-height-rule: exactly;
                    line-height: 22px !important;
                    letter-spacing: 1px !important;
                }
                .text-bold {
                    font-weight: 600 !important;
                }
                .text-link {
                    text-decoration: underline !important;
                }
                .text-linkNoUnderline {
                    text-decoration: none !important;
                }
                .text-strike {
                    text-decoration: line-through !important;
                }
                .textColorDark {
                    color: #23233e !important;
                }
                .textColorNormal {
                    color: #4f4f65 !important;
                }
                .textColorBlue {
                    color: #2020c0 !important;
                }
                .textColorGray {
                    color: #a5a8ad !important;
                }
                .textColorWhite {
                    color: #ffffff !important;
                }
                .Button-primary {
                    font-family: "Helvetica", "Arial", sans-serif !important;
                    border-radius: 3px !important;
                    border: 1px solid #2020c0 !important;
                    color: #ffffff !important;
                    display: block !important;
                    font-size: 16px !important;
                    font-weight: 600 !important;
                    padding: 18px !important;
                    text-decoration: none !important;
                }
                .Button-secondary {
                    font-family: "Helvetica", "Arial", sans-serif !important;
                    border-radius: 3px !important;
                    border: 1px solid #2020c0 !important;
                    color: #2020c0 !important;
                    display: block !important;
                    font-size: 16px !important;
                    font-weight: 600 !important;
                    padding: 18px !important;
                    text-decoration: none !important;
                }
            </style>
        <![endif]-->
        <!-- HIDDEN PREHEADER TEXT -->
    </head>
    <body>
        <div class="preheader" style="display: none; font-size: 1px; color: rgb(255, 255, 255); line-height: 1px; max-height: 0px; max-width: 0px; opacity: 0; overflow: hidden;"></div>
        <table border="0" cellpadding="0" cellspacing="0" width="100%" class="mainTable" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; background-color: rgb(240, 240, 240);">
            <tbody>
                <tr>
                    <td style="
                            display: none !important;
                            visibility: hidden;
                            mso-hide: all;
                            font-size: 1px;
                            color: #ffffff;
                            line-height: 1px;
                            max-height: 0px;
                            max-width: 0px;
                            opacity: 0;
                            overflow: hidden;
                            -webkit-text-size-adjust: 100%;
                            -ms-text-size-adjust: 100%;
                            mso-table-lspace: 0pt;
                            mso-table-rspace: 0pt;
                            border-collapse: collapse;
                            display: table-cell;
                        ">
                        We are thrilled that you will be joining us. If yo...
                    </td>
                    <!-- HEADER -->
                </tr>
                <tr>
                    <td align="center" class="header" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                        <!--[if (gte mso 9)|(IE)]>
    <table align="center" border="0" cellspacing="0" cellpadding="0" width="600">
    <tr>
    <td align="center" valign="top" width="600">
    <![endif]-->
                        <table border="0" cellpadding="0" cellspacing="0" width="100%" class="Content" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; width: 580px; margin: 0 auto;">
                            <tbody>
                                <tr class="spacer">
                                    <td height="12px" colspan="2" style="font-size: 12px; line-height: 12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        &nbsp;
                                    </td>
                                </tr>
                                <tr class="spacer">
                                    <td height="12px" colspan="2" style="font-size: 12px; line-height: 12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        &nbsp;
                                    </td>
                                </tr>
                                <tr>
                                    <td align="left" valign="middle" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        <h1 style="font-size: 33px; font-weight: 800; line-height: 30px;">Dstricts</h1>
                                    </td>
                                </tr>
                                <tr class="spacer">
                                    <td height="12px" colspan="2" style="font-size: 12px; line-height: 12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        &nbsp;
                                    </td>
                                </tr>
                                <tr class="spacer">
                                    <td height="12px" colspan="2" style="font-size: 12px; line-height: 12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        &nbsp;
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <!--[if (gte mso 9)|(IE)]>
    </td>
    </tr>
    </table>
    <![endif]-->
                    </td>
                </tr>
                <!-- CONTENT -->
                <tr>
                    <td align="center" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                        <!--[if (gte mso 9)|(IE)]>
    <table align="center" border="0" cellspacing="0" cellpadding="0" width="600">
    <tr>
    <td align="center" valign="top" width="600">
    <![endif]-->
                        <table border="0" cellpadding="0" cellspacing="0" width="100%" class="Content bg-white" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; background-color: white; width: 580px; margin: 0 auto;">
                            <tbody>
                                <tr>
                                    <td class="Content-container Content-container--main text textColorNormal" style="
                                            -webkit-text-size-adjust: 100%;
                                            -ms-text-size-adjust: 100%;
                                            mso-table-lspace: 0pt;
                                            mso-table-rspace: 0pt;
                                            border-collapse: collapse;
                                            display: table-cell;
                                            font-family: GT America Regular, Roboto, Helvetica, Arial, sans-serif;
                                            font-weight: 400;
                                            font-size: 16px;
                                            line-height: 21px;
                                            color: rgb(79, 79, 101);
                                            padding-left: 60px;
                                            padding-right: 60px;
                                            padding-top: 54px;
                                            padding-bottom: 60px;
                                        ">
                                        <table width="100%" border="0" cellspacing="0" cellpadding="0" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
                                            <!-- RESTAURANT INFO -->
                                            <tbody>
                                                <tr>
                                                    <td valign="top" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                                        <table align="left" border="0" cellpadding="0" cellspacing="0" width="100%" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
                                                            <tbody>
                                                                <tr>
                                                                    <td width="12" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                                                        &nbsp;
                                                                    </td>
                                                                    <td align="left" valign="middle" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                                                        <span class="h2 textColorDark" style="
                                                                                font-family: GT America Medium, Roboto, Helvetica, Arial, sans-serif;
                                                                                font-weight: 600;
                                                                                vertical-align: middle;
                                                                                font-size: 16px;
                                                                                line-height: 24px;
                                                                                color: rgb(35, 35, 62);
                                                                            ">
                                                                            '.htmlentities($rowRoomservice['first_name'],ENT_NOQUOTES, 'ISO-8859-1').'
                                                                        </span>
                                                                    </td>
                                                                </tr>
                                                                <tr class="spacer">
                                                                    <td height="12px" colspan="2" style="
                                                                            font-size: 12px;
                                                                            line-height: 12px;
                                                                            -webkit-text-size-adjust: 100%;
                                                                            -ms-text-size-adjust: 100%;
                                                                            mso-table-lspace: 0pt;
                                                                            mso-table-rspace: 0pt;
                                                                            border-collapse: collapse;
                                                                            display: table-cell;
                                                                        ">
                                                                        &nbsp;
                                                                    </td>
                                                                </tr>
                                                                <tr class="spacer">
                                                                    <td height="12px" colspan="2" style="
                                                                            font-size: 12px;
                                                                            line-height: 12px;
                                                                            -webkit-text-size-adjust: 100%;
                                                                            -ms-text-size-adjust: 100%;
                                                                            mso-table-lspace: 0pt;
                                                                            mso-table-rspace: 0pt;
                                                                            border-collapse: collapse;
                                                                            display: table-cell;
                                                                        ">
                                                                        &nbsp;
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </td>
                                                </tr>
                                                <!-- INTRO -->
                                                <tr>
                                                    <td valign="top" align="left" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                                        <table width="100%" border="0" cellspacing="0" cellpadding="0" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
                                                            <tbody>
                                                                <tr>
                                                                    <td align="left" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                                                        <span class="h1 textColorDark" style="
                                                                                font-family: GT America Condensed Bold, Roboto Condensed, Roboto, Helvetica, Arial, sans-serif;
                                                                                font-weight: 700;
                                                                                vertical-align: middle;
                                                                                font-size: 36px;
                                                                                line-height: 42px;
                                                                                color: rgb(35, 35, 62);
                                                                            ">
                                                                            Your booking have been confirmed at '.$rowWellnessCompany['company_name'].'
                                                                        </span>
                                                                    </td>
                                                                </tr>
                                                                
                                                                
                                                                
                                                            </tbody>
                                                        </table>
                                                    </td>
                                                </tr>
                                                <!-- MESSAGE -->

                                                <!-- BOOKING INFO -->
                                                
                                                <!-- ADDRESS -->
                                                <tr>
                                                    <td align="center" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                                        <table border="0" cellpadding="0" cellspacing="0" width="100%" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
                                                            <tbody>
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                            </tbody>
                                                        </table>
                                                    </td>
                                                </tr>
                                                <tr class="spacer">
                                                    <td height="18px" colspan="2" style="
                                                            font-size: 18px;
                                                            line-height: 18px;
                                                            -webkit-text-size-adjust: 100%;
                                                            -ms-text-size-adjust: 100%;
                                                            mso-table-lspace: 0pt;
                                                            mso-table-rspace: 0pt;
                                                            border-collapse: collapse;
                                                            display: table-cell;
                                                        ">
                                                        &nbsp;
                                                    </td>
                                                </tr>
                                                <tr class="spacer">
                                                    <td height="18px" colspan="2" style="
                                                            font-size: 18px;
                                                            line-height: 18px;
                                                            -webkit-text-size-adjust: 100%;
                                                            -ms-text-size-adjust: 100%;
                                                            mso-table-lspace: 0pt;
                                                            mso-table-rspace: 0pt;
                                                            border-collapse: collapse;
                                                            display: table-cell;
                                                        ">
                                                        &nbsp;
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td align="left" colspan="2" valign="top" width="100%" height="1" class="hr" style="
                                                            -webkit-text-size-adjust: 100%;
                                                            -ms-text-size-adjust: 100%;
                                                            mso-table-lspace: 0pt;
                                                            mso-table-rspace: 0pt;
                                                            border-collapse: collapse;
                                                            display: table-cell;
                                                            background-color: rgb(211, 211, 216);
                                                            border-collapse: collapse;
                                                            mso-table-lspace: 0pt;
                                                            mso-table-rspace: 0pt;
                                                            mso-line-height-rule: exactly;
                                                            line-height: 1px;
                                                        ">
                                                        <!--[if gte mso 15]>&nbsp;<![endif]-->
                                                    </td>
                                                </tr>

                                                <!-- RECEIPT -->

                                                <tr class="spacer">
                                                    <td height="18px" colspan="2" style="
                                                            font-size: 18px;
                                                            line-height: 18px;
                                                            -webkit-text-size-adjust: 100%;
                                                            -ms-text-size-adjust: 100%;
                                                            mso-table-lspace: 0pt;
                                                            mso-table-rspace: 0pt;
                                                            border-collapse: collapse;
                                                            display: table-cell;
                                                        ">
                                                        &nbsp;
                                                    </td>
                                                </tr>
                                                <!-- EDIT RECEIPT -->
                                                <!-- CANCELLATION POLICY -->
                                                <tr>
                                                    <td valign="top" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                                        <table border="0" cellpadding="0" cellspacing="0" width="100%" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
                                                            <tbody>
                                                                <tr>
                                                                    <td align="left" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                                                        <div class="text text-bold textColorDark" style="
                                                                                font-family: GT America Regular, Roboto, Helvetica, Arial, sans-serif;
                                                                                font-weight: 400;
                                                                                font-size: 16px;
                                                                                line-height: 21px;
                                                                                font-weight: 600;
                                                                                color: rgb(35, 35, 62);
                                                                            ">
                                                                            Address for meeting
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td align="left" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                                                        <div class="text textColorNormal mt1" style="
                                                                                margin-top: 6px;
                                                                                font-family: GT America Regular, Roboto,Helvetica, Arial, sans-serif;
                                                                                font-weight: 400;
                                                                                font-size: 16px;
                                                                                line-height: 21px;
                                                                                color: rgb(79, 79, 101);
                                                                            ">
                                                                            <span>'.$rowWellnessCompany['visiting_address'].' '.$rowWellnessCompany['d_port_number'].'</span>
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </td>
                                                </tr>
                                                <tr class="spacer">
                                                    <td height="12px" colspan="2" style="
                                                            font-size: 12px;
                                                            line-height: 12px;
                                                            -webkit-text-size-adjust: 100%;
                                                            -ms-text-size-adjust: 100%;
                                                            mso-table-lspace: 0pt;
                                                            mso-table-rspace: 0pt;
                                                            border-collapse: collapse;
                                                            display: table-cell;
                                                        ">
                                                        &nbsp;
                                                    </td>
                                                </tr>
                                                <tr class="spacer">
                                                    <td height="12px" colspan="2" style="
                                                            font-size: 12px;
                                                            line-height: 12px;
                                                            -webkit-text-size-adjust: 100%;
                                                            -ms-text-size-adjust: 100%;
                                                            mso-table-lspace: 0pt;
                                                            mso-table-rspace: 0pt;
                                                            border-collapse: collapse;
                                                            display: table-cell;
                                                        ">
                                                        &nbsp;
                                                    </td>
                                                </tr>
                                                <!-- QUESTIONS -->
                                            </tbody>
                                        </table>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </td>
                </tr>
                <!-- FOOTER -->
                <tr>
                    <td align="center" class="Content" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell; width: 580px; margin: 0 auto;">
                        <!-- Will most likely required a feature flag -->
                        <!--[if (gte mso 9)|(IE)]>
<table align="center" border="0" cellspacing="0" cellpadding="0" width="600">
<tr>
<td align="center" valign="top" width="600">
<![endif]-->
                        <table width="100%" border="0" cellspacing="0" cellpadding="0" align="center" class="Content-container" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; padding-left: 60px; padding-right: 60px;">
                            <tbody>
                                <tr class="spacer">
                                    <td height="12px" colspan="2" style="font-size: 12px; line-height: 12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        &nbsp;
                                    </td>
                                </tr>
                                <tr class="spacer">
                                    <td height="12px" colspan="2" style="font-size: 12px; line-height: 12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        &nbsp;
                                    </td>
                                </tr>
                                <tr class="spacer">
                                    <td height="12px" colspan="2" style="font-size: 12px; line-height: 12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        &nbsp;
                                    </td>
                                </tr>
                                <tr>
                                    <td align="center" valign="top" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        <a href="https://www.exploretock.com" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%;">
                                            <img src="https://storage.googleapis.com/tock-public-assets/images-email-template/tock-brandmark-color.png" width="30" height="30" alt="Tock" border="0" style="-ms-interpolation-mode: bicubic; border: 0; height: auto; line-height: 100%; outline: none; text-decoration: none; display: block;">
                                        </a>
                                    </td>
                                </tr>
                                <tr class="spacer">
                                    <td height="18px" colspan="2" style="font-size: 18px; line-height: 18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        &nbsp;
                                    </td>
                                </tr>
                                <tr>
                                    <td align="center" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        <div class="text-xsmall textColorNormal" style="font-family: GT America Regular, Roboto,Helvetica, Arial, sans-serif; font-size: 11px; text-transform: uppercase; line-height: 22px; letter-spacing: 1px; color: rgb(79, 79, 101);">
                                            © 2019 Tock, Inc.
                                        </div>
                                        <div class="text-xsmall textColorNormal" style="font-family: GT America Regular, Roboto,Helvetica, Arial, sans-serif; font-size: 11px; text-transform: uppercase; line-height: 22px; letter-spacing: 1px; color: rgb(79, 79, 101);">
                                            All Rights Reserved
                                        </div>
                                    </td>
                                </tr>
                                <tr class="spacer">
                                    <td height="12px" colspan="2" style="font-size: 12px; line-height: 12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        &nbsp;
                                    </td>
                                </tr>
                                <tr class="spacer">
                                    <td height="12px" colspan="2" style="font-size: 12px; line-height: 12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        &nbsp;
                                    </td>
                                </tr>
                                <tr class="spacer">
                                    <td height="12px" colspan="2" style="font-size: 12px; line-height: 12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        &nbsp;
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <!--[if (gte mso 9)|(IE)]>
</td>
</tr>
</table>
<![endif]-->
                    </td>
                </tr>
            </tbody>
        </table>
    
</body></html>';	
				try {
					 sendEmail($subject, $to, $emailContent);
					}

					 
					catch(Exception $e) {
					   
					}
			}
			
			}
			else
			{
				$to      = $rowRoomservice['email'];
				$subject = "Booking Confirmed";
				$emailContent ='<html><head>
        <title>Reservation confirmed</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <style type="text/css">
            /* GT AMERICA */

            @font-face {
                font-display: fallback;
                font-family: "GT America Regular";
                font-weight: 400;
                src: url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Regular.woff2") format("woff2"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Regular.woff") format("woff"),
                    url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Regular.ttf") format("truetype");
            }

            @font-face {
                font-display: fallback;
                font-family: "GT America Medium";
                font-weight: 600;
                src: url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Medium.woff2") format("woff2"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Medium.woff") format("woff"),
                    url("https://www.exploretock.com/fonts/gt-america/GT-America-Standard-Medium.ttf") format("truetype");
            }

            @font-face {
                font-display: fallback;
                font-family: "GT America Condensed Bold";
                font-weight: 700;
                src: url("https://www.exploretock.com/fonts/gt-america/GT-America-Condensed-Bold.woff2") format("woff2"), url("https://www.exploretock.com/fonts/gt-america/GT-America-Condensed-Bold.woff") format("woff"),
                    url("https://www.exploretock.com/fonts/gt-america/GT-America-Condensed-Bold.ttf") format("truetype");
            }

            /* CLIENT-SPECIFIC RESET */

            body,
            table,
            td,
            a {
                -webkit-text-size-adjust: 100%;
                -ms-text-size-adjust: 100%;
            }

            /* Prevent WebKit and Windows mobile changing default text sizes */

            table,
            td {
                mso-table-lspace: 0pt;
                mso-table-rspace: 0pt;
            }

            /* Remove spacing between tables in Outlook 2007 and up */

            img {
                -ms-interpolation-mode: bicubic;
            }

            /* Allow smoother rendering of resized image in Internet Explorer */

            .im {
                color: inherit !important;
            }

            /* DEVICE-SPECIFIC RESET */

            a[x-apple-data-detectors] {
                color: inherit !important;
                text-decoration: none !important;
                font-size: inherit !important;
                font-family: inherit !important;
                font-weight: inherit !important;
                line-height: inherit !important;
            }

            /* iOS BLUE LINKS */

            /* RESET */

            img {
                border: 0;
                height: auto;
                line-height: 100%;
                outline: none;
                text-decoration: none;
                display: block;
            }

            table {
                border-collapse: collapse;
            }

            table td {
                border-collapse: collapse;
                display: table-cell;
            }

            body {
                height: 100% !important;
                margin: 0 !important;
                padding: 0 !important;
                width: 100% !important;
            }

            /* BG COLORS */

            .mainTable {
                background-color: #f0f0f0;
            }

            .mainTable--hospitality {
                background-color: #f7f2ed;
            }

            html {
                background-color: #f0f0f0;
            }

            /* VARIABLES */

            .bg-white {
                background-color: white;
            }

            .hr {
                /* Cross-client horizontal rule. Adapted from https://litmus.com/community/discussions/4633-is-there-a-reliable-1px-horizontal-rule-method */
                background-color: #d3d3d8;
                border-collapse: collapse;
                mso-table-lspace: 0pt;
                mso-table-rspace: 0pt;
                mso-line-height-rule: exactly;
                line-height: 1px;
            }

            .textAlignLeft {
                text-align: left !important;
            }

            .textAlignRight {
                text-align: right !important;
            }

            .textAlignCenter {
                text-align: center !important;
            }

            .mt1 {
                margin-top: 6px;
            }

            .list {
                padding-left: 18px;
                margin: 0;
            }

            /* TYPOGRAPHY */

            body {
                font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
                font-weight: 400;
                color: #4f4f65;
                -webkit-font-smoothing: antialiased;
                -ms-text-size-adjust: 100%;
                -moz-osx-font-smoothing: grayscale;
                font-smoothing: always;
                text-rendering: optimizeLegibility;
            }

            .h1 {
                font-family: "GT America Condensed Bold", "Roboto Condensed", "Roboto", "Helvetica", "Arial", sans-serif;
                font-weight: 700;
                vertical-align: middle;
                font-size: 36px;
                line-height: 42px;
            }

            .h2 {
                font-family: "GT America Medium", "Roboto", "Helvetica", "Arial", sans-serif;
                font-weight: 600;
                vertical-align: middle;
                font-size: 16px;
                line-height: 24px;
            }

            .text {
                font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
                font-weight: 400;
                font-size: 16px;
                line-height: 21px;
            }

            .text-list {
                font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
                font-weight: 400;
                font-size: 16px;
                line-height: 25px;
            }

            .textSmall {
                font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
                font-weight: 400;
                font-size: 14px;
            }

            .text-xsmall {
                font-family: "GT America Regular", "Roboto", "Helvetica", "Arial", sans-serif;
                font-size: 11px;
                text-transform: uppercase;
                line-height: 22px;
                letter-spacing: 1px;
            }

            .text-bold {
                font-weight: 600;
            }

            .text-link {
                text-decoration: underline;
            }

            .text-linkNoUnderline {
                text-decoration: none;
            }

            .text-strike {
                text-decoration: line-through;
            }

            /* FONT COLORS */

            .textColorDark {
                color: #23233e;
            }

            .textColorNormal {
                color: #4f4f65;
            }

            .textColorBlue {
                color: #2020c0;
            }

            .textColorGrayDark {
                color: #7b7b8b;
            }

            .textColorGray {
                color: #a5a8ad;
            }

            .textColorWhite {
                color: #ffffff;
            }

            .textColorRed {
                color: #df3232;
            }

            /* BUTTON */

            .Button-primary-wrapper {
                border-radius: 3px;
                background-color: #2020c0;
            }

            .Button-primary {
                font-family: "GT America Medium", "Roboto", "Helvetica", "Arial", sans-serif;
                border-radius: 3px;
                border: 1px solid #2020c0;
                color: #ffffff;
                display: block;
                font-size: 16px;
                font-weight: 600;
                padding: 18px;
                text-decoration: none;
            }

            .Button-secondary-wrapper {
                border-radius: 3px;
                background-color: #ffffff;
            }

            .Button-secondary {
                font-family: "GT America Medium", "Roboto", "Helvetica", "Arial", sans-serif;
                border-radius: 3px;
                border: 1px solid #2020c0;
                color: #2020c0;
                display: block;
                font-size: 16px;
                font-weight: 600;
                padding: 18px;
                text-decoration: none;
            }

            /* LAYOUT */

            .Content-container {
                padding-left: 60px;
                padding-right: 60px;
            }

            .Content-container--main {
                padding-top: 54px;
                padding-bottom: 60px;
            }

            .Content {
                width: 580px;
                margin: 0 auto;
            }

            .wrapper {
                max-width: 600px;
            }

            .section {
                padding: 24px 0px;
                border-bottom: 1px solid #d3d3d8;
            }

            .section--noBorder {
                padding: 24px 0px 0;
            }

            .section--last {
                padding: 24px 0px;
            }

            .message {
                background-color: #f4f4f5;
                padding: 18px;
            }

            .card {
                border: 1px solid #d3d3d8;
                padding: 18px;
            }

            /* HEADER */

            .header-tockLogoImage {
                display: block;
                color: #f0f0f0;
            }

            .header-heroImage {
                padding-bottom: 24px;
            }

            /* PREHEADER */

            .preheader {
                display: none;
                font-size: 1px;
                color: #ffffff;
                line-height: 1px;
                max-height: 0px;
                max-width: 0px;
                opacity: 0;
                overflow: hidden;
            }

            /* BANNER */

            .notice {
                padding: 12px;
                background: #23233e;
                color: #ffffff;
                display: block;
                font-size: 14px;
                font-family: "GT America Medium", "Roboto", "Helvetica", "Arial", sans-serif;
                font-weight: 600;
            }

            /* INTRO */

            .section--intro {
                padding-bottom: 48px;
            }

            /* BOOKING INFO */

            .business-logo__container {
                width: 48px;
                height: 48px;
                border-radius: 3px;
                border: 1px solid #d3d3d8;
                overflow: hidden;
            }

            .business-logo__image {
                border: 1px solid transparent;
                border-radius: 3px;
                width: 48px;
                height: 48px;
                display: block;
            }

            .business-address--address {
                width: 50%;
            }

            .business-address--map {
                width: 50%;
            }

            .business-address--map-image {
                width: 100%;
            }

            /* MOBILE TICKETS */

            .mobile-ticket--description {
                width: 65%;
                margin-top: 12px;
                margin-right: 5%;
            }

            .mobile-ticket--code {
                width: 30%;
            }

            .mobile-ticket--code-image {
                width: 100%;
            }

            /* RESERVATION ACTIONS */

            .linksTable {
                border-bottom: 1px solid #d3d3d8;
            }

            .linksTableRow {
                padding: 24px 12px;
            }

            .actions-icon {
                vertical-align: middle;
            }

            .actions-text {
                vertical-align: middle;
            }

            /* RECEIPT */

            .receipt__container {
                border: 1px solid #d3d3d8;
                padding: 24px;
            }

            .receipt__row {
                border-top: 1px solid #d3d3d8;
            }

            /* FEEDBACK ICONS */

            .feedback-link {
                border: 1px solid #d4d5da;
                border-radius: 3px;
                display: inline-block;
                width: calc(32% - 2px);
                padding: 10px 0;
            }

            .feedback-link-bumper {
                display: inline-block;
                width: 1%;
            }

            .feedback-link img {
                height: 50px;
                width: 50px;
            }

            /* SOCIAL ICONS */

            .social-link {
                display: inline-block;
                width: auto;
            }

            .social-link-text {
                padding: 14px 24px 14px 14px;
            }

            /* TABLET STYLES */

            @media screen and (max-width: 648px) {
                /* DEVICE-SPECIFIC RESET */
                div[style*="margin: 16px 0;"] {
                    margin: 0 !important;
                }
                /* ANDROID CENTER FIX */
                /* LAYOUT */
                .wrapper {
                    width: 100% !important;
                    max-width: 100% !important;
                }
                .Content {
                    width: 90% !important;
                }
                .Content-container {
                    padding-left: 36px !important;
                    padding-right: 36px !important;
                }
                .Content-container--main {
                    padding-top: 30px !important;
                    padding-bottom: 42px !important;
                }
                .responsiveTable {
                    width: 100% !important;
                }
                /* RESERVATION ACTIONS */
                .linksTableRow {
                    padding-left: 0 !important;
                    padding-right: 0 !important;
                    padding-top: 12px !important;
                    padding-bottom: 12px !important;
                }
                .linksTableRow--borderRight {
                    border-right: none !important;
                    padding-left: 0 !important;
                    padding-right: 0 !important;
                }
                /* FEEDBACK LINK */
                .feedback-link img {
                    height: 38px !important;
                    width: 38px !important;
                }
            }

            /* MOBILE STYLES */

            @media screen and (max-width: 480px) {
                /* TYPOGRAPHY */
                .h1 {
                    font-size: 30px !important;
                    line-height: 30px !important;
                }
                .text {
                    font-size: 16px !important;
                    line-height: 22px !important;
                }
                /* BUTTON */
                .mobile-buttonContainer {
                    width: 100% !important;
                }
                /* LAYOUT */
                .Content {
                    width: 100% !important;
                }
                .Content-container {
                    padding-left: 18px !important;
                    padding-right: 18px !important;
                }
                .Content-container--main {
                    padding-top: 24px !important;
                    padding-bottom: 30px !important;
                }
                .section {
                    padding: 18px 0 !important;
                }
                .section--last {
                    padding: 18px 0 !important;
                }
                .header {
                    padding: 0 18px !important;
                }
                .business-address--address {
                    width: 100% !important;
                }
                .business-address--map {
                    margin-top: 30px !important;
                    width: 100% !important;
                }
                .mobile-ticket--description {
                    width: 100% !important;
                    margin-top: 0px !important;
                }
                .mobile-ticket--code {
                    margin-top: 30px !important;
                    margin-left: 0;
                    width: 100% !important;
                }
                /* RECEIPT */
                .receipt__container {
                    padding: 12px !important;
                }
                /* SOCIAL ICONS */
                .social-link {
                    display: block !important;
                    width: 100% !important;
                    border-bottom: 1px solid #d3d3d8 !important;
                }
                /* INTRO */
                .section--intro {
                    padding-top: 18px !important;
                    padding-bottom: 18px !important;
                }
            }
        </style>

        <!--[if mso]>
            <style type="text/css">
                .h1 {
                    font-family: "Helvetica", "Arial", sans-serif !important;
                    font-weight: 700 !important;
                    vertical-align: middle !important;
                    font-size: 36px !important;
                    mso-line-height-rule: exactly;
                    line-height: 42px !important;
                }
                .h2 {
                    font-family: "Helvetica", "Arial", sans-serif !important;
                    font-weight: 600 !important;
                    vertical-align: middle !important;
                    font-size: 16px !important;
                    mso-line-height-rule: exactly;
                    line-height: 24px !important;
                }
                .text {
                    font-family: "Helvetica", "Arial", sans-serif !important;
                    font-weight: 400 !important;
                    font-size: 16px !important;
                    mso-line-height-rule: exactly;
                    line-height: 21px !important;
                }
                .text-list {
                    font-family: "Helvetica", "Arial", sans-serif !important;
                    font-weight: 400 !important;
                    font-size: 16px !important;
                    mso-line-height-rule: exactly;
                    line-height: 25px !important;
                }
                .textSmall {
                    font-family: "Helvetica", "Arial", sans-serif !important;
                    font-weight: 400 !important;
                    font-size: 14px !important;
                }
                .text-xsmall {
                    font-family: "Helvetica", "Arial", sans-serif !important;
                    font-size: 11px !important;
                    text-transform: uppercase !important;
                    mso-line-height-rule: exactly;
                    line-height: 22px !important;
                    letter-spacing: 1px !important;
                }
                .text-bold {
                    font-weight: 600 !important;
                }
                .text-link {
                    text-decoration: underline !important;
                }
                .text-linkNoUnderline {
                    text-decoration: none !important;
                }
                .text-strike {
                    text-decoration: line-through !important;
                }
                .textColorDark {
                    color: #23233e !important;
                }
                .textColorNormal {
                    color: #4f4f65 !important;
                }
                .textColorBlue {
                    color: #2020c0 !important;
                }
                .textColorGray {
                    color: #a5a8ad !important;
                }
                .textColorWhite {
                    color: #ffffff !important;
                }
                .Button-primary {
                    font-family: "Helvetica", "Arial", sans-serif !important;
                    border-radius: 3px !important;
                    border: 1px solid #2020c0 !important;
                    color: #ffffff !important;
                    display: block !important;
                    font-size: 16px !important;
                    font-weight: 600 !important;
                    padding: 18px !important;
                    text-decoration: none !important;
                }
                .Button-secondary {
                    font-family: "Helvetica", "Arial", sans-serif !important;
                    border-radius: 3px !important;
                    border: 1px solid #2020c0 !important;
                    color: #2020c0 !important;
                    display: block !important;
                    font-size: 16px !important;
                    font-weight: 600 !important;
                    padding: 18px !important;
                    text-decoration: none !important;
                }
            </style>
        <![endif]-->
        <!-- HIDDEN PREHEADER TEXT -->
    </head>
    <body>
        <div class="preheader" style="display: none; font-size: 1px; color: rgb(255, 255, 255); line-height: 1px; max-height: 0px; max-width: 0px; opacity: 0; overflow: hidden;"></div>
        <table border="0" cellpadding="0" cellspacing="0" width="100%" class="mainTable" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; background-color: rgb(240, 240, 240);">
            <tbody>
                <tr>
                    <td style="
                            display: none !important;
                            visibility: hidden;
                            mso-hide: all;
                            font-size: 1px;
                            color: #ffffff;
                            line-height: 1px;
                            max-height: 0px;
                            max-width: 0px;
                            opacity: 0;
                            overflow: hidden;
                            -webkit-text-size-adjust: 100%;
                            -ms-text-size-adjust: 100%;
                            mso-table-lspace: 0pt;
                            mso-table-rspace: 0pt;
                            border-collapse: collapse;
                            display: table-cell;
                        ">
                        We are thrilled that you will be joining us. If yo...
                    </td>
                    <!-- HEADER -->
                </tr>
                <tr>
                    <td align="center" class="header" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                        <!--[if (gte mso 9)|(IE)]>
    <table align="center" border="0" cellspacing="0" cellpadding="0" width="600">
    <tr>
    <td align="center" valign="top" width="600">
    <![endif]-->
                        <table border="0" cellpadding="0" cellspacing="0" width="100%" class="Content" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; width: 580px; margin: 0 auto;">
                            <tbody>
                                <tr class="spacer">
                                    <td height="12px" colspan="2" style="font-size: 12px; line-height: 12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        &nbsp;
                                    </td>
                                </tr>
                                <tr class="spacer">
                                    <td height="12px" colspan="2" style="font-size: 12px; line-height: 12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        &nbsp;
                                    </td>
                                </tr>
                                <tr>
                                    <td align="left" valign="middle" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        <h1 style="font-size: 33px; font-weight: 800; line-height: 30px;">Dstricts</h1>
                                    </td>
                                </tr>
                                <tr class="spacer">
                                    <td height="12px" colspan="2" style="font-size: 12px; line-height: 12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        &nbsp;
                                    </td>
                                </tr>
                                <tr class="spacer">
                                    <td height="12px" colspan="2" style="font-size: 12px; line-height: 12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        &nbsp;
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <!--[if (gte mso 9)|(IE)]>
    </td>
    </tr>
    </table>
    <![endif]-->
                    </td>
                </tr>
                <!-- CONTENT -->
                <tr>
                    <td align="center" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                        <!--[if (gte mso 9)|(IE)]>
    <table align="center" border="0" cellspacing="0" cellpadding="0" width="600">
    <tr>
    <td align="center" valign="top" width="600">
    <![endif]-->
                        <table border="0" cellpadding="0" cellspacing="0" width="100%" class="Content bg-white" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; background-color: white; width: 580px; margin: 0 auto;">
                            <tbody>
                                <tr>
                                    <td class="Content-container Content-container--main text textColorNormal" style="
                                            -webkit-text-size-adjust: 100%;
                                            -ms-text-size-adjust: 100%;
                                            mso-table-lspace: 0pt;
                                            mso-table-rspace: 0pt;
                                            border-collapse: collapse;
                                            display: table-cell;
                                            font-family: GT America Regular, Roboto, Helvetica, Arial, sans-serif;
                                            font-weight: 400;
                                            font-size: 16px;
                                            line-height: 21px;
                                            color: rgb(79, 79, 101);
                                            padding-left: 60px;
                                            padding-right: 60px;
                                            padding-top: 54px;
                                            padding-bottom: 60px;
                                        ">
                                        <table width="100%" border="0" cellspacing="0" cellpadding="0" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
                                            <!-- RESTAURANT INFO -->
                                            <tbody>
                                                <tr>
                                                    <td valign="top" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                                        <table align="left" border="0" cellpadding="0" cellspacing="0" width="100%" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
                                                            <tbody>
                                                                <tr>
                                                                    <td width="12" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                                                        &nbsp;
                                                                    </td>
                                                                    <td align="left" valign="middle" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                                                        <span class="h2 textColorDark" style="
                                                                                font-family: GT America Medium, Roboto, Helvetica, Arial, sans-serif;
                                                                                font-weight: 600;
                                                                                vertical-align: middle;
                                                                                font-size: 16px;
                                                                                line-height: 24px;
                                                                                color: rgb(35, 35, 62);
                                                                            ">
                                                                            '.htmlentities($rowRoomservice['first_name'],ENT_NOQUOTES, 'ISO-8859-1').'
                                                                        </span>
                                                                    </td>
                                                                </tr>
                                                                <tr class="spacer">
                                                                    <td height="12px" colspan="2" style="
                                                                            font-size: 12px;
                                                                            line-height: 12px;
                                                                            -webkit-text-size-adjust: 100%;
                                                                            -ms-text-size-adjust: 100%;
                                                                            mso-table-lspace: 0pt;
                                                                            mso-table-rspace: 0pt;
                                                                            border-collapse: collapse;
                                                                            display: table-cell;
                                                                        ">
                                                                        &nbsp;
                                                                    </td>
                                                                </tr>
                                                                <tr class="spacer">
                                                                    <td height="12px" colspan="2" style="
                                                                            font-size: 12px;
                                                                            line-height: 12px;
                                                                            -webkit-text-size-adjust: 100%;
                                                                            -ms-text-size-adjust: 100%;
                                                                            mso-table-lspace: 0pt;
                                                                            mso-table-rspace: 0pt;
                                                                            border-collapse: collapse;
                                                                            display: table-cell;
                                                                        ">
                                                                        &nbsp;
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </td>
                                                </tr>
                                                <!-- INTRO -->
                                                <tr>
                                                    <td valign="top" align="left" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                                        <table width="100%" border="0" cellspacing="0" cellpadding="0" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
                                                            <tbody>
                                                                <tr>
                                                                    <td align="left" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                                                        <span class="h1 textColorDark" style="
                                                                                font-family: GT America Condensed Bold, Roboto Condensed, Roboto, Helvetica, Arial, sans-serif;
                                                                                font-weight: 700;
                                                                                vertical-align: middle;
                                                                                font-size: 36px;
                                                                                line-height: 42px;
                                                                                color: rgb(35, 35, 62);
                                                                            ">
                                                                            Your booking have been confirmed at '.$rowWellnessCompany['company_name'].'
                                                                        </span>
                                                                    </td>
                                                                </tr>
                                                                
                                                                
                                                                
                                                            </tbody>
                                                        </table>
                                                    </td>
                                                </tr>
                                                <!-- MESSAGE -->

                                                <!-- BOOKING INFO -->
                                                
                                                <!-- ADDRESS -->
                                                <tr>
                                                    <td align="center" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                                        <table border="0" cellpadding="0" cellspacing="0" width="100%" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
                                                            <tbody>
                                                                
                                                                
                                                                
                                                                
                                                                
                                                                
                                                            </tbody>
                                                        </table>
                                                    </td>
                                                </tr>
                                                <tr class="spacer">
                                                    <td height="18px" colspan="2" style="
                                                            font-size: 18px;
                                                            line-height: 18px;
                                                            -webkit-text-size-adjust: 100%;
                                                            -ms-text-size-adjust: 100%;
                                                            mso-table-lspace: 0pt;
                                                            mso-table-rspace: 0pt;
                                                            border-collapse: collapse;
                                                            display: table-cell;
                                                        ">
                                                        &nbsp;
                                                    </td>
                                                </tr>
                                                <tr class="spacer">
                                                    <td height="18px" colspan="2" style="
                                                            font-size: 18px;
                                                            line-height: 18px;
                                                            -webkit-text-size-adjust: 100%;
                                                            -ms-text-size-adjust: 100%;
                                                            mso-table-lspace: 0pt;
                                                            mso-table-rspace: 0pt;
                                                            border-collapse: collapse;
                                                            display: table-cell;
                                                        ">
                                                        &nbsp;
                                                    </td>
                                                </tr>
                                                <tr>
                                                    <td align="left" colspan="2" valign="top" width="100%" height="1" class="hr" style="
                                                            -webkit-text-size-adjust: 100%;
                                                            -ms-text-size-adjust: 100%;
                                                            mso-table-lspace: 0pt;
                                                            mso-table-rspace: 0pt;
                                                            border-collapse: collapse;
                                                            display: table-cell;
                                                            background-color: rgb(211, 211, 216);
                                                            border-collapse: collapse;
                                                            mso-table-lspace: 0pt;
                                                            mso-table-rspace: 0pt;
                                                            mso-line-height-rule: exactly;
                                                            line-height: 1px;
                                                        ">
                                                        <!--[if gte mso 15]>&nbsp;<![endif]-->
                                                    </td>
                                                </tr>

                                                <!-- RECEIPT -->

                                                <tr class="spacer">
                                                    <td height="18px" colspan="2" style="
                                                            font-size: 18px;
                                                            line-height: 18px;
                                                            -webkit-text-size-adjust: 100%;
                                                            -ms-text-size-adjust: 100%;
                                                            mso-table-lspace: 0pt;
                                                            mso-table-rspace: 0pt;
                                                            border-collapse: collapse;
                                                            display: table-cell;
                                                        ">
                                                        &nbsp;
                                                    </td>
                                                </tr>
                                                <!-- EDIT RECEIPT -->
                                                <!-- CANCELLATION POLICY -->
                                                <tr>
                                                    <td valign="top" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                                        <table border="0" cellpadding="0" cellspacing="0" width="100%" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse;">
                                                            <tbody>
                                                                <tr>
                                                                    <td align="left" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                                                        <div class="text text-bold textColorDark" style="
                                                                                font-family: GT America Regular, Roboto, Helvetica, Arial, sans-serif;
                                                                                font-weight: 400;
                                                                                font-size: 16px;
                                                                                line-height: 21px;
                                                                                font-weight: 600;
                                                                                color: rgb(35, 35, 62);
                                                                            ">
                                                                            Address for meeting
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                                <tr>
                                                                    <td align="left" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                                                        <div class="text textColorNormal mt1" style="
                                                                                margin-top: 6px;
                                                                                font-family: GT America Regular, Roboto,Helvetica, Arial, sans-serif;
                                                                                font-weight: 400;
                                                                                font-size: 16px;
                                                                                line-height: 21px;
                                                                                color: rgb(79, 79, 101);
                                                                            ">
                                                                            <span>'.$rowWellnessCompany['visiting_address'].' '.$rowWellnessCompany['d_port_number'].'</span>
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                            </tbody>
                                                        </table>
                                                    </td>
                                                </tr>
                                                <tr class="spacer">
                                                    <td height="12px" colspan="2" style="
                                                            font-size: 12px;
                                                            line-height: 12px;
                                                            -webkit-text-size-adjust: 100%;
                                                            -ms-text-size-adjust: 100%;
                                                            mso-table-lspace: 0pt;
                                                            mso-table-rspace: 0pt;
                                                            border-collapse: collapse;
                                                            display: table-cell;
                                                        ">
                                                        &nbsp;
                                                    </td>
                                                </tr>
                                                <tr class="spacer">
                                                    <td height="12px" colspan="2" style="
                                                            font-size: 12px;
                                                            line-height: 12px;
                                                            -webkit-text-size-adjust: 100%;
                                                            -ms-text-size-adjust: 100%;
                                                            mso-table-lspace: 0pt;
                                                            mso-table-rspace: 0pt;
                                                            border-collapse: collapse;
                                                            display: table-cell;
                                                        ">
                                                        &nbsp;
                                                    </td>
                                                </tr>
                                                <!-- QUESTIONS -->
                                            </tbody>
                                        </table>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </td>
                </tr>
                <!-- FOOTER -->
                <tr>
                    <td align="center" class="Content" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell; width: 580px; margin: 0 auto;">
                        <!-- Will most likely required a feature flag -->
                        <!--[if (gte mso 9)|(IE)]>
<table align="center" border="0" cellspacing="0" cellpadding="0" width="600">
<tr>
<td align="center" valign="top" width="600">
<![endif]-->
                        <table width="100%" border="0" cellspacing="0" cellpadding="0" align="center" class="Content-container" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; padding-left: 60px; padding-right: 60px;">
                            <tbody>
                                <tr class="spacer">
                                    <td height="12px" colspan="2" style="font-size: 12px; line-height: 12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        &nbsp;
                                    </td>
                                </tr>
                                <tr class="spacer">
                                    <td height="12px" colspan="2" style="font-size: 12px; line-height: 12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        &nbsp;
                                    </td>
                                </tr>
                                <tr class="spacer">
                                    <td height="12px" colspan="2" style="font-size: 12px; line-height: 12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        &nbsp;
                                    </td>
                                </tr>
                                <tr>
                                    <td align="center" valign="top" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        <a href="https://www.exploretock.com" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%;">
                                            <img src="https://storage.googleapis.com/tock-public-assets/images-email-template/tock-brandmark-color.png" width="30" height="30" alt="Tock" border="0" style="-ms-interpolation-mode: bicubic; border: 0; height: auto; line-height: 100%; outline: none; text-decoration: none; display: block;">
                                        </a>
                                    </td>
                                </tr>
                                <tr class="spacer">
                                    <td height="18px" colspan="2" style="font-size: 18px; line-height: 18px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        &nbsp;
                                    </td>
                                </tr>
                                <tr>
                                    <td align="center" style="-webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        <div class="text-xsmall textColorNormal" style="font-family: GT America Regular, Roboto,Helvetica, Arial, sans-serif; font-size: 11px; text-transform: uppercase; line-height: 22px; letter-spacing: 1px; color: rgb(79, 79, 101);">
                                            © 2019 Tock, Inc.
                                        </div>
                                        <div class="text-xsmall textColorNormal" style="font-family: GT America Regular, Roboto,Helvetica, Arial, sans-serif; font-size: 11px; text-transform: uppercase; line-height: 22px; letter-spacing: 1px; color: rgb(79, 79, 101);">
                                            All Rights Reserved
                                        </div>
                                    </td>
                                </tr>
                                <tr class="spacer">
                                    <td height="12px" colspan="2" style="font-size: 12px; line-height: 12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        &nbsp;
                                    </td>
                                </tr>
                                <tr class="spacer">
                                    <td height="12px" colspan="2" style="font-size: 12px; line-height: 12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        &nbsp;
                                    </td>
                                </tr>
                                <tr class="spacer">
                                    <td height="12px" colspan="2" style="font-size: 12px; line-height: 12px; -webkit-text-size-adjust: 100%; -ms-text-size-adjust: 100%; mso-table-lspace: 0pt; mso-table-rspace: 0pt; border-collapse: collapse; display: table-cell;">
                                        &nbsp;
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                        <!--[if (gte mso 9)|(IE)]>
</td>
</tr>
</table>
<![endif]-->
                    </td>
                </tr>
            </tbody>
        </table>
    
</body></html>';	
				try {
					 sendEmail($subject, $to, $emailContent);
					}

					 
					catch(Exception $e) {
					   
					}
			}
			
				
			$stmt = $dbCon->prepare("update hotel_roomservice_item_ordered set is_verified=1,is_paid=?, company_id=?, card_id=?,customer_id=?,charge_id=?,is_user=?,user_id=? where qloud_checkout_id=? and is_verified=0 and service_type=? and wellness_id=? and booking_person_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("iiissiiiiii", $rowP['is_paid'], $rowP['buyer_id'],$rowP['card_id'],$rowP['customer_id'],$rowP['charge_id'],$rowP['user'],$rowP['user_id'],$data['checkid'],$data['service_type'],$data['wellness_id'],$rowP['user_id']);
			$stmt->execute();	
				
			}
			else
			{
			$stmt = $dbCon->prepare("update company_hotel_amenities_user_request set is_verified=1 where qloud_checkout_id=? and is_verified=0");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['checkid']);
			$stmt->execute();
					
			}
		  
			 if($rowP['service_type']==5)
			{
			  $curl = curl_init();
			  curl_setopt_array($curl, array(
			  CURLOPT_URL => 'https://dstricts.com/user/index.php/DstrictsApp/payCartItemUsingApp',
			  CURLOPT_RETURNTRANSFER => true,
			  CURLOPT_ENCODING => '',
			  CURLOPT_MAXREDIRS => 10,
			  CURLOPT_TIMEOUT => 0,
			  CURLOPT_FOLLOWLOCATION => true,
			  CURLOPT_HTTP_VERSION => CURL_HTTP_VERSION_1_1,
			  CURLOPT_CUSTOMREQUEST => 'POST',
			  CURLOPT_POSTFIELDS => array('service_type' => $rowP['service_type'],'is_paid' => $rowP['is_paid'],'user' => $rowP['user'],'buyer_id' => $rowP['buyer_id'],'card_id' => $rowP['card_id'],'user_id' => $rowP['user_id'],'customer_id' => $rowP['customer_id'],'charge_id' => $rowP['charge_id'],'qloud_checkout_id' => $rowP['qloud_checkout_id'],'wellness_id' => $data['wellness_id']),
			));
			}
			else
			{
			$curl = curl_init();
			  curl_setopt_array($curl, array(
			  CURLOPT_URL => 'https://dstricts.com/user/index.php/DstrictsApp/payCartItemUsingApp',
			  CURLOPT_RETURNTRANSFER => true,
			  CURLOPT_ENCODING => '',
			  CURLOPT_MAXREDIRS => 10,
			  CURLOPT_TIMEOUT => 0,
			  CURLOPT_FOLLOWLOCATION => true,
			  CURLOPT_HTTP_VERSION => CURL_HTTP_VERSION_1_1,
			  CURLOPT_CUSTOMREQUEST => 'POST',
			  CURLOPT_POSTFIELDS => array('service_type' => $rowP['service_type'],'is_paid' => $rowP['is_paid'],'user' => $rowP['user'],'buyer_id' => $rowP['buyer_id'],'card_id' => $rowP['card_id'],'user_id' => $rowP['user_id'],'customer_id' => $rowP['customer_id'],'charge_id' => $rowP['charge_id'],'qloud_checkout_id' => $rowP['qloud_checkout_id']),
			));	
			}
			$response = curl_exec($curl);
			curl_close($curl); 
			 
			$stmt->close();
			$dbCon->close();
			return 1;
			
			 
			
		}
		
		function cartInfo($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select * from hotel_roomservice_item_ordered where qloud_checkout_id=? and is_verified=0 and service_type=1");
			/* bind parameters for markers */
			 
			$stmt->bind_param("i",$data['checkid']);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			while($row = $result->fetch_assoc())
			{
				$row['enc']=$this->encrypt_decrypt('encrypt',$row['dish_id']);
				array_push($org,$row);
			}
			$stmt->close();
			$dbCon->close();
			return $org;
			
			 
			
		}
		
		function cartInfoList($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select * from hotel_roomservice_item_ordered where qloud_checkout_id=? and is_verified=0 and service_type=?");
			/* bind parameters for markers */
			 
			$stmt->bind_param("ii",$data['checkid'],$data['service_type']);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			while($row = $result->fetch_assoc())
			{
				$row['dish_detail']="The price is based upon $".$row['dish_price']." a piece";
			$stmt = $dbCon->prepare("select category_id from drycleaning_services where id=?");
			$stmt->bind_param("i", $row['dish_id']);
			$stmt->execute();
			$result2 = $stmt->get_result();
			$rowCat= $result2->fetch_assoc();
				if($rowCat['category_id']==1)
				{
				$row['category_name']='Drycleaning';
				 
				}
				else if($rowCat['category_id']==2)
				{
				$row['category_name']='Wash';
				 
				}
				else if($rowCat['category_id']==3)
				{
				$row['category_name']='Ironing';
				 
				}
				array_push($org,$row);
			}
			$stmt->close();
			$dbCon->close();
			return $org;
			
			 
			
		}
		
		
		
		
		
	function hotelCompleteInfo($data)
		{
			$dbCon = AppModel::createConnection();
			$checkout_id=$data['id'];
			
			$stmt = $dbCon->prepare("delete from hotel_checkout_dependent_detail where hotel_checkout_id=? and is_verified=0");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $checkout_id);
			$stmt->execute();
			
			$stmt = $dbCon->prepare("delete from hotel_checkout_invitation_info where hotel_checkout_id=? and is_verified=0");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $checkout_id);
			$stmt->execute();
			
			
 			$stmt = $dbCon->prepare("select location_id from company_hotel_room_type_detail where id=(select room_type_id from hotel_checkout_detail where id=?)");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $checkout_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			
			$stmt = $dbCon->prepare("select checkout_booking_date,checkin_booking_date,checkin_date,checkout_date,guest_adult,guest_children,room_name,hotel_room_type.room_type,hotel_checkout_detail.property_id,first_name from hotel_checkout_detail left join hotel_room_detail on hotel_room_detail.id=hotel_checkout_detail.room_id left join company_hotel_room_type_detail on company_hotel_room_type_detail.id=hotel_checkout_detail.room_type_id left join hotel_room_type on hotel_room_type.id=company_hotel_room_type_detail.room_type left join user_logins on user_logins.id=hotel_checkout_detail.user_id where hotel_checkout_detail.id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $checkout_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowDate = $result->fetch_assoc();
			
			
			
			$stmt = $dbCon->prepare("select * from company_wifi  where property_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $rowDate['property_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowWifi = $result->fetch_assoc();

			$stmt = $dbCon->prepare("select count(id) as num from hotel_checkout_invitation_info where hotel_checkout_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $checkout_id);
			$stmt->execute();
			$resultCount = $stmt->get_result();
			$rowDependentCount = $resultCount->fetch_assoc();
			$rowDate['guest_adult']=$rowDate['guest_adult'];
			$rowDate['guest_adult_left']=$rowDate['guest_adult']-$rowDependentCount['num']-1;
			
			$stmt = $dbCon->prepare("select count(id) as num from hotel_checkout_dependent_detail where hotel_checkout_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $checkout_id);
			$stmt->execute();
			$resultCount = $stmt->get_result();
			$rowDependentCount = $resultCount->fetch_assoc();
			$rowDate['guest_children']=$rowDate['guest_children'];
			$rowDate['guest_children_left']=$rowDate['guest_children']-$rowDependentCount['num']-1;
			 if($rowDate['guest_children_left']<0)
			 {
				 $rowDate['guest_children_left']=0;
			 }
			$location_id=$row['location_id'];
			
			$stmt = $dbCon->prepare("select hotel_description,property_location.visiting_address,hotel_name,dry_cleaning,property_location.city_v,property_location.country_v,property_location.postal_code_v from hotel_basic_information left join property_location on property_location.id=hotel_basic_information.property_id left join company_profiles on property_location.company_id=company_profiles.company_id  where property_location.id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $location_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowHotel = $result->fetch_assoc();
			$rowHotel['checkin_date']=date('d M',strtotime($rowDate['checkin_date']));
			$rowHotel['checkout_date']=date('d M',strtotime($rowDate['checkout_date']));
			$rowHotel['guest_adult']=$rowDate['guest_adult'];
			$rowHotel['guest_children']=$rowDate['guest_children'];
			$rowHotel['guest_adult_checkedin']=$rowHotel['guest_adult']-$rowDate['guest_adult_left'];
			$rowHotel['guest_children_checkedin']=$rowHotel['guest_children']-$rowDate['guest_children_left'];
			$rowHotel['guest_adult_left']=$rowDate['guest_adult_left'];
			$rowHotel['guest_children_left']=$rowDate['guest_children_left'];
			$rowHotel['guest_checkin_left']=$rowHotel['guest_adult_left']+$rowHotel['guest_children_left'];
			$rowHotel['room_name']=$rowDate['room_name']; 
			$rowHotel['room_type']=$rowDate['room_type']; 
			$rowHotel['first_name']=html_entity_decode($rowDate['first_name'],ENT_NOQUOTES, 'UTF-8');
			$rowHotel['visiting_address']=html_entity_decode($rowHotel['visiting_address'],ENT_NOQUOTES, 'UTF-8').','.$rowHotel['city_v'].','.$rowHotel['country_v'].'-'.$rowHotel['postal_code_v'];
			if(empty($rowWifi))
			{
			$rowHotel['wifi_available']=0; 
			$rowHotel['wifi_username']='';
			$rowHotel['wifi_password']=''; 
			}
			else
			{
			$rowHotel['wifi_available']=1; 
			$rowHotel['wifi_username']=$rowWifi['wifi_username']; 
			$rowHotel['wifi_password']=$rowWifi['wifi_password']; 
			}
			$stmt = $dbCon->prepare("select count(id) as num from hotel_images where property_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $location_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			$rowHotel['hotel_images']=array();
			if($row['num']>0)
			{
			$stmt = $dbCon->prepare("select * from hotel_images where property_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $location_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$i=0;
			while($row = $result->fetch_assoc())
			{
			 $filename="../estorecss/".$row['image_path'].".txt"; $value_a=file_get_contents("../estorecss/".$row['image_path'].".txt"); $value_a=str_replace('"','',$value_a); $row['image_path1'] = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$row['image_path'].'.jpg' );
			$row['image_path1']=str_replace('../','https://www.safeqloud.com/',$row['image_path1']);
			$rowHotel['hotel_images'][$i]['ImageUrl']=$row['image_path1'];
			$i++;
			}	
			}
			else
			{
			$rowHotel['hotel_images']=array();	
			$rowHotel['hotel_images'][0]['ImageUrl']='https://www.safeqloud.com/estorecss/tmpnew0.09086000 1600564862.jpg';
			$rowHotel['hotel_images'][1]['ImageUrl']='https://www.safeqloud.com/estorecss/tmpnew0.09086000 1600564862.jpg';
			}
			$rowHotel['inhouse_resturants']=array();
			$stmt = $dbCon->prepare("select distinct resturant_type as rtype  from resturant_information where id in (select resturant_id from hotel_roomservice_resturant where hotel_roomservice_resturant.hotel_property_id=? and is_inhouse=1 and company_service_info=1) and is_delivery_available=1");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $location_id);
			$stmt->execute();
			$result = $stmt->get_result();
			
			while($row = $result->fetch_assoc())
			{
				if($row['rtype']==1)
					$row['resturant_type']='Restaurants';
				else if($row['rtype']==2) 
					$row['resturant_type']='Coffee & Tea';
				else if($row['rtype']==3) 
					$row['resturant_type']='Bakeries';
				else if($row['rtype']==4) 
					$row['resturant_type']='Bars, Pubs & Nightclub';
			array_push($rowHotel['inhouse_resturants'],$row);
			}	
			
			$rowHotel['inhouse_fittness']=array();
			$stmt = $dbCon->prepare("select id,center_name,center_type as ctype  from wellness_center_information where id in (select wellness_id from hotel_wellness_services where hotel_wellness_services.hotel_property_id=? and is_approved=1)");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $location_id);
			$stmt->execute();
			$result = $stmt->get_result();
			
			while($row = $result->fetch_assoc())
			{
				if($row['ctype']==1)
					$row['center_type']='Spa';
				else if($row['ctype']==2) 
					$row['center_type']='Fitness';
				else if($row['ctype']==3) 
					$row['center_type']='Hair & Nails';
				else if($row['ctype']==4) 
					$row['center_type']='Barber';
			array_push($rowHotel['inhouse_fittness'],$row);
			}	
			
			$rowHotel['hotel_venues']=array();
			$stmt = $dbCon->prepare("select id,venue_name from company_venue where location_id=? and owner_of_the_venue=2 and price_info=1 and capacity_info=1 and photo_info=1");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $location_id);
			$stmt->execute();
			$result = $stmt->get_result();
			
			while($row = $result->fetch_assoc())
			{
			$stmt = $dbCon->prepare("select * from company_venue_photos where venue_id=? and sorting_number=1");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $row['id']);
			$stmt->execute();
			$result2 = $stmt->get_result();
			$rowPhoto = $result2->fetch_assoc();
			 
			 $filename="../estorecss/".$rowPhoto['venue_photo_path'].".txt"; $value_a=file_get_contents("../estorecss/".$rowPhoto['venue_photo_path'].".txt"); $value_a=str_replace('"','',$value_a); $rowPhoto['image_path1'] = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$rowPhoto['venue_photo_path'].'.jpg' );
			 
			$row['image_path1']=str_replace('../','https://www.safeqloud.com/',$rowPhoto['image_path1']);
			 
			array_push($rowHotel['hotel_venues'],$row);
			}	
			
			return $rowHotel; 
		}
	
	function selectedRoomServiceServeBasedAppMenu($data)
		{
			function base64_to_jpeg($base64_string, $output_file) {
			$ifp = fopen( $output_file, 'wb' ); 
			$data = explode( ',', $base64_string );
			fwrite( $ifp, base64_decode( $data[1] ) );
			fclose( $ifp ); 
			return $output_file; 
			}
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select location_id  from company_hotel_room_type_detail where company_hotel_room_type_detail.id=(select room_type_id from hotel_checkout_detail where id=?) ");
			$stmt->bind_param("i", $data['id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowProperty= $result->fetch_assoc();
			  
			$roomservice_id= $rowProperty['location_id'];
			$stmt = $dbCon->prepare("select available_dishes,resturant_id,available_guest_dishes from hotel_roomservice_resturant left join resturant_information on  resturant_information.id=hotel_roomservice_resturant.resturant_id where hotel_property_id=?  and company_service_info=1 and is_delivery_available=1");
			$stmt->bind_param("i", $roomservice_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$allDish='';
			$allRestu='';
			while($row= $result->fetch_assoc())
			{
				if($row['available_guest_dishes']=='' || $row['available_guest_dishes']==null)
					continue;
				$allDish=$allDish.$row['available_guest_dishes'].',';
				$allRestu=$allRestu.$row['resturant_id'].',';
			}
			 $allDish=substr($allDish,0,-1);
				 
				$org=array();
				$j=0;
				$stmt = $dbCon->prepare("select distinct category_food,food_category,place_of_display from resturant_available_dishes left join food_category on food_category.id=resturant_available_dishes.category_food where find_in_set (resturant_available_dishes.id,?) and serve_type=?  and temp_available_item=1 order by place_of_display");
				$stmt->bind_param("si", $allDish,$data['serve_type']);
				$stmt->execute();
				$result1 = $stmt->get_result();
				
				while($rowCategory = $result1->fetch_assoc())
				{
					array_push($org,$rowCategory);
					$org[$j]['category']=array();
					$stmt = $dbCon->prepare("select resturant_available_dishes.id,dish_name,dish_detail,dish_image as dimage,dish_price,temp_available_item from resturant_available_dishes left join dishes_detail_information on dishes_detail_information.id=resturant_available_dishes.dish_id where find_in_set(resturant_available_dishes.id,?) and serve_type=? and category_food=? and is_available_item=1  and temp_available_item=1");
					$stmt->bind_param("sii", $allDish,$data['serve_type'],$rowCategory['category_food']);
					$stmt->execute();
					$result2 = $stmt->get_result();
					$k=0;
					while($rowDishes = $result2->fetch_assoc())
					{
						$rowDishes['food_category']=$rowCategory['food_category'];
						$rowDishes['dish_name']=html_entity_decode($rowDishes['dish_name'],ENT_NOQUOTES, 'UTF-8');
						$rowDishes['dish_detail']=html_entity_decode($rowDishes['dish_detail'],ENT_NOQUOTES, 'UTF-8');
						$rowDishes['serve_type']=1; 
						 $filename="../estorecss/".$rowDishes ['dimage'].".txt"; if (file_exists($filename)) { $value_a=file_get_contents("../estorecss/".$rowDishes ['dimage'].".txt"); $value_a=str_replace('"','',$value_a);  $imgs = base64_to_jpeg( $value_a, '../estorecss/tmp'.$rowDishes ['dimage'].'.jpg' );  $imgs='../../../../'.$imgs; } else { $value_a="../../../../../html/usercontent/images/default-profile-pic.jpg";  $imgs="../../../../../html/usercontent/images/default-profile-pic.jpg"; }
						 
						 $imgs=str_replace('../../../../../','https://www.safeqloud.com/',$imgs);
						array_push($org[$j]['category'],$rowDishes);
						$org[$j]['category'][$k]['dish_image']=$imgs;
						 
						$k++;
					}
					$j++;
				}
				 
			$stmt->close();
			$dbCon->close();
			return $org;
			
			
		}
	 
 function selectedRoomServiceAppMenu($data)
		{
			function base64_to_jpeg($base64_string, $output_file) {
			$ifp = fopen( $output_file, 'wb' ); 
			$data = explode( ',', $base64_string );
			fwrite( $ifp, base64_decode( $data[1] ) );
			fclose( $ifp ); 
			return $output_file; 
			}
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select location_id  from company_hotel_room_type_detail where company_hotel_room_type_detail.id=(select room_type_id from hotel_checkout_detail where id=?) ");
			$stmt->bind_param("i", $data['id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowProperty= $result->fetch_assoc();
			$roomservice_id= $rowProperty['location_id'];
			$stmt = $dbCon->prepare("select available_guest_dishes,available_dishes,resturant_id from hotel_roomservice_resturant left join resturant_information on  resturant_information.id=hotel_roomservice_resturant.resturant_id where hotel_property_id=?  and company_service_info=1 and is_delivery_available=1");
			$stmt->bind_param("i", $roomservice_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$allDish='';
			$allRestu='';
			while($row= $result->fetch_assoc())
			{
				if($row['available_guest_dishes']=='' || $row['available_guest_dishes']==null)
					continue;
				$allDish=$allDish.$row['available_guest_dishes'].',';
				$allRestu=$allRestu.$row['resturant_id'].',';
			}
			 
			
			$stmt = $dbCon->prepare("select distinct serve_type from resturant_available_dishes where find_in_set (resturant_id,?)  and is_available_item=1  and temp_available_item=1 order by serve_type");
			$stmt->bind_param("s", $allRestu);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			$j=0;
			while($row= $result->fetch_assoc())
			{
				if($row['serve_type']==1)
				{
				$row['serve_info']='Breakfast';
				$row['serve_image']="https://www.safeqloud.com/html/usercontent/images/roomserviceImages/Breakfast.jpg";
				}
				else if($row['serve_type']==2)
				{
				$row['serve_info']='Brunch';
				$row['serve_image']="https://www.safeqloud.com/html/usercontent/images/roomserviceImages/Brunch.jpg";
				}
				else if($row['serve_type']==3)
				{
				$row['serve_info']='Lunch';
				$row['serve_image']="https://www.safeqloud.com/html/usercontent/images/roomserviceImages/lunch.jpg";
				}
				else if($row['serve_type']==4)
				{
				$row['serve_info']='Dinner';
				$row['serve_image']="https://www.safeqloud.com/html/usercontent/images/roomserviceImages/dinner.jpg";
				}
				else if($row['serve_type']==5)
				{
				$row['serve_info']='Beverage';
				$row['serve_image']="https://www.safeqloud.com/html/usercontent/images/roomserviceImages/Beverage.jpg";
				}
				 
				array_push($org,$row);
				$org[$j]['category']=array();
				$i=0;
				$stmt = $dbCon->prepare("select distinct category_food,food_category,place_of_display from resturant_available_dishes left join food_category on food_category.id=resturant_available_dishes.category_food where find_in_set (resturant_available_dishes.resturant_id,?) and serve_type=?  and temp_available_item=1 order by place_of_display");
				$stmt->bind_param("si", $allRestu,$row['serve_type']);
				$stmt->execute();
				$result1 = $stmt->get_result();
				$k=0;
				while($rowCategory = $result1->fetch_assoc())
				{
					
					$stmt = $dbCon->prepare("select resturant_available_dishes.id,dish_name,dish_detail,dish_image as dimage,dish_price,temp_available_item from resturant_available_dishes left join dishes_detail_information on dishes_detail_information.id=resturant_available_dishes.dish_id where find_in_set(resturant_available_dishes.id,?) and serve_type=? and category_food=? and is_available_item=1  and temp_available_item=1");
					$stmt->bind_param("sii", $allDish,$row['serve_type'],$rowCategory['category_food']);
					$stmt->execute();
					$result2 = $stmt->get_result();
					while($rowDishes = $result2->fetch_assoc())
					{
						$rowDishes['dish_name']=html_entity_decode($rowDishes['dish_name'],ENT_NOQUOTES, 'UTF-8');
						$rowDishes['dish_detail']=html_entity_decode($rowDishes['dish_detail'],ENT_NOQUOTES, 'UTF-8');
						$rowDishes['serve_type']=1;
						 $filename="../estorecss/".$rowDishes ['dimage'].".txt"; if (file_exists($filename)) { $value_a=file_get_contents("../estorecss/".$rowDishes ['dimage'].".txt"); $value_a=str_replace('"','',$value_a);  $imgs = base64_to_jpeg( $value_a, '../estorecss/tmp'.$rowDishes ['dimage'].'.jpg' );  $imgs='../../../../'.$imgs; } else { $value_a="../../../../../html/usercontent/images/default-profile-pic.jpg";  $imgs="../../../../../html/usercontent/images/default-profile-pic.jpg"; }
						 
						 $imgs=str_replace('../../../../../','https://www.safeqloud.com/',$imgs);
						array_push($org[$j]['category'],$rowDishes);
						$org[$j]['category'][$k]['enc']= $this -> encrypt_decrypt('encrypt',$rowDishes['id']);
						$org[$j]['category'][$k]['dish_image']=$imgs;
						 
						$k++;
					}
					$i++;
				}
				$j++;
			}
			$stmt->close();
			$dbCon->close();
			return $org;
			
			
		}
	 
 function selectedRoomServiceAppServes($data)
		{
			function base64_to_jpeg($base64_string, $output_file) {
			$ifp = fopen( $output_file, 'wb' ); 
			$data = explode( ',', $base64_string );
			fwrite( $ifp, base64_decode( $data[1] ) );
			fclose( $ifp ); 
			return $output_file; 
			}
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select location_id  from company_hotel_room_type_detail where company_hotel_room_type_detail.id=(select room_type_id from hotel_checkout_detail where id=?) ");
			$stmt->bind_param("i", $data['id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowProperty= $result->fetch_assoc();
			$roomservice_id= $rowProperty['location_id'];
			$stmt = $dbCon->prepare("select available_guest_dishes,available_dishes,resturant_id from hotel_roomservice_resturant left join resturant_information on  resturant_information.id=hotel_roomservice_resturant.resturant_id where hotel_property_id=?  and company_service_info=1 and is_delivery_available=1");
			$stmt->bind_param("i", $roomservice_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$allDish='';
			$allRestu='';
			while($row= $result->fetch_assoc())
			{
				$allDish=$allDish.$row['available_guest_dishes'].',';
				$allRestu=$allRestu.$row['resturant_id'].',';
			}
			 
			
			$stmt = $dbCon->prepare("select distinct serve_type from resturant_available_dishes where find_in_set (id,?)  and is_available_item=1  and temp_available_item=1 order by serve_type");
			$stmt->bind_param("s", $allDish);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			$j=0;
			while($row= $result->fetch_assoc())
			{
				if($row['serve_type']==1)
				{
				$row['serve_info']='Breakfast';
				$row['serve_image']="https://www.safeqloud.com/html/usercontent/images/roomserviceImages/Breakfast.jpg";
				}
				else if($row['serve_type']==2)
				{
				$row['serve_info']='Brunch';
				$row['serve_image']="https://www.safeqloud.com/html/usercontent/images/roomserviceImages/Brunch.jpg";
				}
				else if($row['serve_type']==3)
				{
				$row['serve_info']='Lunch';
				$row['serve_image']="https://www.safeqloud.com/html/usercontent/images/roomserviceImages/lunch.jpg";
				}
				else if($row['serve_type']==4)
				{
				$row['serve_info']='Dinner';
				$row['serve_image']="https://www.safeqloud.com/html/usercontent/images/roomserviceImages/dinner.jpg";
				}
				else if($row['serve_type']==5)
				{
				$row['serve_info']='Beverage';
				$row['serve_image']="https://www.safeqloud.com/html/usercontent/images/roomserviceImages/Beverage.jpg";
				}
				 
				array_push($org,$row);
				 
				$j++;
			}
			$stmt->close();
			$dbCon->close();
			return $org;
			
			
		}
	 
	 
 function selectedLaundaryCategories($data)
		{
			function base64_to_jpeg($base64_string, $output_file) {
			$ifp = fopen( $output_file, 'wb' ); 
			$data = explode( ',', $base64_string );
			fwrite( $ifp, base64_decode( $data[1] ) );
			fclose( $ifp ); 
			return $output_file; 
			}
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select location_id  from company_hotel_room_type_detail where company_hotel_room_type_detail.id=(select room_type_id from hotel_checkout_detail where id=?) ");
			$stmt->bind_param("i", $data['id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowProperty= $result->fetch_assoc();
			$roomservice_id= $rowProperty['location_id'];
			$stmt = $dbCon->prepare("select available_services,drycleaning_id from hotel_drycleaning_services where hotel_property_id=?");
			$stmt->bind_param("i", $roomservice_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$allDish='';
			$allRestu='';
			while($row= $result->fetch_assoc())
			{
				$allDish=$allDish.$row['available_services'].',';
				$allRestu=$allRestu.$row['drycleaning_id'].',';
			}
			 
			
			$stmt = $dbCon->prepare("select distinct category_id from drycleaning_services where find_in_set (id,?) order by category_id");
			$stmt->bind_param("s", $allDish);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			$j=0;
			while($row= $result->fetch_assoc())
			{
				if($row['category_id']==1)
				{
				$row['serve_info']='Drycleaning';
				$row['serve_image']="https://www.safeqloud.com/html/usercontent/images/roomserviceImages/drycleaning.jpeg";
				}
				else if($row['category_id']==2)
				{
				$row['serve_info']='Wash';
				$row['serve_image']="https://www.safeqloud.com/html/usercontent/images/roomserviceImages/wash.jpeg";
				}
				else if($row['category_id']==3)
				{
				$row['serve_info']='Ironing';
				$row['serve_image']="https://www.safeqloud.com/html/usercontent/images/roomserviceImages/ironing.jpeg";
				}
				 
				 
				array_push($org,$row);
				 
				$j++;
			}
			$stmt->close();
			$dbCon->close();
			return $org;
			
			
		}
	 
	 
	 function selectedDrycleaningServeBasedAppMenu($data)
		{
			function base64_to_jpeg($base64_string, $output_file) {
			$ifp = fopen( $output_file, 'wb' ); 
			$data = explode( ',', $base64_string );
			fwrite( $ifp, base64_decode( $data[1] ) );
			fclose( $ifp ); 
			return $output_file; 
			}
			 
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select location_id  from company_hotel_room_type_detail where company_hotel_room_type_detail.id=(select room_type_id from hotel_checkout_detail where id=?) ");
			$stmt->bind_param("i", $data['id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowProperty= $result->fetch_assoc();
			$roomservice_id= $rowProperty['location_id'];
			$stmt = $dbCon->prepare("select available_services,drycleaning_id from hotel_drycleaning_services where hotel_property_id=?");
			$stmt->bind_param("i", $roomservice_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$allDish='';
			$allRestu='';
			while($row= $result->fetch_assoc())
			{
				$allDish=$allDish.$row['available_services'].',';
				$allRestu=$allRestu.$row['drycleaning_id'].',';
			}
			 
		 
					$org=array();
					$stmt = $dbCon->prepare("select drycleaning_services.id,article_name as dish_name,price as dish_price from drycleaning_services left join drycleaning_articles on drycleaning_articles.id=drycleaning_services.service_id where find_in_set(drycleaning_services.id,?) and category_id=?");
					$stmt->bind_param("si", $allDish,$data['category_id']);
					$stmt->execute();
					$result2 = $stmt->get_result();
					$k=0;
					while($rowDishes = $result2->fetch_assoc())
					{
						$rowDishes['dish_name']=html_entity_decode($rowDishes['dish_name'],ENT_NOQUOTES, 'UTF-8');
						$rowDishes['dish_detail']='';
						$rowDishes['serve_type']=4; 
						 
						$stmt = $dbCon->prepare("select dish_quantity,dish_price from hotel_roomservice_item_ordered where qloud_checkout_id=? and is_verified=0 and dish_id=? and service_type=4");
						/* bind parameters for markers */
						 
						$stmt->bind_param("ii",$data['id'],$rowDishes['id']);
						$stmt->execute();
						$resultCount = $stmt->get_result();
						$rowCount = $resultCount->fetch_assoc();
						 
						if($rowCount['dish_quantity']==null)
						{
							$rowDishes['dish_quantity']=0; 
						}
						else
						$rowDishes['dish_quantity']=$rowCount['dish_quantity']; 
						array_push($org,$rowDishes);
						 
					}
				
			$stmt->close();
			$dbCon->close();
			return $org;
			
			
		}
	 

	function selectedRoomServiceMenu($data)
		{
			function base64_to_jpeg($base64_string, $output_file) {
			$ifp = fopen( $output_file, 'wb' ); 
			$data = explode( ',', $base64_string );
			fwrite( $ifp, base64_decode( $data[1] ) );
			fclose( $ifp ); 
			return $output_file; 
			}
			$dbCon = AppModel::createConnection();
			$roomservice_id= $this -> encrypt_decrypt('decrypt',$data['hid']);
			$stmt = $dbCon->prepare("select available_guest_dishes,available_dishes,resturant_id from hotel_roomservice_resturant left join resturant_information on  resturant_information.id=hotel_roomservice_resturant.resturant_id where hotel_property_id=?  and company_service_info=1 and is_delivery_available=1");
			$stmt->bind_param("i", $roomservice_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$allDish='';
			$allRestu='';
			while($row= $result->fetch_assoc())
			{
				$allDish=$allDish.$row['available_guest_dishes'].',';
				$allRestu=$allRestu.$row['resturant_id'].',';
			}
			 
			
			$stmt = $dbCon->prepare("select distinct serve_type from resturant_available_dishes where find_in_set (resturant_id,?)  and is_available_item=1 and temp_available_item=1 order by serve_type");
			$stmt->bind_param("s", $allRestu);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			$j=0;
			while($row= $result->fetch_assoc())
			{
				if($row['serve_type']==1)
				{
				$row['serve_info']='Breakfast';
				}
				else if($row['serve_type']==2)
				{
				$row['serve_info']='Brunch';
				}
				else if($row['serve_type']==3)
				{
				$row['serve_info']='Lunch';
				}
				else if($row['serve_type']==4)
				{
				$row['serve_info']='Dinner';
				}
				else if($row['serve_type']==5)
				{
				$row['serve_info']='Beverage';
				}
				array_push($org,$row);
				$org[$j]['category']=array();
				$i=0;
				$stmt = $dbCon->prepare("select distinct category_food,food_category,place_of_display from resturant_available_dishes left join food_category on food_category.id=resturant_available_dishes.category_food where find_in_set (resturant_available_dishes.resturant_id,?) and serve_type=?  and temp_available_item=1 order by place_of_display");
				$stmt->bind_param("si", $allRestu,$row['serve_type']);
				$stmt->execute();
				$result1 = $stmt->get_result();
				while($rowCategory = $result1->fetch_assoc())
				{
					array_push($org[$j]['category'],$rowCategory);
					$k=0;
					$org[$j]['category'][$i]['dishes']=array();
					$stmt = $dbCon->prepare("select resturant_available_dishes.id,dish_name,dish_detail,dish_image,dish_price,temp_available_item from resturant_available_dishes left join dishes_detail_information on dishes_detail_information.id=resturant_available_dishes.dish_id where find_in_set(resturant_available_dishes.id,?) and serve_type=? and category_food=? and is_available_item=1  and temp_available_item=1");
					$stmt->bind_param("sii", $allDish,$row['serve_type'],$rowCategory['category_food']);
					$stmt->execute();
					$result2 = $stmt->get_result();
					while($rowDishes = $result2->fetch_assoc())
					{
						 $filename="../estorecss/".$rowDishes ['dish_image'].".txt"; if (file_exists($filename)) { $value_a=file_get_contents("../estorecss/".$rowDishes ['dish_image'].".txt"); $value_a=str_replace('"','',$value_a);  $imgs = base64_to_jpeg( $value_a, '../estorecss/tmp'.$rowDishes ['dish_image'].'.jpg' );  $imgs='../../../../'.$imgs; } else { $value_a="../../../../../html/usercontent/images/default-profile-pic.jpg";  $imgs="../../../../../html/usercontent/images/default-profile-pic.jpg"; }
						 $imgs=str_replace('../../../../../','https://www.safeqloud.com/',$imgs);
						array_push($org[$j]['category'][$i]['dishes'],$rowDishes);
						$org[$j]['category'][$i]['dishes'][$k]['enc']= $this -> encrypt_decrypt('encrypt',$rowDishes['id']);
						$org[$j]['category'][$i]['dishes'][$k]['dish_image']=$imgs;
						$k++;
					}
					$i++;
				}
				$j++;
			}
			$stmt->close();
			$dbCon->close();
			return $org;
			
			
		}
	 
	  function selectedWellnessServiceMenuItemInfo($data)
		{
			function base64_to_jpeg($base64_string, $output_file) {
			$ifp = fopen( $output_file, 'wb' ); 
			$data = explode( ',', $base64_string );
			fwrite( $ifp, base64_decode( $data[1] ) );
			fclose( $ifp ); 
			return $output_file; 
			}
			$dbCon = AppModel::createConnection();
			$roomservice_id= $this -> encrypt_decrypt('decrypt',$data['item_id']);
			 
				$stmt = $dbCon->prepare("select wellness_available_services.id,dish_name,dish_detail,dish_image,dish_price from wellness_available_services left join dishes_detail_information on dishes_detail_information.id=wellness_available_services.service_id where wellness_available_services.id=?");
					$stmt->bind_param("i", $roomservice_id);
					$stmt->execute();
					$result2 = $stmt->get_result();
					$rowDishes = $result2->fetch_assoc();
						 $filename="../estorecss/".$rowDishes ['dish_image'].".txt"; if (file_exists($filename)) { $value_a=file_get_contents("../estorecss/".$rowDishes ['dish_image'].".txt"); $value_a=str_replace('"','',$value_a);  $imgs = base64_to_jpeg( $value_a, '../estorecss/tmp'.$rowDishes ['dish_image'].'.jpg' );  $imgs='../../../../'.$imgs; } else { $value_a="../../../../../html/usercontent/images/default-profile-pic.jpg";  $imgs="../../../../../html/usercontent/images/default-profile-pic.jpg"; }
						 $imgs=str_replace('../../../../../','https://www.safeqloud.com/',$imgs);
						$rowDishes['dish_image']=$imgs;
						$k++;
			$stmt->close();
			$dbCon->close();
			return $rowDishes;
			
			
		}
	 
	  function selectedWellnessServiceMenu($data)
		{
			function base64_to_jpeg($base64_string, $output_file) {
			$ifp = fopen( $output_file, 'wb' ); 
			$data = explode( ',', $base64_string );
			fwrite( $ifp, base64_decode( $data[1] ) );
			fclose( $ifp ); 
			return $output_file; 
			}
			$dbCon = AppModel::createConnection();
			$roomservice_id= $this -> encrypt_decrypt('decrypt',$data['hid']);
			 
			$stmt = $dbCon->prepare("select available_services,wellness_id from hotel_wellness_services where hotel_property_id=?");
			$stmt->bind_param("i", $roomservice_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$allDish='';
			$allRestu='';
			while($row= $result->fetch_assoc())
			{
				
				$allDish=$allDish.$row['available_services'].',';
				$allRestu=$allRestu.$row['wellness_id'].',';
			}
			
			
				$org=array();
				$i=0;
				 	$stmt = $dbCon->prepare("select wellness_available_services.id,dish_name,dish_detail,dish_image,dish_price from wellness_available_services left join dishes_detail_information on dishes_detail_information.id=wellness_available_services.service_id where find_in_set (wellness_available_services.id,?) and find_in_set (wellness_available_services.wellness_id,?)");
					$stmt->bind_param("ss", $allDish,$allRestu);
					$stmt->execute();
					$result2 = $stmt->get_result();
					while($rowDishes = $result2->fetch_assoc())
					{
						array_push($org,$rowDishes);
						 $filename="../estorecss/".$rowDishes ['dish_image'].".txt"; if (file_exists($filename)) { $value_a=file_get_contents("../estorecss/".$rowDishes ['dish_image'].".txt"); $value_a=str_replace('"','',$value_a);  $imgs = base64_to_jpeg( $value_a, '../estorecss/tmp'.$rowDishes ['dish_image'].'.jpg' );  $imgs='../../../../'.$imgs; } else { $value_a="../../../../../html/usercontent/images/default-profile-pic.jpg";  $imgs="../../../../../html/usercontent/images/default-profile-pic.jpg"; }
						
						 $imgs=str_replace('../../../../../','https://www.safeqloud.com/',$imgs);
						$org[$i]['enc']= $this -> encrypt_decrypt('encrypt',$rowDishes['id']);
						$org[$i]['dish_image']=$imgs;
						$i++;
					}
					 
				
			 
			$stmt->close();
			$dbCon->close();
			return $org;
			
			
		}
	 
	  function selectedRoomServiceMenuItemInfo($data)
		{
			function base64_to_jpeg($base64_string, $output_file) {
			$ifp = fopen( $output_file, 'wb' ); 
			$data = explode( ',', $base64_string );
			fwrite( $ifp, base64_decode( $data[1] ) );
			fclose( $ifp ); 
			return $output_file; 
			}
			$dbCon = AppModel::createConnection();
			$roomservice_id= $this -> encrypt_decrypt('decrypt',$data['item_id']);
				$stmt = $dbCon->prepare("select resturant_available_dishes.id,dish_name,dish_detail,dish_image,dish_price,temp_available_item from resturant_available_dishes left join dishes_detail_information on dishes_detail_information.id=resturant_available_dishes.dish_id where resturant_available_dishes.id=?");
					$stmt->bind_param("i", $roomservice_id);
					$stmt->execute();
					$result2 = $stmt->get_result();
					$rowDishes = $result2->fetch_assoc();
						 $filename="../estorecss/".$rowDishes ['dish_image'].".txt"; if (file_exists($filename)) { $value_a=file_get_contents("../estorecss/".$rowDishes ['dish_image'].".txt"); $value_a=str_replace('"','',$value_a);  $imgs = base64_to_jpeg( $value_a, '../estorecss/tmp'.$rowDishes ['dish_image'].'.jpg' );  $imgs='../../../../'.$imgs; } else { $value_a="../../../../../html/usercontent/images/default-profile-pic.jpg";  $imgs="../../../../../html/usercontent/images/default-profile-pic.jpg"; }
						 $imgs=str_replace('../../../../../','https://www.safeqloud.com/',$imgs);
						$rowDishes['dish_image']=$imgs;
						 
			$stmt->close();
			$dbCon->close();
			return $rowDishes;
			
			
		}
		
		
	 
	 
		
	function updateDependentCheckinIds($data)
    {
		
		$dbCon = AppModel::createConnection();
		$stmt = $dbCon->prepare("update user_certificates set dependents_id=? where certificate_key=?");
		/* bind parameters for markers */
		$stmt->bind_param("ss",$data['selected_dependents'], $data['certi']);
		$stmt->execute();
			 
		$stmt->close();
		$dbCon->close();
		return 1;	
		
    }
	
	
	
		function verifyUserBookingExists($data)
		{ 
		
			$dbCon = AppModel::createConnection();
			$id=$this->encrypt_decrypt('decrypt',$data['id']);
			
			$stmt = $dbCon->prepare("select user_id from user_certificates where certificate_key=? and is_connected=1");
			
			/* bind parameters for markers */
			$stmt->bind_param("s", $data['certi']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowUser = $result->fetch_assoc();
			 
			$stmt = $dbCon->prepare("select user_id from hotel_checkout_detail where id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $id);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowHotel = $result->fetch_assoc();
			if($rowUser['user_id']==$rowHotel['user_id'])
			{
			$stmt = $dbCon->prepare("select count(id) as num  from dependents   where id in (select dependent_id from dependent_guardian where guardian_user_id=? and is_approved=1) and  created_by=?  and id not in (select dependent_id from hotel_checkout_dependent_detail where hotel_checkout_id=?)");
			$stmt->bind_param("iii", $rowHotel['user_id'],$rowHotel['user_id'],$id);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();	
			if($row['num']==0)
			{
			$stmt->close();
			$dbCon->close();
			return 1;
			}
			else
			{
			$stmt = $dbCon->prepare("update user_certificates set hotel_checkin_id=? where certificate_key=?");
			/* bind parameters for markers */
			$stmt->bind_param("ss", $data['id'],$data['certi']);
			$stmt->execute();
			
			$stmt->close();
			$dbCon->close();
			return 2;		
			}
			}
			else
			{
			$stmt->close();
			$dbCon->close();
			return 0;		
			}
			
		 
		}
		
		
		
		function addDependentImages($data)
		{
			$dbCon = AppModel::createConnection();
			$data1 = strip_tags($data['ImageData']);
			$data1='url("data:image/png;base64,'.$data1.'")';
			//echo $data; die;
			define('UPLOAD_DIR','../estorecss/'); // image dir path
			$img_name1="new".microtime();
			file_put_contents(UPLOAD_DIR.$img_name1.".txt", $data1);
				 
			$arr=array();
			 
			if($data['imageId']==1)
			{
			$stmt = $dbCon->prepare("update dependents set front_image_path=? where id=?");
			}
			else
			{
			$stmt = $dbCon->prepare("update dependents set back_image_path=?,is_completed=1,is_passport_updated=1 where id=?");	
			}
			$stmt->bind_param("si",  $img_name1,$data['id']);	
			$stmt->execute();
			
			
			$stmt->close();
			$dbCon->close();
			return 1;	
			 
			 
		}
		
		function addDependentProfileImages($data)
		{
			$dbCon = AppModel::createConnection();
			$data1 = strip_tags($data['ImageData']);
			$data1='url("data:image/png;base64,'.$data1.'")';
			//echo $data; die;
			define('UPLOAD_DIR','../estorecss/'); // image dir path
			$img_name1="new".microtime();
			file_put_contents(UPLOAD_DIR.$img_name1.".txt", $data1);
			$stmt = $dbCon->prepare("update dependents set image_path=? where id=?");
			$stmt->bind_param("si",  $img_name1,$data['id']);	
			$stmt->execute();
			$stmt->close();
			$dbCon->close();
			return 1;	
			 
			 
		}
		
		function updateDependent($data)
		{
			$dbCon = AppModel::createConnection();
			$fname=htmlentities($data['FirstName'],ENT_NOQUOTES, 'UTF-8');
			$lname=htmlentities($data['last_name'],ENT_NOQUOTES, 'UTF-8');	
			
			if($data['is_ssn_available']==1)
			{
				$data['SocialSecurityNumber']=$data['SocialSecurityNumber'];
				$email=$data['SocialSecurityNumber'].'@safeqloud.com';
			}
			else
			{
				$stmt = $dbCon->prepare("select passport_number from dependents where id=?");
			
				/* bind parameters for markers */
				$stmt->bind_param("i", $data['id']);
				$stmt->execute();
				$result = $stmt->get_result();
				
				$row = $result->fetch_assoc();
				$data['SocialSecurityNumber']=$row['passport_number'];
				$email=$row['passport_number'].'@safeqloud.com';
			}
			
			
			if($data['is_same_address']==1)
			{
				$stmt = $dbCon->prepare("select address,city,port_number,zipcode from user_address where user_id=? and is_personal_address=1");
			
				/* bind parameters for markers */
				$stmt->bind_param("i", $data['UserId']);
				$stmt->execute();
				$result = $stmt->get_result();
				
				$row = $result->fetch_assoc();
				$data['address']=$row['address'];
				$data['city']=$row['city'];
				$data['port_number']=$row['port_number'];
				$data['zipcode']=$row['zipcode'];
			}
			 
			
			$stmt = $dbCon->prepare("select country_of_residence from user_logins where id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['UserId']);
			$stmt->execute();
			$result = $stmt->get_result();
			
			$row = $result->fetch_assoc();
			
			$stmt = $dbCon->prepare("update dependents set dependent_type=1,first_name=?,last_name=?,ssn=?,email=?,country_id=?,child_address=?,child_city=?,child_zip=?,child_port_number=?,is_address_same=?,is_ssn_available=?,birth_day=?,birth_month=?,birth_year=? where id=?");
			$stmt->bind_param("ssssissssiiiiii",$fname,$lname,$data['SocialSecurityNumber'],$email,$row['country_of_residence'],$data['address'],$data['city'],$data['zipcode'],$data['port_number'],$data['is_same_address'],$data['is_ssn_available'],$data['birth_day'],$data['birth_month'],$data['birth_year'],$data['id']);
			$stmt->execute();
			 
			$stmt->close();
			$dbCon->close();
			return $data['id'];
			 
			
		}
		
		function dependentDetail($data)
		{
			$dbCon = AppModel::createConnection();
			 
			$stmt = $dbCon->prepare("select * from dependents where id=?");
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			
			$stmt = $dbCon->prepare("select country_name from phone_country_code where id=?");
			/* bind parameters for markers */
			$stmt->bind_param("i", $row['country_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowCountry = $result->fetch_assoc();
			$row['country_name']=$rowCountry['country_name'];
			$filename="../estorecss/".$row ['image_path'].".txt"; if (file_exists($filename)) { $value_a=file_get_contents("../estorecss/".$row ['image_path'].".txt"); $value_a=str_replace('"','',$value_a);  $imgs = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$row ['image_path'].'.jpg' );  $imgs='../../../../'.$imgs; } else { $value_a="../../../../../html/usercontent/images/default-profile-pic.jpg";  $imgs="../../../../../html/usercontent/images/default-profile-pic.jpg"; }
			$imgs=str_replace('../../../../../','https://www.safeqloud.com/',$imgs);
			$row['image_path']=$imgs; 
			
			$filename="../estorecss/".$row ['front_image_path'].".txt"; if (file_exists($filename)) { $value_a=file_get_contents("../estorecss/".$row ['front_image_path'].".txt"); $value_a=str_replace('"','',$value_a);  $imgs = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$row ['front_image_path'].'.jpg' );  $imgs='../../../../'.$imgs; } else { $value_a="../../../../../html/usercontent/images/default-profile-pic.jpg";  $imgs="../../../../../html/usercontent/images/default-profile-pic.jpg"; }
			$imgs=str_replace('../../../../../','https://www.safeqloud.com/',$imgs);
			$row['front_image_path']=$imgs; 
			
			$filename="../estorecss/".$row ['back_image_path'].".txt"; if (file_exists($filename)) { $value_a=file_get_contents("../estorecss/".$row ['back_image_path'].".txt"); $value_a=str_replace('"','',$value_a);  $imgs = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$row ['back_image_path'].'.jpg' );  $imgs='../../../../'.$imgs; } else { $value_a="../../../../../html/usercontent/images/default-profile-pic.jpg";  $imgs="../../../../../html/usercontent/images/default-profile-pic.jpg"; }
			$imgs=str_replace('../../../../../','https://www.safeqloud.com/',$imgs);
			$row['back_image_path']=$imgs; 
			
			if($row['is_address_same']==1)
			{
				$stmt = $dbCon->prepare("select address,city,port_number,zipcode from user_address where user_id=? and is_personal_address=1");
			
				/* bind parameters for markers */
				$stmt->bind_param("i", $row['created_by']);
				$stmt->execute();
				$result = $stmt->get_result();
				
				$rowAddress = $result->fetch_assoc();
				$row['child_address']=$rowAddress['address'];
				$row['child_city']=$rowAddress['city'];
				$row['child_port_number']=$rowAddress['port_number'];
				$row['child_zip']=$rowAddress['zipcode'];	
			}
			
			$row['issue_date']='';
			$row['expiry_date']='';
			if($row['birth_day']==null)
			{
			$row['birth_day']='';
			$row['birth_month']='';
			$row['birth_year']='';	
			$row['dob']='Not available';
			$row['age']=0;
			}
			else
			{
			$date=$row['birth_day'].'-'.$row['birth_month'].'-'.$row['birth_year'];
			$row['dob']=date('d M Y',strtotime($date));
			$date1 = date('Y-m-d',strtotime($date));
			$date2 = date('Y-m-d');
			$diff = abs(strtotime($date2) - strtotime($date1));

			$row['age'] = floor($diff / (365*60*60*24));	
			}
			if($row['is_passport_updated']==null)
			{
			$row['passport_number']='';
			$row['issue_month']='';
			$row['issue_year']='';	
			$row['expiry_month']='';
			$row['expiry_year']='';				
			}
			
			$row['address']='';	
			$row['blood_group']='';	
			$row['allergic']='';	
			
			$row['p_country']=$row['country_id'];
			
			$stmt->close();
			$dbCon->close();
			return $row;
			 
			
		}
		
		function addDependent($data)
		{
			$dbCon = AppModel::createConnection();
		
			$fname=htmlentities($data['FirstName'],ENT_NOQUOTES, 'UTF-8');
			$lname=htmlentities($data['last_name'],ENT_NOQUOTES, 'UTF-8');	
			
			if($data['is_ssn_available']==1)
			{
				$data['SocialSecurityNumber']=$data['SocialSecurityNumber'];
				$email=$data['SocialSecurityNumber'].'@safeqloud.com';
			}
			else
			{
				$data['SocialSecurityNumber']='';
				$email='';
			}
			
			
			if($data['is_same_address']==1)
			{
				$stmt = $dbCon->prepare("select address,city,port_number,zipcode from user_address where user_id=? and is_personal_address=1");
			
				/* bind parameters for markers */
				$stmt->bind_param("i", $data['UserId']);
				$stmt->execute();
				$result = $stmt->get_result();
				
				$row = $result->fetch_assoc();
				$data['address']=$row['address'];
				$data['city']=$row['city'];
				$data['port_number']=$row['port_number'];
				$data['zipcode']=$row['zipcode'];
			}
			 
			
			$stmt = $dbCon->prepare("select country_of_residence from user_logins where id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['UserId']);
			$stmt->execute();
			$result = $stmt->get_result();
			
			$rowCountry = $result->fetch_assoc();
			
			$stmt = $dbCon->prepare("insert into dependents(dependent_type,first_name,last_name,ssn,created_by,created_on,email,country_id,is_completed,child_address,child_city,child_zip,child_port_number,is_address_same,is_ssn_available,birth_day,birth_month,birth_year)
			values(?,?,?,?,?,now(),?,?,?,?, ?,?,?, ?,?,?, ?,?)");
			$stmt->bind_param("isssisiissssiiiii",$data['DependentType'],$fname,$lname,$data['SocialSecurityNumber'],$data['UserId'],$email,$rowCountry['country_of_residence'],$data['is_ssn_available'],$data['address'],$data['city'],$data['zipcode'],$data['port_number'],$data['is_same_address'],$data['is_ssn_available'],$data['birth_day'],$data['birth_month'],$data['birth_year']);
			$stmt->execute();
			 
			$id=$stmt->insert_id;
				
			$stmt = $dbCon->prepare("select email,country_of_residence,phone_number,phone_country_code.country_code,ssn,country_phone  from user_logins left join user_profiles on user_profiles.user_logins_id=user_logins.id left join country on user_logins.country_of_residence=country.id left join phone_country_code on phone_country_code.country_name=country.country_name where user_logins.id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['UserId']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			$st=1;
			$stmt = $dbCon->prepare("insert into dependent_guardian(dependent_id,guardian_ssn,guardian_email,guardian_user_id, inviting_person_user_id,created_on,is_approved,guardian_phone,guardian_country)
			values(?,?,?,?,?,now(),?,?,?)");
			$stmt->bind_param("issiiiss",$id,$row['ssn'],$row['email'],$data['UserId'],$data['UserId'],$st,$row['phone_number'],$row['country_phone']);
			$stmt->execute();
			
			
			$phone="+".trim($row['country_code'])."".trim($row['phone_number']);
			
			$subject='Dependent added';
			$to=$phone;
			$html=$fname.' '.$lname.' has been added as your dependent. please confirm or reject the same.';
			$res=sendSms($subject, $to, $html);
			$rs=json_decode($res,true);
			$to=$row['email'];
				
			$stmt->close();
			$dbCon->close();
			return $id;
			 
			
		}
		
		function addDependentPassport($data)
		{
			$dbCon = AppModel::createConnection();
			
			$stmt = $dbCon->prepare("select ssn,is_ssn_available,created_by from dependents where id=?");
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$dependent = $result->fetch_assoc();
			
			$stmt = $dbCon->prepare("select country_of_residence from user_logins where id=?");
			/* bind parameters for markers */
			$stmt->bind_param("i", $dependent['created_by']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			
			$stmt = $dbCon->prepare("update dependents set country_id=?,p_country=?,passport_number=?,issue_month=?,issue_year=?,expiry_month=?, expiry_year=? where id=?");
			$stmt->bind_param("iisssssi",$row['country_of_residence'],$row['country_of_residence'],$data['PassportNumber'],$data['IssueMonth'],$data['IssueYear'],$data['ExpiryMonth'],$data['ExpiryYear'],$data['id']);
			$stmt->execute();
			
			if($dependent['is_ssn_available']==0)
			{
			$email=$data['PassportNumber'].'@safeqloud.com';
			$stmt = $dbCon->prepare("update dependents set ssn=?,email=? where id=?");
			$stmt->bind_param("ssi",$data['PassportNumber'],$email,$data['id']);
			$stmt->execute();	
			}
			
			$stmt->close();
			$dbCon->close();
			return 1;
		}
		
		function checkSsn($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select country_of_residence from user_logins where id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['UserId']);
			$stmt->execute();
			$result = $stmt->get_result();
			
			$row = $result->fetch_assoc();
			
			$stmt = $dbCon->prepare("select id from dependents where ssn=? and country_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("si", $data['SocialSecurityNumber'],$row['country_of_residence']);
			$stmt->execute();
			$result = $stmt->get_result();
			
			$row = $result->fetch_assoc();
			if(empty($row))
			{
				$stmt->close();
				$dbCon->close();
				return 1;
			
			}
			else
			{
				$stmt->close();
				$dbCon->close();
				return 0;
			}
			
		}
	
	
	function checkDependentSsn($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select country_of_residence from user_logins where id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['UserId']);
			$stmt->execute();
			$result = $stmt->get_result();
			
			$row = $result->fetch_assoc();
			
			$stmt = $dbCon->prepare("select id from dependents where ssn=? and country_id=? and id!=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("sii", $data['SocialSecurityNumber'],$row['country_of_residence'],$data['id']);
			$stmt->execute();
			$result = $stmt->get_result();
			
			$row = $result->fetch_assoc();
			if(empty($row))
			{
				$stmt->close();
				$dbCon->close();
				return 1;
			
			}
			else
			{
				$stmt->close();
				$dbCon->close();
				return 0;
			}
			
		}
	
	function checkPassport($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select country_of_residence from user_logins where id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['UserId']);
			$stmt->execute();
			$result = $stmt->get_result();
			
			$row = $result->fetch_assoc();
			
			
			$stmt = $dbCon->prepare("select id  from dependents   where  passport_number=? and country_id=? and id!=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("sii", $data['PassportNumber'],$row['country_of_residence'],$data['id']);
			$stmt->execute();
			$result = $stmt->get_result();
			
			$rowPass = $result->fetch_assoc();
			 
			if(empty($rowPass))
			{
				$stmt->close();
				$dbCon->close();
				return 1;
			}
			else
			{
				$stmt->close();
				$dbCon->close();
				return 0;
			}
			 
			
		}
	
	
		function dependentsList($data)
		{
			 $dbCon = AppModel::createConnection();
			
			$stmt = $dbCon->prepare("select id,concat_ws(' ',first_name,last_name) as name,ssn,first_name,email,dependent_type,created_on,image_path  from dependents where id in (select dependent_id from dependent_guardian where guardian_user_id=? and is_approved=1) and created_by=? and dependent_type=1");
			
			/* bind parameters for markers */
			$stmt->bind_param("ii", $data['user_id'], $data['user_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			while($row = $result->fetch_assoc())
			{
			array_push($org,$row);
			}
			$stmt->close();
			$dbCon->close();
			return $org;
		}
		
		
		 function completeMenu()
		{
			$dbCon = AppModel::createConnection();
			 
			$resturant_id=$this -> encrypt_decrypt('decrypt',$_POST['id']);
			$stmt = $dbCon->prepare("select distinct serve_type,serve_available from resturant_available_dishes where resturant_id=? and serve_available=1 order by serve_type");
			$stmt->bind_param("i", $resturant_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			 $i=0;
			while($row= $result->fetch_assoc())
			{
				 
				array_push($org,$row);
					$k=0;
					$org[$i]['dishes']=array();
					$stmt = $dbCon->prepare("select resturant_available_dishes.id,dish_name,dish_detail,dish_image,dish_price,temp_available_item from resturant_available_dishes left join dishes_detail_information on dishes_detail_information.id=resturant_available_dishes.dish_id where resturant_id=? and serve_type=?");
					$stmt->bind_param("ii", $resturant_id,$row['serve_type']);
					$stmt->execute();
					$result2 = $stmt->get_result();
					while($rowDishes = $result2->fetch_assoc())
					{
						$rowDishes['dish_name']=html_entity_decode($rowDishes['dish_name'],ENT_NOQUOTES, 'UTF-8'); 
						$rowDishes['dish_detail']=html_entity_decode($rowDishes['dish_detail'],ENT_NOQUOTES, 'UTF-8'); 
						 $filename="../estorecss/".$rowDishes ['dish_image'].".txt"; if (file_exists($filename)) { $value_a=file_get_contents("../estorecss/".$rowDishes ['dish_image'].".txt"); $value_a=str_replace('"','',$value_a);  $imgs =$this-> base64_to_jpeg( $value_a, '../estorecss/tmp'.$rowDishes ['dish_image'].'.jpg' ); } else { $value_a="../html/usercontent/images/default-profile-pic.jpg";  $imgs="../html/usercontent/images/default-profile-pic.jpg"; }
						$imgs=str_replace('../','https://www.safeqloud.com/',$imgs);
						array_push($org[$i]['dishes'],$rowDishes);
						$org[$i]['dishes'][$k]['dish_image']=$imgs;
						$k++;
					}
					$i++;
				
			}
			$stmt->close();
			$dbCon->close();
			return $org;
			
			
		}
	
		
	function completeMenuOld()
		{
			 
			$dbCon = AppModel::createConnection();
			$resturant_id= $this -> encrypt_decrypt('decrypt',$_POST['id']);
			 
			$org=array();
			 
				$i=0;
				$stmt = $dbCon->prepare("select distinct category_food,food_category,place_of_display from resturant_available_dishes left join food_category on food_category.id=resturant_available_dishes.category_food where resturant_available_dishes.resturant_id=?  order by place_of_display");
				$stmt->bind_param("i", $resturant_id);
				$stmt->execute();
				$result1 = $stmt->get_result();
				while($rowCategory = $result1->fetch_assoc())
				{
					array_push($org,$rowCategory);
					 
					$org[$i]['dishes']=array();
					$stmt = $dbCon->prepare("select resturant_available_dishes.id,dish_name,dish_detail,dish_image,dish_price,temp_available_item from resturant_available_dishes left join dishes_detail_information on dishes_detail_information.id=resturant_available_dishes.dish_id where resturant_id=? and category_food=?");
					$stmt->bind_param("ii", $resturant_id,$rowCategory['category_food']);
					$stmt->execute();
					$result2 = $stmt->get_result();
					while($rowDishes = $result2->fetch_assoc())
					{
						  
						array_push($org[$i]['dishes'],$rowDishes);
						 
					}
					$i++;
				}
			 $stmt->close();
			$dbCon->close();
			return $org;
			
			
		}
	 
		
		
	function resturantImages()
	{
			$dbCon = AppModel::createConnection();
			$id= $this -> encrypt_decrypt('decrypt',$_POST['id']);
		$stmt = $dbCon->prepare("select big_image_path,small_image1_path,small_image2_path from business_dashboard_images where business_type=3 and business_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $id);
			$stmt->execute();
			$resultImages = $stmt->get_result();
			$rowImages = $resultImages->fetch_assoc();
			 
			$bigImage=$rowImages['big_image_path'];	
			$filename="../estorecss/".$bigImage.".txt"; $value_a=file_get_contents("../estorecss/".$bigImage.".txt"); $value_a=str_replace('"','',$value_a); $rowImages['image_path'] = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$bigImage.'.jpg' );
			 
			$rowImages['image_path']=str_replace('../','https://www.safeqloud.com/',$rowImages['image_path']);
			$org[0]=$rowImages;

			$bigImage=$rowImages['small_image1_path'];	
			$filename="../estorecss/".$bigImage.".txt"; $value_a=file_get_contents("../estorecss/".$bigImage.".txt"); $value_a=str_replace('"','',$value_a); $rowImages['image_path'] = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$bigImage.'.jpg' );
			 
			$rowImages['image_path']=str_replace('../','https://www.safeqloud.com/',$rowImages['image_path']);
			$org[1]=$rowImages;
			
			$bigImage=$rowImages['small_image2_path'];	
			$filename="../estorecss/".$bigImage.".txt"; $value_a=file_get_contents("../estorecss/".$bigImage.".txt"); $value_a=str_replace('"','',$value_a); $rowImages['image_path'] = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$bigImage.'.jpg' );
			 
			$rowImages['image_path']=str_replace('../','https://www.safeqloud.com/',$rowImages['image_path']);
			$org[2]=$rowImages;
			
			$stmt->close();
			$dbCon->close();
			  
			return $org;
			
	}
	
	function resturantCityList()
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select distinct city_v as city from property_location where id in(select property_id from resturant_information)");
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			while($row = $result->fetch_assoc())
			{
			array_push($org,$row);
			}
			 
			$stmt->close();
			$dbCon->close();
			return $org;
		}
	
	
	function resturantList()
		{
			$dbCon = AppModel::createConnection();
			
			$search='%'.$_POST['city'].'%';
			 	 
			$stmt = $dbCon->prepare("select description,property_location.latitude,property_location.longitude,profile_pic,country_code,phone,dress_code,table_reservation,pets_allowed, form_of_payment, broadcast_type, broadcast_channel, resturant_name as property_nickname,resturant_type, resturant_information.property_id,property_location.visiting_address as address,property_location.port_number,resturant_information.id  from resturant_information left join property_location on property_location.id=resturant_information.property_id left join company_profiles on property_location.company_id=company_profiles.company_id left join phone_country_code on phone_country_code.country_name=company_profiles.phone_country where property_location.visiting_address like ? or property_location.state_v like ? or property_location.city_v like ?");
			$stmt->bind_param("sss", $search,$search,$search);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			$j=0;
			while($row = $result->fetch_assoc())
			{
			$row['enc']=$this -> encrypt_decrypt('encrypt',$row['id']);	 
			array_push($org,$row);
			
			$org[$j]['images']=array();
			
			$stmt = $dbCon->prepare("select big_image_path,small_image1_path,small_image2_path from business_dashboard_images where business_type=3 and business_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $row['id']);
			$stmt->execute();
			$resultImages = $stmt->get_result();
			$rowImages = $resultImages->fetch_assoc();
			 
			$bigImage=$rowImages['big_image_path'];	
			$filename="../estorecss/".$bigImage.".txt"; $value_a=file_get_contents("../estorecss/".$bigImage.".txt"); $value_a=str_replace('"','',$value_a); $rowImages['image_path'] = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$bigImage.'.jpg' );
			 
			$rowImages['image_path']=str_replace('../','https://www.safeqloud.com/',$rowImages['image_path']);
			$org[$j]['images'][0]=$rowImages;

			$bigImage=$rowImages['small_image1_path'];	
			$filename="../estorecss/".$bigImage.".txt"; $value_a=file_get_contents("../estorecss/".$bigImage.".txt"); $value_a=str_replace('"','',$value_a); $rowImages['image_path'] = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$bigImage.'.jpg' );
			 
			$rowImages['image_path']=str_replace('../','https://www.safeqloud.com/',$rowImages['image_path']);
			$org[$j]['images'][1]=$rowImages;
			
			$bigImage=$rowImages['small_image2_path'];	
			$filename="../estorecss/".$bigImage.".txt"; $value_a=file_get_contents("../estorecss/".$bigImage.".txt"); $value_a=str_replace('"','',$value_a); $rowImages['image_path'] = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$bigImage.'.jpg' );
			 
			$rowImages['image_path']=str_replace('../','https://www.safeqloud.com/',$rowImages['image_path']);
			$org[$j]['images'][2]=$rowImages;
			
			$j++;
			}
			 
			$stmt->close();
			$dbCon->close();
			  
			return $org;
			
			
		}
	
	function resturantInfo()
		{
			$dbCon = AppModel::createConnection();
			$id= $this -> encrypt_decrypt('decrypt',$_POST['id']);
			 
			$stmt = $dbCon->prepare("select resturant_information.description,property_location.latitude,property_location.longitude,profile_pic,country_code,phone,dress_code,table_reservation,pets_allowed, form_of_payment, broadcast_type, broadcast_channel, resturant_name as property_nickname,resturant_type, resturant_information.property_id,property_location.visiting_address as address,resturant_information.id  from resturant_information left join property_location on property_location.id=resturant_information.property_id left join company_profiles on property_location.company_id=company_profiles.company_id left join phone_country_code on phone_country_code.country_name=company_profiles.phone_country where resturant_information.id=?");
			$stmt->bind_param("i", $id);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			$stmt->close();
			$dbCon->close();
			  
			return $row;
			
			
		}
	
	
	function daycareRequestCount($data)
		{
				$dbCon = AppModel::createConnection();
				$company_id= $data['company_id'];
				$org=array();
				$stmt = $dbCon->prepare("select count(id) as num from dropped_off_children where child_id in (select id from child_care_info where company_id=?) and is_approved=0 and is_left=0");
				$stmt->bind_param("i", $company_id);
				$stmt->execute();
				$result_received = $stmt->get_result();
				$row_received = $result_received->fetch_assoc();
				
				$stmt = $dbCon->prepare("select count(id) as num from dropped_off_children where child_id in (select id from child_care_info where company_id=?) and is_approved=1 and is_left=1");
				$stmt->bind_param("i", $company_id);
				$stmt->execute();
				$result_picked = $stmt->get_result();
				$row_picked = $result_picked->fetch_assoc();
				$org['received']=$row_received['num'];
				$org['picked']=$row_picked['num'];
				$org['ttl']=$row_received['num']+$row_picked['num'];
				
				$stmt = $dbCon->prepare("select count(id) as num from child_care_info where id not in (select child_id from parent_info where child_id in (select id from child_care_info where company_id=?) ) and company_id=?");
				$stmt->bind_param("ii", $company_id,$company_id);
				$stmt->execute();
				$result_received = $stmt->get_result();
				$row_received = $result_received->fetch_assoc();
				$org['inactive']=$row_received['num'];
				$org['ttl']=$org['ttl']+$row_received['num'];
				
				$stmt = $dbCon->prepare("select duns_is_approved from companies where id=?");
				$stmt->bind_param("i", $company_id);
				$stmt->execute();
				$result_received = $stmt->get_result();
				$row_received = $result_received->fetch_assoc();
				
				$org['duns_is_approved']=$row_received['duns_is_approved'];
				$stmt->close();
				$dbCon->close();
				return $org;
			
			
		}
		
		 function dunsInfoCount($data)
		{
				$dbCon = AppModel::createConnection();
				$company_id= $this -> encrypt_decrypt('decrypt',$data['cid']);
				 
				$stmt = $dbCon->prepare("select duns_is_approved from companies where id=?");
				$stmt->bind_param("i", $company_id);
				$stmt->execute();
				$result_received = $stmt->get_result();
				$row_received = $result_received->fetch_assoc();
				 
				$stmt->close();
				$dbCon->close();
				return $row_received['duns_is_approved'];
			
			
		}
	
	function apartmentAmenitiesDetailInfo()
		{
			 
			$dbCon = AppModel::createConnection();
			$hotel_id= $this -> encrypt_decrypt('decrypt',$_POST['id']);  
			 
			$stmt = $dbCon->prepare("select * from apartment_amenities where id in (select amenity_id from user_apartment_amenities_detail where user_amenitiy_category_id in (select id from user_apartment_amenities_category_detail where user_address_id=?))");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $hotel_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			while($row = $result->fetch_assoc())
			{
			array_push($org,$row);	
			}
				$stmt->close();
				$dbCon->close();
				 
				return $org;
			
		}
		
	
	function apartmentDetailInfo()
		{
			 
			$dbCon = AppModel::createConnection();
			$hotel_id= $this -> encrypt_decrypt('decrypt',$_POST['id']);  
			 
			$stmt = $dbCon->prepare("select * from user_address where id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $hotel_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			
			 $stmt = $dbCon->prepare("select count(id) as num from user_apartment_bedrooms where user_address_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $row['id']);
			$stmt->execute();
			$resultBedrooms = $stmt->get_result();
			$rowBedrooms = $resultBedrooms->fetch_assoc();
			
			$row['bedrooms']=$rowBedrooms['num'];
			
			 $stmt = $dbCon->prepare("select count(id) as num from user_apartment_bedrooms_beds where bedroom_id in (select id from user_apartment_bedrooms where user_address_id=?)");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $row['id']);
			$stmt->execute();
			$resultBedrooms = $stmt->get_result();
			$rowBedrooms = $resultBedrooms->fetch_assoc();
			
			$row['guests']=$rowBedrooms['num'];
			
			
			 $stmt = $dbCon->prepare("select sum(toilet_and_sink) as toilet,count(id) as bath from user_apartment_bathroom_detail where   user_address_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $row['id']);
			$stmt->execute();
			$resultBedrooms = $stmt->get_result();
			$rowBedrooms = $resultBedrooms->fetch_assoc();
			
			$row['toilet']=$rowBedrooms['toilet'];
			$row['bath']=$rowBedrooms['bath'];
			
			
			
			 $stmt = $dbCon->prepare("select apartment_photo_path as image_path from user_apartment_photos where user_address_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $row['id']);
			$stmt->execute();
			$resultImage = $stmt->get_result();
			$rowImage = $resultImage->fetch_assoc();
			 
			
			$bigImage=$rowImage['image_path'];	
			 
			 
			 $filename="../estorecss/".$bigImage.".txt"; $value_a=file_get_contents("../estorecss/".$bigImage.".txt"); $value_a=str_replace('"','',$value_a); $row['image_path'] = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$bigImage.'.jpg' );
			 $row['enc']= $this -> encrypt_decrypt('encrypt',$row['id']);  
			$row['image_path']=str_replace('../','https://www.safeqloud.com/',$row['image_path']);
			 
			 $stmt = $dbCon->prepare("select min(minimum_price) as price from user_apartment_pricing_info where user_address_id=?");
			
				/* bind parameters for markers */
				$stmt->bind_param("i", $row['id']);
				$stmt->execute();
				$resultPrice = $stmt->get_result();
				$rowPrice = $resultPrice->fetch_assoc();
				$row['price']=$rowPrice['price'];
			
			
				$stmt->close();
				$dbCon->close();
				 
				return $row;
			
		}
		
		function apartmentImages()
		{
			$dbCon = AppModel::createConnection();
			$hotel_id= $this -> encrypt_decrypt('decrypt',$_POST['id']);  
			$stmt = $dbCon->prepare("select apartment_photo_path as image_path from user_apartment_photos where user_address_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $hotel_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			while($row = $result->fetch_assoc())
			{
			 $filename="../estorecss/".$row['image_path'].".txt"; $value_a=file_get_contents("../estorecss/".$row['image_path'].".txt"); $value_a=str_replace('"','',$value_a); $row['image_path1'] = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$row['image_path'].'.jpg' );
			$row['image_path1']=str_replace('../','safeqloud.com/',$row['image_path1']);
			array_push($org,$row);
			}
			return $org;
			
		}
		
		
	function apartmentDetailInfoDstrictApp($data)
		{
			 
			$dbCon = AppModel::createConnection();
			 
			$stmt = $dbCon->prepare("select room_type_id,user_id,card_id,checkin_date,checkout_date,guest_adult,guest_children,delivery_address_id from hotel_checkout_detail where id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowApartment = $result->fetch_assoc();
			$guest_id=$rowApartment['user_id'];
			$hotel_id= $rowApartment['room_type_id'];  
			 
			$stmt = $dbCon->prepare("select * from user_address where id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $hotel_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			$row['address']=html_entity_decode($row['address'],ENT_NOQUOTES, 'UTF-8'); 
			$row['description']=html_entity_decode($row['apartment_description'],ENT_NOQUOTES, 'UTF-8'); 
			$stmt = $dbCon->prepare("select * from user_address where user_id=? and is_personal_address=1");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $row['user_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowUserAddress = $result->fetch_assoc();
			
			
			$row['you_address']=html_entity_decode($rowUserAddress['address'],ENT_NOQUOTES, 'UTF-8'); 
			$row['you_city']=html_entity_decode($rowUserAddress['city'],ENT_NOQUOTES, 'UTF-8'); 
			$row['you_zipcode']=html_entity_decode($rowUserAddress['zipcode'],ENT_NOQUOTES, 'UTF-8'); 
			$row['you_port_number']=html_entity_decode($rowUserAddress['port_number'],ENT_NOQUOTES, 'UTF-8'); 
			
			$stmt = $dbCon->prepare("select card_number from user_cards where id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $rowApartment['card_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowGuestCard = $result->fetch_assoc();
			$row['card_detail']='Visa'.substr($rowGuestCard['card_number'],-4);
			$row['duration']=date('d M',strtotime($rowApartment['checkin_date'])).'-'.date('d M',strtotime($rowApartment['checkout_date']));
			$row['check_in_date']=date('D, d M Y',strtotime($rowApartment['checkin_date']));
			$row['checked_out_date']=date('D, d M Y',strtotime($rowApartment['checkout_date']));
			$row['guest']=$rowApartment['guest_adult'].' adults & '.$rowApartment['guest_children'].' children';
			
			$stmt = $dbCon->prepare("select concat_ws(' ',first_name,last_name) as name,country_of_residence,phone_number,country_code,email from user_logins left join user_profiles on user_profiles.user_logins_id=user_logins.id left join phone_country_code on phone_country_code.id=user_logins.country_of_residence where user_logins.id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $row['user_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowUser = $result->fetch_assoc();
			
			$stmt = $dbCon->prepare("select tenant_type from landloard_building_tenant where tenant_email=? and building_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("si", $rowUser['email'],$row['building_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowTenant = $result->fetch_assoc();
			
			if(empty($rowTenant))
			{
			$row['payment']=0;
			}
			else
			{
				if($rowTenant['tenant_type']==1)
				{
					$row['payment']=1;
				}
				else
				{
					$row['payment']=0;
				}
			}
			
			$row['host_name']=$rowUser['name'];
			$row['host_email']=$rowUser['email'];
			$row['host_phone']='+'.$rowUser['country_code'].' '.$rowUser['phone_number'];
			
			
			$stmt = $dbCon->prepare("select concat_ws(' ',first_name,last_name) as name,country_of_residence,phone_number,country_code,email from user_logins left join user_profiles on user_profiles.user_logins_id=user_logins.id left join phone_country_code on phone_country_code.id=user_logins.country_of_residence where user_logins.id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $guest_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowGuest = $result->fetch_assoc();
			
			
			$row['guest_name']=$rowGuest['name'];
			$row['guest_email']=$rowGuest['email'];
			$row['guest_phone']='+'.$rowGuest['country_code'].' '.$rowGuest['phone_number'];
			$row['guest_id']='Passport';
			
			
			$stmt = $dbCon->prepare("select count(id) as num from user_apartment_bedrooms where user_address_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $row['id']);
			$stmt->execute();
			$resultBedrooms = $stmt->get_result();
			$rowBedrooms = $resultBedrooms->fetch_assoc();
			
			$row['bedrooms']=$rowBedrooms['num'];
			
			 $stmt = $dbCon->prepare("select count(id) as num from user_apartment_bedrooms_beds where bedroom_id in (select id from user_apartment_bedrooms where user_address_id=?)");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $row['id']);
			$stmt->execute();
			$resultBedrooms = $stmt->get_result();
			$rowBedrooms = $resultBedrooms->fetch_assoc();
			
			$row['guests']=$rowBedrooms['num'];
			
			
			 $stmt = $dbCon->prepare("select sum(toilet_and_sink) as toilet,count(id) as bath from user_apartment_bathroom_detail where   user_address_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $row['id']);
			$stmt->execute();
			$resultBedrooms = $stmt->get_result();
			$rowBedrooms = $resultBedrooms->fetch_assoc();
			
			$row['toilet']=$rowBedrooms['toilet'];
			$row['bath']=$rowBedrooms['bath'];
		
			
			
			 $stmt = $dbCon->prepare("select apartment_photo_path as image_path from user_apartment_photos where user_address_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $row['id']);
			$stmt->execute();
			$resultImage = $stmt->get_result();
			$rowImage = $resultImage->fetch_assoc();
			 
			
			$bigImage=$rowImage['image_path'];	
			 
			 
			 $filename="../estorecss/".$bigImage.".txt"; $value_a=file_get_contents("../estorecss/".$bigImage.".txt"); $value_a=str_replace('"','',$value_a); $row['image_path'] = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$bigImage.'.jpg' );
			 $row['enc']= $this -> encrypt_decrypt('encrypt',$row['id']);  
			$row['image_path']=str_replace('../','https://www.safeqloud.com/',$row['image_path']);
			 
			 $stmt = $dbCon->prepare("select min(minimum_price) as price from user_apartment_pricing_info where user_address_id=?");
			
				/* bind parameters for markers */
				$stmt->bind_param("i", $row['id']);
				$stmt->execute();
				$resultPrice = $stmt->get_result();
				$rowPrice = $resultPrice->fetch_assoc();
				$row['price']=$rowPrice['price'];
			
			
				$stmt->close();
				$dbCon->close();
				 
				return $row;
			
		}
			
			
	function apartmentList()
	{
		 
			$dbCon = AppModel::createConnection();
			 
			$search='%'.$_POST['city'].'%';
			$total_days=round(($_POST['end_date']-$_POST['start_date']) / (60 * 60 * 24));
			 $strt=date('Y-m-d',$_POST['start_date']);
			 $end=date('Y-m-d',$_POST['end_date']);
			 
			$stmt = $dbCon->prepare("select * from user_address where is_published=1 and (state like ? or city like ?) and district_short_rent=1 and id not in (SELECT room_type_id from hotel_checkout_detail where hotel_property_type=2  and ((checkin_date BETWEEN ? AND ?) or (checkout_date BETWEEN ? AND ?)))");
			
			//$stmt = $dbCon->prepare("select * from user_address where is_published=1 and state like ? and district_short_rent=1");
			
			/* bind parameters for markers */
			$stmt->bind_param("ssssss", $search,$search, $strt,$end, $strt,$end);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			
			$j=0;
			while($row = $result->fetch_assoc())
			{
			 
			$skip=0;
			$price=0;
			 for($i=0;$i<$total_days;$i++)
			 {
			 
			$stmt = $dbCon->prepare("select pricing_start_date,pricing_end_date,monday_price,tuesday_price,wednesday_price,thursday_price,friday_price,saturday_price,sunday_price,shortest_duration,monday_open,tuesday_open,wednesday_open,thursday_open,friday_open,saturday_open,sunday_open from user_apartment_pricing_info where user_address_id=? and (id in (select id from user_apartment_pricing_info where pricing_start_date<=? && pricing_end_date>=?) || id in (select id from user_apartment_pricing_info where  pricing_start_date>=? && pricing_end_date<=?) || id in (select id from user_apartment_pricing_info where pricing_start_date<=?  && pricing_end_date<=?))");
			
			/* bind parameters for markers */
			$stmt->bind_param("issssss", $row['id'],$_POST['start_date'],$_POST['end_date'],$_POST['start_date'],$_POST['end_date'],$_POST['start_date'],$_POST['end_date']);
			$stmt->execute();
			$resultPrice = $stmt->get_result();
			while($rowPrice = $resultPrice->fetch_assoc())
			{
			 
			if(empty($rowPrice))
			{
			$skip=1;
			break;	
			}
		 
			if($rowPrice['shortest_duration']>$total_days)
			{
				 
				$skip=1;
				break;
			}
			$currentdate=strtotime("+".$i." days", $_POST['start_date']);
			$c=date('Y-m-d',$currentdate);	
			 
			$stmt = $dbCon->prepare("select count(blocked_date) as num from user_apartment_blocked_dates where blocked_date=? and user_address_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("si", $currentdate,$row['id']);
			$stmt->execute();
			$blockedDate = $stmt->get_result();
			$rowBlocked = $blockedDate->fetch_assoc();
			 
			if($rowBlocked['num']==1)
			{
				$skip=1;
			 
				break;	
			}
				
			if($rowPrice['pricing_start_date']<=strtotime($c) || $rowPrice['pricing_end_date']>=strtotime($c))
			{
			//echo $rowPrice['pricing_start_date'].'-'.strtotime($c).'-'.$rowPrice['pricing_end_date'].'</br>';
			$d1 = new DateTime($c);
			$day=$d1->format('w');
			 
			if($day==0)
			{
				 
				if($rowPrice['sunday_open']==0)
				{
				$skip=1;
				//echo $day.'-'.$skip.'/'.$c;	
				break;
				}
				else
				{
				$price=$price+$rowPrice['sunday_price'];	
				break;
				}
				
			}
			
			else if($day==1)
			{
				if($rowPrice['monday_open']==0)
				{
				$skip=1;
				//echo $day.'-'.$skip.'/'.$c;	
				break;
				}
				else
				{
				$price=$price+$rowPrice['monday_price'];
				break;				
				}
				
			}
			else if($day==2)
			{
				if($rowPrice['tuesday_open']==0)
				{
				$skip=1;
				////echo $day.'-'.$skip.'/'.$c;		
				break;
				}
				else
				{
				$price=$price+$rowPrice['tuesday_price'];
			    break;
				}
				
			}
			
			else if($day==3)
			{
				if($rowPrice['wednesday_open']==0)
				{
				$skip=1;
				////echo $day.'-'.$skip.'/'.$c;		
				break;
				}
				else
				{
				$price=$price+$rowPrice['wednesday_price'];	
				break;
				}
				
			}
			else if($day==4)
			{
				if($rowPrice['thursday_open']==0)
				{
				$skip=1;
				////echo $day.'-'.$skip.'/'.$c;		
				break;
				}
				else
				{
				$price=$price+$rowPrice['thursday_price'];	
				break;
				}
				
			}
			else if($day==5)
			{
				if($rowPrice['friday_open']==0)
				{
				$skip=1;
				////echo $day.'-'.$skip.'/'.$c;		
				break;
				}
				else
				{
				$price=$price+$rowPrice['friday_price'];
				break;				
				}
				
			}
			else if($day==6)
			{
				if($rowPrice['saturday_open']==0)
				{
				$skip=1;
				////echo $day.'-'.$skip.'/'.$c;		
				break;
				}
				else
				{
				$price=$price+$rowPrice['saturday_price'];
				break;
				}
				
			}
			}
			}
			if($skip==1)
			{
				 
				break;
			}
			}
		
			if($skip==1)
			{
				continue;
			}
			else
			{
			$row['price']=round($price/$total_days);
			}
			
			
			
		  
			$stmt = $dbCon->prepare("select apartment_photo_path as image_path from user_apartment_photos where user_address_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $row['id']);
			$stmt->execute();
			$resultImage = $stmt->get_result();
			$rowImage = $resultImage->fetch_assoc();
			 
			
			$bigImage=$rowImage['image_path'];	
			 
			 
			 $filename="../estorecss/".$bigImage.".txt"; $value_a=file_get_contents("../estorecss/".$bigImage.".txt"); $value_a=str_replace('"','',$value_a); $row['image_path'] = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$bigImage.'.jpg' );
			 $row['enc']= $this -> encrypt_decrypt('encrypt',$row['id']);  
			$row['image_path']=str_replace('../','https://www.safeqloud.com/',$row['image_path']);
			array_push($org,$row);
			$org[$j]['images']=array();
			
			$stmt = $dbCon->prepare("select apartment_photo_path as image_path from user_apartment_photos where user_address_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $row['id']);
			$stmt->execute();
			$resultImages = $stmt->get_result();
			while($rowImages = $resultImages->fetch_assoc())
			{
			$bigImage=$rowImages['image_path'];	
			$filename="../estorecss/".$bigImage.".txt"; $value_a=file_get_contents("../estorecss/".$bigImage.".txt"); $value_a=str_replace('"','',$value_a); $rowImages['image_path'] = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$bigImage.'.jpg' );
			 
			$rowImages['image_path']=str_replace('../','https://www.safeqloud.com/',$rowImages['image_path']);
			array_push($org[$j]['images'],$rowImages);	
			}
			
			if(empty($rowImages = $resultImages->fetch_assoc()))
			{
				$org[$j]['images'][0]['image_path']=$row['image_path'];
			}
			$j++;
			}
			 
				$stmt->close();
				$dbCon->close();
				 
				return $org;
	}
	
	function longTermApartmentList()
	{
		 
			$dbCon = AppModel::createConnection();
			$search='%'.$_POST['city'].'%';
			$stmt = $dbCon->prepare("select * from user_address where   state like ? and district_long_rent=1 and publish_dstrict_long_rent=1");
			
			/* bind parameters for markers */
			$stmt->bind_param("s", $search);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			
			$j=0;
			while($row = $result->fetch_assoc())
			{
			 
			 $stmt = $dbCon->prepare("select count(apartment_photo_path) as num from user_apartment_photos where user_address_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $row['id']);
			$stmt->execute();
			$resultImage = $stmt->get_result();
			$rowImage = $resultImage->fetch_assoc();
			
			if($rowImage['num']<10)
			{
				continue;
			}
		  
			$stmt = $dbCon->prepare("select apartment_photo_path as image_path from user_apartment_photos where user_address_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $row['id']);
			$stmt->execute();
			$resultImage = $stmt->get_result();
			$rowImage = $resultImage->fetch_assoc();
			 
			
			$bigImage=$rowImage['image_path'];	
			 
			 
			 $filename="../estorecss/".$bigImage.".txt"; $value_a=file_get_contents("../estorecss/".$bigImage.".txt"); $value_a=str_replace('"','',$value_a); $row['image_path'] = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$bigImage.'.jpg' );
			 $row['enc']= $this -> encrypt_decrypt('encrypt',$row['id']);  
			$row['image_path']=str_replace('../','https://www.safeqloud.com/',$row['image_path']);
			array_push($org,$row);
			$org[$j]['images']=array();
			
			$stmt = $dbCon->prepare("select apartment_photo_path as image_path from user_apartment_photos where user_address_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $row['id']);
			$stmt->execute();
			$resultImages = $stmt->get_result();
			while($rowImages = $resultImages->fetch_assoc())
			{
			$bigImage=$rowImages['image_path'];	
			$filename="../estorecss/".$bigImage.".txt"; $value_a=file_get_contents("../estorecss/".$bigImage.".txt"); $value_a=str_replace('"','',$value_a); $rowImages['image_path'] = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$bigImage.'.jpg' );
			 
			$rowImages['image_path']=str_replace('../','https://www.safeqloud.com/',$rowImages['image_path']);
			array_push($org[$j]['images'],$rowImages);	
			}
			
			if(empty($rowImages = $resultImages->fetch_assoc()))
			{
				$org[$j]['images'][0]['image_path']=$row['image_path'];
			}
			$j++;
			}
			 
				$stmt->close();
				$dbCon->close();
				 
				return $org;
	}
	
	function apartmentForSaleList()
	{
		 
			$dbCon = AppModel::createConnection();
			$search='%'.$_POST['city'].'%';
			$stmt = $dbCon->prepare("select * from user_address where   state like ? and district_sale=1 and publish_dstrict_sale=1");
			
			/* bind parameters for markers */
			$stmt->bind_param("s", $search);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			
			$j=0;
			while($row = $result->fetch_assoc())
			{
			 
			 $stmt = $dbCon->prepare("select count(apartment_photo_path) as num from user_apartment_photos where user_address_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $row['id']);
			$stmt->execute();
			$resultImage = $stmt->get_result();
			$rowImage = $resultImage->fetch_assoc();
			
			if($rowImage['num']<10)
			{
				continue;
			}
		  
			$stmt = $dbCon->prepare("select apartment_photo_path as image_path from user_apartment_photos where user_address_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $row['id']);
			$stmt->execute();
			$resultImage = $stmt->get_result();
			$rowImage = $resultImage->fetch_assoc();
			 
			
			$bigImage=$rowImage['image_path'];	
			 
			 
			 $filename="../estorecss/".$bigImage.".txt"; $value_a=file_get_contents("../estorecss/".$bigImage.".txt"); $value_a=str_replace('"','',$value_a); $row['image_path'] = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$bigImage.'.jpg' );
			 $row['enc']= $this -> encrypt_decrypt('encrypt',$row['id']);  
			$row['image_path']=str_replace('../','https://www.safeqloud.com/',$row['image_path']);
			array_push($org,$row);
			$org[$j]['images']=array();
			
			$stmt = $dbCon->prepare("select apartment_photo_path as image_path from user_apartment_photos where user_address_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $row['id']);
			$stmt->execute();
			$resultImages = $stmt->get_result();
			while($rowImages = $resultImages->fetch_assoc())
			{
			$bigImage=$rowImages['image_path'];	
			$filename="../estorecss/".$bigImage.".txt"; $value_a=file_get_contents("../estorecss/".$bigImage.".txt"); $value_a=str_replace('"','',$value_a); $rowImages['image_path'] = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$bigImage.'.jpg' );
			 
			$rowImages['image_path']=str_replace('../','https://www.safeqloud.com/',$rowImages['image_path']);
			array_push($org[$j]['images'],$rowImages);	
			}
			
			if(empty($rowImages = $resultImages->fetch_assoc()))
			{
				$org[$j]['images'][0]['image_path']=$row['image_path'];
			}
			$j++;
			}
			 
				$stmt->close();
				$dbCon->close();
				 
				return $org;
	}
	
	
	function apartmentIsAvailable()
	{
		 
			$dbCon = AppModel::createConnection();
			$room_type_id= $this -> encrypt_decrypt('decrypt',$_POST['rid']);
			 
			$total_days=round(($_POST['end_date']-$_POST['start_date']) / (60 * 60 * 24));
			 $strt=date('Y-m-d',$_POST['start_date']);
			 $end=date('Y-m-d',$_POST['end_date']);
			$stmt = $dbCon->prepare("SELECT count(id) as num from hotel_checkout_detail where
									room_type_id=? and hotel_property_type=2  and ((checkin_date BETWEEN ? AND ?) or (checkout_date BETWEEN ? AND ?))");
			
			/* bind parameters for markers */
			$stmt->bind_param("issss", $room_type_id, $strt,$end, $strt,$end);
			$stmt->execute();
			$result = $stmt->get_result();
			 
			$row = $result->fetch_assoc();
			if($row['num']>0)
			{
				return 1;
			}
			$skip=0;
			$price=0;
			 for($i=0;$i<$total_days;$i++)
			 {
				 
			$stmt = $dbCon->prepare("select pricing_start_date,pricing_end_date,monday_price,tuesday_price,wednesday_price,thursday_price,friday_price,saturday_price,sunday_price,shortest_duration,monday_open,tuesday_open,wednesday_open,thursday_open,friday_open,saturday_open,sunday_open from user_apartment_pricing_info where user_address_id=? and (pricing_start_date<=? and pricing_end_date>=?)");
			
			/* bind parameters for markers */
			$stmt->bind_param("iii", $room_type_id,$_POST['end_date'],$_POST['start_date']);
			$stmt->execute();
			$resultPrice = $stmt->get_result();
			while($rowPrice = $resultPrice->fetch_assoc())
			{
			
			   	
			if($rowPrice['shortest_duration']>$total_days)
			{
				 
				$skip=1;
				break;
			}
			$currentdate=strtotime("+".$i." days", $_POST['start_date']);
			$c=date('Y-m-d',$currentdate);	
			 
			$stmt = $dbCon->prepare("select count(blocked_date) as num from user_apartment_blocked_dates where blocked_date=? and user_address_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("si", $currentdate,$room_type_id);
			$stmt->execute();
			$blockedDate = $stmt->get_result();
			$rowBlocked = $blockedDate->fetch_assoc();
			if($rowBlocked['num']==1)
			{
				$skip=1;
			 
				break;	
			}
			if($rowPrice['pricing_start_date']<=$c || $rowPrice['pricing_end_date']>=$c)
			{
			$d1 = new DateTime($c);
			$day=$d1->format('w');
			 
			if($day==0)
			{
				 
				if($rowPrice['sunday_open']==0)
				{
				$skip=1;
				//echo $day.'-'.$skip.'/'.$c;	
				break;
				}
				else
				{
				$price=$price+$rowPrice['sunday_price'];	
				}
				
			}
			
			else if($day==1)
			{
				if($rowPrice['monday_open']==0)
				{
				$skip=1;
				//echo $day.'-'.$skip.'/'.$c;	
				break;
				}
				else
				{
				$price=$price+$rowPrice['monday_price'];	
				}
				
			}
			else if($day==2)
			{
				if($rowPrice['tuesday_open']==0)
				{
				$skip=1;
				////echo $day.'-'.$skip.'/'.$c;		
				break;
				}
				else
				{
				$price=$price+$rowPrice['tuesday_price'];	
				}
				
			}
			
			else if($day==3)
			{
				if($rowPrice['wednesday_open']==0)
				{
				$skip=1;
				////echo $day.'-'.$skip.'/'.$c;		
				break;
				}
				else
				{
				$price=$price+$rowPrice['wednesday_price'];	
				}
				
			}
			else if($day==4)
			{
				if($rowPrice['thursday_open']==0)
				{
				$skip=1;
				////echo $day.'-'.$skip.'/'.$c;		
				break;
				}
				else
				{
				$price=$price+$rowPrice['thursday_price'];	
				}
				
			}
			else if($day==5)
			{
				if($rowPrice['friday_open']==0)
				{
				$skip=1;
				////echo $day.'-'.$skip.'/'.$c;		
				break;
				}
				else
				{
				$price=$price+$rowPrice['friday_price'];	
				}
				
			}
			else if($day==6)
			{
				if($rowPrice['saturday_open']==0)
				{
				$skip=1;
				////echo $day.'-'.$skip.'/'.$c;		
				break;
				}
				else
				{
				$price=$price+$rowPrice['saturday_price'];	
				}
				
			}
			}
			}
			if($skip==1)
			{
				 
				break;
			}
			}
			 
			
				$stmt->close();
				$dbCon->close();
				 
				return $skip;
	}
	
	
	
	function orderHotelAmenity()
		{
			$dbCon = AppModel::createConnection();
			$hotel_id= $this -> encrypt_decrypt('decrypt',$_POST['id']); 
			$room_type_id= $this -> encrypt_decrypt('decrypt',$_POST['rid']);
			$room_id= $this -> encrypt_decrypt('decrypt',$_POST['rmid']);
			$a_id= $this -> encrypt_decrypt('decrypt',$_POST['aid']);
			$id= $this -> encrypt_decrypt('decrypt',$_POST['qloud_checkout_id']);
			$stmt = $dbCon->prepare("select * from company_hotel_amenities_user_request where qloud_checkout_id=? and amenity_id=? and is_verified=0");
			$stmt->bind_param("is",$id,$a_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			 
			if(empty($row))
			{
			$t=0;
			$quantity=$_POST['quantity'];
			$stmt = $dbCon->prepare("insert into `company_hotel_amenities_user_request`(hotel_id,room_type_id,room_id,amenity_id,user_id,created_on,qloud_checkout_id,aminity_quantity,aminity_price,amenity_name) values ( ?, ?, ?, ?, ?, now(),?,?,?,?)");
			
			/* bind parameters for markers */
			$stmt->bind_param("iiisiiiis",$hotel_id,$room_type_id,$room_id,$a_id,$_POST['user_id'],$id,$quantity,$t,$_POST['aname']);
			$stmt->execute();
			$id=$stmt->insert_id;
			$val=$this -> encrypt_decrypt('encrypt',$id);
			}
			else
			{
			$t=0;
			$quantity=$_POST['quantity']+$row['aminity_quantity'];
			$stmt = $dbCon->prepare("update company_hotel_amenities_user_request set aminity_quantity=?,aminity_price=? where id=?");
			$stmt->bind_param("iii",$quantity,$t,$row['id']);
			$stmt->execute();	
			$val=$this -> encrypt_decrypt('encrypt',$row['id']);
			}
			
			 
			$stmt->close();
			$dbCon->close();
			return $val;
			
		}
	function hotelBathroomAmenities($data)
		{
			$dbCon = AppModel::createConnection();
			$hotel_id= $this -> encrypt_decrypt('decrypt',$data['id']); 
			$room_type_id= $this -> encrypt_decrypt('decrypt',$data['rid']);
			$room_id= $this -> encrypt_decrypt('decrypt',$data['rmid']);
			 
			$stmt = $dbCon->prepare("select hotel_bathroom_amenities from hotel_basic_information where property_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $hotel_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			
			$stmt = $dbCon->prepare("select bathroom_amenities_available from company_hotel_room_type_detail where id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $room_type_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowRtype = $result->fetch_assoc();
			
			$stmt = $dbCon->prepare("select room_bathroom_amenities from hotel_room_detail where id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $room_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowRoom = $result->fetch_assoc();
			$amenities=$row['hotel_bathroom_amenities'].''.$rowRtype['bathroom_amenities_available'].''.$rowRoom['room_bathroom_amenities'];
			 
			$stmt = $dbCon->prepare("select * from company_hotel_bathroom_amenities where find_in_set(id,?) and is_order>0");
			
			/* bind parameters for markers */
			$stmt->bind_param("s", $amenities);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			$j=0;
			while($row  = $result->fetch_assoc())
			{
				array_push($org,$row);
				$org[$j]['enc']=$this->encrypt_decrypt('encrypt','b_'.$row['id']);
				$j++;
			}
			
			return $org;
		}
	
	function hotelMediaAmenities($data)
		{
			$dbCon = AppModel::createConnection();
			$hotel_id= $this -> encrypt_decrypt('decrypt',$data['id']); 
			$room_type_id= $this -> encrypt_decrypt('decrypt',$data['rid']);
			$room_id= $this -> encrypt_decrypt('decrypt',$data['rmid']);
			 
			$stmt = $dbCon->prepare("select hotel_connectivity_amenities from hotel_basic_information where property_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $hotel_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			
			$stmt = $dbCon->prepare("select connectivity_amenities_available from company_hotel_room_type_detail where id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $room_type_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowRtype = $result->fetch_assoc();
			
			$stmt = $dbCon->prepare("select room_connectivity_amenities from hotel_room_detail where id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $room_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowRoom = $result->fetch_assoc();
			$amenities=$row['hotel_connectivity_amenities'].''.$rowRtype['connectivity_amenities_available'].''.$rowRoom['room_connectivity_amenities'];
			 
			$stmt = $dbCon->prepare("select * from company_hotel_connectivity_amenities where find_in_set(id,?) and is_order>0");
			
			/* bind parameters for markers */
			$stmt->bind_param("s", $amenities);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			$j=0;
			while($row  = $result->fetch_assoc())
			{
				array_push($org,$row);
				$org[$j]['enc']=$this->encrypt_decrypt('encrypt','c_'.$row['id']);
				$j++;
			}
			
			return $org;
		}
	
	function hotelRoomAmenities($data)
		{
			$dbCon = AppModel::createConnection();
			$hotel_id= $this -> encrypt_decrypt('decrypt',$data['id']); 
			$room_type_id= $this -> encrypt_decrypt('decrypt',$data['rid']);
			$room_id= $this -> encrypt_decrypt('decrypt',$data['rmid']);
			 
			$stmt = $dbCon->prepare("select hotel_general_amenities from hotel_basic_information where property_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $hotel_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			
			$stmt = $dbCon->prepare("select general_amenities_available from company_hotel_room_type_detail where id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $room_type_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowRtype = $result->fetch_assoc();
			
			$stmt = $dbCon->prepare("select room_general_amenities from hotel_room_detail where id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $room_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowRoom = $result->fetch_assoc();
			$amenities=$row['hotel_general_amenities'].''.$rowRtype['general_amenities_available'].''.$rowRoom['room_general_amenities'];
			
			$stmt = $dbCon->prepare("select * from company_hotel_general_amenities where find_in_set(id,?) and is_order>0 and is_room=1");
			
			/* bind parameters for markers */
			$stmt->bind_param("s", $amenities);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			$j=0;
			while($row  = $result->fetch_assoc())
			{
				array_push($org,$row);
				$org[$j]['enc']=$this->encrypt_decrypt('encrypt','g_'.$row['id']);
				$j++;
			}
			
			return $org;
		}
	
		function hotelBedAmenities($data)
		{
			$dbCon = AppModel::createConnection();
			$hotel_id= $this -> encrypt_decrypt('decrypt',$data['id']); 
			$room_type_id= $this -> encrypt_decrypt('decrypt',$data['rid']);
			$room_id= $this -> encrypt_decrypt('decrypt',$data['rmid']);
			 
			$stmt = $dbCon->prepare("select hotel_general_amenities from hotel_basic_information where property_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $hotel_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			
			$stmt = $dbCon->prepare("select general_amenities_available from company_hotel_room_type_detail where id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $room_type_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowRtype = $result->fetch_assoc();
			
			$stmt = $dbCon->prepare("select room_general_amenities from hotel_room_detail where id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $room_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowRoom = $result->fetch_assoc();
			$amenities=$row['hotel_general_amenities'].''.$rowRtype['general_amenities_available'].''.$rowRoom['room_general_amenities'];
			
			$stmt = $dbCon->prepare("select * from company_hotel_general_amenities where find_in_set(id,?) and is_order>0 and is_room=2");
			
			/* bind parameters for markers */
			$stmt->bind_param("s", $amenities);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			$j=0;
			while($row  = $result->fetch_assoc())
			{
				array_push($org,$row);
				$org[$j]['enc']=$this->encrypt_decrypt('encrypt','g_'.$row['id']);
				$j++;
			}
			
			return $org;
		}
	
	function updateLeave($data)
		{
			$dbCon = AppModel::createConnection();
			$st=1;
			$next_days=$data['day_leave']-1;
			$date = date("Y-m-d");
			$mod_date = date('Y-m-d',strtotime($date."+ ".$next_days." days"));
			//echo $mod_date; echo $date; die;
			$stmt = $dbCon->prepare("insert into employee_leave_vacation(company_id,user_id,leave_start,leave_end,created_on,total_leave,is_approved,leave_description) values(?,?,now(),?,now(),?,?, ?)");
			
			/* bind parameters for markers */
			$stmt->bind_param("iisiis", $data['company_id'],$data['user_id'],$mod_date,$data['day_leave'],$st,$data['leave_description']);
			$stmt->execute();
			
			$stmt->close();
			$dbCon->close();
			return 1;
		}
		
		
		function updateVacationInfo($data)
		{
			$dbCon = AppModel::createConnection();
			$st=2;
			 $diff = strtotime($data['end_date']) - strtotime($data['start_date']); 
			 $diff = abs(round($diff / 86400))+1; 
			 
			$stmt = $dbCon->prepare("insert into employee_leave_vacation(company_id,user_id,leave_start,leave_end,created_on,total_leave,leave_type,leave_description) values(?,?,?,?,now(),?,?, ?)");
			
			/* bind parameters for markers */
			$stmt->bind_param("iissiis", $data['company_id'],$data['user_id'],$data['start_date'],$data['end_date'],$diff,$st,$data['leave_description']);
			$stmt->execute();
			
			$stmt->close();
			$dbCon->close();
			return 1;
		}
		
	
	function checkEmployeeTime($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select max(id) as eid,max(created_on) edate from employee_attendence where company_id=? and user_id=? and is_exit=0");
			$stmt->bind_param("ii", $data['company_id'],$data['user_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			date_default_timezone_set("Europe/Stockholm");
			$starttimestamp = strtotime($row['edate']);
			$endtimestamp = strtotime(date('Y-m-d H:i:s'));
			//echo $starttimestamp.'-'; echo $endtimestamp;
			$difference = floor(abs($endtimestamp - $starttimestamp)/3600);
			$difference2 = floor(abs($endtimestamp - $starttimestamp )/60);
			$difference2=$difference2 -($difference*60);
			$difference3 = floor(abs($endtimestamp - $starttimestamp));
			$difference3 = abs($difference3 - ($difference*3600) - ($difference2*60));
			$row['diffh']=$difference;
			$row['diffm']=$difference2;
			$row['diffs']=$difference3;
			$stmt->close();
			$dbCon->close();
			return $row;
			
			
		 		
		}
	function updateAttendence($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("insert into employee_attendence(company_id,user_id,entry_date,entry_time,created_on) values(?,?,now(),now(),now())");
			
			/* bind parameters for markers */
			$stmt->bind_param("ii", $data['company_id'],$data['user_id']);
			$stmt->execute();
			
			$stmt->close();
			$dbCon->close();
			return 1;
		}
		
		function updateExit($data)
		{
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("update employee_attendence set  exit_time=now(),modified_on=now(),is_exit=1 where id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['eid']);
			$stmt->execute();
			
			$stmt->close();
			$dbCon->close();
			return 1;
		}
		
	
	function checkEmployeeAttendence($data)
		{
			$dbCon = AppModel::createConnection();
			$company_id= $data['company_id'];
			
			$stmt = $dbCon->prepare("select max(id),max(entry_date) edate from employee_attendence where company_id=? and user_id=? and is_exit=0");
			$stmt->bind_param("ii", $company_id,$data['user_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			 
			if(date('Y-m-d',strtotime($row['edate']))==date('Y-m-d'))
			{
		 
			$stmt->close();
			$dbCon->close();
			return 1;
			}
			else
			{
			 
			$stmt = $dbCon->prepare("select id from employee_leave_vacation where company_id=? and user_id=? and leave_type=1");
			$stmt->bind_param("ii", $company_id,$data['user_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();	
			 
			if(empty($row))
			{
				 
			$stmt->close();
			$dbCon->close();
			return 0;	
			}
			else
			{
					 
			$stmt = $dbCon->prepare("select leave_start,leave_end from employee_leave_vacation where id=?");
			$stmt->bind_param("i", $row['id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();	
			if((date('Y-m-d',strtotime($row['leave_start']))==date('Y-m-d') || date('Y-m-d',strtotime($row['leave_end']))==date('Y-m-d')) || (date('Y-m-d',strtotime($row['leave_start']))<date('Y-m-d') && date('Y-m-d',strtotime($row['leave_end']))>date('Y-m-d')))
			{
					 
			$stmt->close();
			$dbCon->close();
			return 2;
			}
			else
			{
				 
			$stmt->close();
			$dbCon->close();
			return 0;
			}
			}
			}
			
		}
    
	
	function hotelPayInfo()
		{
			 
			$dbCon = AppModel::createConnection();
			 
			$id= $this -> encrypt_decrypt('decrypt',$_POST['id']);  
			 
			$stmt = $dbCon->prepare("select buyer_id,is_buyer_company,hotel_checkout_detail.user_id,visiting_address,port_number,visiting_city,visiting_state,property_location.id as p_id,room_type_id,total_days,price,hotel_name,fdesk_country_code,fdesk_phone_number from hotel_checkout_detail left join company_hotel_room_type_detail on company_hotel_room_type_detail.id= hotel_checkout_detail.room_type_id left join hotel_basic_information on hotel_basic_information.property_id=company_hotel_room_type_detail.location_id left join property_location on property_location.id=hotel_basic_information.property_id where hotel_checkout_detail.id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $id);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowPrice = $result->fetch_assoc();
			
			$stmt = $dbCon->prepare("select * from hotel_images where property_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $rowPrice['p_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowImage = $result->fetch_assoc();
			
			$filename="../estorecss/".$rowImage['image_path'].".txt"; $value_a=file_get_contents("../estorecss/".$rowImage['image_path'].".txt"); $value_a=str_replace('"','',$value_a); $rowImage['image_path'] = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$rowImage['image_path'].'.jpg' );
			$rowPrice['image_path']=str_replace('../','https://www.safeqloud.com/',$rowImage['image_path']);
			
			
			
		  if($row['is_buyer_company']==0)
		  {
			  $buyer=$rowPrice['user_id'];
			  $is_buyer_company=0;
			  $stmt = $dbCon->prepare("select concat_ws(' ', first_name,last_name) as name,email from user_logins where id = ?");
        
				/* bind parameters for markers */
				$stmt->bind_param("i", $buyer);
				$stmt->execute();
				$result = $stmt->get_result();
				$rowUser    = $result->fetch_assoc();
				 
		  }
		  else
		   {
			  $buyer=$rowPrice['buyer_id'];
			  $is_buyer_company=1;
			   $stmt = $dbCon->prepare("select company_name as name,company_email as email from companies where id = ?");
        
				/* bind parameters for markers */
				$stmt->bind_param("i", $buyer);
				$stmt->execute();
				$result = $stmt->get_result();
				$rowUser    = $result->fetch_assoc();
		  }
		  
			$price=$rowPrice['price']*$rowPrice['total_days']*100;
			 if($price<300)
			 {
				 $price=300;
			 }
			$rowPrice['name']=$rowUser['name'];
			$rowPrice['email']=$rowUser['email'];
			$rowPrice['price']=$price;
			 
			return $rowPrice;
		}
	
	
	
	
	
	
	
	function apartmentPayInfo()
		{
			 
			$dbCon = AppModel::createConnection();
			 
			$id= $this -> encrypt_decrypt('decrypt',$_POST['id']);  
			 
			$stmt = $dbCon->prepare("select passport_image,buyer_id,is_buyer_company,hotel_checkout_detail.user_id,user_address.address as visiting_address,user_address.port_number,user_address.city as visiting_city,user_address.state as visiting_state,user_address.id as p_id,room_type_id,total_days,price,property_nickname as hotel_name,country_code as fdesk_country_code,phone_number as fdesk_phone_number from hotel_checkout_detail left join user_address on user_address.id= hotel_checkout_detail.room_type_id left join user_profiles on user_profiles.user_logins_id=user_address.user_id left join user_logins on user_logins.id=user_address.user_id left join phone_country_code on user_logins.country_of_residence=phone_country_code.id where hotel_checkout_detail.id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $id);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowPrice = $result->fetch_assoc();
			$rowPrice['enc_p_id']= $this -> encrypt_decrypt('encrypt',$rowPrice['p_id']);  
			 
			
			$filename="../estorecss/".$rowPrice['passport_image'].".txt"; $value_a=file_get_contents("../estorecss/".$rowPrice['passport_image'].".txt"); $value_a=str_replace('"','',$value_a); $rowPrice['passport_image'] = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$rowPrice['passport_image'].'.jpg' );
			$rowPrice['image_path']=str_replace('../','https://www.safeqloud.com/',$rowPrice['passport_image']);
			
			
			
		  if($row['is_buyer_company']==0)
		  {
			  $buyer=$rowPrice['user_id'];
			  $is_buyer_company=0;
			  $stmt = $dbCon->prepare("select concat_ws(' ', first_name,last_name) as name,email from user_logins where id = ?");
        
				/* bind parameters for markers */
				$stmt->bind_param("i", $buyer);
				$stmt->execute();
				$result = $stmt->get_result();
				$rowUser    = $result->fetch_assoc();
				 
		  }
		  else
		   {
			  $buyer=$rowPrice['buyer_id'];
			  $is_buyer_company=1;
			   $stmt = $dbCon->prepare("select company_name as name,company_email as email from companies where id = ?");
        
				/* bind parameters for markers */
				$stmt->bind_param("i", $buyer);
				$stmt->execute();
				$result = $stmt->get_result();
				$rowUser    = $result->fetch_assoc();
		  }
		  
			$price=$rowPrice['price']*$rowPrice['total_days']*100;
			 if($price<300)
			 {
				 $price=300;
			 }
			$rowPrice['name']=$rowUser['name'];
			$rowPrice['email']=$rowUser['email'];
			$rowPrice['price']=$price;
			 
			return $rowPrice;
		}
	
	
	
	function hotelDetailRoomTypeInfo()
		{
			 
			$dbCon = AppModel::createConnection();
			$hotel_id= $this -> encrypt_decrypt('decrypt',$_POST['id']);  
			 
			$stmt = $dbCon->prepare("select property_location.id as hotel_id,hotel_description,web_type,website,fdesk_country_code,fdesk_phone_number,property_location.latitude,property_location.longitude,profile_pic,property_location.visiting_address,country_code,phone,hotel_name from hotel_basic_information left join property_location on property_location.id=hotel_basic_information.property_id left join company_profiles on property_location.company_id=company_profiles.company_id left join phone_country_code on phone_country_code.id=hotel_basic_information.fdesk_country_code where property_location.id=(select location_id from company_hotel_room_type_detail where id=?)");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $hotel_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			 if($row ['profile_pic']!=null) { $filename="../estorecss/".$row ['profile_pic'].".txt"; if (file_exists($filename)) { $value_a=file_get_contents("../estorecss/".$row ['profile_pic'].".txt"); $value_a=str_replace('"','',$value_a); $row['image_path'] = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$row['profile_pic'].'.jpg' ); } else { $row['image_path']="../html/usercontent/images/default-profile-pic.jpg"; } }  else $row['image_path']="../html/usercontent/images/default-profile-pic.jpg";
			 $row['enc']=$this -> encrypt_decrypt('encrypt',$row['hotel_id']);
				$stmt->close();
				$dbCon->close();
				 
				return $row;
			
		}
	
	function hotelRoomTypeInfo()
		{
			$dbCon = AppModel::createConnection();
			$hotel_id= $this -> encrypt_decrypt('decrypt',$_POST['id']);  
			$room_id= $this -> encrypt_decrypt('decrypt',$_POST['rid']);  
			$stmt = $dbCon->prepare("select payment_option,hotel_description,web_type,website,fdesk_country_code,fdesk_phone_number,property_location.longitude,property_location.latitude,hotel_name,property_location.visiting_address,company_hotel_room_type_detail.id,room_type_name,room_price,hotel_room_type.room_type from company_hotel_room_type_detail left join hotel_room_type on hotel_room_type.id=company_hotel_room_type_detail.room_type left join hotel_basic_information on company_hotel_room_type_detail.location_id=hotel_basic_information.property_id left join property_location on property_location.id=hotel_basic_information.property_id where company_hotel_room_type_detail.id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $hotel_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			$big="new0.09086000 1600564862";
			$small1="new0.13561200 1600564862";
			$small2="new0.15516700 1600564862";
			$row = $result->fetch_assoc();
			
			$stmt = $dbCon->prepare("select room_price_info from hotel_room_detail where hotel_room_detail.id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $room_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$row1 = $result->fetch_assoc();
			$row['room_price']=$row1['room_price_info'];
			$stmt->close();
			$dbCon->close();
			 
			return $row;
			
		}
		
		
		function hotelRoomTypePriceInfo()
		{
			$dbCon = AppModel::createConnection();
			$hotel_id= $this -> encrypt_decrypt('decrypt',$_POST['id']);  
			$room_id= $this -> encrypt_decrypt('decrypt',$_POST['rid']);  
			 
			$stmt = $dbCon->prepare("select hotel_description,web_type,website,fdesk_country_code,fdesk_phone_number,property_location.longitude,property_location.latitude,hotel_name,property_location.visiting_address,company_hotel_room_type_detail.id,room_type_name,room_price,hotel_room_type.room_type from company_hotel_room_type_detail left join hotel_room_type on hotel_room_type.id=company_hotel_room_type_detail.room_type left join hotel_basic_information on company_hotel_room_type_detail.location_id=hotel_basic_information.property_id left join property_location on property_location.id=hotel_basic_information.property_id where company_hotel_room_type_detail.id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $room_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			$big="new0.09086000 1600564862";
			$small1="new0.13561200 1600564862";
			$small2="new0.15516700 1600564862";
			$row = $result->fetch_assoc();
			$stmt->close();
			$dbCon->close();
			 
			return $row;
			
		}
	
	
	
	
	function hotelRoomTypeImages()
		{
			$dbCon = AppModel::createConnection();
			$hotel_id= $this -> encrypt_decrypt('decrypt',$_POST['id']);  
			$stmt = $dbCon->prepare("select * from company_hotel_room_type_photos where room_type_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $hotel_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			while($row = $result->fetch_assoc())
			{
			 $filename="../estorecss/".$row['image_path'].".txt"; $value_a=file_get_contents("../estorecss/".$row['image_path'].".txt"); $value_a=str_replace('"','',$value_a); $row['image_path1'] = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$row['image_path'].'.jpg' );
			$row['image_path1']=str_replace('../','safeqloud.com/',$row['image_path1']);
			array_push($org,$row);
			}
			return $org;
			
		}
	
	function hotelList()
	{
		 
		$dbCon = AppModel::createConnection();
			$search='%'.$_POST['city'].'%';
			 
			$stmt = $dbCon->prepare("select property_location.company_id,hotel_basic_information.property_id,hotel_description,property_location.id,profile_pic,property_location.visiting_address,country_code,phone,hotel_name,property_location.latitude,property_location.longitude from hotel_basic_information left join property_location on property_location.id=hotel_basic_information.property_id  left join company_profiles on property_location.company_id=company_profiles.company_id left join phone_country_code on phone_country_code.country_name=company_profiles.phone_country where is_hotel=1 and (property_location.visiting_address like ? or property_location.visiting_state like ? or property_location.visiting_city like ? or property_location.country_v like ? or property_location.city_v like ?) ");
			
			/* bind parameters for markers */
			$stmt->bind_param("sssss", $search,$search,$search,$search,$search);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			$big="new0.09086000 1600564862";
			$small1="new0.13561200 1600564862";
			$small2="new0.15516700 1600564862";
			$j=0;
			while($row = $result->fetch_assoc())
			{
			$row['hotel_description']=htmlentities(html_entity_decode($row['hotel_description']),ENT_NOQUOTES, 'UTF-8');	
			 
			$stmt = $dbCon->prepare("select min(room_price) as price,room_size,hotel_room_type.room_type from company_hotel_room_type_detail left join hotel_room_type on hotel_room_type.id=company_hotel_room_type_detail.room_type where location_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $row['id']);
			$stmt->execute();
			$resultPrice = $stmt->get_result();
			$rowPrice = $resultPrice->fetch_assoc();
			$row['price']=$rowPrice['price'];
			$row['room_size']=$rowPrice['room_size'];
			$row['room_type']=$rowPrice['room_type'];
			$stmt = $dbCon->prepare("select image_path from hotel_images where property_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $row['id']);
			$stmt->execute();
			$resultImage = $stmt->get_result();
			$rowImage = $resultImage->fetch_assoc();
			 
			if(empty($rowImage))
			{
				$bigImage=$big;
			}
			else
			{
			$bigImage=$rowImage['image_path'];	
			}
			 
			 $filename="../estorecss/".$bigImage.".txt"; $value_a=file_get_contents("../estorecss/".$bigImage.".txt"); $value_a=str_replace('"','',$value_a); $row['image_path'] = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$bigImage.'.jpg' );
			 $row['enc']= $this -> encrypt_decrypt('encrypt',$row['id']);  
			$row['image_path']=str_replace('../','https://www.safeqloud.com/',$row['image_path']);
			array_push($org,$row);
			$org[$j]['images']=array();
			
			$stmt = $dbCon->prepare("select image_path from hotel_images where property_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $row['id']);
			$stmt->execute();
			$resultImages = $stmt->get_result();
			while($rowImages = $resultImages->fetch_assoc())
			{
			$bigImage=$rowImages['image_path'];	
			$filename="../estorecss/".$bigImage.".txt"; $value_a=file_get_contents("../estorecss/".$bigImage.".txt"); $value_a=str_replace('"','',$value_a); $rowImages['image_path'] = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$bigImage.'.jpg' );
			 
			$rowImages['image_path']=str_replace('../','https://www.safeqloud.com/',$rowImages['image_path']);
			array_push($org[$j]['images'],$rowImages);	
			}
			
			if(empty($rowImages = $resultImages->fetch_assoc()))
			{
				$org[$j]['images'][0]['image_path']=$row['image_path'];
			}
			$j++;
			}
			 
				$stmt->close();
				$dbCon->close();
				//echo '<pre>'; print_r($org);  echo '</pre>'; 
				return $org;
	}
	
		function hotelRoomTypeList()
		{
			$dbCon = AppModel::createConnection();
			 
			//$hotel_id= $this -> encrypt_decrypt('decrypt','clBsMkdxdkd2UG5vR1d0TWQ2UEFKdz09');  
			// $_POST['checkin']=1648249200;
			//$_POST['checkout']=1648677600;
			$hotel_id= $this -> encrypt_decrypt('decrypt',$_POST['id']); 
			$stmt = $dbCon->prepare("select number_of_rooms,hotel_description,web_type,website,fdesk_country_code,fdesk_phone_number,longitude,latitude,hotel_name,property_location.visiting_address,company_hotel_room_type_detail.id,room_type_name,room_price,hotel_room_type.room_type from company_hotel_room_type_detail left join hotel_room_type on hotel_room_type.id=company_hotel_room_type_detail.room_type left join hotel_basic_information on company_hotel_room_type_detail.location_id=hotel_basic_information.property_id left join property_location on property_location.id=hotel_basic_information.property_id where company_hotel_room_type_detail.location_id=? and is_available=1");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $hotel_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			$j=0; 
			while($row = $result->fetch_assoc())
			{
			 	
			$select="select count(id) as num from hotel_checkout_detail where checked_in<3 and room_type_id='".$row['id']."' and checkin_booking_date<='".$_POST['checkin']."' and checkout_booking_date>'".$_POST['checkout']."' and is_paid=1";
			$resultCountId=mysqli_query($dbCon, $select);
			$rowCountId=mysqli_fetch_array($resultCountId);	
			 
			if($row['number_of_rooms']==$rowCountId['num'])
			{
				continue;
			}
			$row['enc']= $this -> encrypt_decrypt('encrypt',$row['id']);  
			array_push($org,$row); 
			$stmt = $dbCon->prepare("select image_path from company_hotel_room_type_photos where room_type_id=? limit 0,6");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $row['id']);
			$stmt->execute();
			$result1 = $stmt->get_result();
			$org[$j]['images']=array();
			while($row1 = $result1->fetch_assoc())
			{
			$image=$row1['image_path'];
			$value_a=file_get_contents("../estorecss/".$image.".txt"); $value_a=str_replace('"','',$value_a); $row1['image_path'] = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$image.'.jpg' );
			$row1['image_path']=str_replace('../','https://www.safeqloud.com/',$row1['image_path']);	
			array_push($org[$j]['images'],$row1);			
			}
			
			
			$select="select room_id from hotel_checkout_detail where checked_in<3 and room_type_id='".$row['id']."' and checkin_booking_date<='".$_POST['checkin']."' and checkout_booking_date>='".$_POST['checkout']."'";
			$resultCountId=mysqli_query($dbCon, $select);
			$rmID='0,';
			while($rowCountId=mysqli_fetch_array($resultCountId))
			{
				$rmID=$rmID.$rowCountId['room_id'].',';
			}
			$rmID=substr($rmID,0,-1);
			$org[$j]['rooms']=array();
			 $select="select hotel_room_bedding_type.bedding_type,hotel_room_detail.id,room_price_info,room_name,room_size,room_size_unit from hotel_room_detail left join hotel_room_bedding_type on hotel_room_bedding_type.id=hotel_room_detail.bedding_type where room_type='".$row['id']."' and hotel_room_detail.id not in (".$rmID.") group by room_price_info";
			 
			 $result1=mysqli_query($dbCon, $select); 
			 while($row1=mysqli_fetch_array($result1))
			 {
			 
				$row1['enc']= $this -> encrypt_decrypt('encrypt',$row1['id']); 	
				array_push($org[$j]['rooms'],$row1);			
				}
			
			$j++;
			}
			//echo '<pre>'; print_r($org); echo '</pre>'; die;
			$stmt->close();
			$dbCon->close();
			return $org;
			
		}
	
		function hotelRoomTypeCheckinList()
		{
			$dbCon = AppModel::createConnection();
			 $a=explode(',',substr($_POST['id_checkout'],0,-1));
			 $org=array();
			 foreach($a as $key)
			 {
			$stmt = $dbCon->prepare("select hotel_basic_information.property_id,hotel_description,web_type,website,fdesk_country_code,fdesk_phone_number,longitude,latitude,hotel_name,property_location.visiting_address,company_hotel_room_type_detail.id,room_type_name,room_price,hotel_room_type.room_type from company_hotel_room_type_detail left join hotel_room_type on hotel_room_type.id=company_hotel_room_type_detail.room_type left join hotel_basic_information on company_hotel_room_type_detail.location_id=hotel_basic_information.property_id left join property_location on property_location.id=hotel_basic_information.property_id where company_hotel_room_type_detail.id=(select room_type_id from hotel_checkout_detail where id=?) ");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $key);
			$stmt->execute();
			$result = $stmt->get_result();
			
			$j=0; 
			$row = $result->fetch_assoc();
			if(!empty($row))
			{
				
			$stmt = $dbCon->prepare("select checkout_date from hotel_checkout_detail where id=?");
			$stmt->bind_param("i",$key);
			$stmt->execute();
			$result2 = $stmt->get_result();
			$row2 = $result2->fetch_assoc();	
			$today=strtotime(date('Y-m-d'));
			$booking_overdate=strtotime($row2['checkout_date']);
			
			if($today>$booking_overdate)
			{
				continue;
			}

			
			$row['property_id_enc']= $this -> encrypt_decrypt('encrypt',$row['property_id']); 
			$row['enc']= $this -> encrypt_decrypt('encrypt',$row['id']);  
			$row['qloud_checkout_id']=$this->encrypt_decrypt('encrypt',$key);
			array_push($org,$row); 
			$stmt = $dbCon->prepare("select image_path from company_hotel_room_type_photos where room_type_id=? limit 0,6");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $row['id']);
			$stmt->execute();
			$result1 = $stmt->get_result();
			$org[$j]['images']=array();
			while($row1 = $result1->fetch_assoc())
			{
			$image=$row1['image_path'];
			$value_a=file_get_contents("../estorecss/".$image.".txt"); $value_a=str_replace('"','',$value_a); $row1['image_path'] = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$image.'.jpg' );
			$row1['image_path']=str_replace('../','https://www.safeqloud.com/',$row1['image_path']);	
			array_push($org[$j]['images'],$row1);			
			}
			
			$stmt = $dbCon->prepare("select id,room_price_info,room_name from hotel_room_detail where room_type=? group by room_price_info");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $row['id']);
			$stmt->execute();
			$result1 = $stmt->get_result();
			$org[$j]['rooms']=array();
			while($row1 = $result1->fetch_assoc())
			{
			$row1['enc']= $this -> encrypt_decrypt('encrypt',$row1['id']); 
			
			array_push($org[$j]['rooms'],$row1);	
			
			}
			$j++;
			}
			}
			//echo '<pre>'; print_r($org); echo '</pre>'; die;
			$stmt->close();
			$dbCon->close();
			return $org;
			
		}
	
	
	function hotelCheckinList()
		{
			$dbCon = AppModel::createConnection();
			 
			 $id= $_POST['id_checkout'];   
			  
			$stmt = $dbCon->prepare("select hotel_checkout_id from hotel_checkout_invitation_info where invited_user_id=? and is_confirmed=1");
			$stmt->bind_param("i",$_POST['user_id']);
			$stmt->execute();
			$result2 = $stmt->get_result();
			while($row2 = $result2->fetch_assoc())
			{
				$id=$id.$row2['hotel_checkout_id'].',';
			} 
			 
			 $a=explode(',',substr($id,0,-1));
			 
			 $org=array();
			 $j=0; 
			 foreach($a as $key)
			 {
			$stmt = $dbCon->prepare("select company_hotel_room_type_detail.id,hotel_name as property_nickname,property_location.visiting_address as address,room_service,hotel_basic_information.property_id  from company_hotel_room_type_detail left join hotel_room_type on hotel_room_type.id=company_hotel_room_type_detail.room_type left join hotel_basic_information on company_hotel_room_type_detail.location_id=hotel_basic_information.property_id left join property_location on property_location.id=hotel_basic_information.property_id where company_hotel_room_type_detail.id=(select room_type_id from hotel_checkout_detail where id=?) ");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $key);
			$stmt->execute();
			$result = $stmt->get_result();
			
			
			$row = $result->fetch_assoc();
			
			if(!empty($row))
			{
			
			$stmt = $dbCon->prepare("select checkout_booking_date from hotel_checkout_detail where id=?");
			$stmt->bind_param("i",$key);
			$stmt->execute();
			$result2 = $stmt->get_result();
			$row2 = $result2->fetch_assoc();
 			
			$today=strtotime(date('Y-m-d'));
			$booking_overdate=$row2['checkout_booking_date'];
			  
			 
			if($today>$booking_overdate)
			{
				continue;
			}
			$row['booking_overdate']=date('Y-m-d',$booking_overdate); 
			$row['property_nickname']=html_entity_decode($row['property_nickname'],ENT_NOQUOTES, 'UTF-8'); 
			$row['address']=html_entity_decode($row['address'],ENT_NOQUOTES, 'UTF-8'); 
			$row['enc']= 1;  
			$row['qloud_checkout_id']=$key;
			$id=$row['id'];
			 
			array_push($org,$row); 
			 $stmt = $dbCon->prepare("select image_path from hotel_images where property_id=? limit 0,6");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $row['property_id']);
			$stmt->execute();
			$result1 = $stmt->get_result();
			 
			$row1 = $result1->fetch_assoc();
			if(empty($row1))
			{
				$org[$j]['image_path']="https://www.safeqloud.com/estorecss/tmpnew0.09086000 1600564862.jpg";
			}
			else
			{
			$image=$row1['image_path'];
			$value_a=file_get_contents("../estorecss/".$image.".txt"); $value_a=str_replace('"','',$value_a); $row1['image_path'] = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$image.'.jpg' );
			$row1['image_path']=str_replace('../','https://www.safeqloud.com/',$row1['image_path']);	
			$org[$j]['image_path']=$row1['image_path'];		
			}
					
			 $j++;
			}
			
			}
			 
			$stmt->close();
			$dbCon->close();
			return $org;
			
		}
	
		
	
	
	function apartmentCheckedInList()
		{
			$dbCon = AppModel::createConnection();
			 
			$a=explode(',',substr($_POST['room_type'],0,-1));
			$b=explode(',',substr($_POST['id_checkout'],0,-1));
			 
			$org=array(); 
			$j=0;
			foreach($a as $key)
			{
			$stmt = $dbCon->prepare("select id,property_nickname,address from user_address where id=? ");
			/* bind parameters for markers */
			$stmt->bind_param("i", $key);
			$stmt->execute();
			$result = $stmt->get_result();
			
			$row = $result->fetch_assoc();
			if(!empty($row))
			{
			$row['address']=html_entity_decode($row['address'],ENT_NOQUOTES, 'UTF-8'); 	
			$row['property_nickname']=html_entity_decode($row['property_nickname'],ENT_NOQUOTES, 'UTF-8').'(Guest)'; 	
			$row['qloud_checkout_id']=$b[$j]; 
			$row['enc']= 2; 
			$row['room_service']=0;
			
			$stmt = $dbCon->prepare("select checkout_booking_date from hotel_checkout_detail where id=?");
			$stmt->bind_param("i",$row['qloud_checkout_id']);
			$stmt->execute();
			$result2 = $stmt->get_result();
			$row2 = $result2->fetch_assoc();
 			
			$today=strtotime(date('Y-m-d'));
			$booking_overdate=$row2['checkout_booking_date'];
			  
			 
			if($today>$booking_overdate)
			{
				continue;
			}
			$row['booking_overdate']=date('Y-m-d',$booking_overdate); 
			$stmt = $dbCon->prepare("select apartment_photo_path,sorting_number,id from user_apartment_photos where user_address_id=?");
			$stmt->bind_param("i", $key);
			$stmt->execute();
			$result1 = $stmt->get_result();
			$row1 = $result1->fetch_assoc();
			$image=$row1['apartment_photo_path'];
			$value_a=file_get_contents("../estorecss/".$image.".txt"); $value_a=str_replace('"','',$value_a); $row1['apartment_photo_path'] = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$image.'.jpg' );
			$row1['apartment_photo_path']=str_replace('../','https://www.safeqloud.com/',$row1['apartment_photo_path']);	
			$row['image_path']=$row1['apartment_photo_path'];
			array_push($org,$row); 
			
			$j++; 	
			}
			
			}
			$stmt->close();
			$dbCon->close();
			return $org;
			
		}
	
	function apartmentOwnerCheckedInList()
		{
			$dbCon = AppModel::createConnection();
			 
			$a=explode(',',substr($_POST['room_type'],0,-1));
			$b=explode(',',substr($_POST['id_checkout'],0,-1));
			 
			$org=array(); 
			$j=0;
			foreach($a as $key)
			{
			$stmt = $dbCon->prepare("select id,property_nickname,address from user_address where id=? ");
			/* bind parameters for markers */
			$stmt->bind_param("i", $key);
			$stmt->execute();
			$result = $stmt->get_result();
			
			$row = $result->fetch_assoc();
			if(!empty($row))
			{
			$row['address']=html_entity_decode($row['address'],ENT_NOQUOTES, 'UTF-8'); 	
			$row['property_nickname']=html_entity_decode($row['property_nickname'],ENT_NOQUOTES, 'UTF-8').'(Owner)'; 	
			$row['qloud_checkout_id']=$b[$j]; 
			$row['enc']= 2; 
			$row['room_service']=0;
			
			$row['booking_overdate']=date('Y-m-d'); 
			$stmt = $dbCon->prepare("select apartment_photo_path,sorting_number,id from user_apartment_photos where user_address_id=?");
			$stmt->bind_param("i", $key);
			$stmt->execute();
			$result1 = $stmt->get_result();
			$row1 = $result1->fetch_assoc();
			$image=$row1['apartment_photo_path'];
			$value_a=file_get_contents("../estorecss/".$image.".txt"); $value_a=str_replace('"','',$value_a); $row1['apartment_photo_path'] = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$image.'.jpg' );
			$row1['apartment_photo_path']=str_replace('../','https://www.safeqloud.com/',$row1['apartment_photo_path']);	
			$row['image_path']=$row1['apartment_photo_path'];
			array_push($org,$row); 
			
			$j++; 	
			}
			
			}
			$stmt->close();
			$dbCon->close();
			return $org;
			
		}
	
	
	
	function hotelImages()
		{
			$dbCon = AppModel::createConnection();
			$location_id= $this -> encrypt_decrypt('decrypt',$_POST['id']);
 			
			$stmt = $dbCon->prepare("select * from hotel_images where property_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $location_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			while($row = $result->fetch_assoc())
			{
			 $filename="../estorecss/".$row['image_path'].".txt"; $value_a=file_get_contents("../estorecss/".$row['image_path'].".txt"); $value_a=str_replace('"','',$value_a); $row['image_path1'] = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$row['image_path'].'.jpg' );
			$row['image_path1']=str_replace('../','safeqloud.com/',$row['image_path1']);
			array_push($org,$row);
			}
			return $org;
			
		}
			
		function hotelImagesCount()
		{
			$dbCon = AppModel::createConnection();
			$location_id= $this -> encrypt_decrypt('decrypt',$_POST['id']);
 			
			$stmt = $dbCon->prepare("select count(id) as num from hotel_images where property_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $location_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			return $row['num'];
			
		}
		
			function hotelDetailInfo()
		{
			$dbCon = AppModel::createConnection();
			$hotel_id= $this -> encrypt_decrypt('decrypt',$_POST['id']);  
			$checkout_id= $this -> encrypt_decrypt('decrypt',$_POST['checkid']);  
			$stmt = $dbCon->prepare("select checkin_date,checkout_date,guest_adult,guest_children from hotel_checkout_detail where id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $checkout_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowDate = $result->fetch_assoc();
			 
			$stmt = $dbCon->prepare("select count(id) as num from hotel_checkout_dependent_detail where hotel_checkout_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $checkout_id);
			$stmt->execute();
			$resultCount = $stmt->get_result();
			$rowDependentCount = $resultCount->fetch_assoc();
			$rowDate['guest_children']=$rowDate['guest_children']-$rowDependentCount['num'];
			 if($rowDate['guest_children']<0)
			 {
				 $rowDate['guest_children']=0;
			 }
			
			$stmt = $dbCon->prepare("select hotel_description,web_type,website,fdesk_country_code,fdesk_phone_number,property_location.latitude,property_location.longitude,profile_pic,property_location.visiting_address,country_code,phone,hotel_name from hotel_basic_information left join property_location on property_location.id=hotel_basic_information.property_id left join company_profiles on property_location.company_id=company_profiles.company_id left join phone_country_code on phone_country_code.id=hotel_basic_information.fdesk_country_code where property_location.id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $hotel_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			$row['hotel_description']=htmlentities(html_entity_decode($row['hotel_description']),ENT_NOQUOTES, 'UTF-8');	
			 $row['guest_children']=$rowDate['guest_children'];
			 if($row ['profile_pic']!=null) { $filename="../estorecss/".$row ['profile_pic'].".txt"; if (file_exists($filename)) { $value_a=file_get_contents("../estorecss/".$row ['profile_pic'].".txt"); $value_a=str_replace('"','',$value_a); $row['image_path'] = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$row['profile_pic'].'.jpg' ); } else { $row['image_path']="../html/usercontent/images/default-profile-pic.jpg"; } }  else $row['image_path']="../html/usercontent/images/default-profile-pic.jpg";
			 $row['image_path']=str_replace('../','safeqloud.com/',$row['image_path']);
				$stmt->close();
				$dbCon->close();
				 
				return $row;
			
		}
	
		
	
	function contactList($data)
    {
        $dbCon = AppModel::createConnection();
		  
		$stmt = $dbCon->prepare("select is_admin,address,passport_image,employees.first_name,employees.id,concat_ws(' ',employees.first_name,employees.last_name)  as name,company_name,employees.email,employees.company_id,employees.user_login_id from employees left join companies on companies.id=employees.company_id left join user_logins on user_logins.id=employees.user_login_id  left join company_profiles on company_profiles.company_id=employees.company_id left join manage_employee_permissions on employees.id=manage_employee_permissions.employee_id where employees.company_id=? order by employees.first_name");
		$stmt->bind_param("i", $data['company_id']);
		$stmt->execute();
		$result = $stmt->get_result();
		$org=array();
		while($row = $result->fetch_assoc())
		{
		 
		$stmt = $dbCon->prepare("select title from user_company_profile where company_id=? and user_login_id=?");
		$stmt->bind_param("ii", $row['company_id'],$row['user_login_id']);
		$stmt->execute();
		$resultTitle = $stmt->get_result();
		$rowTitle = $resultTitle->fetch_assoc();	
		if($rowTitle['title']=='' || $rowTitle['title']==null)
		{
			$row['title']='Employee';
		}
		else
		{
			$row['title']=$rowTitle['title'];	
		}
		if($row['passport_image']!=null || $row['passport_image']!="") { 
						 
		$filename="../estorecss/".$row ['passport_image'].".txt"; if (file_exists($filename)) { $value_a=file_get_contents("../estorecss/".$row ['passport_image'].".txt"); $value_a=str_replace('"','',$value_a);  $imgs = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$row ['passport_image'].'.jpg' ); $imgs=str_replace('../','',$imgs); $imgs='https://www.safeqloud.com/'.$imgs; } else {   $imgs="https://www.safeqloud.com/estorecss/logoXXX.png"; }
		$row['image']=$imgs;
		}
		else
		{
		$row['image']='https://www.safeqloud.com/estorecss/logoXXX.png';
		}
						 
		$row['enc']=$this -> encrypt_decrypt('encrypt',$row['id']);	
		 
		array_push($org,$row);
					
		}
		 
		$stmt->close();
        $dbCon->close();
		return $org;
	}
	
	
	 
	
	
	function employerRequestCount($data)
		{
			$dbCon = AppModel::createConnection();
			 
			$user_id=$data['user_id'];
			$stmt = $dbCon->prepare("select email from user_logins where id=?");
			$stmt->bind_param("i", $user_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			$stmt = $dbCon->prepare("select count(estore_employee_invite.id) as num from estore_employee_invite left join invitation on estore_employee_invite.id=invitation.invited_user_id where (estore_employee_invite.email=? or estore_employee_invite.work_email=?) and invitation.status=0 and is_relieved=0");
			$stmt->bind_param("ss", $row['email'],$row['email']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			$stmt->close();
			$dbCon->close();
			return $row['num'];
			
			
		}
		
	function employerRequestReceived($data)
		{
			$dbCon = AppModel::createConnection();
			$user_id=$data['user_id'];
			$stmt = $dbCon->prepare("select email from user_logins where id=?");
			$stmt->bind_param("i", $user_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			$stmt = $dbCon->prepare("select invited_emp,estore_employee_invite.id,invitation.status,invitation.created_date,company_name from estore_employee_invite left join invitation on estore_employee_invite.id=invitation.invited_user_id left join companies on estore_employee_invite.company_id=companies.id where (estore_employee_invite.email=? or estore_employee_invite.work_email=? ) and invitation.status=0 and is_relieved=0 limit 0,5");
			$stmt->bind_param("ss", $row['email'],$row['email']);
			/* bind parameters for markers */
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			while($row = $result->fetch_assoc())
			{
				$row['company_name']=html_entity_decode($row['company_name'],ENT_NOQUOTES, 'UTF-8');
				array_push($org,$row); 
			}
			$stmt->close();
			$dbCon->close();
			return $org;
			
			
		}
		
		
		function approveEmployerRequest($data)
		{
			$dbCon = AppModel::createConnection();
			
			$request_id= $data['id'];
			$stmt= $dbCon->prepare("select invited_emp,company_id,name,last_name,title,email,work_email,first_name_p,last_name_p,sex_p,email_p,dob_day_p,dob_month_p,dob_year_p,employee_number from estore_employee_invite where id=?");
			$stmt->bind_param("i", $request_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$row_emp = $result->fetch_assoc();
			
			$company=$row_emp['company_id'];
			$stmt= $dbCon->prepare("select id,first_name,last_name,email,email_verification_code as hash_code from user_logins where email= ? or email=?");
			$stmt->bind_param("ss", $row_emp['email'], $row_emp['work_email']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row_id = $result->fetch_assoc();
			$fields=array();
			$fields=$row_id;
			$fields['safeqloud']=$request_id;
			$fields['stat']=$data['stat'];
			 
			$url='https://www.qmatchup.com/beta/user/index.php/Invitation/updateQloud';
			$ch = curl_init();
			curl_setopt($ch,CURLOPT_URL, $url);
			curl_setopt($ch,CURLOPT_POST, count($fields));
			curl_setopt($ch,CURLOPT_POSTFIELDS, $fields);
			curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
			
			curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, false);
			curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true);
			curl_setopt($ch, CURLOPT_COOKIESESSION, true);
			curl_setopt($ch, CURLOPT_REFERER, true);
			curl_setopt($ch, CURLOPT_COOKIEJAR, true);
			curl_setopt($ch, CURLOPT_COOKIEFILE, true);
			 
			$result=curl_exec ($ch);
			  
			curl_close ($ch);
			 
			
			$d=date('Y-m-d');
			if($data['stat']==2)
			{
				$stmt= $dbCon->prepare("update invitation set status=2,accepted_date=? where invited_user_id= ?");
				$stmt->bind_param("si",$d,$request_id);
				$stmt->execute();
				$stmt= $dbCon->prepare("select invited_emp,company_id,name,last_name,title,email,work_email,first_name_p,last_name_p,sex_p,email_p,dob_day_p,dob_month_p,dob_year_p,employee_number from estore_employee_invite where id=?");
				
				$stmt->bind_param("i", $request_id);
				$stmt->execute();
				$result = $stmt->get_result();
				$row_emp = $result->fetch_assoc();
				$company=$row_emp['company_id'];
				
				$stmt= $dbCon->prepare("select id,first_name,last_name,email,email_verification_code as hash_code from user_logins where email= ? or email=?");
				
				$stmt->bind_param("ss", $row_emp['email'], $row_emp['work_email']);
				$stmt->execute();
				$result = $stmt->get_result();
				$row_id = $result->fetch_assoc();
				
				$stmt= $dbCon->prepare("update estore_employee_invite set real_employee_id=? where id=? ");
				$stmt->bind_param("ii", $row_id['id'],$request_id);
				$stmt->execute();
			}
			else if($data['stat']==1)
			{
				$stmt= $dbCon->prepare("select invited_emp,company_id,name,last_name,title,email,work_email,first_name_p,last_name_p,sex_p,email_p,dob_day_p,dob_month_p,dob_year_p,employee_number from estore_employee_invite where id=?");
				
				$stmt->bind_param("i", $request_id);
				$stmt->execute();
				$result = $stmt->get_result();
				$row_emp = $result->fetch_assoc();
				$company=$row_emp['company_id'];
				$stmt= $dbCon->prepare("update invitation set status=1,accepted_date=? where invited_user_id= ?");
				$stmt->bind_param("si", $d,$request_id);
				if($stmt->execute())
				{
					$stmt= $dbCon->prepare("select id,first_name,last_name,email,email_verification_code as hash_code from user_logins where id= ?");
					
					$stmt->bind_param("i", $data['user_id']);
					$stmt->execute();
					$result = $stmt->get_result();
					$row_id = $result->fetch_assoc();
					
					$s=0;
					$u=1;
					$stmt= $dbCon->prepare("insert into company_permission (`company_id`,`user_login_id`,`purchase`,`alert`,`supplier`,`customer`,`employee`,`proposal`,`project_proposal`,`create_article`,`import_article`) values (?,?,?,?,?,?,?,?,?,?,?)");
					$stmt->bind_param("iiiiiiiiiii", $company,$row_id['id'],$s,$s,$s,$s,$u,$s,$s,$s,$s);
					$stmt->execute();
					if($row_emp['invited_emp']==1)
					{
						$stmt= $dbCon->prepare("insert into employees (`company_id`,`first_name`,`last_name`,`status`,`signup_hash`,`email`,`user_login_id`, employee_number) values (?,?,?,?,?,?,?, ?)");
						$stmt->bind_param("ississis", $company,$row_id['first_name'],$row_id['last_name'],$s,$row_id['hash_code'],$row_id['email'],$row_id['id'],$row_emp['employee_number']);
					}  
					else if($row_emp['invited_emp']==2)
					{
						$stmt= $dbCon->prepare("insert into students (`company_id`,`first_name`,`last_name`,`status`,`signup_hash`,`email`,`user_login_id`) values (?,?,?,?,?,?,?,?)");
						$stmt->bind_param("ississi", $company,$row_id['first_name'],$row_id['last_name'],$s,$row_id['hash_code'],$row_id['email'],$row_id['id']);
					}  
					if($stmt->execute())
					{
						
						
						$stmt= $dbCon->prepare("update estore_employee_invite set real_employee_id=? where id=? ");
						$stmt->bind_param("ii", $row_id['id'],$request_id);
						$stmt->execute();
						
						
						$stmt= $dbCon->prepare("select mobile_p,company_id,name,last_name,title,email,work_email,first_name_p,last_name_p,sex_p,email_p,dob_day_p,dob_month_p,dob_year_p from estore_employee_invite where id=?");
						$stmt->bind_param("i", $request_id);
						$stmt->execute();
						$result = $stmt->get_result();
						$row_emp = $result->fetch_assoc();
						$company=$row_emp['company_id'];
						
						$stmt= $dbCon->prepare("update user_logins set dob_day=?,dob_month=?,dob_year=?,dob_day_p=?,dob_month_p=?, dob_year_p=? where id=?");
						$stmt->bind_param("iiiiiii", $row_emp['dob_day_p'],$row_emp['dob_month_p'],$row_emp['dob_year_p'],$row_emp['dob_day_p'],$row_emp['dob_month_p'],$row_emp['dob_year_p'],$row['id']);
						//$stmt->execute();
						
						$stmt= $dbCon->prepare("select id,first_name,last_name,email,email_verification_code as hash_code from user_logins where email= ? or email=?");
						//echo $query; die;
						$stmt->bind_param("ss", $row_emp['email'], $row_emp['work_email']);
						$stmt->execute();
						$result = $stmt->get_result();
						$row_id = $result->fetch_assoc();
						
						
						$stmt= $dbCon->prepare("select * from virtual_user_company_profile where company_id=? and invited_user_id=?");
						$stmt->bind_param("ii", $company,$request_id);
						$stmt->execute();
						$result = $stmt->get_result();
						$row_virtual = $result->fetch_assoc();
						
						if(empty($row_virtual))
						{
							$stmt= $dbCon->prepare("insert into user_company_profile (company_id,user_login_id,title,email) values (?,?,?,?)");
							$stmt->bind_param("iiss", $company,$row_id['id'],$row_emp['title'],$row_emp['work_email']);
							$stmt->execute();
						}
						else
						{
							if($row_virtual['job_function']=="" || $row_virtual['job_function']==null)
							{
								$row_virtual['job_function']=1;
							}
							$stmt= $dbCon->prepare("insert into user_company_profile (location_id,job_function,ssn,e_number,description_job,e_type,h_date,res_date,company_id,user_login_id,title,department,phone,mobile,email,fax,skype,facebook,twitter,i_street,i_town,i_city,i_zip,i_country,d_street,d_town,d_city,d_zip,d_country,b_member,mentor,c_id,prospect,partner,supplier) values (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)");
							$stmt->bind_param("iissssssiisssssssssssssssssssssssss",$row_virtual['location_id'],$row_virtual['job_function'],$row_virtual['ssn'],$row_virtual['e_number'],$row_virtual['description_job'],$row_virtual['e_type'],$row_virtual['h_date'],$row_virtual['res_date'],$company,$row_id['id'],$row_virtual['title'],$row_virtual['department'],$row_virtual['phone'],$row_virtual['mobile'],$row_virtual['email'],$row_virtual['fax'],$row_virtual['skype'],$row_virtual['facebook'],$row_virtual['twitter'],$row_virtual['i_street'],$row_virtual['i_town'],$row_virtual['i_city'],$row_virtual['i_zip'],$row_virtual['i_country'],$row_virtual['d_street'],$row_virtual['d_town'],$row_virtual['d_city'],$row_virtual['d_zip'],$row_virtual['d_country'],$row_virtual['b_member'],$row_virtual['mentor'],$row_virtual['c_id'],$row_virtual['prospect'],$row_virtual['partner'],$row_virtual['supplier']);
							$stmt->execute();
						}
						
						
						$stmt= $dbCon->prepare("select * from virtual_user_profiles where invited_user_id=?");
						$stmt->bind_param("i", $request_id);
						$stmt->execute();
						$result = $stmt->get_result();
						$row_uvirtual = $result->fetch_assoc();
						
						if(!empty($row_uvirtual))
						{
							$stmt= $dbCon->prepare("select id from user_profiles where user_logins_id=?");
							
							$stmt->bind_param("i", $row_id['id']);
							$stmt->execute();
							$result = $stmt->get_result();
							$row_pro = $result->fetch_assoc();
							$d=date('Y-m-d');
							if(empty($row_pro))
							{
								$stmt= $dbCon->prepare("insert into user_profiles (mobile_p,nation,user_logins_id,created_on,modified_on,summary,zipcode,city,state,country,phone_number,address,marital_status,blog,skype,linkedln,facebook,twitter,instagram) values (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?)");
								$stmt->bind_param("ssissssssssssssssss", $row_emp['mobile_p'],$row_uvirtual['nation'],$row_id['id'],$d,$d,$row_uvirtual['summary'],$row_uvirtual['zipcode'],$row_uvirtual['city'],$row_uvirtual['state'],$row_uvirtual['country'],$row_uvirtual['phone_number'],$row_uvirtual['address'],$row_uvirtual['marital_status'],$row_uvirtual['blog'],$row_uvirtual['skype'],$row_uvirtual['linkedln'],$row_uvirtual['facebook'],$row_uvirtual['twitter'],$row_uvirtual['instagram']);
								$stmt->execute();
							}
							else 
							{
								$stmt= $dbCon->prepare("update user_profiles set modified_on=?,summary=?,zipcode=?,city=?,state=?,country=?,phone_number=?,address=?,marital_status=?,blog=?,skype=?,linkedln=?,facebook=?,twitter=?,instagram=? where user_logins_id=?");
								$stmt->bind_param("sssssssssssssssi", $d,$row_uvirtual['summary'],$row_uvirtual['zipcode'],$row_uvirtual['city'],$row_uvirtual['state'],$row_uvirtual['country'],$row_uvirtual['phone_number'],$row_uvirtual['address'],$row_uvirtual['marital_status'],$row_uvirtual['blog'],$row_uvirtual['skype'],$row_uvirtual['linkedln'],$row_uvirtual['facebook'],$row_uvirtual['twitter'],$row_uvirtual['instagram'],$row_id['id']);
								$stmt->execute();
							}
						}
						
						
					}
					
				}
			}
			
			$stmt = $dbCon->prepare("select count(id) as num from estore_employee_invite where company_id=?");
			
			/* bind parameters for markers */
			
			$stmt->bind_param("i", $company);
			$stmt->execute();
			$result = $stmt->get_result();
			$row_invited = $result->fetch_assoc();
			
			$stmt = $dbCon->prepare("select count(id) as num from estore_employee_invite where company_id=? and real_employee_id is not null");
			
			/* bind parameters for markers */
			
			$stmt->bind_param("i", $company);
			$stmt->execute();
			$result = $stmt->get_result();
			$row_invited_approved = $result->fetch_assoc();
			
			
			$stmt = $dbCon->prepare("select count(id) as num from employee_request_cloud where company_id=?");
			
			/* bind parameters for markers */
			
			$stmt->bind_param("i", $company);
			$stmt->execute();
			$result = $stmt->get_result();
			$row_request = $result->fetch_assoc();
			
			$stmt = $dbCon->prepare("select count(id) as num from employee_request_cloud where company_id=? and is_approved=1");
			
			/* bind parameters for markers */
			
			$stmt->bind_param("i", $company);
			$stmt->execute();
			$result = $stmt->get_result();
			$row_request_approved = $result->fetch_assoc();
			
			$total_request=$row_invited['num']+$row_request['num'];
			$total_request_approved=$row_invited_approved['num']+$row_request_approved['num'];
			$completed=($total_request_approved/$total_request)*100;
			$completed=round($completed,0);
			
			$stmt = $dbCon->prepare("update company_profiles set completed_requests=? where company_id=?");
			
			/* bind parameters for markers */
			
			$stmt->bind_param("ii", $completed,$company);
			$stmt->execute();
			
			
			 
			$stmt= $dbCon->prepare("delete from  invitation where invited_user_id= ?");
			$stmt->bind_param("i",$request_id);
			//$stmt->execute();
			$stmt= $dbCon->prepare("delete from  estore_employee_invite where id= ?");
			$stmt->bind_param("i",$request_id);
			//$stmt->execute();
			$stmt= $dbCon->prepare("delete from  virtual_user_company_profile where invited_user_id= ?");
			$stmt->bind_param("i",$request_id);
			//$stmt->execute();
			$stmt= $dbCon->prepare("delete from  virtual_user_profiles where invited_user_id= ?");
			$stmt->bind_param("i",$request_id);
			//$stmt->execute();
			
				$stmt->close();
				$dbCon->close();
				return 1;
			
			
		}
		
		
	
 function checkMobileAvailability($data)
    {
		
		 $dbCon = AppModel::createConnection();
		 
		 $stmt = $dbCon->prepare("select user_profiles.id from user_profiles left join user_logins on user_logins.id=user_profiles.user_logins_id where phone_number=? and country_of_residence=?");
			/* bind parameters for markers */
		$stmt->bind_param("si", $data['MobileNo'],$data['CountryId']);
		$stmt->execute();
		$result = $stmt->get_result();
		$row = $result->fetch_assoc();
		
		 $arr=array();
        if(!empty($row))
		{
			$arr['result']=0;
			$stmt->close();
			$dbCon->close();
			return $arr;	
		}
		else
		{ 
	$num=(mt_rand(111111,999999));
	 $stmt = $dbCon->prepare("select id from mobile_otp_verification where phone_number=? and country_code=?");
			/* bind parameters for markers */
		$stmt->bind_param("si", $data['MobileNo'],$data['CountryId']);
		$stmt->execute();
		$result = $stmt->get_result();
		$row = $result->fetch_assoc();
		
			if(empty($row))
			{
			$stmt = $dbCon->prepare("insert into mobile_otp_verification (phone_number,country_code,otp) values(?, ?, ?)");
			/* bind parameters for markers */
			$stmt->bind_param("sii", $data['MobileNo'],$data['CountryId'],$num);
			$stmt->execute();	
			}
			else
			{
			$stmt = $dbCon->prepare("update mobile_otp_verification set otp=? where id=?");
			/* bind parameters for markers */
			$stmt->bind_param("si", $num,$row['id']);
			$stmt->execute();
			}
			
			
			 $stmt = $dbCon->prepare("select country_code  from  phone_country_code where id=?");
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['CountryId']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc(); 
			$to            = '+'.trim($row['country_code']).''.trim($data['MobileNo']);
			//$to            = '+919896240046';
			$subject       = "One time password!";
			$emailContent ="Your one time password to verify your mobile is : ".$num;
			$res=json_decode(sendSms($subject, $to, $emailContent),true);
			 
			if($res['status']=='OK')
			{
			$arr['result']=1;
			}
			else
			{
			$arr['result']=2;	
			}
			$stmt->close();
			$dbCon->close();
			return $arr;	
		}	
		
    }
	
	function verifyAddMobileOtp($data)
    {
		
		 $dbCon = AppModel::createConnection();
		 
		$stmt = $dbCon->prepare("select otp from mobile_otp_verification where phone_number=? and country_code=?");
			/* bind parameters for markers */
		$stmt->bind_param("si", $data['MobileNo'],$data['CountryId']);
		$stmt->execute();
		$result = $stmt->get_result();
		$row = $result->fetch_assoc();
		  
		 $arr=array();
        if($row['otp']==$data['OtpPin'])
		{
			
			$arr['result']=1;
			$stmt->close();
			$dbCon->close();
			return $arr;	
		}
		else
		{ 
	
			$arr['result']=0;
			$stmt->close();
			$dbCon->close();
			return $arr;	
		}	
		
    }
	
	function createEmailAccount($data) {
			$dbCon = AppModel::createConnection();
			 
			$a=explode('@', $data['Email']);
			$domain = array_pop($a);
			$random_hash = substr(md5(uniqid(rand(), true)), 16, 16); 
			$stmt = $dbCon->prepare("SELECT id FROM user_logins WHERE email=?");
			
			/* bind parameters for markers*/
			$stmt->bind_param("s", $data['Email']);
			$stmt->execute();
			$result = $stmt->get_result();
			$myrow  = $result->fetch_assoc();
			
			if(empty($myrow))
			{
			$key = '56f98a45d581cb76cab4693fa48ae7f9'; 
			$request = 'http://check.block-disposable-email.com/easyapi/json/' . $key . '/' . $domain;
			
			$response = file_get_contents($request);
			
			$dea = json_decode($response);
			$rf=1;
			$st=0;
			$org=array();
			if ($dea->request_status == 'success')
				{
				$num=(mt_rand(111111,999999));
				$stmt = $dbCon->prepare("INSERT INTO user_logins (registered_from,get_started_wizard_status,email,  email_verification_code , created_on , modified_on, country_of_residence,otp_verification ,grading_status) VALUES (?, ?,   ?, ?, now(), now(), ?, ?, ?)");
				
				/*
					The argument may be one of four types:
					
					i - integer
					d - double
					s - string
					b - BLOB
				*/
				$st=0;
				$stmt->bind_param("iissisi", $rf,$st,$data['Email'], $random_hash, $data['CountryId'],$num,$rf);
				$stmt->execute();
				$id=$stmt->insert_id;
				
				$stmt = $dbCon->prepare("INSERT INTO user_profiles (user_logins_id , created_on , modified_on, phone_number ) VALUES (?, now(), now(), ?)");
				$stmt->bind_param("is", $id, $data['MobileNumber']);  
				$stmt->execute();
				
				$to      = $data['Email'];
				$subject = "Qloud ID - Verify your email";
				$emailContent='<html>
   <head></head>
   <body>
      <div style="margin-top:0!important;margin-bottom:0!important;margin-right:0!important;margin-left:0!important;padding:0">
         <center style="width:100%;table-layout:fixed">
            <table width="100%" cellpadding="0" cellspacing="0" bgcolor="#F5F7F8" style="text-align:center">
               <tbody>
                  <tr>
                     <td>
                        <table width="100%" cellpadding="0" cellspacing="0" bgcolor="#F5F7F8">
                           <tbody>
                              <tr>
                                 <td>
                                    <div style="margin-top:0;margin-bottom:0;margin-right:auto;margin-left:auto;padding-left:0px;padding-right:0px">
                                       <table align="center" style="border-spacing:0;font-family:sans-serif;color:#f5f7f8;Margin:0 auto;width:100%" bgcolor="#F5F7F8">
                                          <tbody>
                                             <tr>
                                                <td style="padding-top:0;padding-bottom:0;padding-right:0;padding-left:0" bgcolor="#F5F7F8">
                                                   <table width="100%" style="border-spacing:0;font-family:sans-serif;color:#f5f7f8" bgcolor="#F5F7F8">
                                                      <tbody>
                                                         <tr>
                                                            <td style="padding-bottom:0px;padding-top:0px;padding-left:20px;padding-right:20px;background-color:#f5f7f8;color:#f5f7f8;width:100%;font-size:1px;line-height:1px;text-align:left;display:none!important">
                                                               <p style="text-align:left;line-height:6px;Margin-top:0px;Margin-bottom:0px">Dina domäner är inställda på att förnyas automatiskt. Öppna det här e-postmeddelandet för att säkerställa att allt fortfarande är uppdaterat. Och glöm inte att du får 20 % rabatt på nya produkter. &nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;</p>
                                                               <div style="display:none;max-height:0px;overflow:hidden">
                                                                  &nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌<wbr>&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌<wbr>&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌<wbr>&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌<wbr>&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌<wbr>&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌<wbr>&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌<wbr>&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;
                                                               </div>
                                                            </td>
                                                         </tr>
                                                      </tbody>
                                                   </table>
                                                </td>
                                             </tr>
                                          </tbody>
                                       </table>
                                    </div>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                        <table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#F5F7F8">
                           <tbody>
                              <tr>
                                 <td bgcolor="#F5F7F8" style="padding-top:0px;padding-bottom:20px">
                                    <div style="margin-top:0;margin-bottom:0;margin-right:auto;margin-left:auto;padding-left:0px;padding-right:0px">
                                    </div>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                        <table width="100%" cellpadding="0" cellspacing="0" bgcolor="#F5F7F8">
                           <tbody>
                              <tr>
                                 <td style="padding-bottom:20px">
                                    <div style="max-width:600px;margin-top:0;margin-bottom:0;margin-right:auto;margin-left:auto;padding-left:20px;padding-right:20px">
                                       <table align="center" style="border-spacing:0;font-family:sans-serif;color:#111111;Margin:0 auto;width:100%;max-width:600px" bgcolor="#F5F7F8">
                                          <tbody>
                                             <tr>
                                                <td bgcolor="#F5F7F8" style="padding-top:0;padding-bottom:0;padding-right:0;padding-left:0">
                                                   <table width="73%" style="border-spacing:0;font-family:Audiowide;color:#111111" bgcolor="#F5F7F8">
                                                      <tbody>
                                                         <tr>
                                                            <td style="padding-top:5px;padding-bottom:0;padding-right:0;padding-left:0px" align="left">
                                                               <p style="font-size:30px; font-weight:normal; Audiowide;">safeqloud</p>
                                                            </td>
                                                         </tr>
                                                      </tbody>
                                                   </table>
                                                </td>
                                                <td width="100%" bgcolor="#F5F7F8" style="padding-top:0;padding-bottom:0;padding-right:0;padding-left:0">
                                                   <table width="100%" style="border-spacing:0;font-family:sans-serif;color:#111111" bgcolor="#F5F7F8">
                                                      <tbody>
                                                         <tr>
                                                            <td style="padding-top:10px;padding-bottom:0px;padding-left:10px;padding-right:0px;background-color:#f5f7f8;width:100%;text-align:right">
                                                               <p style="Margin-top:0px;margin-bottom:0px;font-size:13px;line-height:16px"><strong><a href="tel:077%20588%2080%2023" style="text-decoration:none;color:#111111" target="_blank">Website: <u></u>www.safeqloud.com<u></u></a></strong></p>
                                                            </td>
                                                         </tr>
                                                         <tr>
                                                            <td style="padding-top:0px;padding-bottom:0px;padding-left:10px;padding-right:0px;background-color:#f5f7f8;width:100%;text-align:right">
                                                               <p style="Margin-top:5px;margin-bottom:0px;font-size:13px;line-height:16px">If you have any questions - <u></u>Contact us<u></u></p>
                                                            </td>
                                                         </tr>
                                                      </tbody>
                                                   </table>
                                                </td>
                                             </tr>
                                          </tbody>
                                       </table>
                                    </div>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                        <table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#F5F7F8">
                           <tbody>
                              <tr>
                                 <td bgcolor="#F5F7F8" style="background-color:#f5f7f8;padding-top:0;padding-right:0;padding-left:0;padding-bottom:0">
                                    <div style="max-width:600px;margin-top:0;margin-bottom:0;margin-right:auto;margin-left:auto;padding-left:20px;padding-right:20px">
                                       <table bgcolor="#FFFFFF" width="100%" align="center" border="0" cellspacing="0" cellpadding="0" style="font-family:sans-serif;color:#111111">
                                          <tbody>
                                             <tr>
                                                <td bgcolor="#FFFFFF" align="left" style="padding-top:0px;padding-bottom:0;padding-right:0px;padding-left:0px;text-align:left;background-color:#ffffff;font-weight:bold;font-size:32px;line-height:42px">
                                                   <div style="text-align: center; line-height: 22px; max-width: 600px;
                                                      float: left;
                                                      position: relative; ">
                                                      <div class="wrap maxwi_100 xs-padr25 xs-padl10 padt10 xs-padt0 red_ff2828_bg  brdb_new tall xs-nobrdb" style="max-width: 100%; background-color: #ff2828 !important;
                                                         width: 960px;
                                                         position: relative;
                                                         margin: 0 auto;
                                                         ">
                                                         <div style="height: 250px; width: auto; max-width: 100%; padding-top: 100px; padding-right: 30px;
                                                            padding-left: 30px; margin-right: auto;
                                                            margin-left: auto;  z-index: 5; max-width: 100%; width: auto;">
                                                            <div class="padding-bottom: 40px; text-align: center; font-size: 45px;"><img src="http://www.safeqloud.com/html/usercontent/images/doublecheck.png" width="45px;" height="45px;"></div>
                                                            <div class="padb0 xxs-padb0 ">
                                                               <h1 style="font-size: 50px; font-weight: normal; text-align: center; padding-bottom: 10px; color:white;">Success</h1>
                                                            </div>
                                                            <div style="margin-top: 20px; font-weight: normal; margin-bottom: 10px; text-align: center; color:white; font-size: 20px;">Please verify your email using the one time password : '.$num.'</div>
                                                         </div>
                                                      </div>
                                                   </div>
                                                </td>
                                             </tr>
                                          </tbody>
                                       </table>
                                    </div>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                        <table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#F5F7F8">
                           <tbody>
                              <tr>
                                 <td bgcolor="#F5F7F8" style="padding-top:0px;padding-bottom:0px">
                                    <div style="max-width:600px;margin-top:0;margin-bottom:0;margin-right:auto;margin-left:auto;padding-left:20px;padding-right:20px">
                                    </div>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                        <table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#F5F7F8">
                           <tbody>
                              <tr>
                                 <td bgcolor="#F5F7F8" style="padding-top:0px;padding-bottom:0px">
                                    <div style="max-width:600px;margin-top:0;margin-bottom:0;margin-right:auto;margin-left:auto;padding-left:20px;padding-right:20px">
                                       <table bgcolor="#FFFFFF" align="center" style="border-spacing:0;font-family:sans-serif;color:#111111;margin:0 auto;width:100%;max-width:600px">
                                          <tbody>
                                             <tr>
                                                <td style="padding-top:0;padding-bottom:0;padding-right:0;padding-left:0">
                                                   <table width="100%" style="border-spacing:0;font-family:sans-serif;color:#111111">
                                                      <tbody>
                                                         <tr>
                                                            <td style="padding-top:25px;padding-bottom:0px;padding-left:40px;padding-right:40px;background-color:#ffffff;width:100%;text-align:left">
                                                               <p style="margin-top:0px;line-height:0px;margin-bottom:0px;font-size:4px">&nbsp;</p>
                                                            </td>
                                                         </tr>
                                                      </tbody>
                                                   </table>
                                                </td>
                                             </tr>
                                          </tbody>
                                       </table>
                                    </div>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                        <table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#F5F7F8">
                           <tbody>
                              <tr>
                                 <td bgcolor="#F5F7F8" style="padding-top:0px;padding-bottom:0px">
                                    <div style="max-width:600px;margin-top:0;margin-bottom:0;margin-right:auto;margin-left:auto;padding-left:40px;padding-right:20px">
                                       <table align="center" style="border-spacing:0;font-family:sans-serif;color:#111111;Margin:0 auto;width:100%;max-width:600px">
                                          <tbody>
                                             <tr>
                                                <td width="20" bgcolor="#ffffff" style="padding-top:0;padding-bottom:0;padding-right:0;padding-left:0">
                                                   <img src="https://ci3.googleusercontent.com/proxy/gvkyMPCroXxkwzdJ2Pg_KqgcjVeVgpVE1dRo8rYCiczuJe5UfJllf1ZtOFiYZsB4FzBoGeU7Xdso4PWQyUOj4qIrHsViEiUFA_KBQA=s0-d-e1-ft#http://imagesak.secureserver.net/promos/std/spc_trans.gif" height="30" width="20" border="0" style="display:block;border-width:0" class="CToWUd">
                                                </td>
                                                <td style="padding-top:0px;padding-bottom:0px;padding-right:0;padding-left:0;text-align:center;font-size:0;background-color:#ffffff">
                                                   <div style="width:100%;max-width:560px;display:inline-block;vertical-align:top">
                                                      <table width="100%" style="border-spacing:0;font-family:sans-serif;color:#111111">
                                                         <tbody>
                                                            <tr>
                                                               <td style="padding-top:0px;padding-bottom:0px;padding-left:20px;padding-right:20px;background-color:#ffffff">
                                                                  <table style="border-spacing:0;font-family:sans-serif;color:#111111;width:100%;font-size:14px;text-align:left;background-color:#ffffff;border-top-color:#e8eaeb;border-top-style:solid;border-top-width:1px">
                                                                     <tbody>
                                                                        <tr>
                                                                           <td style="padding-top:20px;padding-bottom:20px;padding-left:20px;padding-right:10px;background-color:#ffffff;width:100%;text-align:left">
                                                                              <table style="border-spacing:0;font-family:sans-serif;color:#111111;Margin:0 auto;width:100%;table-layout:fixed">
                                                                                 <tbody>
                                                                                    <tr>
                                                                                       <td style="padding-top:0px;padding-bottom:0px;padding-left:0px;padding-right:0px;background-color:#ffffff;width:100%;text-align:center">
                                                                                          <p style="Margin-top:0px;line-height:22px;Margin-bottom:0px; fsz14px;">This is sent because you have created a new account using Qloud ID App</p>
                                                                                       </td>
                                                                                    </tr>
                                                                                 </tbody>
                                                                              </table>
                                                                           </td>
                                                                        </tr>
                                                                     </tbody>
                                                                  </table>
                                                               </td>
                                                            </tr>
                                                         </tbody>
                                                      </table>
                                                   </div>
                                                </td>
                                             </tr>
                                          </tbody>
                                       </table>
                                    </div>
                                 </td>
                                 <td width="20" bgcolor="#ffffff" style="padding-top:0;padding-bottom:0;padding-right:0;padding-left:0">
                                    <img src="https://ci3.googleusercontent.com/proxy/gvkyMPCroXxkwzdJ2Pg_KqgcjVeVgpVE1dRo8rYCiczuJe5UfJllf1ZtOFiYZsB4FzBoGeU7Xdso4PWQyUOj4qIrHsViEiUFA_KBQA=s0-d-e1-ft#http://imagesak.secureserver.net/promos/std/spc_trans.gif" height="30" width="20" border="0" style="display:block;border-width:0" class="CToWUd">
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </td>
                  </tr>
               </tbody>
            </table>
            <table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#F5F7F8">
               <tbody>
                  <tr>
                     <td bgcolor="#F5F7F8" style="padding-top:0px;padding-bottom:0px">
                        <div style="max-width:600px;margin-top:0;margin-bottom:0;margin-right:auto;margin-left:auto;padding-left:20px;padding-right:20px">
                           <table bgcolor="#F5F7F8" align="center" style="border-spacing:0;font-family:sans-serif;color:#111111;margin:0 auto;width:100%;max-width:600px">
                              <tbody>
                                 <tr>
                                    <td style="padding-top:0;padding-bottom:0;padding-right:0;padding-left:0">
                                       <table width="100%" style="border-spacing:0;font-family:sans-serif;color:#111111">
                                          <tbody>
                                             <tr>
                                                <td style="padding-top:25px;padding-bottom:0px;padding-left:40px;padding-right:40px;background-color:#f5f7f8;width:100%;text-align:left">
                                                   <p style="margin-top:0px;line-height:0px;margin-bottom:0px;font-size:4px">&nbsp;</p>
                                                </td>
                                             </tr>
                                          </tbody>
                                       </table>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </td>
                  </tr>
               </tbody>
            </table>
         </center>
      </div>
   </body>
</html>';


try{
	sendEmail($subject, $to, $emailContent);
}
catch(Exception $e) {
	
}


				$org['user_id']=$id;
				$org['email']=$data['Email'];
				$org['result']=1;
				$stmt->close();
				$dbCon->close();
				return $org;
				
				} 
				else 
				{
				$org['user_id']=0;
				$org['email']=$data['Email'];
				$org['result']=0;	
				$stmt->close();
				$dbCon->close();
				return $org;
			}
			}
			else 
			{
				$org['user_id']=$myrow['id'];
				$org['email']=$data['Email'];
				$org['result']=2;
				$stmt->close();
				$dbCon->close();
				return $org;
			}	
		}

	function saveCardDetails($data)
		{ 
		
			$dbCon = AppModel::createConnection();
			 
			$stmt = $dbCon->prepare("insert into user_cards(`user_login_id`,`created_on`,`card_number`,card_cvv,exp_month,exp_year,name_on_card,card_type) values(?, now(), ?, ?, ?, ?, ?, ?)");
			$stmt->bind_param("isisiss", $data['UserId'],$data['CardNumber'],$data['Cvv'],$data['ExpirationMonth'],$data['ExpirationYear'],htmlentities($data['CardHolderName'],ENT_NOQUOTES, 'UTF-8'),$data['card_type']);
			if($stmt->execute())
			{
			$stmt = $dbCon->prepare("select is_id_active,invoice_address_required,delivery_address_required from user_profiles where user_logins_id = ?");
				
						/* bind parameters for markers */
			$stmt->bind_param("i", $data['UserId']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowId    = $result->fetch_assoc();	
			
			$stmt = $dbCon->prepare("update user_certificates set pay_required=1,safeqloud_pay_status=1 where certificate_key=?");
			$stmt->bind_param("s", $data['certi']);
			$stmt->execute();
			
			
			$stmt = $dbCon->prepare("select count(id) as num from user_address where user_id = ?");
				
						/* bind parameters for markers */
			$stmt->bind_param("i", $data['UserId']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowAdd    = $result->fetch_assoc();	
			
			if($rowId['delivery_address_required']==0 && $rowAdd['num']==0)
			{
			$stmt->close();
			$dbCon->close();
			return 1;	
			}
			else 
			{
			$stmt = $dbCon->prepare("update user_certificates set safeqloud_pay_status=2 where certificate_key=?");
			$stmt->bind_param("s", $data['certi']);
			$stmt->execute();	
			
			$stmt = $dbCon->prepare("select count(id) as num from user_identification where user_id = ?");
				
						/* bind parameters for markers */
			$stmt->bind_param("i", $data['UserId']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowId    = $result->fetch_assoc();	
			if($rowId['num']==0)
			{
			$stmt->close();
			$dbCon->close();
			return 3;
			}
			else
			{
				
			$stmt = $dbCon->prepare("select count(id) as num from user_identification where user_id = ? and is_completed=1");
				
						/* bind parameters for markers */
			$stmt->bind_param("i", $data['UserId']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowId    = $result->fetch_assoc();	
			if($rowId['num']==0)
			{
			$stmt = $dbCon->prepare("update user_certificates set checkin_required=1,safeqloud_pay_status=3 where certificate_key=?");
			$stmt->bind_param("s", $data['certi']);
			$stmt->execute();	
			$stmt->close();
			$dbCon->close();
			return 4;
			}
			else
			{
			$stmt = $dbCon->prepare("update user_certificates set checkin_required=1,safeqloud_pay_status=4 where user_id=?");
			$stmt->bind_param("i", $data['UserId']);
			$stmt->execute();
			$stmt->close();
			$dbCon->close();
			return 5;	
			}
				
			}
			}
			}
			else
			{
			$stmt->close();
			$dbCon->close();
			return 0;	
			}
		}
	
	
	function listCardDetails($data)
		{ 
		
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select id,name_on_card,card_number from  user_cards where `user_login_id`=?");
			$stmt->bind_param("i", $data['UserId']);
			$stmt->execute();
			$result = $stmt->get_result();
			 
			$org=array();
			while($row = $result->fetch_assoc())
			{
				$row['name_on_card']=html_entity_decode($row['name_on_card'],ENT_NOQUOTES, 'UTF-8');
				$row['card_number']='**** **** **** '.substr($row['card_number'],-4);
				array_push($org,$row);
			}
			$stmt->close();
			$dbCon->close(); 
			return $org;
		}
		
		function lawersInfo()
		{
			$dbCon = AppModel::createConnection();
			 
			$stmt = $dbCon->prepare("select employee_id,languages_used_by_staff,company_name,concat_ws(' ',first_name,last_name) as name from law_firm_resources left join employees on law_firm_resources.employee_id=employees.id left join companies on companies.id=employees.company_id where employee_id in (select id from employees where is_lawer=1 and company_id =? ) and type_of_lawer=?");
			$stmt->bind_param("ii", $_POST['location_detail'],$_POST['type_of_lawer']);
			$stmt->execute();
			$result = $stmt->get_result();
			 
			$org=array();
			while($row = $result->fetch_assoc())
			{
			$practice_area=explode(',',$row['languages_used_by_staff']);
				if (!(in_array($_POST['languages_known'], $practice_area)))
				{
				continue;
				}
			 array_push($org,$row);
		}
			 
			$stmt->close();
			$dbCon->close();
			return $org;
			
			
		}
		
		
		function languagesKnown()
		{
			$dbCon = AppModel::createConnection();
			 
			$stmt = $dbCon->prepare("select id,lang_eng from world_languages");
			$stmt->execute();
			$result = $stmt->get_result();
			$org = array();
			$i=0;
			while($row = $result->fetch_assoc())
			{
				array_push($org,$row);
			}
			
			 
			$stmt->close();
			$dbCon->close();
			return $org;
			
			
		}
		function lawCompanyDetails()
		{ 
		
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select company_id,visiting_address from  property_location left join companies on companies.id=property_location.company_id where company_id in (select company_id from company_lawfirm_account_request where is_approved=1) and companies.country_id=67");
			 
			$stmt->execute();
			$result = $stmt->get_result();
			 
			$org=array();
			while($row = $result->fetch_assoc())
			{
				
				array_push($org,$row);
			}
			$stmt->close();
				$dbCon->close(); 
			return $org;
		}
	
	function companyAddressDetail($data)
		{ 
		
			$dbCon = AppModel::createConnection();
			 
			
			$stmt = $dbCon->prepare("select company_name as name_on_house,property_location.id,street_name_v as address, city_v as city, postal_code_v as zipcode, d_port_number as port_number,street_name_i as invoice_address, city_i as invoice_city, postal_code_i as invoice_zipcode,i_port_number as invoice_port_number,is_invoice_same as is_invoice_same  from  property_location left join companies on companies.id=property_location.company_id where property_location.id =?");
			$stmt->bind_param("i", $data['id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			foreach($row as $string)
			{
			$string=html_entity_decode($string,ENT_NOQUOTES, 'UTF-8');
			}
			$stmt->close();
				$dbCon->close();
			return $row;
		}
	
	
	
	function addressDetail($data)
		{ 
		
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select * from  user_address where `id`=?");
			$stmt->bind_param("i", $data['id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			$stmt->close();
			$dbCon->close();
			$row['address']=html_entity_decode($row['address'],ENT_NOQUOTES, 'UTF-8');
			$row['city']=html_entity_decode($row['city'],ENT_NOQUOTES, 'UTF-8');
			$row['invoice_address']=html_entity_decode($row['invoice_address'],ENT_NOQUOTES, 'UTF-8');
			$row['invoice_city']=html_entity_decode($row['invoice_city'],ENT_NOQUOTES, 'UTF-8');
			$stmt->close();
				$dbCon->close(); 
			return $row;
		}
		
		function getBookingDetail($data)
		{ 
		
			$dbCon = AppModel::createConnection();
			$id=$this->encrypt_decrypt('decrypt',$data['id']);
			$d=date('Y-m-d');
			
			$stmt = $dbCon->prepare("select payment_option,total_days,guest_adult,guest_children,checkin_booking_date,checkout_booking_date,room_type_id,total_days,price,hotel_property_type from hotel_checkout_detail where id=? and is_paid=0");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $id);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowPrice = $result->fetch_assoc();
		 
			if($rowPrice['hotel_property_type']==1)
			{
			$stmt = $dbCon->prepare("select longitude,latitude,hotel_name,property_location.visiting_address,company_hotel_room_type_detail.id,room_type_name,room_price,hotel_room_type.room_type from company_hotel_room_type_detail left join hotel_room_type on hotel_room_type.id=company_hotel_room_type_detail.room_type left join hotel_basic_information on company_hotel_room_type_detail.location_id=hotel_basic_information.property_id left join property_location on property_location.id=hotel_basic_information.property_id where company_hotel_room_type_detail.id=?");	
			}				
			else
			{
				$stmt = $dbCon->prepare("select longitude,latitude,property_nickname as hotel_name,address as visiting_address,id,property_nickname as room_type_name  from user_address where id=?");
			}
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $rowPrice['room_type_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			
			$row['room_price']=$rowPrice['price'];
			$row['room_type']=1;
			
			$stmt->close();
			$dbCon->close();
			 
			$row['price']=$rowPrice['price']*$rowPrice['total_days'];
			if($rowPrice['guest_children']==0)
			{
			$row['guests']=$rowPrice['guest_adult'].' adults';	
			}
			else if($rowPrice['guest_children']==1)
			{
			$row['guests']=$rowPrice['guest_adult'].' adults & '.$rowPrice['guest_children'].' child';	
			}
			else
			{
			$row['guests']=$rowPrice['guest_adult'].' adults & '.$rowPrice['guest_children'].' children';		
			}
			$row['payment_option']=$rowPrice['payment_option'];
			$row['total_days']=$rowPrice['total_days'];
			$row['booking']=date('d M',$rowPrice['checkin_booking_date']).'-'.date('d M Y',$rowPrice['checkout_booking_date']);	
			$stmt->close();
			$dbCon->close();
			return $row;
		}
		
		
		function verifyCheckinDetail($data)
		{ 
		
			$dbCon = AppModel::createConnection();
			$id=$this->encrypt_decrypt('decrypt',$data['id']);
			if($id==0)
			{
			$stmt = $dbCon->prepare("select user_id from user_certificates where certificate_key=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("s", $data['certi']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			$stmt->close();
			$dbCon->close();
			return $row;
			}
			else
			{
			$stmt = $dbCon->prepare("select user_id from hotel_checkout_detail where id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $id);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			$stmt->close();
			$dbCon->close();
			return $row;	
			}
			
		}
		
		
		function getPurchaseDetail($data)
		{ 
		
			$dbCon = AppModel::createConnection();
			$ip=$this->encrypt_decrypt('decrypt',$data['ip']);
			$d=date('Y-m-d');
			  
			$stmt = $dbCon->prepare("select * from eshop_checkout_detail where ip_address=? and created_on=?");
			$stmt->bind_param("ss", $ip,$d);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			$stmt = $dbCon->prepare("select sum(total_price) as sum  from eshop_checkout_products_detail where eshop_checkout_id=?  and is_paid=0");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $row['id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowPrice = $result->fetch_assoc();
			
			$stmt = $dbCon->prepare("select free_text,company_name from business_dashboard_images left join companies on companies.id=business_dashboard_images.business_id where business_id=? and business_type=1");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $row['company_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			
			$row = $result->fetch_assoc();
			$org=array();
			$stmt->close();
			$dbCon->close();
			 
			$org['price']=$rowPrice['sum'];
			if($row['free_text']==null || $row['free_text']=='')
			{
			$org['company_name']=html_entity_decode($row['company_name'],ENT_NOQUOTES, 'UTF-8');	
			}
			else
			{
				$org['company_name']=html_entity_decode($row['free_text'],ENT_NOQUOTES, 'UTF-8');
			}
		 $stmt->close();
				$dbCon->close();
			return $org;
		}
		
		function profileDetail($data)
		{
			
			$dbCon = AppModel::createConnection();
			 
			$stmt = $dbCon->prepare("select companies.id,company_name,company_email,profile_pic from companies left join company_profiles on company_profiles.company_id=companies.id where companies.id in (select company_id from user_company_profile where user_login_id=? and company_permission=1) order by company_name desc limit 0,10");
				/* bind parameters for markers */
			$stmt->bind_param("i", $data['user_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			 
			$org=array();
			while($row = $result->fetch_assoc())
			{
				
				if($row['profile_pic']=="" || $row['profile_pic']==null)
				{
					$image='https://www.safeqloud.com/html/usercontent/images/random/officepng.png';
				}
				else
				{
				$filename="../estorecss/".$row['profile_pic'].".txt"; $value_a=file_get_contents("../estorecss/".$row['profile_pic'].".txt"); $value_a=str_replace('"','',$value_a); $image = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$row['profile_pic'].'.jpg' );
				$image=str_replace('../','https://www.safeqloud.com/',$image);	
				}
				$row['profile_pic']=$image;
				$row['company_name']=html_entity_decode($row['company_name'],ENT_NOQUOTES, 'UTF-8');
				array_push($org,$row);
			}
			 
				$stmt->close();
				$dbCon->close();
				return $org;	
		 
			
		}
	
		
		
		function invoiceAddresses($data)
		{
		$dbCon = AppModel::createConnection();	
		 
		$stmt = $dbCon->prepare("select company_profiles.company_id,country_name,company_name,company_profiles.id,si_address,si_city,si_zip,si_country,i_port_number from company_profiles left join companies on companies.id=company_profiles.company_id left join phone_country_code on phone_country_code.id=companies.country_id where company_id in (select company_id from user_company_profile where user_login_id=? and company_permission=1) order by company_name desc limit 0,10");
		/* bind parameters for markers */
		$stmt->bind_param("i", $data['user_id']);
		$stmt->execute();
		$result = $stmt->get_result();
		$org=array();
		$j=0;
		while($row = $result->fetch_assoc())
		{
			$org[$j]['is_user']=0;
			$org[$j]['company_id']=$row['company_id'];
			$org[$j]['index_id']='0_'.$row['id'];
			$org[$j]['id']=$row['id'];
			$org[$j]['name_on_house']=html_entity_decode($row['company_name'],ENT_NOQUOTES, 'UTF-8');
			$org[$j]['invoice_address']=html_entity_decode($row['si_address'],ENT_NOQUOTES, 'UTF-8');
			$org[$j]['invoice_city']=html_entity_decode($row['si_city'],ENT_NOQUOTES, 'UTF-8');
			$org[$j]['invoice_zip']=html_entity_decode($row['si_zip'],ENT_NOQUOTES, 'UTF-8');
			$org[$j]['invoice_country']=html_entity_decode($row['country_name'],ENT_NOQUOTES, 'UTF-8');
			$org[$j]['invoice_port_number']=html_entity_decode($row['i_port_number'],ENT_NOQUOTES, 'UTF-8');
		$j++;	 
		}
	 
		$stmt = $dbCon->prepare("select concat_ws(' ',user_logins.first_name,user_logins.last_name) as name,country_name,user_address.id,invoice_address,invoice_city,invoice_zipcode,invoice_port_number from  user_address left join user_logins on user_logins.id=user_address.user_id left join phone_country_code on phone_country_code.id=user_logins.country_of_residence where `user_id`=? and is_personal_address=1");
		$stmt->bind_param("i", $data['user_id']);
		$stmt->execute();
		$result = $stmt->get_result();
		$row = $result->fetch_assoc();
		if(!empty($row))
		{
			$org[$j]['is_user']=1;
			$org[$j]['company_id']=0;
			$org[$j]['index_id']='1_'.$row['id'];
			$org[$j]['id']=$row['id'];
			$org[$j]['name_on_house']=html_entity_decode($row['name'],ENT_NOQUOTES, 'UTF-8');
			$org[$j]['invoice_address']=html_entity_decode($row['invoice_address'],ENT_NOQUOTES, 'UTF-8');
			$org[$j]['invoice_city']=html_entity_decode($row['invoice_city'],ENT_NOQUOTES, 'UTF-8');
			$org[$j]['invoice_zip']=html_entity_decode($row['invoice_zipcode'],ENT_NOQUOTES, 'UTF-8');
			$org[$j]['invoice_country']=html_entity_decode($row['country_name'],ENT_NOQUOTES, 'UTF-8');
			$org[$j]['invoice_port_number']=html_entity_decode($row['invoice_port_number'],ENT_NOQUOTES, 'UTF-8'); 	
		}
			
			$stmt->close();
			$dbCon->close();
			return $org;	
		}
		
		function deliveryAddressDetail($data)
		{ 
		
			$dbCon = AppModel::createConnection();
			if($data['user_address']==1)
			{
			$stmt = $dbCon->prepare("select entry_code,country_name,user_address.id,user_address.address,user_address.city,user_address.zipcode,user_address.port_number,user_address.name_on_house from  user_address left join user_logins on user_logins.id=user_address.user_id left join phone_country_code on phone_country_code.id=user_logins.country_of_residence where user_address.id=?");
			$stmt->bind_param("i", $data['id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			$stmt->close();
			$dbCon->close();
			$row['address']=html_entity_decode($row['address'],ENT_NOQUOTES, 'UTF-8');
			$row['city']=html_entity_decode($row['city'],ENT_NOQUOTES, 'UTF-8');
			$row['zipcode']=html_entity_decode($row['zipcode'],ENT_NOQUOTES, 'UTF-8');
			$row['port_number']=html_entity_decode($row['port_number'],ENT_NOQUOTES, 'UTF-8');
			$row['name_on_house']=html_entity_decode($row['name_on_house'],ENT_NOQUOTES, 'UTF-8');
			$row['country_name']=html_entity_decode($row['country_name'],ENT_NOQUOTES, 'UTF-8');
			}
			else
			{
			$stmt = $dbCon->prepare("select country_name,company_name,property_location.id,street_name_v, city_v, postal_code_v, d_port_number from  property_location left join companies on companies.id=property_location.company_id left join phone_country_code on phone_country_code.id=companies.country_id where property_location.id =?");
			$stmt->bind_param("i",$data['id']);
			$stmt->execute();
			$result = $stmt->get_result();	
			$row = $result->fetch_assoc();
			$stmt->close();
			$dbCon->close();
			$row['address']=html_entity_decode($row['street_name_v'],ENT_NOQUOTES, 'UTF-8');
			$row['city']=html_entity_decode($row['city_v'],ENT_NOQUOTES, 'UTF-8');
			$row['zipcode']=html_entity_decode($row['postal_code_v'],ENT_NOQUOTES, 'UTF-8');
			$row['port_number']=html_entity_decode($row['d_port_number'],ENT_NOQUOTES, 'UTF-8');
			$row['name_on_house']=html_entity_decode($row['company_name'],ENT_NOQUOTES, 'UTF-8');
			$row['country_name']=html_entity_decode($row['country_name'],ENT_NOQUOTES, 'UTF-8');
			$row['entry_code']='';
			}
			return $row;
		}
		
	
	function listAddresses($data)
		{ 
		
			$dbCon = AppModel::createConnection();
			$org=array();
			$j=0;
			if($data['user_address']==1)
			{
			$stmt = $dbCon->prepare("select id,address,city,zipcode,port_number,name_on_house from  user_address where `user_id`=?");
			$stmt->bind_param("i", $data['UserId']);
			$stmt->execute();
			$result = $stmt->get_result();
			while($row = $result->fetch_assoc())
			{
				$org[$j]['id']=$row['id'];
				$org[$j]['user_address']=1;
				$org[$j]['heading_address']=html_entity_decode($row['name_on_house'],ENT_NOQUOTES, 'UTF-8').','.html_entity_decode($row['address'],ENT_NOQUOTES, 'UTF-8').' '.$row['port_number']; 
				$org[$j]['subheading_address']=html_entity_decode($row['city'],ENT_NOQUOTES, 'UTF-8').'  '.$row['zipcode']; 
				$j++;
			}
				
			}
			else
			{
			$stmt = $dbCon->prepare("select company_name,property_location.id,street_name_v, city_v, postal_code_v, d_port_number from  property_location left join companies on companies.id=property_location.company_id where property_location.id in (select location_id from employee_location where employee_id in (select id from employees where user_login_id=? and company_id in (select company_id from user_company_profile where user_login_id=? and company_permission=1))) limit 0,10");
			$stmt->bind_param("ii", $data['UserId'],$data['UserId']);
			$stmt->execute();
			$result = $stmt->get_result();
			 
			while($row = $result->fetch_assoc())
			{
				$org[$j]['id']=$row['id'];
				$org[$j]['user_address']=0;
				$org[$j]['heading_address']=html_entity_decode($row['company_name'],ENT_NOQUOTES, 'UTF-8').','.html_entity_decode($row['street_name_v'],ENT_NOQUOTES, 'UTF-8').'-'.$row['d_port_number']; 
				$org[$j]['subheading_address']=html_entity_decode($row['city_v'],ENT_NOQUOTES, 'UTF-8').' - '.$row['postal_code_v']; 
				$j++;
			}	
			}
			
			
			 
			 
			return $org;
		}
		
		function listDeliveryAddresses($data)
		{ 
		
			$dbCon = AppModel::createConnection();
			$org=array();
			$org['user_address']=array();
			$org['company_address']=array();
			$j=0;
			$stmt = $dbCon->prepare("select country_name from  phone_country_code where id=(select country_of_residence from user_logins where id=?)");
			$stmt->bind_param("i", $data['UserId']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowCountry = $result->fetch_assoc();
			$stmt = $dbCon->prepare("select id,address,city,zipcode,port_number,name_on_house from  user_address where `user_id`=?");
			$stmt->bind_param("i", $data['UserId']);
			$stmt->execute();
			$result = $stmt->get_result();
			while($row = $result->fetch_assoc())
			{
				$org['user_address'][$j]['id']=$row['id'];
				$org['user_address'][$j]['user_address']=1;
				$org['user_address'][$j]['name_on_house']=html_entity_decode($row['name_on_house'],ENT_NOQUOTES, 'UTF-8');
				$org['user_address'][$j]['heading_address']=html_entity_decode($row['address'],ENT_NOQUOTES, 'UTF-8').' '.$row['port_number']; 
				$org['user_address'][$j]['subheading_address']=html_entity_decode($row['city'],ENT_NOQUOTES, 'UTF-8').' '.$row['zipcode'].','.$rowCountry['country_name']; 
				$j++;
			}
				
			$j=0;
			$stmt = $dbCon->prepare("select country_name,company_name,property_location.id,street_name_v, city_v, postal_code_v, d_port_number from  property_location left join companies on companies.id=property_location.company_id left join phone_country_code on phone_country_code.id=companies.country_id where property_location.id in (select location_id from employee_location where employee_id in (select id from employees where user_login_id=? and company_id in (select company_id from user_company_profile where user_login_id=? and company_permission=1))) limit 0,10");
			$stmt->bind_param("ii", $data['UserId'],$data['UserId']);
			$stmt->execute();
			$result = $stmt->get_result();
			 
			while($row = $result->fetch_assoc())
			{
				$org['company_address'][$j]['id']=$row['id'];
				$org['company_address'][$j]['user_address']=0;
				$org['company_address'][$j]['name_on_house']=html_entity_decode($row['company_name'],ENT_NOQUOTES, 'UTF-8');
				$org['company_address'][$j]['heading_address']=html_entity_decode($row['street_name_v'],ENT_NOQUOTES, 'UTF-8').' '.$row['d_port_number']; 
				$org['company_address'][$j]['subheading_address']=html_entity_decode($row['city_v'],ENT_NOQUOTES, 'UTF-8').' '.$row['postal_code_v'].','.$rowCountry['country_name']; 
				$j++;
			}	
			
			
			 
			 
			return $org;
		}
		
		function bedroomBedDetail($data)
		{ 
			$dbCon = AppModel::createConnection();
		
			$org=array();
			$stmt = $dbCon->prepare("select * from user_apartment_bedrooms_beds where bedroom_id=?");
			$stmt->bind_param("i", $data['id']);
			$stmt->execute();
			$result1 = $stmt->get_result();
			$j=0;
			while($row= $result1->fetch_assoc())
			{				

			array_push($org,$row);
			$org[$j]['bedtype']=array();
			$stmt = $dbCon->prepare("select * from apartment_bed_type");
			$stmt->execute();
			$result2 = $stmt->get_result();
			while($row2= $result2->fetch_assoc())
			{	
			array_push($org[$j]['bedtype'],$row2);
			}
			$j++;
			}
			$stmt->close();
			$dbCon->close();
			return $org;	
		}
		
		function bedroomDetail($data)
		{ 
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("update user_address set bedroom_updated=1 where id=?");
			$stmt->bind_param("i", $data['aid']);
			$stmt->execute();
			
			$stmt = $dbCon->prepare("select * from user_apartment_bedrooms where user_address_id=?");
			$stmt->bind_param("i", $data['aid']);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			$j=0;
			while($row = $result->fetch_assoc())
			{
			$row['bedroom_count']=$j+1;	
			array_push($org,$row);
			$org[$j]['bed_type']=array();
			$stmt = $dbCon->prepare("select * from user_apartment_bedrooms_beds where bedroom_id=?");
			$stmt->bind_param("i", $row['id']);
			$stmt->execute();
			$result1 = $stmt->get_result();
			while($row1= $result1->fetch_assoc())
			{							
			array_push($org[$j]['bed_type'],$row1);
			}
			$j++;
			}
			$stmt->close();
			$dbCon->close();
			return $org;	
		}
		
		function bedTypeDetail()
		{ 
		
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select * from apartment_bed_type");
			$stmt->execute();
			$result2 = $stmt->get_result();
			$org=array();
			
			while($row= $result2->fetch_assoc())
			{	
			array_push($org,$row);
			}
			
			$stmt->close();
			$dbCon->close();
			return $org;
		}
		
		
		function addBedroom($data)
		{ 
		
			$dbCon = AppModel::createConnection();
			
			$stmt = $dbCon->prepare("insert into user_apartment_bedrooms (user_address_id, created_on) values (?,now())");
			$stmt->bind_param("i", $data['aid']);
			$stmt->execute();	
			$id=$stmt->insert_id;
			$bed='Single';
			$stmt = $dbCon->prepare("insert into user_apartment_bedrooms_beds (bedroom_id,bed_info, created_on,modified_on) values (?,?,now(),now())");
			$stmt->bind_param("is", $id,$bed);
			$stmt->execute();	
			
			 
			$stmt->close();
			$dbCon->close();
			return 1;	
		}
		
	
		
		function deleteBedroom($data)
		{ 
		
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select count(id) as num from user_apartment_bedrooms where user_address_id=?");
			$stmt->bind_param("i", $data['aid']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			if($row['num']>1)
			{
			$stmt = $dbCon->prepare("select max(id) as m_id from user_apartment_bedrooms where user_address_id=?");
			$stmt->bind_param("i", $data['aid']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			
			$stmt = $dbCon->prepare("delete from user_apartment_bedrooms where id=?");
			$stmt->bind_param("i", $row['m_id']);
			$stmt->execute();	
			
			$stmt = $dbCon->prepare("delete from user_apartment_bedrooms_beds where bedroom_id=?");
			$stmt->bind_param("i", $row['m_id']);
			$stmt->execute();	
			$stmt->close();
			$dbCon->close();
			return 1;
			}
			 else
			 {
			$stmt->close();
			$dbCon->close();
			return 0;
			 }
			 	
		}
		
		function deleteBedroomBedInfo($data)
		{ 
		
			$dbCon = AppModel::createConnection();
			
			$stmt = $dbCon->prepare("select max(id) as m_id from user_apartment_bedrooms_beds where bedroom_id=?");
			$stmt->bind_param("i", $data['id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowBed = $result->fetch_assoc();
			
			$stmt = $dbCon->prepare("select count(id) as num from user_apartment_bedrooms_beds where bedroom_id=?");
			$stmt->bind_param("i", $data['id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			if($row['num']>1)
			{
			$stmt = $dbCon->prepare("delete from user_apartment_bedrooms_beds where id=?");
			$stmt->bind_param("i", $rowBed['m_id']);
			$stmt->execute();
			$stmt->close();
			$dbCon->close();
			return 1;	
			}
			else
			{
			$stmt = $dbCon->prepare("select count(id) as num from user_apartment_bedrooms where user_address_id=?");
			$stmt->bind_param("i", $data['aid']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			if($row['num']>1)
			{
			
			$stmt = $dbCon->prepare("delete from user_apartment_bedrooms where id=?");
			$stmt->bind_param("i",$data['id']);
			$stmt->execute();	
			
			$stmt = $dbCon->prepare("delete from user_apartment_bedrooms_beds where id=?");
			$stmt->bind_param("i", $rowBed['m_id']);
			$stmt->execute();	
			$stmt->close();
			$dbCon->close();
			return 1;
			}
			else
			{
			$stmt->close();
			$dbCon->close();
			return 0;
			}	
			}
			 
			
			 	
		}
		
		function updateBedTypeInfo($data)
		{ 
		
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("update user_apartment_bedrooms_beds set bed_info=?,modified_on=now() where id=?");
			$stmt->bind_param("si",$data['bed_info'], $data['bed_id']);
			$stmt->execute();
			$stmt->close();
			$dbCon->close();
			return 1;
		}
		
		function addBedToBedroom($data)
		{ 
		
			$dbCon = AppModel::createConnection();
			$bed="Single";
			$stmt = $dbCon->prepare("insert into user_apartment_bedrooms_beds (bedroom_id,bed_info,created_on,modified_on) values (?, ?, now(), now())");
			$stmt->bind_param("is", $data['id'],$bed);
			$stmt->execute();
			$stmt->close();
			$dbCon->close();
			return 1;
		}
		
		
		function listUserDeliveryAddresses($data)
		{ 
		
			$dbCon = AppModel::createConnection();
			$stmt = $dbCon->prepare("select id,address,city,zipcode,port_number,name_on_house,bedroom_updated,bathroom_updated,property_nickname from  user_address where `user_id`=?");
			$stmt->bind_param("i", $data['UserId']);
			$stmt->execute();
			$result = $stmt->get_result();
			 
			$org=array();
			$j=0;
			while($row = $result->fetch_assoc())
			{
				$row['address']=html_entity_decode($row['address'],ENT_NOQUOTES, 'UTF-8');
				$row['name_on_house']= html_entity_decode($row['name_on_house'],ENT_NOQUOTES, 'UTF-8');
				$row['property_nickname']= html_entity_decode($row['property_nickname'],ENT_NOQUOTES, 'UTF-8');
				$row['user_address']=1;
				$row['heading_address']=html_entity_decode($row['name_on_house'],ENT_NOQUOTES, 'UTF-8').','.html_entity_decode($row['address'],ENT_NOQUOTES, 'UTF-8').'-'.$row['port_number']; 
				$row['subheading_address']=html_entity_decode($row['city'],ENT_NOQUOTES, 'UTF-8').' - '.$row['zipcode']; 
				 array_push($org,$row);
				$j++;
			}
			
			$stmt->close();
			$dbCon->close(); 
			 
			return $org;
		}
		
		
		function addAddress($data)
		{ 
		
			$dbCon = AppModel::createConnection();
			 
			if($data['IsInvoiceAddressSame']==true)
			{
			$data['IsInvoiceAddressSame']=1;
			}
			else
			{
			$data['IsInvoiceAddressSame']=0;	
			}
			
			if($data['IsNameSame']==true)
			{
			$data['IsNameSame']=1;
			}
			else
			{
			$data['IsNameSame']=0;	
			}
			$stmt = $dbCon->prepare("select count(id) as num from user_address where user_id = ?");
				
						/* bind parameters for markers */
			$stmt->bind_param("i", $data['UserId']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowId    = $result->fetch_assoc();	
			if($rowId['num']==0)
			{
			$stmt = $dbCon->prepare("update user_profiles set name_on_door=?, entry_code=?, full_address=?, port_number=?, address=?, city=?, zipcode=?,invoice_address=?,invoice_zipcode=?,invoice_city=?,invoice_port=?,is_invoice_same=?,is_name_on_house_same=?,is_id_active=1  where user_logins_id=?");
				/* bind parameters for markers */
			$stmt->bind_param("sssssssssssiii",$data['Name'],$data['EntryCode'], $data['DeliveryAddress'],$data['DeliveryPortNumber'], $data['DeliveryAddress'],$data['DeliveryCity'],$data['DeliveryZipCode'],$data['InvoiceAddress'],$data['InvoiceZipCode'],$data['InvoiceCity'],$data['InvoicePortNumber'],$data['IsInvoiceAddressSame'],$data['IsNameSame'],$data['UserId']);
			$stmt->execute();
			
			$stmt = $dbCon->prepare("insert into  user_address ( `user_id`, `address`  , `city`  , `zipcode` , `port_number` , `invoice_address`  , `invoice_city`  , `invoice_zipcode`  , `invoice_port_number`  , `is_name_same`  , `is_invoice_same`  , `name_on_house`   , `created_on`,entry_code ) values (? , ?, ?, ?, ? , ?, ?, ?, ? , ?, ?, ?, now(), ?)");
				/* bind parameters for markers */
			$stmt->bind_param("issssssssiiss",$data['UserId'],$data['DeliveryAddress'],$data['DeliveryCity'],$data['DeliveryZipCode'],$data['DeliveryPortNumber'],$data['InvoiceAddress'],$data['InvoiceCity'],$data['InvoiceZipCode'],$data['InvoicePortNumber'],$data['IsInvoiceAddressSame'],$data['IsNameSame'],$data['Name'],$data['EntryCode']);
			$stmt->execute();
			$id=$stmt->insert_id;
			}
			else
			{
				$st=0;
			$stmt = $dbCon->prepare("insert into  user_address ( `user_id`, `address`  , `city`  , `zipcode` , `port_number` , `invoice_address`  , `invoice_city`  , `invoice_zipcode`  , `invoice_port_number`  , `is_name_same`  , `is_invoice_same`  , `name_on_house`   , `created_on`,entry_code, is_personal_address ) values (? , ?, ?, ?, ? , ?, ?, ?, ? , ?, ?, ?, now(), ?, ?)");
				/* bind parameters for markers */
			$stmt->bind_param("issssssssiissi",$data['UserId'],$data['DeliveryAddress'],$data['DeliveryCity'], $data['DeliveryZipCode'],$data['DeliveryPortNumber'],$data['InvoiceAddress'],$data['InvoiceCity'],$data['InvoiceZipCode'],$data['InvoicePortNumber'],$data['IsInvoiceAddressSame'],$data['IsNameSame'],$data['Name'],$data['EntryCode'],$st);
			$stmt->execute();
			$id=$stmt->insert_id;	
			}
			
			$stmt = $dbCon->prepare("update user_certificates set safeqloud_pay_status=2 where certificate_key=?");
			$stmt->bind_param("s", $data['CertificateKey']);
			$stmt->execute();
			
			$stmt = $dbCon->prepare("select count(id) as num from user_identification where user_id = ?");
				
						/* bind parameters for markers */
			$stmt->bind_param("i", $data['UserId']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowId    = $result->fetch_assoc();	
			if($rowId['num']==0)
			{
			$stmt->close();
			$dbCon->close();
			return 2;
			}
			else
			{
				
			$stmt = $dbCon->prepare("select count(id) as num from user_identification where user_id = ? and is_completed=1");
				
						/* bind parameters for markers */
			$stmt->bind_param("i", $data['UserId']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowId    = $result->fetch_assoc();	
			if($rowId['num']==0)
			{
			$stmt = $dbCon->prepare("update user_certificates set checkin_required=1,safeqloud_pay_status=3 where certificate_key=?");
			$stmt->bind_param("s", $data['certi']);
			$stmt->execute();	
			$stmt->close();
			$dbCon->close();
			return 3;
			}
			else
			{
			$stmt = $dbCon->prepare("update user_certificates set checkin_required=1,safeqloud_pay_status=4 where user_id=?");
			$stmt->bind_param("i", $data['UserId']);
			$stmt->execute();
			$stmt->close();
			$dbCon->close();
			return 1;	
			}
				
			}
			
			 
		}
	
	function addNewAddress($data)
		{ 
		
			$dbCon = AppModel::createConnection();
			 
			if($data['IsInvoiceAddressSame']==true)
			{
			$data['IsInvoiceAddressSame']=1;
			}
			else
			{
			$data['IsInvoiceAddressSame']=0;	
			}
			
			if($data['IsNameSame']==true)
			{
			$data['IsNameSame']=1;
			}
			else
			{
			$data['IsNameSame']=0;	
			}
			$stmt = $dbCon->prepare("select count(id) as num from user_address where user_id = ?");
				
						/* bind parameters for markers */
			$stmt->bind_param("i", $data['UserId']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowId    = $result->fetch_assoc();	
			if($rowId['num']==0)
			{
			$stmt = $dbCon->prepare("update user_profiles set name_on_door=?, entry_code=?, full_address=?, port_number=?, address=?, city=?, zipcode=?,invoice_address=?,invoice_zipcode=?,invoice_city=?,invoice_port=?,is_invoice_same=?,is_name_on_house_same=?,is_id_active=1  where user_logins_id=?");
				/* bind parameters for markers */
			$stmt->bind_param("sssssssssssiii",$data['Name'],$data['EntryCode'], htmlentities($data['DeliveryAddress'],ENT_NOQUOTES, 'UTF-8'),$data['DeliveryPortNumber'], htmlentities($data['DeliveryAddress'],ENT_NOQUOTES, 'UTF-8'),htmlentities($data['DeliveryCity'],ENT_NOQUOTES, 'UTF-8'),htmlentities($data['DeliveryZipCode'],ENT_NOQUOTES, 'UTF-8'),htmlentities($data['InvoiceAddress'],ENT_NOQUOTES, 'UTF-8'),$data['InvoiceZipCode'],htmlentities($data['InvoiceCity'],ENT_NOQUOTES, 'UTF-8'),$data['InvoicePortNumber'],$data['IsInvoiceAddressSame'],$data['IsNameSame'],$data['UserId']);
			$stmt->execute();
			
			$stmt = $dbCon->prepare("insert into  user_address ( `user_id`, `address`  , `city`  , `zipcode` , `port_number` , `invoice_address`  , `invoice_city`  , `invoice_zipcode`  , `invoice_port_number`  , `is_name_same`  , `is_invoice_same`  , `name_on_house`   , `created_on`,entry_code ) values (? , ?, ?, ?, ? , ?, ?, ?, ? , ?, ?, ?, now(), ?)");
				/* bind parameters for markers */
			$stmt->bind_param("issssssssiiss",$data['UserId'],htmlentities($data['DeliveryAddress'],ENT_NOQUOTES, 'UTF-8'),$data['DeliveryCity'], htmlentities($data['DeliveryZipCode'],ENT_NOQUOTES, 'UTF-8'),htmlentities($data['DeliveryPortNumber'],ENT_NOQUOTES, 'UTF-8'),htmlentities($data['InvoiceAddress'],ENT_NOQUOTES, 'UTF-8'),$data['InvoiceCity'],htmlentities($data['InvoiceZipCode'],ENT_NOQUOTES, 'UTF-8'),$data['InvoicePortNumber'],$data['IsInvoiceAddressSame'],$data['IsNameSame'],$data['Name'],$data['EntryCode']);
			$stmt->execute();
			$id=$stmt->insert_id;
			}
			else
			{
				$st=0;
			$stmt = $dbCon->prepare("insert into  user_address ( `user_id`, `address`  , `city`  , `zipcode` , `port_number` , `invoice_address`  , `invoice_city`  , `invoice_zipcode`  , `invoice_port_number`  , `is_name_same`  , `is_invoice_same`  , `name_on_house`   , `created_on`,entry_code, is_personal_address ) values (? , ?, ?, ?, ? , ?, ?, ?, ? , ?, ?, ?, now(), ?, ?)");
				/* bind parameters for markers */
			$stmt->bind_param("issssssssiissi",$data['UserId'],htmlentities($data['DeliveryAddress'],ENT_NOQUOTES, 'UTF-8'),$data['DeliveryCity'], htmlentities($data['DeliveryZipCode'],ENT_NOQUOTES, 'UTF-8'),htmlentities($data['DeliveryPortNumber'],ENT_NOQUOTES, 'UTF-8'),htmlentities($data['InvoiceAddress'],ENT_NOQUOTES, 'UTF-8'),$data['InvoiceCity'],htmlentities($data['InvoiceZipCode'],ENT_NOQUOTES, 'UTF-8'),$data['InvoicePortNumber'],$data['IsInvoiceAddressSame'],$data['IsNameSame'],$data['Name'],$data['EntryCode'],$st);
			$stmt->execute();
			$id=$stmt->insert_id;	
			}
			if(isset($data['CertificateKey']))
			{
			$stmt = $dbCon->prepare("update  user_certificates set `delivery_address_id`=?  , `delivered_at`=1  where certificate_key=?");
				/* bind parameters for markers */
			$stmt->bind_param("is",$id,$data['CertificateKey']);
			$stmt->execute();
			}
			$stmt->close();
			$dbCon->close();
			return 1;
			 
		}
	
	function updateUserAddress($data)
		{ 
		
			$dbCon = AppModel::createConnection();
			 
			 
			
			 
			$stmt = $dbCon->prepare("select is_personal_address from user_address where id = ?");
				
						/* bind parameters for markers */
			$stmt->bind_param("i", $data['id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowId    = $result->fetch_assoc();	
			if($rowId['is_personal_address']==1)
			{
			$stmt = $dbCon->prepare("update user_profiles set name_on_door=?, entry_code=?, full_address=?, port_number=?, address=?, city=?, zipcode=?,invoice_address=?,invoice_zipcode=?,invoice_city=?,invoice_port=?,is_invoice_same=?,is_name_on_house_same=?,is_id_active=1  where user_logins_id=?");
				/* bind parameters for markers */
			$stmt->bind_param("sssssssssssiii",$data['name_on_house'],$data['entry_code'], htmlentities($data['address'],ENT_NOQUOTES, 'UTF-8'),$data['port_number'], htmlentities($data['address'],ENT_NOQUOTES, 'UTF-8'),htmlentities($data['city'],ENT_NOQUOTES, 'UTF-8'),htmlentities($data['zipcode'],ENT_NOQUOTES, 'UTF-8'),htmlentities($data['invoice_address'],ENT_NOQUOTES, 'UTF-8'),$data['invoice_zipcode'],htmlentities($data['invoice_city'],ENT_NOQUOTES, 'UTF-8'),$data['invoice_port_number'],$data['is_invoice_same'],$data['is_name_same'],$data['user_id']);
			$stmt->execute();
			}
			
			$stmt = $dbCon->prepare("update  user_address set `address`=?  , `city`=? , `zipcode`=? , `port_number`=? , `invoice_address`=?  , `invoice_city` =? , `invoice_zipcode` =? , `invoice_port_number`=?  , `is_name_same`=?  , `is_invoice_same`=?  , `name_on_house` =?  , entry_code =? where id=?");
				/* bind parameters for markers */
			$stmt->bind_param("ssssssssiissi",htmlentities($data['address'],ENT_NOQUOTES, 'UTF-8'),$data['city'], htmlentities($data['zipcode'],ENT_NOQUOTES, 'UTF-8'),htmlentities($data['port_number'],ENT_NOQUOTES, 'UTF-8'),htmlentities($data['invoice_address'],ENT_NOQUOTES, 'UTF-8'),$data['invoice_city'],htmlentities($data['invoice_zipcode'],ENT_NOQUOTES, 'UTF-8'),$data['invoice_port_number'],$data['is_invoice_same'],$data['is_name_same'],$data['name_on_house'],$data['entry_code'],$data['id']);
			$stmt->execute();
			$stmt = $dbCon->prepare("update  user_certificates set `delivery_address_id`=?  , `delivered_at`=1  where certificate_key=?");
				/* bind parameters for markers */
			$stmt->bind_param("is",$data['id'],$data['CertificateKey']);
			$stmt->execute();
			$stmt->close();
			$dbCon->close();
			return 1;
			 
		}
	
	
	function updateCompanyAddress($data)
		{ 
		
			$dbCon = AppModel::createConnection();
			
			$stmt = $dbCon->prepare("update  user_certificates set `delivery_address_id`=?  , `delivered_at`=?  where certificate_key=?");
				/* bind parameters for markers */
			$stmt->bind_param("iis",$data['id'],$data['delivered_at'],$data['CertificateKey']);
			$stmt->execute();
			$dbCon->close();
			return 1;
			 
		}
	
	
	
	function restoreAccount($data) {
			$dbCon = AppModel::createConnection();
			 
			$stmt = $dbCon->prepare("SELECT id FROM user_logins WHERE email=?");
			
			/* bind parameters for markers*/
			$stmt->bind_param("s", $data['Email']);
			$stmt->execute();
			$result = $stmt->get_result();
			$myrow  = $result->fetch_assoc();
			 
			if(!empty($myrow))
			{
			 
				$num=(mt_rand(111111,999999));
				$stmt = $dbCon->prepare("update user_logins set otp_verification=? where id=?");
				
				$stmt->bind_param("si", $num,$myrow['id']);
				$stmt->execute();
				
				$to      = $data['Email'];
				$subject = "Qloud ID - Verify your email";
				$emailContent='<html>
   <head></head>
   <body>
      <div style="margin-top:0!important;margin-bottom:0!important;margin-right:0!important;margin-left:0!important;padding:0">
         <center style="width:100%;table-layout:fixed">
            <table width="100%" cellpadding="0" cellspacing="0" bgcolor="#F5F7F8" style="text-align:center">
               <tbody>
                  <tr>
                     <td>
                        <table width="100%" cellpadding="0" cellspacing="0" bgcolor="#F5F7F8">
                           <tbody>
                              <tr>
                                 <td>
                                    <div style="margin-top:0;margin-bottom:0;margin-right:auto;margin-left:auto;padding-left:0px;padding-right:0px">
                                       <table align="center" style="border-spacing:0;font-family:sans-serif;color:#f5f7f8;Margin:0 auto;width:100%" bgcolor="#F5F7F8">
                                          <tbody>
                                             <tr>
                                                <td style="padding-top:0;padding-bottom:0;padding-right:0;padding-left:0" bgcolor="#F5F7F8">
                                                   <table width="100%" style="border-spacing:0;font-family:sans-serif;color:#f5f7f8" bgcolor="#F5F7F8">
                                                      <tbody>
                                                         <tr>
                                                            <td style="padding-bottom:0px;padding-top:0px;padding-left:20px;padding-right:20px;background-color:#f5f7f8;color:#f5f7f8;width:100%;font-size:1px;line-height:1px;text-align:left;display:none!important">
                                                               <p style="text-align:left;line-height:6px;Margin-top:0px;Margin-bottom:0px">Dina domäner är inställda på att förnyas automatiskt. Öppna det här e-postmeddelandet för att säkerställa att allt fortfarande är uppdaterat. Och glöm inte att du får 20 % rabatt på nya produkter. &nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;</p>
                                                               <div style="display:none;max-height:0px;overflow:hidden">
                                                                  &nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌<wbr>&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌<wbr>&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌<wbr>&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌<wbr>&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌<wbr>&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌<wbr>&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌<wbr>&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;
                                                               </div>
                                                            </td>
                                                         </tr>
                                                      </tbody>
                                                   </table>
                                                </td>
                                             </tr>
                                          </tbody>
                                       </table>
                                    </div>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                        <table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#F5F7F8">
                           <tbody>
                              <tr>
                                 <td bgcolor="#F5F7F8" style="padding-top:0px;padding-bottom:20px">
                                    <div style="margin-top:0;margin-bottom:0;margin-right:auto;margin-left:auto;padding-left:0px;padding-right:0px">
                                    </div>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                        <table width="100%" cellpadding="0" cellspacing="0" bgcolor="#F5F7F8">
                           <tbody>
                              <tr>
                                 <td style="padding-bottom:20px">
                                    <div style="max-width:600px;margin-top:0;margin-bottom:0;margin-right:auto;margin-left:auto;padding-left:20px;padding-right:20px">
                                       <table align="center" style="border-spacing:0;font-family:sans-serif;color:#111111;Margin:0 auto;width:100%;max-width:600px" bgcolor="#F5F7F8">
                                          <tbody>
                                             <tr>
                                                <td bgcolor="#F5F7F8" style="padding-top:0;padding-bottom:0;padding-right:0;padding-left:0">
                                                   <table width="73%" style="border-spacing:0;font-family:Audiowide;color:#111111" bgcolor="#F5F7F8">
                                                      <tbody>
                                                         <tr>
                                                            <td style="padding-top:5px;padding-bottom:0;padding-right:0;padding-left:0px" align="left">
                                                               <p style="font-size:30px; font-weight:normal; Audiowide;">safeqloud</p>
                                                            </td>
                                                         </tr>
                                                      </tbody>
                                                   </table>
                                                </td>
                                                <td width="100%" bgcolor="#F5F7F8" style="padding-top:0;padding-bottom:0;padding-right:0;padding-left:0">
                                                   <table width="100%" style="border-spacing:0;font-family:sans-serif;color:#111111" bgcolor="#F5F7F8">
                                                      <tbody>
                                                         <tr>
                                                            <td style="padding-top:10px;padding-bottom:0px;padding-left:10px;padding-right:0px;background-color:#f5f7f8;width:100%;text-align:right">
                                                               <p style="Margin-top:0px;margin-bottom:0px;font-size:13px;line-height:16px"><strong><a href="tel:077%20588%2080%2023" style="text-decoration:none;color:#111111" target="_blank">Website: <u></u>www.safeqloud.com<u></u></a></strong></p>
                                                            </td>
                                                         </tr>
                                                         <tr>
                                                            <td style="padding-top:0px;padding-bottom:0px;padding-left:10px;padding-right:0px;background-color:#f5f7f8;width:100%;text-align:right">
                                                               <p style="Margin-top:5px;margin-bottom:0px;font-size:13px;line-height:16px">If you have any questions - <u></u>Contact us<u></u></p>
                                                            </td>
                                                         </tr>
                                                      </tbody>
                                                   </table>
                                                </td>
                                             </tr>
                                          </tbody>
                                       </table>
                                    </div>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                        <table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#F5F7F8">
                           <tbody>
                              <tr>
                                 <td bgcolor="#F5F7F8" style="background-color:#f5f7f8;padding-top:0;padding-right:0;padding-left:0;padding-bottom:0">
                                    <div style="max-width:600px;margin-top:0;margin-bottom:0;margin-right:auto;margin-left:auto;padding-left:20px;padding-right:20px">
                                       <table bgcolor="#FFFFFF" width="100%" align="center" border="0" cellspacing="0" cellpadding="0" style="font-family:sans-serif;color:#111111">
                                          <tbody>
                                             <tr>
                                                <td bgcolor="#FFFFFF" align="left" style="padding-top:0px;padding-bottom:0;padding-right:0px;padding-left:0px;text-align:left;background-color:#ffffff;font-weight:bold;font-size:32px;line-height:42px">
                                                   <div style="text-align: center; line-height: 22px; max-width: 600px;
                                                      float: left;
                                                      position: relative; ">
                                                      <div class="wrap maxwi_100 xs-padr25 xs-padl10 padt10 xs-padt0 red_ff2828_bg  brdb_new tall xs-nobrdb" style="max-width: 100%; background-color: #ff2828 !important;
                                                         width: 960px;
                                                         position: relative;
                                                         margin: 0 auto;
                                                         ">
                                                         <div style="height: 250px; width: auto; max-width: 100%; padding-top: 100px; padding-right: 30px;
                                                            padding-left: 30px; margin-right: auto;
                                                            margin-left: auto;  z-index: 5; max-width: 100%; width: auto;">
                                                            <div class="padding-bottom: 40px; text-align: center; font-size: 45px;"><img src="http://www.safeqloud.com/html/usercontent/images/doublecheck.png" width="45px;" height="45px;"></div>
                                                            <div class="padb0 xxs-padb0 ">
                                                               <h1 style="font-size: 50px; font-weight: normal; text-align: center; padding-bottom: 10px; color:white;">Success</h1>
                                                            </div>
                                                            <div style="margin-top: 20px; font-weight: normal; margin-bottom: 10px; text-align: center; color:white; font-size: 20px;">Please verify your email using the one time password : '.$num.'</div>
                                                         </div>
                                                      </div>
                                                   </div>
                                                </td>
                                             </tr>
                                          </tbody>
                                       </table>
                                    </div>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                        <table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#F5F7F8">
                           <tbody>
                              <tr>
                                 <td bgcolor="#F5F7F8" style="padding-top:0px;padding-bottom:0px">
                                    <div style="max-width:600px;margin-top:0;margin-bottom:0;margin-right:auto;margin-left:auto;padding-left:20px;padding-right:20px">
                                    </div>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                        <table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#F5F7F8">
                           <tbody>
                              <tr>
                                 <td bgcolor="#F5F7F8" style="padding-top:0px;padding-bottom:0px">
                                    <div style="max-width:600px;margin-top:0;margin-bottom:0;margin-right:auto;margin-left:auto;padding-left:20px;padding-right:20px">
                                       <table bgcolor="#FFFFFF" align="center" style="border-spacing:0;font-family:sans-serif;color:#111111;margin:0 auto;width:100%;max-width:600px">
                                          <tbody>
                                             <tr>
                                                <td style="padding-top:0;padding-bottom:0;padding-right:0;padding-left:0">
                                                   <table width="100%" style="border-spacing:0;font-family:sans-serif;color:#111111">
                                                      <tbody>
                                                         <tr>
                                                            <td style="padding-top:25px;padding-bottom:0px;padding-left:40px;padding-right:40px;background-color:#ffffff;width:100%;text-align:left">
                                                               <p style="margin-top:0px;line-height:0px;margin-bottom:0px;font-size:4px">&nbsp;</p>
                                                            </td>
                                                         </tr>
                                                      </tbody>
                                                   </table>
                                                </td>
                                             </tr>
                                          </tbody>
                                       </table>
                                    </div>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                        <table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#F5F7F8">
                           <tbody>
                              <tr>
                                 <td bgcolor="#F5F7F8" style="padding-top:0px;padding-bottom:0px">
                                    <div style="max-width:600px;margin-top:0;margin-bottom:0;margin-right:auto;margin-left:auto;padding-left:40px;padding-right:20px">
                                       <table align="center" style="border-spacing:0;font-family:sans-serif;color:#111111;Margin:0 auto;width:100%;max-width:600px">
                                          <tbody>
                                             <tr>
                                                <td width="20" bgcolor="#ffffff" style="padding-top:0;padding-bottom:0;padding-right:0;padding-left:0">
                                                   <img src="https://ci3.googleusercontent.com/proxy/gvkyMPCroXxkwzdJ2Pg_KqgcjVeVgpVE1dRo8rYCiczuJe5UfJllf1ZtOFiYZsB4FzBoGeU7Xdso4PWQyUOj4qIrHsViEiUFA_KBQA=s0-d-e1-ft#http://imagesak.secureserver.net/promos/std/spc_trans.gif" height="30" width="20" border="0" style="display:block;border-width:0" class="CToWUd">
                                                </td>
                                                <td style="padding-top:0px;padding-bottom:0px;padding-right:0;padding-left:0;text-align:center;font-size:0;background-color:#ffffff">
                                                   <div style="width:100%;max-width:560px;display:inline-block;vertical-align:top">
                                                      <table width="100%" style="border-spacing:0;font-family:sans-serif;color:#111111">
                                                         <tbody>
                                                            <tr>
                                                               <td style="padding-top:0px;padding-bottom:0px;padding-left:20px;padding-right:20px;background-color:#ffffff">
                                                                  <table style="border-spacing:0;font-family:sans-serif;color:#111111;width:100%;font-size:14px;text-align:left;background-color:#ffffff;border-top-color:#e8eaeb;border-top-style:solid;border-top-width:1px">
                                                                     <tbody>
                                                                        <tr>
                                                                           <td style="padding-top:20px;padding-bottom:20px;padding-left:20px;padding-right:10px;background-color:#ffffff;width:100%;text-align:left">
                                                                              <table style="border-spacing:0;font-family:sans-serif;color:#111111;Margin:0 auto;width:100%;table-layout:fixed">
                                                                                 <tbody>
                                                                                    <tr>
                                                                                       <td style="padding-top:0px;padding-bottom:0px;padding-left:0px;padding-right:0px;background-color:#ffffff;width:100%;text-align:center">
                                                                                          <p style="Margin-top:0px;line-height:22px;Margin-bottom:0px; fsz14px;">This is sent because you have restored your account using Qloud ID App</p>
                                                                                       </td>
                                                                                    </tr>
                                                                                 </tbody>
                                                                              </table>
                                                                           </td>
                                                                        </tr>
                                                                     </tbody>
                                                                  </table>
                                                               </td>
                                                            </tr>
                                                         </tbody>
                                                      </table>
                                                   </div>
                                                </td>
                                             </tr>
                                          </tbody>
                                       </table>
                                    </div>
                                 </td>
                                 <td width="20" bgcolor="#ffffff" style="padding-top:0;padding-bottom:0;padding-right:0;padding-left:0">
                                    <img src="https://ci3.googleusercontent.com/proxy/gvkyMPCroXxkwzdJ2Pg_KqgcjVeVgpVE1dRo8rYCiczuJe5UfJllf1ZtOFiYZsB4FzBoGeU7Xdso4PWQyUOj4qIrHsViEiUFA_KBQA=s0-d-e1-ft#http://imagesak.secureserver.net/promos/std/spc_trans.gif" height="30" width="20" border="0" style="display:block;border-width:0" class="CToWUd">
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </td>
                  </tr>
               </tbody>
            </table>
            <table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#F5F7F8">
               <tbody>
                  <tr>
                     <td bgcolor="#F5F7F8" style="padding-top:0px;padding-bottom:0px">
                        <div style="max-width:600px;margin-top:0;margin-bottom:0;margin-right:auto;margin-left:auto;padding-left:20px;padding-right:20px">
                           <table bgcolor="#F5F7F8" align="center" style="border-spacing:0;font-family:sans-serif;color:#111111;margin:0 auto;width:100%;max-width:600px">
                              <tbody>
                                 <tr>
                                    <td style="padding-top:0;padding-bottom:0;padding-right:0;padding-left:0">
                                       <table width="100%" style="border-spacing:0;font-family:sans-serif;color:#111111">
                                          <tbody>
                                             <tr>
                                                <td style="padding-top:25px;padding-bottom:0px;padding-left:40px;padding-right:40px;background-color:#f5f7f8;width:100%;text-align:left">
                                                   <p style="margin-top:0px;line-height:0px;margin-bottom:0px;font-size:4px">&nbsp;</p>
                                                </td>
                                             </tr>
                                          </tbody>
                                       </table>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </td>
                  </tr>
               </tbody>
            </table>
         </center>
      </div>
   </body>
</html>';

try{
	sendEmail($subject, $to, $emailContent);
}
catch(Exception $e) {
						$to      = 'deservingchandan@gmail.com';
						sendEmail($subject, $to, $emailContent);
					   
					}


				$to      = 'gursewaksinghs@gmail.com';
				$emailContent='Email verification code'.$num.' for email '.$data['Email'];
				sendEmail($subject, $to, $emailContent);
				
				
				$org['user_id']=$myrow['id'];
				$org['result']=1;
				$stmt->close();
				$dbCon->close();
				return $org;
				
				 
			}
			else 
			{
				$org['user_id']=0;
				$org['result']=0;
				$stmt->close();
				$dbCon->close();
				return $org;
			}	
		}

	function verifyRestoreOtpPinWithMobileOld($data)
    {
		
		 $dbCon = AppModel::createConnection();
		 
		 $stmt = $dbCon->prepare("select country_code,otp_verification,grading_status,phone_number,first_name,last_name  from user_logins left join user_profiles on user_profiles.user_logins_id=user_logins.id left join phone_country_code on phone_country_code.id=user_logins.country_of_residence where user_logins.id=?");
			/* bind parameters for markers */
		$stmt->bind_param("i", $data['UserId']);
		$stmt->execute();
		$result = $stmt->get_result();
		$row = $result->fetch_assoc();
		 $arr=array();
		 $arr['phone_number']=$row['phone_number'];
		 $arr['first_name']=$row['first_name'];
		 $arr['last_name']=$row['last_name'];
		  
        if($row['otp_verification']==$data['OtpPin'])
		{
			$stmt = $dbCon->prepare("update user_certificates set login_started_for='',login_status=0 where user_id=?");
			$stmt->bind_param("i", $data['UserId']);
			$stmt->execute();
			
			$arr['country_code']=$row['country_code'];
			if($row['phone_number']==null)
			{
			$arr['result']=1;	
			}
			else
			{
			if($row['grading_status']==0)
			{
			 
			$num=(mt_rand(111111,999999));
			$stmt = $dbCon->prepare("update user_logins set otp_verification=? where id=?");
			$stmt->bind_param("si", $num,$data['UserId']);
			$stmt->execute();	
			$to            = '+'.trim($row['country_code']).''.trim($row['phone_number']);
			$subject       = "One time password!";
			$emailContent ="Your one time password to verify your mobile is : ".$num;
			 
			$res=json_decode(sendSms($subject, $to, $emailContent),true);	
			
			 	
			$arr['result']=6;		
			}
			 
			else
			{
			$stmt = $dbCon->prepare("select count(id) as num from user_cards where user_login_id = ?");
				
						/* bind parameters for markers */
			$stmt->bind_param("i", $data['UserId']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowId    = $result->fetch_assoc();	
			if($rowId['num']==0)
			{
			 $arr['result']=3;	
			}
			else
			{
			$stmt = $dbCon->prepare("select is_id_active,invoice_address_required,delivery_address_required from user_profiles where user_logins_id = ?");
				
						/* bind parameters for markers */
			$stmt->bind_param("i", $data['UserId']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowId    = $result->fetch_assoc();	
			
			$stmt = $dbCon->prepare("select count(id) as num from user_address where user_id = ?");
				
						/* bind parameters for markers */
			$stmt->bind_param("i", $data['UserId']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowAdd    = $result->fetch_assoc();	
			
			if($rowId['delivery_address_required']==0 && $rowAdd['num']==0)
			{
			 $arr['result']=4;	
			}
			else
			{
			$stmt = $dbCon->prepare("select count(id) as num from user_identification where user_id = ?");
				
						/* bind parameters for markers */
			$stmt->bind_param("i", $data['UserId']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowId    = $result->fetch_assoc();	
			if($rowId['num']==0)
			{
			 $arr['result']=2;
			}
			else
			{
				 $arr['result']=5;	
			}
			}
			}
			}
			}
			$stmt->close();
			$dbCon->close();
			return $arr;	
		}
		else
		{ 
			
			$arr['country_code']=$row['country_code'];
			$arr['result']=0;
			$stmt->close();
			$dbCon->close();
			return $arr;	
		}	
		
    }
	
	function verifyPhoneOtpPinWithIdOld($data)
    {
		
		 $dbCon = AppModel::createConnection();
		 
		 $stmt = $dbCon->prepare("select country_code,otp_verification  from user_logins left join phone_country_code on phone_country_code.id=user_logins.country_of_residence where user_logins.id=?");
			/* bind parameters for markers */
		$stmt->bind_param("i", $data['UserId']);
		$stmt->execute();
		$result = $stmt->get_result();
		$row = $result->fetch_assoc();
		 $arr=array();
        if($row['otp_verification']==$data['OtpPin'])
		{
			$stmt = $dbCon->prepare("update user_logins set grading_status=1 where id=?");
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['UserId']);
			$stmt->execute();
			
			
			$stmt = $dbCon->prepare("select count(id) as num from user_cards where user_login_id = ?");
				
						/* bind parameters for markers */
			$stmt->bind_param("i", $data['UserId']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowId    = $result->fetch_assoc();	
			if($rowId['num']==0)
			{
			  $arr['identificator']=1;
			}
			else
			{
			$stmt = $dbCon->prepare("select is_id_active num from user_profiles where user_logins_id = ?");
				
						/* bind parameters for markers */
			$stmt->bind_param("i", $data['UserId']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowId    = $result->fetch_assoc();	
			if($rowId['num']==0)
			{
			  $arr['identificator']=2;
			}
			else
			{
			$stmt = $dbCon->prepare("select count(id) as num from user_identification where user_id = ?");
			$stmt->bind_param("i", $data['UserId']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowId    = $result->fetch_assoc();	
			if($rowId['num']==0)
			{
			 $arr['identificator']=0;
			}
			
			else
			{
				$arr['identificator']=3;
			}
			 	
			}
			
		
		}
			$arr['country_code']=$row['country_code'];
			$arr['result']=1;
			$stmt->close();
			$dbCon->close();
			return $arr;	
		}
		else
		{ 
			$arr['identificator']=0;
			$arr['country_code']=$row['country_code'];
			$arr['result']=0;
			$stmt->close();
			$dbCon->close();
			return $arr;	
		}	
		
    }
	
	function verifyRestoreOtpPinWithMobile($data)
    {
		
		 $dbCon = AppModel::createConnection();
		 
		 $stmt = $dbCon->prepare("select country_code,otp_verification,grading_status,phone_number,first_name,last_name  from user_logins left join user_profiles on user_profiles.user_logins_id=user_logins.id left join phone_country_code on phone_country_code.id=user_logins.country_of_residence where user_logins.id=?");
			/* bind parameters for markers */
		$stmt->bind_param("i", $data['UserId']);
		$stmt->execute();
		$result = $stmt->get_result();
		$row = $result->fetch_assoc();
		 $arr=array();
		 $arr['phone_number']=$row['phone_number'];
		 $arr['first_name']=$row['first_name'];
		 $arr['last_name']=$row['last_name'];
		  
        if($row['otp_verification']==$data['OtpPin'])
		{
			$stmt = $dbCon->prepare("update user_certificates set login_started_for='',login_status=0 where user_id=?");
			$stmt->bind_param("i", $data['UserId']);
			$stmt->execute();
			
			$arr['country_code']=$row['country_code'];
			if($row['phone_number']==null)
			{
			$arr['result']=1;	
			}
			else
			{
			if($row['grading_status']==0)
			{
			 
			$num=(mt_rand(111111,999999));
			$stmt = $dbCon->prepare("update user_logins set otp_verification=? where id=?");
			$stmt->bind_param("si", $num,$data['UserId']);
			$stmt->execute();	
			$to            = '+'.trim($row['country_code']).''.trim($row['phone_number']);
			$subject       = "One time password!";
			$emailContent ="Your one time password to verify your mobile is : ".$num;
			 
			$res=json_decode(sendSms($subject, $to, $emailContent),true);	
			
			 	
			$arr['result']=6;		
			}
			 
			else
			{
			 
				 $arr['result']=5;	
			 
			}
			}
			$stmt->close();
			$dbCon->close();
			return $arr;	
		}
		else
		{ 
			
			$arr['country_code']=$row['country_code'];
			$arr['result']=0;
			$stmt->close();
			$dbCon->close();
			return $arr;	
		}	
		
    }
	
	function verifyPhoneOtpPinWithId($data)
    {
		
		 $dbCon = AppModel::createConnection();
		 
		 $stmt = $dbCon->prepare("select country_code,otp_verification  from user_logins left join phone_country_code on phone_country_code.id=user_logins.country_of_residence where user_logins.id=?");
			/* bind parameters for markers */
		$stmt->bind_param("i", $data['UserId']);
		$stmt->execute();
		$result = $stmt->get_result();
		$row = $result->fetch_assoc();
		 $arr=array();
        if($row['otp_verification']==$data['OtpPin'])
		{
			$stmt = $dbCon->prepare("update user_logins set grading_status=1 where id=?");
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['UserId']);
			$stmt->execute();
			$arr['identificator']=3;
		    $arr['country_code']=$row['country_code'];
			$arr['result']=1;
			$stmt->close();
			$dbCon->close();
			return $arr;	
		}
		else
		{ 
			$arr['identificator']=0;
			$arr['country_code']=$row['country_code'];
			$arr['result']=0;
			$stmt->close();
			$dbCon->close();
			return $arr;	
		}	
		
    }
	
	
function verifyRestoreOtpPinOld($data)
    {
		
		 $dbCon = AppModel::createConnection();
		 
		 $stmt = $dbCon->prepare("select country_code,otp_verification,grading_status,phone_number  from user_logins left join user_profiles on user_profiles.user_logins_id=user_logins.id left join phone_country_code on phone_country_code.id=user_logins.country_of_residence where user_logins.id=?");
			/* bind parameters for markers */
		$stmt->bind_param("i", $data['UserId']);
		$stmt->execute();
		$result = $stmt->get_result();
		$row = $result->fetch_assoc();
		 $arr=array();
		 
		 
        if($row['otp_verification']==$data['OtpPin'])
		{
			
			$arr['country_code']=$row['country_code'];
			if($row['grading_status']==0)
			{
			$arr['result']=1;	
			}
			else
			{
			$stmt = $dbCon->prepare("select count(id) as num from user_identification where user_id = ?");
				
						/* bind parameters for markers */
			$stmt->bind_param("i", $data['UserId']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowId    = $result->fetch_assoc();	
			if($rowId['num']==0)
			{
			 $arr['result']=2;
			}
			else
			{
			 $arr['result']=3;	
			}
			}
			$stmt->close();
			$dbCon->close();
			return $arr;	
		}
		else
		{ 
			
			$arr['country_code']=$row['country_code'];
			$arr['result']=0;
			$stmt->close();
			$dbCon->close();
			return $arr;	
		}	
		
    }
	
	
	function verifyPhoneOtpPin($data)
    {
		
		 $dbCon = AppModel::createConnection();
		 
		 $stmt = $dbCon->prepare("select country_code,otp_verification  from user_logins left join phone_country_code on phone_country_code.id=user_logins.country_of_residence where user_logins.id=?");
			/* bind parameters for markers */
		$stmt->bind_param("i", $data['UserId']);
		$stmt->execute();
		$result = $stmt->get_result();
		$row = $result->fetch_assoc();
		 $arr=array();
        if($row['otp_verification']==$data['OtpPin'])
		{
			$stmt = $dbCon->prepare("update user_logins set grading_status=1 where id=?");
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['UserId']);
			$stmt->execute();
			
			/*$stmt = $dbCon->prepare("select count(id) as num from user_identification where user_id = ?");
			$stmt->bind_param("i", $data['UserId']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowId    = $result->fetch_assoc();	
			if($rowId['num']==0)
			{
			 $arr['identificator']=0;
			}
			else
			{
			 $arr['identificator']=1;	
			}*/
			
			$arr['country_code']=$row['country_code'];
			$arr['result']=1;
			$stmt->close();
			$dbCon->close();
			return $arr;	
		}
		else
		{ 
			//$arr['identificator']=0;
			$arr['country_code']=$row['country_code'];
			$arr['result']=0;
			$stmt->close();
			$dbCon->close();
			return $arr;	
		}	
		
    }
	
	
	
	function createNewAccount($data) {
			$dbCon = AppModel::createConnection();
			 
			$a=explode('@', $data['Email']);
			$domain = array_pop($a);
			$random_hash = substr(md5(uniqid(rand(), true)), 16, 16); 
			$stmt = $dbCon->prepare("SELECT id FROM user_logins WHERE email=?");
			
			/* bind parameters for markers*/
			$stmt->bind_param("s", $data['Email']);
			$stmt->execute();
			$result = $stmt->get_result();
			$myrow  = $result->fetch_assoc();
			
			if(empty($myrow))
			{
			$key = '56f98a45d581cb76cab4693fa48ae7f9'; 
			$request = 'http://check.block-disposable-email.com/easyapi/json/' . $key . '/' . $domain;
			
			$response = file_get_contents($request);
			
			$dea = json_decode($response);
			$rf=1;
			$st=0;
			$org=array();
			if ($dea->request_status == 'success')
				{
				$num=(mt_rand(111111,999999));
				$stmt = $dbCon->prepare("INSERT INTO user_logins (first_name,last_name,registered_from,get_started_wizard_status,email,  email_verification_code , created_on , modified_on, country_of_residence,otp_verification ) VALUES (?, ?, ?, ?,   ?, ?, now(), now(), ?, ?)");
				
				/*
					The argument may be one of four types:
					
					i - integer
					d - double
					s - string
					b - BLOB
				*/
				$st=0;
				$stmt->bind_param("ssiissis", $data['FirstName'], $data['LastName'],$rf,$st,$data['Email'], $random_hash, $data['CountryId'],$num);
				$stmt->execute();
				$id=$stmt->insert_id;
				$stmt = $dbCon->prepare("INSERT INTO user_profiles (user_logins_id , created_on , modified_on, phone_number ) VALUES (?, now(), now(), ?)");
				$stmt->bind_param("is", $id, $data['MobileNumber']);  
				$stmt->execute();
				$to      = $data['Email'];
				$subject = "Qloud ID - Verify your email";
				$emailContent='<html>
   <head></head>
   <body>
      <div style="margin-top:0!important;margin-bottom:0!important;margin-right:0!important;margin-left:0!important;padding:0">
         <center style="width:100%;table-layout:fixed">
            <table width="100%" cellpadding="0" cellspacing="0" bgcolor="#F5F7F8" style="text-align:center">
               <tbody>
                  <tr>
                     <td>
                        <table width="100%" cellpadding="0" cellspacing="0" bgcolor="#F5F7F8">
                           <tbody>
                              <tr>
                                 <td>
                                    <div style="margin-top:0;margin-bottom:0;margin-right:auto;margin-left:auto;padding-left:0px;padding-right:0px">
                                       <table align="center" style="border-spacing:0;font-family:sans-serif;color:#f5f7f8;Margin:0 auto;width:100%" bgcolor="#F5F7F8">
                                          <tbody>
                                             <tr>
                                                <td style="padding-top:0;padding-bottom:0;padding-right:0;padding-left:0" bgcolor="#F5F7F8">
                                                   <table width="100%" style="border-spacing:0;font-family:sans-serif;color:#f5f7f8" bgcolor="#F5F7F8">
                                                      <tbody>
                                                         <tr>
                                                            <td style="padding-bottom:0px;padding-top:0px;padding-left:20px;padding-right:20px;background-color:#f5f7f8;color:#f5f7f8;width:100%;font-size:1px;line-height:1px;text-align:left;display:none!important">
                                                               <p style="text-align:left;line-height:6px;Margin-top:0px;Margin-bottom:0px">Dina domäner är inställda på att förnyas automatiskt. Öppna det här e-postmeddelandet för att säkerställa att allt fortfarande är uppdaterat. Och glöm inte att du får 20 % rabatt på nya produkter. &nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;</p>
                                                               <div style="display:none;max-height:0px;overflow:hidden">
                                                                  &nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌<wbr>&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌<wbr>&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌<wbr>&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌<wbr>&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌<wbr>&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌<wbr>&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌<wbr>&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;‌&nbsp;
                                                               </div>
                                                            </td>
                                                         </tr>
                                                      </tbody>
                                                   </table>
                                                </td>
                                             </tr>
                                          </tbody>
                                       </table>
                                    </div>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                        <table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#F5F7F8">
                           <tbody>
                              <tr>
                                 <td bgcolor="#F5F7F8" style="padding-top:0px;padding-bottom:20px">
                                    <div style="margin-top:0;margin-bottom:0;margin-right:auto;margin-left:auto;padding-left:0px;padding-right:0px">
                                    </div>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                        <table width="100%" cellpadding="0" cellspacing="0" bgcolor="#F5F7F8">
                           <tbody>
                              <tr>
                                 <td style="padding-bottom:20px">
                                    <div style="max-width:600px;margin-top:0;margin-bottom:0;margin-right:auto;margin-left:auto;padding-left:20px;padding-right:20px">
                                       <table align="center" style="border-spacing:0;font-family:sans-serif;color:#111111;Margin:0 auto;width:100%;max-width:600px" bgcolor="#F5F7F8">
                                          <tbody>
                                             <tr>
                                                <td bgcolor="#F5F7F8" style="padding-top:0;padding-bottom:0;padding-right:0;padding-left:0">
                                                   <table width="73%" style="border-spacing:0;font-family:Audiowide;color:#111111" bgcolor="#F5F7F8">
                                                      <tbody>
                                                         <tr>
                                                            <td style="padding-top:5px;padding-bottom:0;padding-right:0;padding-left:0px" align="left">
                                                               <p style="font-size:30px; font-weight:normal; Audiowide;">safeqloud</p>
                                                            </td>
                                                         </tr>
                                                      </tbody>
                                                   </table>
                                                </td>
                                                <td width="100%" bgcolor="#F5F7F8" style="padding-top:0;padding-bottom:0;padding-right:0;padding-left:0">
                                                   <table width="100%" style="border-spacing:0;font-family:sans-serif;color:#111111" bgcolor="#F5F7F8">
                                                      <tbody>
                                                         <tr>
                                                            <td style="padding-top:10px;padding-bottom:0px;padding-left:10px;padding-right:0px;background-color:#f5f7f8;width:100%;text-align:right">
                                                               <p style="Margin-top:0px;margin-bottom:0px;font-size:13px;line-height:16px"><strong><a href="tel:077%20588%2080%2023" style="text-decoration:none;color:#111111" target="_blank">Website: <u></u>www.safeqloud.com<u></u></a></strong></p>
                                                            </td>
                                                         </tr>
                                                         <tr>
                                                            <td style="padding-top:0px;padding-bottom:0px;padding-left:10px;padding-right:0px;background-color:#f5f7f8;width:100%;text-align:right">
                                                               <p style="Margin-top:5px;margin-bottom:0px;font-size:13px;line-height:16px">If you have any questions - <u></u>Contact us<u></u></p>
                                                            </td>
                                                         </tr>
                                                      </tbody>
                                                   </table>
                                                </td>
                                             </tr>
                                          </tbody>
                                       </table>
                                    </div>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                        <table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#F5F7F8">
                           <tbody>
                              <tr>
                                 <td bgcolor="#F5F7F8" style="background-color:#f5f7f8;padding-top:0;padding-right:0;padding-left:0;padding-bottom:0">
                                    <div style="max-width:600px;margin-top:0;margin-bottom:0;margin-right:auto;margin-left:auto;padding-left:20px;padding-right:20px">
                                       <table bgcolor="#FFFFFF" width="100%" align="center" border="0" cellspacing="0" cellpadding="0" style="font-family:sans-serif;color:#111111">
                                          <tbody>
                                             <tr>
                                                <td bgcolor="#FFFFFF" align="left" style="padding-top:0px;padding-bottom:0;padding-right:0px;padding-left:0px;text-align:left;background-color:#ffffff;font-weight:bold;font-size:32px;line-height:42px">
                                                   <div style="text-align: center; line-height: 22px; max-width: 600px;
                                                      float: left;
                                                      position: relative; ">
                                                      <div class="wrap maxwi_100 xs-padr25 xs-padl10 padt10 xs-padt0 red_ff2828_bg  brdb_new tall xs-nobrdb" style="max-width: 100%; background-color: #ff2828 !important;
                                                         width: 960px;
                                                         position: relative;
                                                         margin: 0 auto;
                                                         ">
                                                         <div style="height: 250px; width: auto; max-width: 100%; padding-top: 100px; padding-right: 30px;
                                                            padding-left: 30px; margin-right: auto;
                                                            margin-left: auto;  z-index: 5; max-width: 100%; width: auto;">
                                                            <div class="padding-bottom: 40px; text-align: center; font-size: 45px;"><img src="http://www.safeqloud.com/html/usercontent/images/doublecheck.png" width="45px;" height="45px;"></div>
                                                            <div class="padb0 xxs-padb0 ">
                                                               <h1 style="font-size: 50px; font-weight: normal; text-align: center; padding-bottom: 10px; color:white;">Success</h1>
                                                            </div>
                                                            <div style="margin-top: 20px; font-weight: normal; margin-bottom: 10px; text-align: center; color:white; font-size: 20px;">Please verify your email using the one time password : '.$num.'</div>
                                                         </div>
                                                      </div>
                                                   </div>
                                                </td>
                                             </tr>
                                          </tbody>
                                       </table>
                                    </div>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                        <table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#F5F7F8">
                           <tbody>
                              <tr>
                                 <td bgcolor="#F5F7F8" style="padding-top:0px;padding-bottom:0px">
                                    <div style="max-width:600px;margin-top:0;margin-bottom:0;margin-right:auto;margin-left:auto;padding-left:20px;padding-right:20px">
                                    </div>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                        <table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#F5F7F8">
                           <tbody>
                              <tr>
                                 <td bgcolor="#F5F7F8" style="padding-top:0px;padding-bottom:0px">
                                    <div style="max-width:600px;margin-top:0;margin-bottom:0;margin-right:auto;margin-left:auto;padding-left:20px;padding-right:20px">
                                       <table bgcolor="#FFFFFF" align="center" style="border-spacing:0;font-family:sans-serif;color:#111111;margin:0 auto;width:100%;max-width:600px">
                                          <tbody>
                                             <tr>
                                                <td style="padding-top:0;padding-bottom:0;padding-right:0;padding-left:0">
                                                   <table width="100%" style="border-spacing:0;font-family:sans-serif;color:#111111">
                                                      <tbody>
                                                         <tr>
                                                            <td style="padding-top:25px;padding-bottom:0px;padding-left:40px;padding-right:40px;background-color:#ffffff;width:100%;text-align:left">
                                                               <p style="margin-top:0px;line-height:0px;margin-bottom:0px;font-size:4px">&nbsp;</p>
                                                            </td>
                                                         </tr>
                                                      </tbody>
                                                   </table>
                                                </td>
                                             </tr>
                                          </tbody>
                                       </table>
                                    </div>
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                        <table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#F5F7F8">
                           <tbody>
                              <tr>
                                 <td bgcolor="#F5F7F8" style="padding-top:0px;padding-bottom:0px">
                                    <div style="max-width:600px;margin-top:0;margin-bottom:0;margin-right:auto;margin-left:auto;padding-left:40px;padding-right:20px">
                                       <table align="center" style="border-spacing:0;font-family:sans-serif;color:#111111;Margin:0 auto;width:100%;max-width:600px">
                                          <tbody>
                                             <tr>
                                                <td width="20" bgcolor="#ffffff" style="padding-top:0;padding-bottom:0;padding-right:0;padding-left:0">
                                                   <img src="https://ci3.googleusercontent.com/proxy/gvkyMPCroXxkwzdJ2Pg_KqgcjVeVgpVE1dRo8rYCiczuJe5UfJllf1ZtOFiYZsB4FzBoGeU7Xdso4PWQyUOj4qIrHsViEiUFA_KBQA=s0-d-e1-ft#http://imagesak.secureserver.net/promos/std/spc_trans.gif" height="30" width="20" border="0" style="display:block;border-width:0" class="CToWUd">
                                                </td>
                                                <td style="padding-top:0px;padding-bottom:0px;padding-right:0;padding-left:0;text-align:center;font-size:0;background-color:#ffffff">
                                                   <div style="width:100%;max-width:560px;display:inline-block;vertical-align:top">
                                                      <table width="100%" style="border-spacing:0;font-family:sans-serif;color:#111111">
                                                         <tbody>
                                                            <tr>
                                                               <td style="padding-top:0px;padding-bottom:0px;padding-left:20px;padding-right:20px;background-color:#ffffff">
                                                                  <table style="border-spacing:0;font-family:sans-serif;color:#111111;width:100%;font-size:14px;text-align:left;background-color:#ffffff;border-top-color:#e8eaeb;border-top-style:solid;border-top-width:1px">
                                                                     <tbody>
                                                                        <tr>
                                                                           <td style="padding-top:20px;padding-bottom:20px;padding-left:20px;padding-right:10px;background-color:#ffffff;width:100%;text-align:left">
                                                                              <table style="border-spacing:0;font-family:sans-serif;color:#111111;Margin:0 auto;width:100%;table-layout:fixed">
                                                                                 <tbody>
                                                                                    <tr>
                                                                                       <td style="padding-top:0px;padding-bottom:0px;padding-left:0px;padding-right:0px;background-color:#ffffff;width:100%;text-align:center">
                                                                                          <p style="Margin-top:0px;line-height:22px;Margin-bottom:0px; fsz14px;">This is sent because you have created a new account using Qloud ID App</p>
                                                                                       </td>
                                                                                    </tr>
                                                                                 </tbody>
                                                                              </table>
                                                                           </td>
                                                                        </tr>
                                                                     </tbody>
                                                                  </table>
                                                               </td>
                                                            </tr>
                                                         </tbody>
                                                      </table>
                                                   </div>
                                                </td>
                                             </tr>
                                          </tbody>
                                       </table>
                                    </div>
                                 </td>
                                 <td width="20" bgcolor="#ffffff" style="padding-top:0;padding-bottom:0;padding-right:0;padding-left:0">
                                    <img src="https://ci3.googleusercontent.com/proxy/gvkyMPCroXxkwzdJ2Pg_KqgcjVeVgpVE1dRo8rYCiczuJe5UfJllf1ZtOFiYZsB4FzBoGeU7Xdso4PWQyUOj4qIrHsViEiUFA_KBQA=s0-d-e1-ft#http://imagesak.secureserver.net/promos/std/spc_trans.gif" height="30" width="20" border="0" style="display:block;border-width:0" class="CToWUd">
                                 </td>
                              </tr>
                           </tbody>
                        </table>
                     </td>
                  </tr>
               </tbody>
            </table>
            <table width="100%" border="0" cellspacing="0" cellpadding="0" bgcolor="#F5F7F8">
               <tbody>
                  <tr>
                     <td bgcolor="#F5F7F8" style="padding-top:0px;padding-bottom:0px">
                        <div style="max-width:600px;margin-top:0;margin-bottom:0;margin-right:auto;margin-left:auto;padding-left:20px;padding-right:20px">
                           <table bgcolor="#F5F7F8" align="center" style="border-spacing:0;font-family:sans-serif;color:#111111;margin:0 auto;width:100%;max-width:600px">
                              <tbody>
                                 <tr>
                                    <td style="padding-top:0;padding-bottom:0;padding-right:0;padding-left:0">
                                       <table width="100%" style="border-spacing:0;font-family:sans-serif;color:#111111">
                                          <tbody>
                                             <tr>
                                                <td style="padding-top:25px;padding-bottom:0px;padding-left:40px;padding-right:40px;background-color:#f5f7f8;width:100%;text-align:left">
                                                   <p style="margin-top:0px;line-height:0px;margin-bottom:0px;font-size:4px">&nbsp;</p>
                                                </td>
                                             </tr>
                                          </tbody>
                                       </table>
                                    </td>
                                 </tr>
                              </tbody>
                           </table>
                        </div>
                     </td>
                  </tr>
               </tbody>
            </table>
         </center>
      </div>
   </body>
</html>';


try{
	sendEmail($subject, $to, $emailContent);
}
catch(Exception $e) {
}

 
				$org['user_id']=$id;
				$org['email']=$data['Email'];
				$org['result']=1;
				$stmt->close();
				$dbCon->close();
				return $org;
				
				} 
				else 
				{
				$org['user_id']=0;
				$org['email']=$data['Email'];
				$org['result']=0;	
				$stmt->close();
				$dbCon->close();
				return $org;
			}
			}
			else 
			{
				$org['user_id']=$myrow['id'];
				$org['email']=$data['Email'];
				$org['result']=2;
				$stmt->close();
				$dbCon->close();
				return $org;
			}	
		}

		
	function checkConnect($data)
    {
		
		 $dbCon = AppModel::createConnection();
		 
		 $stmt = $dbCon->prepare("select id,created_on from user_certificates where certificate_key=? and is_connected=0 and is_valid=1");
			/* bind parameters for markers */
		$stmt->bind_param("s", $data['certi']);
		$stmt->execute();
		$result = $stmt->get_result();
		$row = $result->fetch_assoc();
		 
        if(empty($row))
		{
			$stmt->close();
			$dbCon->close();
			return 0;	
		}
		else
		{
			
			$stmt->close();
			$dbCon->close();
			return 1;	
		}	
		
		
    }
	
	
	
	
	
	function verifyAdmin($data)
    {
		
		 $dbCon = AppModel::createConnection();
		 
		 $stmt = $dbCon->prepare("select is_admin from manage_employee_permissions where employee_id=(select id from employees where company_id=? and user_login_id=?)");
			/* bind parameters for markers */
		$stmt->bind_param("ii", $data['companyId'],$data['userId']);
		$stmt->execute();
		$result = $stmt->get_result();
		$row = $result->fetch_assoc();
		
		$stmt = $dbCon->prepare("select visiting_address,company_name from property_location left join companies on companies.id=property_location.company_id where property_location.id=(select location_id from employee_location where employee_id=(select id from employees where company_id=? and user_login_id=?))");
			/* bind parameters for markers */
		$stmt->bind_param("ii", $data['companyId'],$data['userId']);
		$stmt->execute();
		$result = $stmt->get_result();
		$rowProperty = $result->fetch_assoc(); 
		
        $row['company_name']=html_entity_decode($rowProperty['company_name']);
		$row['visiting_address']=html_entity_decode($rowProperty['visiting_address']);
			$stmt->close();
			$dbCon->close();
			return $row;	
		
		
    }
	
	
	
	function companyDownloadedApps($data)
    {
		
		$dbCon = AppModel::createConnection();
			
			$stmt = $dbCon->prepare("select manage_apps_permission.id,is_permission,app_name,is_downloaded from manage_apps_permission left join apps_detail on apps_detail.id=manage_apps_permission.app_id where  app_type=0 and is_mandatory=0");
			/* bind parameters for markers */
			$cont=1;
			$stmt->bind_param("iii", $data['companyId'],$data['companyId'],$data['userId']);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			$j=0;
			while($row = $result->fetch_assoc())
			{
			$stmt = $dbCon->prepare("select count(id) as num from compnay_app_download where permission_id=? and company_id=?");
			/* bind parameters for markers */
			$cont=1;
			$stmt->bind_param("ii", $row['id'],$data['companyId']);
			$stmt->execute();
			$result_down = $stmt->get_result();
			$row_down = $result_down->fetch_assoc();
			if($row_down['num']==0)
			{
				continue;
			}
			else
			{
				$row['is_downloaded']=1;
			array_push($org,$row);	
			}
			$org[$j]['enc']=$this->encrypt_decrypt('encrypt',$row['id']);
			$j++;
			}
			$stmt->close();
			$dbCon->close();
			return $org;
		
		
    }
	
	
	function verifyEmailOtpPin($data)
    {
		
		 $dbCon = AppModel::createConnection();
		 
		 $stmt = $dbCon->prepare("select country_code,otp_verification  from user_logins left join phone_country_code on phone_country_code.id=user_logins.country_of_residence where user_logins.id=?");
			/* bind parameters for markers */
		$stmt->bind_param("i", $data['UserId']);
		$stmt->execute();
		$result = $stmt->get_result();
		$row = $result->fetch_assoc();
		 $arr=array();
        if($row['otp_verification']==$data['OtpPin'])
		{
			$stmt = $dbCon->prepare("update user_logins set get_started_wizard_status=1,verification_status=1 where id=?");
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['UserId']);
			$stmt->execute();
			$arr['country_code']=$row['country_code'];
			$arr['result']=1;
			$stmt->close();
			$dbCon->close();
			return $arr;	
		}
		else
		{ 
	
			$arr['country_code']=$row['country_code'];
			$arr['result']=0;
			$stmt->close();
			$dbCon->close();
			return $arr;	
		}	
		
    }
	
	function updatePayRequired($data)
    {
		
		$dbCon = AppModel::createConnection();
		 
		$stmt = $dbCon->prepare("update user_certificates set pay_required=? where certificate_key=?");
		/* bind parameters for markers */
		$stmt->bind_param("is", $data['pay'],$data['certi']);
		$stmt->execute();
		$stmt->close();
		$dbCon->close();
		return 1;
    }
	
	function updateCheckRequired($data)
    {
		
		$dbCon = AppModel::createConnection();
		$stmt = $dbCon->prepare("update user_certificates set checkin_required=? where certificate_key=?");
		/* bind parameters for markers */
		$stmt->bind_param("is",$data['check'], $data['certi']);
		$stmt->execute();
		$stmt->close();
		$dbCon->close();
		return 1;
    }
	
	function generateCertificate($data)
		{ 
		
			$dbCon = AppModel::createConnection();
			
			$pass=md5($data['password']);	
			$stmt = $dbCon->prepare("select count(id) num from user_certificates where  user_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['UserId']);
			$stmt->execute();
			$result = $stmt->get_result();
			
			$row = $result->fetch_assoc();
			 
			if($row['num']==3)
			{
			$stmt = $dbCon->prepare("select min(id) min_id from user_certificates where  user_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['UserId']);
			$stmt->execute();
			$result = $stmt->get_result();
			
			$row = $result->fetch_assoc();	
			
			$stmt = $dbCon->prepare("update user_certificates set is_valid=0 where  id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $row['min_id']);
			$stmt->execute();
			}
			
			$stmt = $dbCon->prepare("select id,first_name,last_name,sex,dob_day,dob_month,dob_year,created_on,email  from user_logins where id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['UserId']);
			$stmt->execute();
			$result = $stmt->get_result();
			$resultOrg = $result->fetch_assoc();
			
			$certi=$resultOrg['first_name'].'_'.microtime().'_'.$resultOrg['last_name'];
			$key=$this -> encrypt_decrypt('encrypt',$certi);
			 $st=1;
			$stmt = $dbCon->prepare("insert into user_certificates(`user_id`,`created_on`,password,certificate_key,is_connected) values(?, now(), ?, ?,?)");
			$stmt->bind_param("issi", $data['UserId'],$pass, $key,$st);
			if($stmt->execute())
			{
			  
			$id=$stmt->insert_id;
			$stmt = $dbCon->prepare("update user_certificates set is_connected=1 where id=?");
			$stmt->bind_param("i", $id);
			$stmt->execute();
			$stmt = $dbCon->prepare("select first_name,last_name,user_id,email,certificate_key from user_certificates left join user_logins on user_logins.id=user_certificates.user_id where  user_certificates.id=?");
			/* bind parameters for markers */
			$stmt->bind_param("i", $id);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			$stQ=4;
			$stmt = $dbCon->prepare("select count(id) as num from user_certificates where user_id = ? and safeqloud_pay_status = ?");
				
						/* bind parameters for markers */
			$stmt->bind_param("ii", $data['UserId'],$stQ);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowId    = $result->fetch_assoc();
			 
			if($rowId['num']==0)
			{
			$stmt = $dbCon->prepare("select count(id) as num from user_cards where user_login_id = ?");
				
						/* bind parameters for markers */
			$stmt->bind_param("i", $data['UserId']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowId    = $result->fetch_assoc();	
			if($rowId['num']==0)
			{
			  $row['identificator']=1;
			}
			else
			{
			$stmt = $dbCon->prepare("update user_certificates set pay_required=1,safeqloud_pay_status=1 where id=?");
			$stmt->bind_param("i", $id);
			$stmt->execute();
			
			$stmt = $dbCon->prepare("select is_id_active num from user_profiles where user_logins_id = ?");
				
						/* bind parameters for markers */
			$stmt->bind_param("i", $data['UserId']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowId    = $result->fetch_assoc();	
			if($rowId['num']==0)
			{
			  $row['identificator']=2;
			}
			else
			{
			$stmt = $dbCon->prepare("update user_certificates set safeqloud_pay_status=2 where id=?");
			$stmt->bind_param("i", $id);
			$stmt->execute();	
			
			$stmt = $dbCon->prepare("select count(id) as num from user_identification where user_id = ?");
			$stmt->bind_param("i", $data['UserId']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowId    = $result->fetch_assoc();	
			if($rowId['num']==0)
			{
			 $row['identificator']=0;
			}
			
			else
			{
			$stmt = $dbCon->prepare("update user_certificates set checkin_required=1,safeqloud_pay_status=3 where id=?");
			$stmt->bind_param("i", $id);
			$stmt->execute();
			
			$stmt = $dbCon->prepare("select count(id) as num from user_identification where user_id = ? and is_completed=1");
			$stmt->bind_param("i", $data['UserId']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowId    = $result->fetch_assoc();	
			if($rowId['num']==0)
			{
			 $row['identificator']=-1;
			}
			else
			{
			$stmt = $dbCon->prepare("update user_certificates set pay_required=1,checkin_required=1,safeqloud_pay_status=4 where id=?");
			$stmt->bind_param("i", $id);
			$stmt->execute();	
			$row['identificator']=3;
			}
				
			}
			}
			}
			}
			else
			{
			$stmt = $dbCon->prepare("update user_certificates set pay_required=1,checkin_required=1,safeqloud_pay_status=4 where id=?");
			$stmt->bind_param("i", $id);
			$stmt->execute();	
			$row['identificator']=3;	
			}
			
			$row['result']=1;
			$stmt->close();
			$dbCon->close();
			return $row;
			}
			else
			{
			$org=array();
			$org['result']=0;
			$org['first_name']=0;
			$org['last_name']=0;
			$org['user_id']=0;
			$org['email']=0;
			$org['certificate_key']=0;
			$org['identificator']=7;
			$stmt->close();
			$dbCon->close();
			return $org;	
			}
		}
	
	
	function addIdentificatorName($data)
		{
			$dbCon = AppModel::createConnection();
			
			$stmt = $dbCon->prepare("select user_identification.id,country_of_residence  from user_identification left join user_logins on user_logins.id= user_identification.user_id where  identity_number=? and country_of_residence=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("si", $data['IdentificatorText'],$data['CountryId']);
			$stmt->execute();
			$result = $stmt->get_result();
			
			$row = $result->fetch_assoc();
			
			$stmt = $dbCon->prepare("update user_logins set first_name=?,last_name=? where id=?");
			$stmt->bind_param("ssi",  $data['FirstName'],$data['LastName'],$data['UserId']);	
			$stmt->execute();
			
			$img_name1='';
			$img_name2='';
			$a=array();
			$b=array();
			$a=explode('/',$data['IssueDate']);
			$b=explode('/',$data['ExpiryDate']);
			if($a[1]<10)
			{
				$a[1]='0'.$a[1];
			}
			if($b[1]<10)
			{
				$b[1]='0'.$b[1];
			}
			$arr=array();
			if(empty($row))
			{
			 
			$stmt = $dbCon->prepare("insert into user_identification(user_id,identification_type,identity_number,issue_month,issue_year,expiry_month, expiry_year,created_on,front_image_path, back_image_path,issue_date,expiry_date)
			values(?, ?, ?, ?, ?, ?, ?, now(),?,?, ?, ?)");
			$stmt->bind_param("iissisissss", $data['UserId'],$data['IdentificatorId'],$data['IdentificatorText'],$a[1],$a[2],$b[1],$b[2],$img_name1,$img_name2,$data['IssueDate'],$data['ExpiryDate']);	
			$stmt->execute();
			$stmt->close();
			$dbCon->close();
			$arr['result']=1;
			return $arr['result'];	
			}
			else
			{
			 
			
			$stmt->close();
			$dbCon->close();
			$arr['result']=0;
			return $arr['result'];	
			 
			}
			
			 
		}
		
	
	
	function addIdentificator($data)
		{
			$dbCon = AppModel::createConnection();
			
			$stmt = $dbCon->prepare("select user_identification.id,country_of_residence  from user_identification left join user_logins on user_logins.id= user_identification.user_id where  identity_number=? and country_of_residence=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("si", $data['IdentificatorText'],$data['CountryId']);
			$stmt->execute();
			$result = $stmt->get_result();
			
			$row = $result->fetch_assoc();
			 
			$img_name1='';
			$img_name2='';
			$a=array();
			$b=array();
			$a=explode('/',$data['IssueDate']);
			$b=explode('/',$data['ExpiryDate']);
			if($a[1]<10)
			{
				$a[1]='0'.$a[1];
			}
			if($b[1]<10)
			{
				$b[1]='0'.$b[1];
			}
			$arr=array();
			if(empty($row))
			{
			 
			$stmt = $dbCon->prepare("insert into user_identification(user_id,identification_type,identity_number,issue_month,issue_year,expiry_month, expiry_year,created_on,front_image_path, back_image_path,issue_date,expiry_date)
			values(?, ?, ?, ?, ?, ?, ?, now(),?,?, ?, ?)");
			$stmt->bind_param("iissisissss", $data['UserId'],$data['IdentificatorId'],$data['IdentificatorText'],$a[1],$a[2],$b[1],$b[2],$img_name1,$img_name2,$data['IssueDate'],$data['ExpiryDate']);	
			$stmt->execute();
			
			$stmt = $dbCon->prepare("update user_certificates set checkin_required=1,safeqloud_pay_status=3 where certificate_key=?");
			$stmt->bind_param("s", $data['certi']);
			$stmt->execute();
			
			$stmt->close();
			$dbCon->close();
			$arr['result']=1;
			return $arr['result'];	
			}
			else
			{
			$stmt->close();
			$dbCon->close();
			$arr['result']=0;
			return $arr['result'];	
			 
			}
			
			 
		}
		
		function addIdentificatorImages($data)
		{
			$dbCon = AppModel::createConnection();
			 
			 
			$stmt = $dbCon->prepare("select user_identification.id  from user_identification where  user_id=? and identification_type=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("ii", $data['UserId'],$data['IdentificatorId']);
			$stmt->execute();
			$result = $stmt->get_result();
			
			$row = $result->fetch_assoc();
			
			$data1 = strip_tags($data['ImageData']);
			$data1='url("data:image/png;base64,'.$data1.'")';
			//echo $data; die;
			define('UPLOAD_DIR','../estorecss/'); // image dir path
			$img_name1="new".microtime();
			file_put_contents(UPLOAD_DIR.$img_name1.".txt", $data1);
				 
			$arr=array();
			 
			if($data['imageId']==1)
			{
			$stmt = $dbCon->prepare("update user_identification set front_image_path=? where id=?");
			}
			else
			{
			$stmt = $dbCon->prepare("update user_identification set back_image_path=?,is_completed=1 where id=?");	
			}
			$stmt->bind_param("si",  $img_name1,$row['id']);	
			$stmt->execute();
			
			$stmt = $dbCon->prepare("select is_completed  from user_identification where  user_id=? and identification_type=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("ii", $data['UserId'],$data['IdentificatorId']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			
			if($row['is_completed']==1)
			{
			$stmt = $dbCon->prepare("update user_certificates set safeqloud_pay_status=4 where user_id=?");
			$stmt->bind_param("i", $data['UserId']);
			$stmt->execute();	
			}
			
			
			$stmt->close();
			$dbCon->close();
			$arr['result']=1;
			return $arr['result'];	
			 
			 
		}
		
		
		function  identificatorDetail($data)
		{
			$dbCon = AppModel::createConnection();
			 
			 
			$stmt = $dbCon->prepare("select identification_type  from user_identification where  user_id=?");
			
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['UserId']);
			$stmt->execute();
			$result = $stmt->get_result();
			$org=array();
			while($row = $result->fetch_assoc())
			{
			array_push($org,$row);	
			}
			
			 
			$stmt->close();
			$dbCon->close();
			 
			return $org;	
			 
			 
		}
		
		
	
	
	function verifyUserMobile($data)
    {
		
		 $dbCon = AppModel::createConnection();
		 
		 $stmt = $dbCon->prepare("select user_profiles.id from user_profiles left join user_logins on user_logins.id=user_profiles.user_logins_id where phone_number=? and country_of_residence=(select country_of_residence from user_logins where id=?) and user_logins_id!=?");
			/* bind parameters for markers */
		$stmt->bind_param("sii", $data['MobileNo'],$data['UserId'],$data['UserId']);
		$stmt->execute();
		$result = $stmt->get_result();
		$row = $result->fetch_assoc();
		
		 $arr=array();
        if(!empty($row))
		{
			$arr['result']=0;
			$stmt->close();
			$dbCon->close();
			return $arr;	
		}
		else
		{ 
			$num=(mt_rand(111111,999999));
			$stmt = $dbCon->prepare("update user_logins set otp_verification=? where id=?");
			/* bind parameters for markers */
			$stmt->bind_param("ii", $num,$data['UserId']);
			$stmt->execute();
			$stmt = $dbCon->prepare("update user_profiles set phone_number=? where user_logins_id=?");
			/* bind parameters for markers */
			$stmt->bind_param("si", $data['MobileNo'],$data['UserId']);
			$stmt->execute();
			 $stmt = $dbCon->prepare("select country_code,otp_verification  from user_logins left join phone_country_code on phone_country_code.id=user_logins.country_of_residence where user_logins.id=?");
			/* bind parameters for markers */
			$stmt->bind_param("i", $data['UserId']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc(); 
			$to            = '+'.trim($row['country_code']).''.trim($data['MobileNo']);
			 
			$subject       = "One time password!";
			$emailContent ="Your one time password to verify your mobile is : ".$num;
			$res=json_decode(sendSms($subject, $to, $emailContent),true);
			
			 
			$to            = '+919988109510';
			$subject       = "One time password!";
			$emailContent ="Your one time password to verify your mobile is : ".$num;
			$res=json_decode(sendSms($subject, $to, $emailContent),true);
			
			if($res['status']=='OK')
			{
			$arr['result']=1;
			}
			else
			{
			$arr['result']=2;	
			}
			$stmt->close();
			$dbCon->close();
			return $arr;	
		}	
		
    }
	
	function base64_to_jpeg($base64_string, $output_file) {
			$ifp = fopen( $output_file, 'wb' ); 
			$data = explode( ',', $base64_string );
			fwrite( $ifp, base64_decode( $data[1] ) );
			fclose( $ifp ); 
			return $output_file; 
		}
		
	function checkValidity($data)
    {
		
		 $dbCon = AppModel::createConnection();
		  
		
		 $stmt = $dbCon->prepare("select id,created_on,user_id,pay_required,checkin_required from user_certificates where certificate_key=? and is_connected=1 and is_valid=1");
			/* bind parameters for markers */
		$stmt->bind_param("s", $data['certi']);
		$stmt->execute();
		$result = $stmt->get_result();
		$row = $result->fetch_assoc();
		 
		$arry=array();
        if(empty($row))
		{
			$stmt->close();
			$dbCon->close();
			$arry['image']='';
			$arry['result']=0;
			$arry['first_name']='';
			$arry['last_name']='';
			$arry['email']='';
			$arry['id']=''; 
			$arry['identificator']=7;
			$arry['country_code']=''; 
			return $arry;	
		}
		else
		{
		if($row['pay_required']==2 || $row['checkin_required']==2)
		{
		$arry['identificator']=3;	
		}
		else
		{
		$arry['identificator']=7;		
		}
		$data['UserId']=$row['user_id'];
		$id=$row['id'];	
		$futureDate=date('Y-m-d', strtotime($row['created_on']. ' + 365 days'));
		$d=date('Y-m-d');
		  
		if($futureDate==$d || $futureDate<$d)
		{
			$arry['image']='';
			$arry['result']=0;
			$arry['first_name']='';
			$arry['last_name']='';
			$arry['email']='';
			$arry['id']=''; 
			$arry['identificator']=7;
			$arry['country_code']=''; 
			return $arry;
		}
		 $stmt = $dbCon->prepare("select user_logins.id,passport_image,first_name,last_name,email,country_code from user_logins left join phone_country_code on phone_country_code.id=user_logins.country_of_residence where user_logins.id=(select user_id from user_certificates where certificate_key=? and is_connected=1 and is_valid=1)");
			/* bind parameters for markers */
		$stmt->bind_param("s", $data['certi']);
		$stmt->execute();
		$result = $stmt->get_result();
		$row = $result->fetch_assoc();
		$filename="../estorecss/".$row ['passport_image'].".txt"; if (file_exists($filename)) { $value_a=file_get_contents("../estorecss/".$row ['passport_image'].".txt"); $value_a=str_replace('"','',$value_a);  $imgs = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$row ['passport_image'].'.jpg' ); $imgs=str_replace('../','',$imgs); $imgs='https://www.safeqloud.com/'.$imgs; } else {   $imgs=""; }
		
		
			 
			if($arry['identificator']==7)
			{
			$stQ=4;
			$stmt = $dbCon->prepare("select count(id) as num from user_certificates where user_id = ? and safeqloud_pay_status = ?");
				
						/* bind parameters for markers */
			$stmt->bind_param("ii", $data['UserId'],$stQ);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowId    = $result->fetch_assoc();
			 
			if($rowId['num']==0)
			{
			$stmt = $dbCon->prepare("select count(id) as num from user_cards where user_login_id = ?");
				
						/* bind parameters for markers */
			$stmt->bind_param("i", $data['UserId']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowId    = $result->fetch_assoc();	
			//print_r($rowId); die;
			if($rowId['num']==0)
			{
			  $arry['identificator']=1;
			}
			else
			{
			$stmt = $dbCon->prepare("update user_certificates set pay_required=1,safeqloud_pay_status=1 where id=?");
			$stmt->bind_param("i", $id);
			$stmt->execute();
			
			$stmt = $dbCon->prepare("select is_id_active num from user_profiles where user_logins_id = ?");
				
						/* bind parameters for markers */
			$stmt->bind_param("i", $data['UserId']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowId    = $result->fetch_assoc();	
			if($rowId['num']==0)
			{
			  $arry['identificator']=2;
			}
			else
			{
			$stmt = $dbCon->prepare("update user_certificates set safeqloud_pay_status=2 where id=?");
			$stmt->bind_param("i", $id);
			$stmt->execute();	
			
			$stmt = $dbCon->prepare("select count(id) as num from user_identification where user_id = ?");
			$stmt->bind_param("i", $data['UserId']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowId    = $result->fetch_assoc();	
			if($rowId['num']==0)
			{
			 $arry['identificator']=0;
			}
			
			else
			{
			$stmt = $dbCon->prepare("update user_certificates set checkin_required=1,safeqloud_pay_status=3 where id=?");
			$stmt->bind_param("i", $id);
			$stmt->execute();
			
			$stmt = $dbCon->prepare("select count(id) as num from user_identification where user_id = ? and is_completed=1");
			$stmt->bind_param("i", $data['UserId']);
			$stmt->execute();
			$result = $stmt->get_result();
			$rowId    = $result->fetch_assoc();	
			if($rowId['num']==0)
			{
			 $arry['identificator']=-1;
			}
			else
			{
			$stmt = $dbCon->prepare("update user_certificates set pay_required=1,checkin_required=1,safeqloud_pay_status=4 where id=?");
			$stmt->bind_param("i", $id);
			$stmt->execute();	
			$arry['identificator']=3;
			}
				
			}
			}
			}
			}
			else
			{
			$stmt = $dbCon->prepare("update user_certificates set pay_required=1,checkin_required=1,safeqloud_pay_status=4 where id=?");
			$stmt->bind_param("i", $id);
			$stmt->execute();	
			$arry['identificator']=3;	
			}	
			}
			$stmt->close();
			$dbCon->close();
			$arry['identificator']=$arry['identificator'];
			$arry['first_name']=$row['first_name'];
			$arry['last_name']=$row['last_name'];
			$arry['email']=$row['email'];
			$arry['id']=$row['id']; 
			$arry['country_code']=$row['country_code']; 
			$arry['image']=$imgs;
			$arry['result']=1;
			return $arry;	
		}	
		
    }
	
	
	function userDetails($data)
	{
		$dbCon = AppModel::createConnection();
		 
		 $stmt = $dbCon->prepare("select id,passport_image,first_name,last_name,email from user_logins where id=(select user_id from user_certificates where certificate_key=? and is_connected=1 and is_valid=1)");
			/* bind parameters for markers */
		$stmt->bind_param("s", $data['certi']);
		$stmt->execute();
		$result = $stmt->get_result();
		$row = $result->fetch_assoc();
		
		$filename="../estorecss/".$row ['passport_image'].".txt"; if (file_exists($filename)) { $value_a=file_get_contents("../estorecss/".$row ['passport_image'].".txt"); $value_a=str_replace('"','',$value_a);  $imgs = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$row ['passport_image'].'.jpg' ); $imgs=str_replace('../','',$imgs); $imgs='https://www.safeqloud.com/'.$imgs; } else {   $imgs=""; }
			 $arry=array();
			$arry['first_name']=html_entity_decode($row['first_name'],ENT_NOQUOTES, 'UTF-8');
			$arry['last_name']=html_entity_decode($row['last_name'],ENT_NOQUOTES, 'UTF-8');
			$arry['email']=$row['email'];
			$arry['user_id']=$row['id'];
			$arry['certificate_key']=$data['certi'];
			$arry['UserImage']=$imgs;
			$arry['result']=1; 
			 $stmt->close();
		$dbCon->close();
			return $arry;	
	}
	
	
	function userDetailsDstricts($data)
	{
		$dbCon = AppModel::createConnection();
		 
		 $stmt = $dbCon->prepare("select id,passport_image,first_name,last_name,email from user_logins where id=?");
			/* bind parameters for markers */
		$stmt->bind_param("i", $data['user_id']);
		$stmt->execute();
		$result = $stmt->get_result();
		$row = $result->fetch_assoc();
		
		$filename="../estorecss/".$row ['passport_image'].".txt"; if (file_exists($filename)) { $value_a=file_get_contents("../estorecss/".$row ['passport_image'].".txt"); $value_a=str_replace('"','',$value_a);  $imgs = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$row ['passport_image'].'.jpg' ); $imgs=str_replace('../','',$imgs); $imgs='https://www.safeqloud.com/'.$imgs; } else {   $imgs=""; }
			 $arry=array();
			$arry['first_name']=html_entity_decode($row['first_name'],ENT_NOQUOTES, 'UTF-8');
			$arry['last_name']=html_entity_decode($row['last_name'],ENT_NOQUOTES, 'UTF-8');
			$arry['email']=$row['email'];
			$arry['user_id']=$row['id'];
			 
			$arry['UserImage']=$imgs;
			$arry['result']=1; 
			 $stmt->close();
		$dbCon->close();
			return $arry;	
	}
	
	function verifyUserConsent($data)
    {
		
		 $dbCon = AppModel::createConnection();
		 
		 $stmt = $dbCon->prepare("select id from user_certificates where certificate_key=? and is_connected=1 and is_valid=1");
			/* bind parameters for markers */
		$stmt->bind_param("s", $data['certi']);
		$stmt->execute();
		$result = $stmt->get_result();
		$row = $result->fetch_assoc();
		 $arry=array();
        if(empty($row))
		{
			$stmt->close();
			$dbCon->close();
			$arry['first_name']='';
			$arry['last_name']='';
			$arry['company_name']='';
			$arry['image']='';
			$arry['result']=0;
			return $arry;	
		}
		else
		{
		
		 $stmt = $dbCon->prepare("select passport_image,first_name,last_name from user_logins where id=(select user_id from user_certificates where certificate_key=? and is_connected=1 and is_valid=1)");
			/* bind parameters for markers */
		$stmt->bind_param("s", $data['certi']);
		$stmt->execute();
		$result = $stmt->get_result();
		$row = $result->fetch_assoc();
		
		$stmt = $dbCon->prepare("select company_name from companies where id=(select company_id from oauth_clients where client_id=?)");
			/* bind parameters for markers */
		$stmt->bind_param("s", $data['clientId']);
		$stmt->execute();
		$result = $stmt->get_result();
		$rowCompany = $result->fetch_assoc();
		
		$filename="../estorecss/".$row ['passport_image'].".txt"; if (file_exists($filename)) { $value_a=file_get_contents("../estorecss/".$row ['passport_image'].".txt"); $value_a=str_replace('"','',$value_a);  $imgs = $this->base64_to_jpeg( $value_a, '../estorecss/tmp'.$row ['passport_image'].'.jpg' ); $imgs=str_replace('../','',$imgs); $imgs='https://www.safeqloud.com/'.$imgs; } else {   $imgs=""; }
			$stmt->close();
			$dbCon->close();
			
			$arry['first_name']=html_entity_decode($row['first_name'],ENT_NOQUOTES, 'UTF-8');
			$arry['last_name']=html_entity_decode($row['last_name'],ENT_NOQUOTES, 'UTF-8');
			$arry['company_name']=html_entity_decode($rowCompany['company_name'],ENT_NOQUOTES, 'UTF-8');
			$arry['image']=$imgs;
			$arry['result']=1;
			return $arry;	
		}	
		
    }
	
	
	
	
	
	function userDeliveryInvoiceInfo($data)
    {
		
		 $dbCon = AppModel::createConnection();
		 
		 $stmt = $dbCon->prepare("select invoice_address,invoice_zipcode,invoice_city,invoice_port,invoice_address_required from user_profiles where user_logins_id=?");
			/* bind parameters for markers */
		$stmt->bind_param("s", $data['userId']);
		$stmt->execute();
		$result = $stmt->get_result();
		$row = $result->fetch_assoc();
		$row['invoice_address']=html_entity_decode($row['invoice_address'],ENT_NOQUOTES, 'UTF-8');
		$row['invoice_city']=html_entity_decode($row['invoice_city'],ENT_NOQUOTES, 'UTF-8');
		
		$stmt->close();
		$dbCon->close();
		return $row;	
		
		
    }
	
	
	function purchaseDetail($data)
    {
		
		$dbCon = AppModel::createConnection();
		$stmt = $dbCon->prepare("update user_certificates set login_status=2,purchased_for=? where login_status =4 and user_id=? ");
        
        /* bind parameters for markers */
        $stmt->bind_param("ii", $data['company_id'],$data['user_id']);
        $stmt->execute();
		 return 1;	
	 
		
    }
	
		function cardDetail($data)
		{ 
		
			$dbCon = AppModel::createConnection();
			if($data['company_id']==0)
			{
			$stmt = $dbCon->prepare("select * from  user_cards where `id`=?");
			$stmt->bind_param("i", $data['card_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			$row['name_on_card']=html_entity_decode($row['name_on_card'],ENT_NOQUOTES, 'UTF-8');
			$stmt->close();
			$dbCon->close();
			return $row;
			}
			else
			{
			$stmt = $dbCon->prepare("select company_cards.id,card_number,card_cvv,exp_month,exp_year,card_type,company_name as name_on_card from  company_cards left join companies on companies.id=company_cards.company_id where company_cards.id=?");
			$stmt->bind_param("i", $data['card_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			 
			$stmt->close();
			$dbCon->close();
			return $row;	
			}
		}
	
	function updateCardPurchaseDetail($data)
    {
		
		$dbCon = AppModel::createConnection();
		$stmt = $dbCon->prepare("update user_certificates set card_id=? where certificate_key=? ");
        
        /* bind parameters for markers */
        $stmt->bind_param("is", $data['card_id'],$data['certificate_key']);
        $stmt->execute();
		$stmt->close();
		$dbCon->close();
		 return 1;	
	 
		
    }
	
	function savePurchaseCardDetails($data)
		{ 
		
			$dbCon = AppModel::createConnection();
			 $data['card_type']='Visa';
			$stmt = $dbCon->prepare("insert into user_cards(`user_login_id`,`created_on`,`card_number`,card_cvv,exp_month,exp_year,name_on_card,card_type) values(?, now(), ?, ?, ?, ?, ?, ?)");
			$stmt->bind_param("isisiss", $data['UserId'],$data['CardNumber'],$data['Cvv'],$data['ExpirationMonth'],$data['ExpirationYear'],htmlentities($data['CardHolderName'],ENT_NOQUOTES, 'UTF-8'),$data['card_type']);
			$stmt->execute();
			$id=$stmt->insert_id;
			$stmt = $dbCon->prepare("update user_certificates set card_id=? where certificate_key=? ");
        
        /* bind parameters for markers */
			$stmt->bind_param("is", $id,$data['certificate_key']);
			$stmt->execute();
			$stmt->close();
			$dbCon->close();
			return 1;
			 
		}
		
		
		function saveUpdatedPurchaseCardDetails($data)
		{ 
		
			$dbCon = AppModel::createConnection();
			 $data['card_type']='Visa';
			$stmt = $dbCon->prepare("update user_cards set `card_number`=?,card_cvv=?,exp_month=?,exp_year=?,name_on_card=?,card_type=? where id=?");
			$stmt->bind_param("sisiss", $data['CardNumber'],$data['Cvv'],$data['ExpirationMonth'],$data['ExpirationYear'],htmlentities($data['CardHolderName'],ENT_NOQUOTES, 'UTF-8'),$data['card_type'],$data['CardId']);
			$stmt->execute();
			 
			$stmt = $dbCon->prepare("update user_certificates set card_id=? where certificate_key=? ");
        
        /* bind parameters for markers */
			$stmt->bind_param("is", $data['CardId'],$data['Certificatekey']);
			$stmt->execute();
			$stmt->close();
			$dbCon->close();
			return 1;
			 
		}
	
	function confirmPurchase($data)
		{ 
		
			$dbCon = AppModel::createConnection();
			  
			$stmt = $dbCon->prepare("update user_certificates set login_status=2 where certificate_key=? ");
        
        /* bind parameters for markers */
			$stmt->bind_param("s", $data['Certificatekey']);
			$stmt->execute();
			$stmt->close();
			$dbCon->close();
			return 1;
			 
		}
	function purchaseDetailUpdate($data)
    {
		
		$dbCon = AppModel::createConnection();
		$stmt = $dbCon->prepare("update user_certificates set purchased_for=? where certificate_key=? ");
        
        /* bind parameters for markers */
        $stmt->bind_param("is", $data['company_id'],$data['certificate_key']);
        $stmt->execute();
		if($data['company_id']==0)
		{
		$stmt = $dbCon->prepare("select id,name_on_card,card_number,card_cvv,exp_month,exp_year,card_type from  user_cards where `user_login_id`=?");
			$stmt->bind_param("i", $data['user_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			 
			$org=array();
			while($row = $result->fetch_assoc())
			{
				$row['name_on_card']=html_entity_decode($row['name_on_card'],ENT_NOQUOTES, 'UTF-8');
				$row['company_id']=0;
				$row['card_number2']='**** **** **** '.substr($row['card_number'],-4);
				array_push($org,$row);
			}
			 return $org;	
		}
	 else
	 {
		$stmt = $dbCon->prepare("select id,name_on_card,card_number,card_cvv,exp_month,exp_year,card_type from  company_cards where `id`=(select card_id from user_company_profile where user_login_id=? and company_id=?)");
			$stmt->bind_param("ii", $data['user_id'],$data['company_id']);
			$stmt->execute();
			$result = $stmt->get_result();
			 
			$org=array();
			while($row = $result->fetch_assoc())
			{
				$row['name_on_card']=html_entity_decode($row['name_on_card'],ENT_NOQUOTES, 'UTF-8');
				$row['company_id']=$data['company_id'];
				$row['card_number2']='**** **** **** '.substr($row['card_number'],-4);
				array_push($org,$row);
			}
			 return $org;	 
	 }
		
    }
	
	
	function checkPassword($data)
    {
		
		 $dbCon = AppModel::createConnection();
		 $stmt = $dbCon->prepare("select first_name,last_name,user_id,email from user_certificates left join user_logins on user_logins.id=user_certificates.user_id where certificate_key=? and user_certificates.password=?");
			/* bind parameters for markers */
		$stmt->bind_param("ss", $data['certi'],$data['password']);
		$stmt->execute();
		$result = $stmt->get_result();
		$row = $result->fetch_assoc();
		 
		$org=array();
        if(empty($row))
		{
			$org['result']=0;
			$org['first_name']=0;
			$org['last_name']=0;
			$org['user_id']=0;
			$org['email']=0;
			$stmt->close();
			$dbCon->close();
			return $org;	
		}
		else
		{
			$stmt = $dbCon->prepare("update user_certificates set is_connected=1 where certificate_key=? and password=?");
			/* bind parameters for markers */
			$stmt->bind_param("ss", $data['certi'],$data['password']);
			$stmt->execute();
			$row['result']=1;
			$stmt->close();
			$dbCon->close();
			return $row;	
		}	
		
    }
    
	function verifyPassword($data)
    {
		
		 $dbCon = AppModel::createConnection();
		 $stmt = $dbCon->prepare("select id,time_out,password,login_type,login_status from user_certificates  where certificate_key=?");
			/* bind parameters for markers */
		$stmt->bind_param("s", $data['certi']);
		$stmt->execute();
		$result = $stmt->get_result();
		$row = $result->fetch_assoc();
		  // print_r($row); die;
		if($row['password']!=$data['password'])
		{
			 
			if($row['time_out']==1)
			{
				 
			$stmt = $dbCon->prepare("update user_certificates set time_out=0,login_status=0,login_started_for=null where certificate_key=?");
			/* bind parameters for markers */
			$stmt->bind_param("s", $data['certi']);
			$stmt->execute();
			$stmt->close();
			$dbCon->close();
			return 2;	
			}
			else
			{
			$stmt = $dbCon->prepare("update user_certificates set login_status=3 where certificate_key=?");
			/* bind parameters for markers */
			$stmt->bind_param("s", $data['certi']);
			$stmt->execute();
			
			$stmt->close();
			$dbCon->close();
			return 0;
			}			
		}
		else
		{
			 
			if($row['time_out']==1)
			{
				 
			$stmt = $dbCon->prepare("update user_certificates set time_out=0,login_status=0,login_started_for=null where certificate_key=?");
			/* bind parameters for markers */
			$stmt->bind_param("s", $data['certi']);
			$stmt->execute();
			$stmt->close();
			$dbCon->close();
			return 2;	
			}
			else
			{
			if($row['login_type']==1 || $row['login_type']==9)
			{	 
			$stmt = $dbCon->prepare("update user_certificates set login_status=2 where certificate_key=?");
			/* bind parameters for markers */
			$stmt->bind_param("s", $data['certi']);
			$stmt->execute();
							
			$stmt->close();
			$dbCon->close();
			return 1;
			}
			else if($row['login_type']==4)
			{	 
			$stmt = $dbCon->prepare("update user_certificates set login_status=2 where certificate_key=?");
			/* bind parameters for markers */
			$stmt->bind_param("s", $data['certi']);
			$stmt->execute();
							
			$stmt->close();
			$dbCon->close();
			return 1;
			}
			else
			{
			$stmt = $dbCon->prepare("update user_certificates set login_status=4 where certificate_key=?");
			/* bind parameters for markers */
			$stmt->bind_param("s", $data['certi']);
			$stmt->execute();
			$stmt->close();
			$dbCon->close();
			return 3;	
			}
			}			
		}	
		
    }
	
	function verifyInterAppPassword($data)
    {
		
		 $dbCon = AppModel::createConnection();
		 $stmt = $dbCon->prepare("select id,time_out,password,login_type from user_certificates  where certificate_key=?");
			/* bind parameters for markers */
		$stmt->bind_param("s", $data['certi']);
		$stmt->execute();
		$result = $stmt->get_result();
		$row = $result->fetch_assoc();
		
		 
		$org=array(); 
		if($row['password']==$data['password'])
		{
			 
			$time=microtime();
			$session=$this->encrypt_decrypt('encrypt',$time);
			$stmt = $dbCon->prepare("update user_certificates set session_info=? where certificate_key=?");
			/* bind parameters for markers */
			$stmt->bind_param("ss", $session,$data['certi']);
			$stmt->execute();
			$org['result']=1;
			$org['session']=$session;
			$stmt->close();
			$dbCon->close();
			return $org;		
		}
		else
		{
			$org['result']=0;
			$org['session']=0; 
			$stmt->close();
			$dbCon->close();
			return $org;	
		 			
		}	
		
    }
	
	function verifyInterAppSession($data)
    {
		
		 $dbCon = AppModel::createConnection();
		 $stmt = $dbCon->prepare("select user_certificates.id,user_id,user_logins.first_name,user_logins.last_name from user_certificates left join user_logins on user_certificates.user_id=user_logins.id  where session_info=?");
			/* bind parameters for markers */
		$stmt->bind_param("s", $data['certi']);
		$stmt->execute();
		$result = $stmt->get_result();
		$row = $result->fetch_assoc();
		  $org=array(); 
		if(!empty($row))
		{
			 $stmt = $dbCon->prepare("update user_certificates set session_info=null where id=?");
			/* bind parameters for markers */
			$stmt->bind_param("i",$row['id']);
			$stmt->execute();
			$org['result']=1;
			$org['user_id']=$row['user_id'];
			$org['name']=$row['first_name'].' '.$row['last_name'];
			$stmt->close();
			$dbCon->close();
			return $org;		
		}
		else
		{
			$org['result']=0;
			$org['user_id']=0; 
			$org['name']=''; 
			$stmt->close();
			$dbCon->close();
			return $org;	
		 			
		}	
		
    }
	
	function addFoodDetailToCart()
		{
			$dbCon = AppModel::createConnection();
			
			 $id=$_POST['checkid'];
			 $item_id=$_POST['item_id'];
			$stmt = $dbCon->prepare("select * from hotel_roomservice_item_ordered where qloud_checkout_id=? and dish_id=? and is_verified=0 and service_type=?");
			$stmt->bind_param("iii",$id,$item_id,$_POST['service_type']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			 
			if(empty($row))
			{
			$t=$_POST['price']*$_POST['quantity'];
			$stmt = $dbCon->prepare("insert into hotel_roomservice_item_ordered(dish_price,dish_id,dish_quantity,qloud_checkout_id,dish_name,dish_image,dish_detail,total_price,created_on,service_type)
			values(?,?,?,?,?,?,?,?,now(),?)");
			$stmt->bind_param("iiiisssii",$_POST['price'],$item_id,$_POST['quantity'],$id,$_POST['dish_name'],$_POST['dish_image'],$_POST['dish_detail'],$t,$_POST['service_type']);
			$stmt->execute();
			}
			else
			{
			$t=$_POST['price']*$_POST['quantity'];
			$quantity=$_POST['quantity']+$row['dish_quantity'];
			$stmt = $dbCon->prepare("update hotel_roomservice_item_ordered set dish_quantity=?,total_price=? where id=?");
			$stmt->bind_param("iii",$quantity,$t,$row['id']);
			$stmt->execute();	
			}
			
	 
			$stmt->close();
			$dbCon->close();
			return 1;
			
			 
			
		}
		
	function addDrycleaningItemToCart()
		{
			$dbCon = AppModel::createConnection();
			
			 $id=$_POST['checkid'];
			 $item_id=$_POST['item_id'];
			$stmt = $dbCon->prepare("select * from hotel_roomservice_item_ordered where qloud_checkout_id=? and dish_id=? and is_verified=0 and service_type=?");
			$stmt->bind_param("iii",$id,$item_id,$_POST['service_type']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			 
			if(empty($row))
			{
			$t=$_POST['price']*$_POST['quantity'];
			$stmt = $dbCon->prepare("insert into hotel_roomservice_item_ordered(dish_price,dish_id,dish_quantity,qloud_checkout_id,dish_name,dish_image,dish_detail,total_price,created_on,service_type)
			values(?,?,?,?,?,?,?,?,now(),?)");
			$stmt->bind_param("iiiisssii",$_POST['price'],$item_id,$_POST['quantity'],$id,$_POST['dish_name'],$_POST['dish_image'],$_POST['dish_detail'],$t,$_POST['service_type']);
			$stmt->execute();
			}
			else
			{
				if($_POST['quantity']==0)
				{
				$stmt = $dbCon->prepare("delete from hotel_roomservice_item_ordered where id=?");
				$stmt->bind_param("i",$row['id']);
				$stmt->execute();	
				}
				else
				{
				$t=$_POST['price']*$_POST['quantity'];
				$quantity=$_POST['quantity'];
				$stmt = $dbCon->prepare("update hotel_roomservice_item_ordered set dish_quantity=?,total_price=? where id=?");
				$stmt->bind_param("iii",$quantity,$t,$row['id']);
				$stmt->execute();
				}
			}
			
	 
			$stmt->close();
			$dbCon->close();
			return 1;
			
			 
			
		}
	
	
	function addFoodToCart()
		{
			$dbCon = AppModel::createConnection();
			
			 $id=$this->encrypt_decrypt('decrypt',$_POST['checkid']);
			 $item_id=$this->encrypt_decrypt('decrypt',$_POST['item_id']);
			$stmt = $dbCon->prepare("select * from hotel_roomservice_item_ordered where qloud_checkout_id=? and dish_id=? and is_verified=0");
			$stmt->bind_param("ii",$id,$item_id);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			 
			if(empty($row))
			{
			$t=$_POST['price']*$_POST['quantity'];
			$stmt = $dbCon->prepare("insert into hotel_roomservice_item_ordered(dish_price,dish_id,dish_quantity,qloud_checkout_id,dish_name,dish_image,dish_detail,total_price,created_on,service_type)
			values(?,?,?,?,?,?,?,?,now(),?)");
			$stmt->bind_param("iiiisssii",$_POST['price'],$item_id,$_POST['quantity'],$id,$_POST['dish_name'],$_POST['dish_image'],$_POST['dish_detail'],$t,$_POST['service_type']);
			$stmt->execute();
			}
			else
			{
			$t=$_POST['price']*$_POST['quantity'];
			$quantity=$_POST['quantity']+$row['dish_quantity'];
			$stmt = $dbCon->prepare("update hotel_roomservice_item_ordered set dish_quantity=?,total_price=? where id=?");
			$stmt->bind_param("iii",$quantity,$t,$row['id']);
			$stmt->execute();	
			}
			
	 
			$stmt->close();
			$dbCon->close();
			return 1;
			
			 
			
		}
		
		
		
		function addServiceToCart()
		{
			$dbCon = AppModel::createConnection();
			 
			$id=$this->encrypt_decrypt('decrypt',$_POST['location_id']);
			$item_id=$this->encrypt_decrypt('decrypt',$_POST['item_id']);
			
			$t=$_POST['price']*$_POST['quantity'];
			$stmt = $dbCon->prepare("insert into hotel_roomservice_item_ordered(is_private,location_id,booking_person_id,one_shared,dish_price,dish_id,dish_quantity,dish_name,dish_image,dish_detail,total_price,created_on,service_type)
			values(?,?,?,?,?,?,?,?,?,?,?,now(),?)");
			$stmt->bind_param("iiiiiiisssii",$_POST['shared_type_private'],$id,$_POST['user_id'],$_POST['shared_type'],$_POST['price'],$item_id,$_POST['quantity'],$_POST['dish_name'],$_POST['dish_image'],$_POST['dish_detail'],$t,$_POST['service_type']);
			$stmt->execute();
			$stmt->close();
			$dbCon->close();
			return 1;
			
			 
			
		}
		
		
		
		
		
		
	function addOpenOnetimeServiceToCart()
		{
			$dbCon = AppModel::createConnection();
			 
			$id=$this->encrypt_decrypt('decrypt',$_POST['location_id']);
			$item_id=$this->encrypt_decrypt('decrypt',$_POST['item_id']);
			
			$t=$_POST['price']*$_POST['quantity'];
			$stmt = $dbCon->prepare("insert into hotel_roomservice_item_ordered(is_private,location_id,booking_person_id,one_shared,dish_price,dish_id,dish_quantity,dish_name,dish_image,dish_detail,total_price,created_on,service_type,booking_time,booking_date)
			values(?,?,?,?,?,?,?,?,?,?,?,now(),?,?,?)");
			$stmt->bind_param("iiiiiiisssiiii",$_POST['shared_type_private'],$id,$_POST['user_id'],$_POST['shared_type'],$_POST['price'],$item_id,$_POST['quantity'],$_POST['dish_name'],$_POST['dish_image'],$_POST['dish_detail'],$t,$_POST['service_type'],$_POST['event_time'],$_POST['event_date']);
			$stmt->execute();
			$stmt->close();
			$dbCon->close();
			return 1;
			
			 
			
		}
		
		
		
		
	function removeItemFromCart()
		{
			$dbCon = AppModel::createConnection();
			
			 $id=$this->encrypt_decrypt('decrypt',$_POST['checkid']);
			 $item_id=$this->encrypt_decrypt('decrypt',$_POST['item_id']);
			 $stmt = $dbCon->prepare("delete from hotel_roomservice_item_ordered where qloud_checkout_id=? and dish_id=? and is_verified=0 and service_type=?");
			$stmt->bind_param("iii",$id,$item_id,$_POST['service_type']);
			$stmt->execute();
	 
			$stmt->close();
			$dbCon->close();
			return 1;
			
			 
			
		}
		
		
		function removeBookingFromCart()
		{
			$dbCon = AppModel::createConnection();
			$item_id=$this->encrypt_decrypt('decrypt',$_POST['item_id']);
			$stmt = $dbCon->prepare("delete from hotel_roomservice_item_ordered where booking_person_id=? and dish_id=? and is_verified=0 and service_type=?");
			$stmt->bind_param("iii",$_POST['booking_person_id'],$item_id,$_POST['service_type']);
			$stmt->execute();
	 
			$stmt->close();
			$dbCon->close();
			return 1;
			
			 
			
		}
		
		
		function removeAmenityFromCart()
		{
			$dbCon = AppModel::createConnection();
			
			 $id=$this->encrypt_decrypt('decrypt',$_POST['id']);
			 $stmt = $dbCon->prepare("delete from company_hotel_amenities_user_request where id=?");
			$stmt->bind_param("i",$id);
			$stmt->execute();
	 
			$stmt->close();
			$dbCon->close();
			return 1;
			
			 
			
		}
		
	
	
	function updateLoginStatus($data)
    {
		
		 $dbCon = AppModel::createConnection();
		
			$stmt = $dbCon->prepare("update user_certificates set login_status=1 where certificate_key=?");
			/* bind parameters for markers */
			$stmt->bind_param("s", $data['certi']);
			$stmt->execute();
			 
			$stmt->close();
			$dbCon->close();
			return 1;	
	 	
		
    }
	function certificateExxpiryInfo($data)
		{ 
		
			$dbCon = AppModel::createConnection();
			 
			$stmt = $dbCon->prepare("select created_on from user_certificates where certificate_key=?");
			$stmt->bind_param("i", $data['certificate_key']);
			$stmt->execute();
			$result = $stmt->get_result();
			
			$row = $result->fetch_assoc();
			$row['created_on']=date('Y-m-d', strtotime($row['created_on']));
			$row['expiry_date']=date('Y-m-d', strtotime($row['created_on']. ' + 365 days'));
			$stmt->close();
			$dbCon->close();
			return $row;	
		}
	
	function updateLoginIp($data)
    {
		
		 $dbCon = AppModel::createConnection();
		 $a=explode('_',$data['ip']);
		 $data['ip']=$a[0];
		 
		 $stmt = $dbCon->prepare("update user_certificates set login_started_for=null,login_status=0,login_type=1 where certificate_key=?");
		/* bind parameters for markers */
		$stmt->bind_param("s", $data['certi']);
		$stmt->execute();
		 
		if(sizeof($a)==2)
		{
			$user=$this->encrypt_decrypt('decrypt',$a[1]);
			$stmt = $dbCon->prepare("select user_id from user_certificates where certificate_key=?");
			/* bind parameters for markers */
			$stmt->bind_param("s", $data['certi']);
			$stmt->execute();
			$result = $stmt->get_result();
			$row = $result->fetch_assoc();
			if($user!=$row['user_id'])
			{
			$stmt->close();
			$dbCon->close();
			return 3;	
			}
		}
		 $ip=$this->encrypt_decrypt('decrypt',$data['ip']);
	 
		$stmt = $dbCon->prepare("select id,certificate_key from user_certificates where login_started_for=?");
			/* bind parameters for markers */
		$stmt->bind_param("s", $ip);
		$stmt->execute();
		$result = $stmt->get_result();
		$row = $result->fetch_assoc();
		 
		 if(empty($row))
		 {
			 
			 
			$stmt = $dbCon->prepare("update user_certificates set login_started_for=?,login_status=1,time_out=0 where certificate_key=?");
			/* bind parameters for markers */
			$stmt->bind_param("ss", $ip,$data['certi']);
			$stmt->execute();
			 
			$stmt->close();
			$dbCon->close();
			return 1;	
			 
		 }
		 else
		 {
			 $stmt = $dbCon->prepare("update user_certificates set login_started_for='',login_status=1,time_out=0 where login_started_for=?");
			/* bind parameters for markers */
			$stmt->bind_param("s", $ip);
			$stmt->execute();
			
			
			$stmt = $dbCon->prepare("update user_certificates set login_started_for=?,login_status=1 where certificate_key=?");
			/* bind parameters for markers */
			$stmt->bind_param("ss", $ip,$data['certi']);
			$stmt->execute(); 
			$stmt->close();
			$dbCon->close();
			return 1;
			
		 }
		 
		
    }
	
	
	function clearIps($data)
    {
		
		$dbCon = AppModel::createConnection();
		$stmt = $dbCon->prepare("update user_certificates set login_started_for=null,login_status=0 where certificate_key=?");
		/* bind parameters for markers */
		$stmt->bind_param("s", $data['certi']);
		$stmt->execute();
			 
		$stmt->close();
		$dbCon->close();
		return 1;	
		
    }
	
	
	function clearLogin($data)
    {
		
		$dbCon = AppModel::createConnection();
		$stmt = $dbCon->prepare("update user_certificates set login_started_for=null,login_status=0 where certificate_key=?");
		/* bind parameters for markers */
		$stmt->bind_param("s", $data['certi']);
		$stmt->execute();
		$stmt->close();
		$dbCon->close();
		return 1;	
		
    }
	
	
	function clearCertificate($data)
    {
		
		$dbCon = AppModel::createConnection();
		$stmt = $dbCon->prepare("update user_certificates set login_started_for=null,login_status=0,is_valid=0 where certificate_key=?");
		/* bind parameters for markers */
		$stmt->bind_param("s", $data['certi']);
		$stmt->execute();
			 
		$stmt->close();
		$dbCon->close();
		return 1;	
		
    }
	
	function checkOrderReference($data)
    {
		
		 $dbCon = AppModel::createConnection();
		 $ip=$this->encrypt_decrypt('decrypt',$_POST['orderRef']);
		 
		 $stmt = $dbCon->prepare("select id,login_status,user_id from user_certificates where login_started_for=?");
		/* bind parameters for markers */
		$stmt->bind_param("s", $ip);
		$stmt->execute();
		$result = $stmt->get_result();
		$row = $result->fetch_assoc();
		 
		 if(empty($row))
		 {
			 
			$stmt->close();
			$dbCon->close();
			return 0; 
			
		 }
		 else
		 {
			 if($_POST['loginType']==3 || $_POST['loginType']==9)
			 {
				 if(isset($_POST['payForFood']))
				 {
					 $payFood=$_POST['payForFood'];
					 $serviceType=$_POST['serviceType'];
				 } 
				 else
				 {
					$payFood=0; 
					 $serviceType=0;
				 }
				 $stmt = $dbCon->prepare("update user_certificates set client_id=null where user_id=?");
				/* bind parameters for markers */
				$stmt->bind_param("i", $row['user_id']);
				$stmt->execute(); 
				
				if(isset($_POST['total_price']))
				{
				$price=$_POST['total_price'];
				}
				else
				{
					$price=0;
				}
				
				if(isset($_POST['booking_id']))
				 {
					 $_POST['booking_id']=$_POST['booking_id'];
				 }
				 else
				 {
					 $_POST['booking_id']='-';
				 }
				$stmt = $dbCon->prepare("update user_certificates set client_id=?,login_type=?,total_price=?,pay_for_food=?,session_info=?,service_type=?  where id=?");
				/* bind parameters for markers */
				$stmt->bind_param("siiisii", $_POST['client_id'],$_POST['loginType'],$price,$payFood,$_POST['booking_id'],$serviceType,$row['id']);
				$stmt->execute(); 
			 }
			 else if($_POST['loginType']==5 || $_POST['loginType']==4)
			 {
				 $stmt = $dbCon->prepare("update user_certificates set client_id=null where user_id=?");
				/* bind parameters for markers */
				$stmt->bind_param("i", $row['user_id']);
				$stmt->execute(); 
				
				if(isset($_POST['total_price']))
				{
				$price=$_POST['total_price'];
				}
				else
				{
					$price=0;
				}
				 if(isset($_POST['booking_id']))
				 {
					 $_POST['booking_id']=$_POST['booking_id'];
				 }
				 else
				 {
					 $_POST['booking_id']='-';
				 }
				$stmt = $dbCon->prepare("update user_certificates set client_id=?,login_type=?,total_price=?,session_info=? where id=?");
				/* bind parameters for markers */
				$stmt->bind_param("siisi", $_POST['client_id'],$_POST['loginType'],$price,$_POST['booking_id'],$row['id']);
				$stmt->execute(); 
				 
			 }
			 else
			 {
				$stmt = $dbCon->prepare("update user_certificates set login_type=? where id=?");
				/* bind parameters for markers */
				$stmt->bind_param("ii", $_POST['loginType'],$row['id']);
				$stmt->execute();
			 }
			 
			 /*$stmt = $dbCon->prepare("select id,login_type,user_id from user_certificates where login_started_for=?");
		 
		$stmt->bind_param("s", $ip);
		$stmt->execute();
		$result = $stmt->get_result();
		$row = $result->fetch_assoc();*/
			$stmt->close();
			$dbCon->close();
			return $row['login_status']; 
		 }
    }
	function countPickupAddress($data)
    {
		
		 $dbCon = AppModel::createConnection();
		 
		 $stmt = $dbCon->prepare("select id,client_id from user_certificates where certificate_key=? and is_connected=1 and is_valid=1");
			/* bind parameters for markers */
		$stmt->bind_param("s", $data['certi']);
		$stmt->execute();
		$result = $stmt->get_result();
		$row = $result->fetch_assoc();
		 
		
		 
		if($row['client_id']==null || $row['client_id']=='')
		{
		$id=$this->encrypt_decrypt('decrypt',$data['company_id']);
		$stmt = $dbCon->prepare("select count(id) as num from company_pickup_address where company_id=?");
			/* bind parameters for markers */
		$stmt->bind_param("i", $id);	
		}
		else
		{
		$stmt = $dbCon->prepare("select count(id) as num from company_pickup_address where company_id=(select company_id from oauth_clients where client_id=?)");
			/* bind parameters for markers */
		$stmt->bind_param("s", $row['client_id']);	
		}
		
		$stmt->execute();
		$result = $stmt->get_result();
		$rowCompany = $result->fetch_assoc();
		
		 
			$stmt->close();
			$dbCon->close();
			return $rowCompany;	
		 
		
    }

	
	function updatePickupDelivery($data)
    {
		
		 $dbCon = AppModel::createConnection();
		 
		 $stmt = $dbCon->prepare("update user_certificates set delivery_type=? where certificate_key=?");
			/* bind parameters for markers */
		$stmt->bind_param("is",$data['delivery_type'], $data['certi']);
		$stmt->execute();
		 
			$stmt->close();
			$dbCon->close();
			return 1;	
		 
		
    }
	
	
	function updatePickupAddress($data)
    {
		
		 $dbCon = AppModel::createConnection();
		 
		 $stmt = $dbCon->prepare("update user_certificates set pickup_address_id=? where certificate_key=?");
			/* bind parameters for markers */
		$stmt->bind_param("is",$data['pickup_address_id'], $data['certi']);
		$stmt->execute();
		 
			$stmt->close();
			$dbCon->close();
			return 1;	
		 
		
    }

function pickupAddressDetail($data)
    {
		
		 $dbCon = AppModel::createConnection();
		 
		 $stmt = $dbCon->prepare("select id,client_id from user_certificates where certificate_key=? and is_connected=1 and is_valid=1");
			/* bind parameters for markers */
		$stmt->bind_param("s", $data['certi']);
		$stmt->execute();
		$result = $stmt->get_result();
		$row = $result->fetch_assoc();
		 
		if($row['client_id']==null || $row['client_id']=='')
		{
		$id=$this->encrypt_decrypt('decrypt',$data['company_id']);
		$stmt = $dbCon->prepare("select id,address,port_number,zipcode,pickup_address_name,state as country_name,city from company_pickup_address where company_id=?");
			/* bind parameters for markers */
		$stmt->bind_param("i", $id);	
		}
		else
		{
		 
		
		$stmt = $dbCon->prepare("select id,address,port_number,zipcode,pickup_address_name,state as country_name,city from company_pickup_address where company_id=(select company_id from oauth_clients where client_id=?)");
			/* bind parameters for markers */
		$stmt->bind_param("s", $row['client_id']);
		}
		$stmt->execute();
		$result = $stmt->get_result();
		$org=array();
		while($rowCompany = $result->fetch_assoc())
		{
			 
			array_push($org,$rowCompany);
		}
		
		 
			$stmt->close();
			$dbCon->close();
			return $org;	
		 
		
    }	
	
	function getUserId($data)
    {
		
		 $dbCon = AppModel::createConnection();
		 $ip=$this->encrypt_decrypt('decrypt',$_POST['orderRef']);
		 
		 $stmt = $dbCon->prepare("select id,login_status,user_id from user_certificates where login_started_for=?");
		/* bind parameters for markers */
		$stmt->bind_param("s", $ip);
		$stmt->execute();
		$result = $stmt->get_result();
		$row = $result->fetch_assoc();
		$stmt->close();
		$dbCon->close();
		return $row['user_id']; 
	
    }
	
	function bookingDetails()
		{
			$dbCon = AppModel::createConnection();
			$id= $this -> encrypt_decrypt('decrypt',$_POST['id']);   
			$rid= $this -> encrypt_decrypt('decrypt',$_POST['rid']); 
			$date1=strtotime($_POST['date1']);
			$date2=strtotime($_POST['date2']);
			 $stmt = $dbCon->prepare("insert into `hotel_checkout_detail`(`guest_adult`,`guest_children`,`guest_infant`,`checkin_date`,`checkout_date`,`room_type_id`,`total_days`,`price`,`created_on`,hotel_property_type,checkin_booking_date,checkout_booking_date) values ( ?, ?, ?, ?, ?, ?, ?, ?, now(), ?,?,?)");
			
			/* bind parameters for markers */
			$stmt->bind_param("iiissiiiiss", $_POST['guest_adults'], $_POST['guest_children'], $_POST['guest_infants'],$_POST['date1'],$_POST['date2'],$id,$_POST['total_days'],$_POST['price'],$_POST['hotel_property_type'],$date1,$date2);
			$stmt->execute();
			$id=$stmt->insert_id;
			$stmt->close();
			$dbCon->close();
			return $this -> encrypt_decrypt('encrypt',$id);
			
		}
		
    
}